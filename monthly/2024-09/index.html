<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
    div.mermaid {
      width: 0;
    }
</style>

  <link rel="preload" as="font" href="https://wangzaixiang.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://wangzaixiang.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2"  type="font/woff2" crossorigin>


<link rel="stylesheet" href="https://wangzaixiang.github.io/main.css">



  
  
  
  
  
    
  

  
  
    
    
  
  
  
    
  
  
  
  
    
  
  
  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>September 2024 | 程序人生</title>
<meta name="description" content="记录、思考、分享">
<link rel="canonical" href="https://wangzaixiang.github.io/monthly/2024-09/">


  <meta name="twitter:card" content="summary_large_image">
  
    <meta name="twitter:image" content="https://wangzaixiang.github.io/doks.png">
  
  <meta name="twitter:title" content="September 2024">
  <meta name="twitter:description" content="记录、思考、分享">
  <meta name="twitter:site" content="@wangzaixiang">
  <meta name="twitter:creator" content="@wangzaixiang">
  
  <meta property="og:title" content="September 2024">
  <meta property="og:description" content="记录、思考、分享">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://wangzaixiang.github.io/monthly/2024-09/">

  
    <meta property="og:image" content="https://wangzaixiang.github.io/doks.png">
  

  <meta property="og:updated_time" content="">
  <meta property="og:site_name" content="September 2024">

  

  

  
  <meta property="article:publisher" content="https://www.facebook.com/ichunyun">
  <meta property="article:author" content="https://www.facebook.com/ichunyun">
  <meta property="og:locale" content="en_US">





  
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/monthly/2024-09/"
      },
      "headline": "September 2024",
      "image": ,
      "datePublished": "2024-09-01",
      "dateModified": "",
      "author": {
        "@type": "Organization",
        "name": "September 2024"
      },
      "publisher": {
        "@type": "Organization",
        "name": "September 2024",
        
        "logo": {
          "@type": "ImageObject",
          "url": "/logo-doks.png"
        }
        
      },
      "description": "记录、思考、分享"
    }
    </script>
  





<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://wangzaixiang.github.io/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "Monthly",
            "item": "https://wangzaixiang.github.io/monthly/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "2024 09",
            "item": "https://wangzaixiang.github.io/monthly/2024-09/"
          },
        
      
    
  }
</script>







  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="https://wangzaixiang.github.io/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://wangzaixiang.github.io/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://wangzaixiang.github.io/favicon-16x16.png">
  


  

</head>

  

<body class="blog single">
  
  
<div class="header-bar fixed-top"></div>
<header class="navbar fixed-top navbar-expand-md navbar-light">
	<div class="container">
		<input class="menu-btn order-0" type="checkbox" id="menu-btn">
		<label class="menu-icon d-md-none" for="menu-btn"><span class="navicon"></span></label>
		<a class="navbar-brand order-1 order-md-0 me-auto" href="https://wangzaixiang.github.io">程序人生</a>
		<button id="mode" class="btn btn-link order-2 order-md-4" type="button" aria-label="Toggle mode">
			<span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
			<span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
		</button>
		<ul class="navbar-nav fork-me order-3 order-md-5">
			
				
					<li class="nav-item">
						<a class="nav-link" href="https://twitter.com/wangzaixiang"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg><span class="ms-2 visually-hidden">Twitter</span></a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="https://github.com/wangzaixiang/"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg><span class="ms-2 visually-hidden">GitHub</span></a>
					</li>
				
			
		</ul>
		<div class="collapse navbar-collapse order-4 order-md-1">
			<ul class="navbar-nav main-nav me-auto order-5 order-md-2">
				
					
				
				
				
					
						<li class="nav-item blog active">
							<a class="nav-link" href="https://wangzaixiang.github.io/blog/">Blog</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://wangzaixiang.github.io/monthly/">Monthly</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://wangzaixiang.github.io/thoughts/">Thoughts</a>
						</li>
					
				
			</ul>
			<div class="break order-6 d-md-none"></div>
			
				<form class="navbar-form flex-grow-1 order-7 order-md-3">
					<input id="userinput" class="form-control is-search" type="search" placeholder="Search docs..."
						aria-label="Search docs..." autocomplete="off">
					<div id="suggestions" class="shadow bg-white rounded"></div>
				</form>
			
		</div>
	</div>
</header>



  
<div class="wrap container" role="document">
  <div class="content">
    <div class="row justify-content-center">
      
  

      <div class="col-md-12 col-lg-10 col-xxl-12">



        <article>
          <div class="blog-header">
            <h1>September 2024</h1>
            <nav style="display: flex; justify-content: space-between">
              
              <a href="https://wangzaixiang.github.io/monthly/2024-10/"> ⇦ Previous </a>
              

              
<p><small>Posted September  1, 2024&nbsp;&hyphen;&nbsp;<strong>13&nbsp;min read</strong></small></p>


              
              <a href="https://wangzaixiang.github.io/monthly/2024-08/"> Next ⇨ </a>
              
            </nav>

          </div>
          
          <h1 id="languages">Languages</h1>
<ul>
<li>
<p><a href="https://blog.yoshuawuyts.com/tree-structured-concurrency/">Tree-Structured-Concurrency</a></p>
<p>在很多编程语言中，对多线程和并发处理，都停留在线程池、锁、消息队列等机制上。Structured Concurrency 在实际业务中，是一个
更为贴合的并发模型。Java 在 19-23 版本中，也提出了一个 Preview 版本的 Structured-Concurrency（我在公司内部项目中，
也参考这个概念，设计了一个Scala 的 Structured Concurrency API）。

<img src="https:&#x2F;&#x2F;wangzaixiang.github.io&#x2F;processed_images&#x2F;structured-concurrency.1d3eccef9127ba95.png" /></p>
<blockquote>
<p>这个作者的一系列文章，都是围绕着Rust 语言中的概念，例如：Self-Reference, Pin， Async/Await etc. 值得持续关注学习。</p>
</blockquote>
</li>
<li>
<p><a href="https://dioxuslabs.com">Rust GUI</a>
按照文档，跑了一个 Web 示例程序。 感觉：</p>
<ol>
<li>API 很熟悉。 rsx! 相当与将 JSX 和 react 风格迁移到 Rust 中。</li>
<li>一种开发模式，可以支持 WEB, Desktop, TUI, 确实很有吸引力。到了 WEB 中也运行的是 Rust（基于WASM） 而非 JavaScript。</li>
<li>dx 风格也和 cargo/npm 风格很相似，开发模式下，修改源代码自动编译、热加载。简单的例子体验不错，不知道在复杂的项目中，这个效率会如何？
现在来看，是有些担心的，一是 rust 编译速度，二是整个 wasm 重新加载，hot reload 相当于是整个应用了。</li>
<li>wasm 的编译大小，目前看一个简单的例子（dx new 的示例代码)，编译后大小为 957K, br压缩后为 240K。 更复杂的项目会有多大呢？</li>
</ol>
</li>
<li>
<p><a href="https://raphlinus.github.io/rust/gui/2022/05/07/ui-architecture.html">Xilem: an architecture for UI in Rust</a>
一个 React 风格的 Rust GUI 框架，架构设计与 flutter 很相似，这个作者的 blogs 上有很多这方面的思考，介绍了</p>
<ul>
<li>view tree: 短生命周期，每次 render 都会重新创建，仅保留足够长的时间来协助事件分派，然后与下一个版本进行比较，然后就被销毁。
纯值对象。</li>
<li>widget tree：长生命周期，每次 render 会更新。</li>
<li>view state tree. 跨 circle 持续存在。</li>
</ul>
<p>如何维护这三颗树，实现高效的 incremental update，这与<a href="/blog/virtual-dom">DOM 更新技术对比：Virtual DOM or Incremental DOM</a> 中介绍
的内容是同一个主题。</p>
<p>文章也对比了与 immediate mode GUI(egui) 的区别。与 <a href="https://guide.elm-lang.org/architecture/">Elm</a> 架构的区别。</p>
<ul>
<li><a href="https://raphlinus.github.io/ui/druid/2019/11/22/reactive-ui.html">Towards a unified theory of reactive UI</a></li>
<li><a href="https://docs.google.com/presentation/d/1opLymkreSTFfxygjzSLYI_uH7j1YFfE6DLl8RfCiw7E/edit?pli=1#slide=id.p">增量计算之旅</a></li>
<li><a href="https://github.com/linebender/xilem/blob/main/ARCHITECTURE.md">系列架构文档</a></li>
</ul>
</li>
</ul>
<h1 id="mpp-olap">MPP &amp; OLAP</h1>
<ul>
<li>
<p><a href="https://glaredb.com">GlareDB</a> 又一个跨库执行SQL的引擎，从目前官网上没有看到与性能相关的信息，不知道这方面的表现如何。</p>
</li>
<li>
<p><a href="https://www.sohu.com/a/783829162_121124375">Databricks 收购了 Apache Iceberg背后公司 Tabular</a></p>
<ul>
<li><a href="https://iceberg.apache.org">iceberg</a> 开放的分析型表存储格式：支持
<ol>
<li>schema evolution</li>
<li>隐藏分区</li>
<li>分区结构演进</li>
</ol>
</li>
<li><a href="https://www.snowflake.com">snowflake</a> 云数据仓库，支持</li>
</ul>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=bZOvAKGkzpQ">DuckDB internals</a></p>
<ol>
<li>in process like sqlite.</li>
<li>1.1.0 性能优化
<ul>
<li>版本增加了对 join 的优化，可以根据右表的过滤结果，来优化左表的筛选。</li>
<li>对 CTE 的 material 的优化。</li>
</ul>
</li>
<li>extension 支持 rust开发</li>
</ol>
<blockquote>
<p>考虑 DuckDB 作为数据分析的基础引擎，以解决复杂分析场景下的性能问题，与数据库兼容性问题。不同的源数据库，其提供的查询能力差别较大，
（语法，函数）等，对 Full JOIN能力、窗口函数的计算能力等， 逐一适配成本太大，考虑使用 DuckDB 作为数据分析引擎，可以解决这个问题。</p>
</blockquote>
<p>本月开始，计划阅读 DuckDB 的源代码，在阅读过程中整理文档，有几个目的：一是阅读一个优秀的OLAP引擎的源代码，加深对 OLAP 引擎的理解；
二是评估在公司产品中集成 duckdb, 提高产品的分析能力。三是顺便重温一下 C++ 的知识，把自己从 C++ 的陌生区转移到熟悉区来。</p>
</li>
<li>
<p><a href="https://github.com/prql/prql">Pipelined Relational Query Language</a> 一个更为结构化的SQL描述</p>
<p>在数据分析时，对复杂的SQL进行理解，往往是非常头痛的，使用 with CTE 可以让这个过程便得更为结构化， PRQL 提供了另外一个参考的视角。</p>
</li>
<li>
<p><a href="https://hex.tech">Hex</a> 一个蛮有特色的数据分析产品，可以体验一下其产品设计。</p>
<ol>
<li>Notebook 风格，一个 notebook 就是一个 workspace，支持 Python, SQL两种分析语言。</li>
<li>这些计算目前来看是执行在 server 上的</li>
</ol>
</li>
<li>
<p>[Rill Opensource](Dashboards that move as fast as your business)
体验了一下，作为 EndUser，功能还比较粗燥。</p>
</li>
</ul>
<h1 id="web-visualization">Web &amp; Visualization</h1>
<ul>
<li>
<p>NoBuild</p>
<ul>
<li><a href="https://world.hey.com/dhh/you-can-t-get-faster-than-no-build-7a44131c">You can't get faster than No Build</a></li>
<li><a href="https://x.com/dhh/status/1769903387527790975">#NoBuild on X.com</a></li>
<li><a href="https://world.hey.com/dhh/modern-web-apps-without-javascript-bundling-or-transpiling-a20f2755">Modern web apps without JavaScript bundling or transpiling</a></li>
</ul>
<p>#nobuild 对 Web 的众多 pack 框架总是很不爽，mark 一下。</p>
<p>之前也测试过一个网站，https://shoelace.style/components/badge 由于采用了 HTTP/2，在不pack的情况下，也能快速访问。
DHH 是 NoBuild 的发起人，也是 Webpacker(非webpack) 的创建者。（不过，如果使用 ts，还是需要一个 transpiling）</p>
<ol>
<li>减少了 build 时间</li>
<li>由于不再bundle，对单个module的修改，无需重新build整个项目，以及重新下载整个大的bundle文件。</li>
<li>由于不再bundle，对多页面应用，可以更好的利用浏览器的缓存机制。（不同页面 bundle 会导致重复的下载）</li>
</ol>
<p>反面意见：https://dev.to/konnorrogers/why-we-still-bundle-with-http2-in-2022-3noo</p>
<ol>
<li>太多的碎片，会产生瀑布式的请求，因为有一些请求是依赖于其他请求的，这种依赖关系，会导致 HTTP/2 也无法发挥。（优化：将深层次的 import
提升到上一层来？改进采用 modulepreload）</li>
<li>无法享受 tree shaking 带来的好处，后者可以减少下载的大小。</li>
</ol>
<p>Maybe 最佳实践:</p>
<ol>
<li>开发阶段，不使用 pack，减少 build 时间，并且方便 Hot Reload</li>
<li>生产阶段，转为 package, module 两个层级，在 package 上进行 pack, 一个 package 作为一个 前端的单元。源代码级别的 module 太细粒度了。</li>
</ol>
<p>以 shoelace 项目为例，我们可以将组件分为：高频、低频、庞大的组件，拆分为3-5个 package。</p>
</li>
<li>
<p><a href="https://levelup.gitconnected.com/signals-behind-the-scenes-19cbcb6b802b">Signals behind the scenes</a> 介绍了响应式款架 中
Signal API 的实现原理。</p>
<ul>
<li>Variable Manager: 是我设计的一个更为宏观层面（响应联路更长、且支持异步处理）的前端变量响应式管理器，目前在内部产品中使用，后续整理成技术文章。</li>
</ul>
</li>
<li>
<p><a href="https://medium.com/ekino-france/webassembly-the-future-of-backend-development-b40bdc7c5cb4">Wasm: 2023年报告</a></p>
<ul>
<li>作为 Plugin 使用。 例如 nginx plugin。相比 LUA 来说，可以提供更好的性能、完成更复杂的功能，以及使用开发者更熟悉的编程语言。</li>
<li>目前，我觉得最为缺失的，是缺少 Debugger 支持，对开发者来说，这是一个很大的障碍。</li>
</ul>
</li>
<li>
<p><a href="http://www.scala-js.org/news/2024/09/28/announcing-scalajs-1.17.0/">scala-js 1.17.0 支持 Wasm</a> 暂时还是实验性质。</p>
<ul>
<li><a href="https://github.com/keynmol/scalajs-wasm-game-of-life">Game of life Demo in scala-js WASM</a></li>
</ul>
</li>
<li>
<p>Vega-altair: Declarative Visualization in Python 一个 Python 的可视化库，支持声明式的可视化设计。</p>
<ul>
<li>
<p><a href="https://vega.github.io/vega-lite/">Vega-Lite</a> 基于 Vega，更偏向于用户层, 数据描述式风格</p>
</li>
<li>
<p><a href="https://vega.github.io/vega/">Vega</a> 一个更底层的图表描述语言，更归一化，命令式风格</p>
</li>
<li>
<p><a href="https://observablehq.com/@vega">vega on observablehq</a></p>
</li>
<li>
<p><a href="https://observablehq.com/@vega/how-vega-works">How vega works</a>: 一篇介绍 vega 的内部workflow的文章，pipeline(data flow) + react 是其核心。</p>
</li>
<li>
<p><a href="https://vega.github.io/vega/about/vega-and-d3/">Vega and D3</a> d3相比vega更为low level</p>
</li>
<li>
<p><a href="https://zhuanlan.zhihu.com/p/234762889">技术人员眼中的BI之可视化 —— 标准家：Vega &amp; Vega-Lite</a></p>
<blockquote>
<p>当使用Vega-Lite和Voyager时，总有种”小tableau“的感觉，和tableau神似。这也引出了是不是有了Vega-Lite和Voyager，
我们其实就具备了一个小型的BI。
Vega 与 Tableau 有相近的渊源。</p>
</blockquote>
<blockquote>
<p>不知道 vega 的性能表现如何？可以评估使用 wasm 或者 webgl/webgpu 来进行加速？</p>
</blockquote>
</li>
<li>
<p>在 https://vega.github.io/vega/about/vega-and-d3/ 文中提到了 canvas 性能与 SVG 的对比：</p>
<blockquote>
<p>通过引入一个中间层 scenegraph, Vega 可以渲染为 canvas 或者 SVG， 在完整刷新时，Canvas 可以提供2-10倍的速度提升
而 SVG 则更适合于无限放大，可打印能力。Vega 可以扩展到使用 WebGL 来进行渲染（不过，https://github.com/vega/vega-webgl-renderer
这个项目似乎已经8年没有维护了，其Demo在现有的浏览器中都无法正确运行）。</p>
</blockquote>
</li>
</ul>
<p><img src="https://wangzaixiang.github.io/monthly/2024-09/vega-arch.png" alt="img.png" /></p>
<ul>
<li><a href="https://github.com/observablehq/framework">Observable Framework</a> JS/TS 的 notebook.</li>
</ul>
</li>
<li>
<p><a href="https://dev.to/aralroca/build-reactive-web-components-with-ssr-3pb9?utm_source=dormosheio&amp;utm_campaign=dormosheio">Build Reactive Web Components with SSR</a></p>
<ul>
<li>https://brisa.build 这个 framework 还没有open source, 从 doc 来看，提供的 API 尤其是 CLI API 比较友好。 Lit项目的 SSR 感觉还不是很简单。</li>
</ul>
</li>
</ul>
<h1 id="tools">Tools</h1>
<h1 id="books">Books</h1>
<ul>
<li>
<p>本月入手 rust-under-the-hood 从生成的汇编代码来理解 Rust 语言。</p>

<img src="https:&#x2F;&#x2F;wangzaixiang.github.io&#x2F;processed_images&#x2F;rust-under-the-hood.ba739e2bbbce9dfe.png" />
<p>之前也断续阅读过一些 Rust 编译生成的汇编代码，确实，从更低成本的角度来理解语言特性和概念，往往会带来更为深刻的理解。更何况
Rust 自身也是面向底层的一门语言，各种特性的设计都与内存、CPU 优化密切关联。很多在上层复杂的概念，往往只是在上层中不同
角度的投影，在底层反而简单明了。</p>
<p>赶在月底之前，把这本书大概翻了一遍，对 Rust / LLVM 的代码优化有了进一步的了解。</p>
</li>
</ul>

        </article>

        <nav style="display: flex; justify-content: space-between">
          
          <a href="https://wangzaixiang.github.io/monthly/2024-10/"> ⇦ Previous </a>
          

          
          <a href="https://wangzaixiang.github.io/monthly/2024-08/"> Next ⇨ </a>
          
        </nav>

      </div>
    </div>
  </div>
</div>


  
    
<footer class="footer text-muted">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 order-last order-lg-first">
				<ul class="list-inline">
					
					    <!--
						<li class="list-inline-item">Powered by <a href="https://www.netlify.com/">Netlify</a>, <a href="https://www.getzola.org/">Zola</a>, and <a href="https://github.com/aaranxu/adidoks">AdiDoks</a></li>
						-->
					
				</ul>
			</div>
			<div class="col-lg-8 order-first order-lg-last text-lg-end">
				<ul class="list-inline">
					
				</ul>
			</div>
		</div>
	</div>
</footer>

  

  
<script type="text/javascript" src="https://wangzaixiang.github.io/js/main.js" defer></script>

  <script type="text/javascript" src="https://wangzaixiang.github.io/plugins/elasticlunr.min.js" defer></script>
  <script type="text/javascript" src="https://wangzaixiang.github.io/search_index.en.js" defer></script>
  <script type="text/javascript" src="https://wangzaixiang.github.io/js/search.js" defer></script>


  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script type="module">
    let elems = document.querySelectorAll("div.mermaid");
    elems.forEach(function(it) {
      it.innerHTML = it.innerHTML.replace("```mermaid", "").replace("```", "");
    });
    let theme = document.querySelector("body").classList.contains("dark") ? "dark" : "default";
    mermaid.initialize({startOnLoad: false, theme});
    await mermaid.run( { querySelector: '.mermaid' } );
    elems.forEach( it => it.style.width = "80%" );
  </script>
</body>
</html>
