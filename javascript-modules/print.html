<!DOCTYPE HTML>
<html lang="zh-CN" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>JavaScript æ¨¡å—åŒ–å¼€å‘æŒ‡å—</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="æ·±å…¥ç†è§£ JavaScript æ¨¡å—ç³»ç»Ÿï¼šä»åŸºç¡€æ¦‚å¿µåˆ°ç°ä»£å·¥å…·é“¾">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-689596af.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-73575c54.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">JavaScript æ¨¡å—åŒ–å¼€å‘æŒ‡å—</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="javascript-æ¨¡å—åŒ–å¼€å‘æŒ‡å—"><a class="header" href="#javascript-æ¨¡å—åŒ–å¼€å‘æŒ‡å—">JavaScript æ¨¡å—åŒ–å¼€å‘æŒ‡å—</a></h1>
<p>æ¬¢è¿æ¥åˆ° JavaScript æ¨¡å—åŒ–å¼€å‘çš„ä¸–ç•Œï¼</p>
<h2 id="å…³äºæœ¬ä¹¦"><a class="header" href="#å…³äºæœ¬ä¹¦">å…³äºæœ¬ä¹¦</a></h2>
<p>æœ¬ä¹¦æ˜¯ä¸€æœ¬å…¨é¢ä»‹ç» JavaScript æ¨¡å—åŒ–å¼€å‘çš„æŠ€æœ¯æŒ‡å—ï¼Œæ¶µç›–äº†ä»åŸºç¡€æ¦‚å¿µåˆ°ç°ä»£å·¥å…·é“¾çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ã€‚æ— è®ºä½ æ˜¯å‰ç«¯å¼€å‘çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯å¸Œæœ›æ·±å…¥ç†è§£æ¨¡å—åŒ–æœºåˆ¶çš„èµ„æ·±å¼€å‘è€…ï¼Œè¿™æœ¬ä¹¦éƒ½èƒ½ä¸ºä½ æä¾›æœ‰ä»·å€¼çš„å†…å®¹ã€‚</p>
<h2 id="å†…å®¹æ¦‚è§ˆ"><a class="header" href="#å†…å®¹æ¦‚è§ˆ">å†…å®¹æ¦‚è§ˆ</a></h2>
<h3 id="-åŸºç¡€ç¯‡"><a class="header" href="#-åŸºç¡€ç¯‡">ğŸ“š åŸºç¡€ç¯‡</a></h3>
<ul>
<li><strong>æ¨¡å—åŒ–å‘å±•å†å²</strong>: ä»å…¨å±€å˜é‡åˆ°ç°ä»£æ¨¡å—ç³»ç»Ÿçš„æ¼”è¿›å†ç¨‹</li>
<li><strong>æ ¸å¿ƒæ¦‚å¿µ</strong>: ç†è§£æ¨¡å—åŒ–çš„æœ¬è´¨å’Œè®¾è®¡æ€æƒ³</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–</strong>: è§£å†³ä¼ ç»Ÿå¼€å‘æ¨¡å¼çš„ç—›ç‚¹</li>
</ul>
<h3 id="-æŠ€æœ¯ç¯‡"><a class="header" href="#-æŠ€æœ¯ç¯‡">ğŸ”§ æŠ€æœ¯ç¯‡</a></h3>
<ul>
<li><strong>ESæ¨¡å—ç³»ç»Ÿ (ESM)</strong>: JavaScript åŸç”Ÿæ¨¡å—ç³»ç»Ÿçš„æ·±å…¥è§£æ</li>
<li><strong>CommonJS</strong>: Node.js ç”Ÿæ€çš„æ¨¡å—æ ‡å‡†</li>
<li><strong>AMD/UMD</strong>: å¼‚æ­¥æ¨¡å—å®šä¹‰å’Œé€šç”¨æ¨¡å—æ ¼å¼</li>
</ul>
<h3 id="-å·¥å…·ç¯‡"><a class="header" href="#-å·¥å…·ç¯‡">ğŸ› ï¸ å·¥å…·ç¯‡</a></h3>
<ul>
<li><strong>ç°ä»£æ‰“åŒ…å·¥å…·</strong>: Webpackã€Rollupã€Vite ç­‰å·¥å…·çš„æ¨¡å—å¤„ç†æœºåˆ¶</li>
<li><strong>è½¬è¯‘å·¥å…·</strong>: Babelã€TypeScript çš„æ¨¡å—è½¬æ¢åŸç†</li>
<li><strong>è¿è¡Œç¯å¢ƒ</strong>: æµè§ˆå™¨ã€Node.jsã€Deno ä¸­çš„æ¨¡å—å·®å¼‚</li>
</ul>
<h3 id="-å®è·µç¯‡"><a class="header" href="#-å®è·µç¯‡">ğŸ’¡ å®è·µç¯‡</a></h3>
<ul>
<li><strong>æœ€ä½³å®è·µ</strong>: æ¨¡å—è®¾è®¡åŸåˆ™å’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥</li>
<li><strong>é«˜çº§ä¸»é¢˜</strong>: å¾®å‰ç«¯ã€Web Workersã€WASM é›†æˆ</li>
<li><strong>å®æˆ˜æ¡ˆä¾‹</strong>: çœŸå®é¡¹ç›®ä¸­çš„æ¨¡å—åŒ–åº”ç”¨</li>
</ul>
<h2 id="å­¦ä¹ è·¯å¾„"><a class="header" href="#å­¦ä¹ è·¯å¾„">å­¦ä¹ è·¯å¾„</a></h2>
<h3 id="-å¿«é€Ÿå…¥é—¨"><a class="header" href="#-å¿«é€Ÿå…¥é—¨">ğŸš€ å¿«é€Ÿå…¥é—¨</a></h3>
<p>å¦‚æœä½ æ˜¯æ¨¡å—åŒ–å¼€å‘çš„æ–°æ‰‹ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºé˜…è¯»ï¼š</p>
<ol>
<li><a href="#ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–">ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–</a></li>
<li><a href="#æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µ">æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µ</a></li>
<li><a href="#esæ¨¡å—åŸºç¡€">ESæ¨¡å—åŸºç¡€</a></li>
<li><a href="#å¯¼å…¥ä¸å¯¼å‡º">å¯¼å…¥ä¸å¯¼å‡º</a></li>
</ol>
<h3 id="-æ·±å…¥ç†è§£"><a class="header" href="#-æ·±å…¥ç†è§£">ğŸ¯ æ·±å…¥ç†è§£</a></h3>
<p>å¦‚æœä½ å·²æœ‰ä¸€å®šåŸºç¡€ï¼Œæƒ³è¦æ·±å…¥ç†è§£ï¼š</p>
<ol>
<li><a href="#æ¨¡å—è§£ææœºåˆ¶">æ¨¡å—è§£ææœºåˆ¶</a></li>
<li><a href="#å¾ªç¯ä¾èµ–å¤„ç†">å¾ªç¯ä¾èµ–å¤„ç†</a></li>
<li><a href="#æ¨¡å—äº’æ“ä½œæ€§">ä¸ESæ¨¡å—çš„äº’æ“ä½œ</a></li>
<li><a href="#æ‰“åŒ…å·¥å…·-1">ç°ä»£å·¥å…·é“¾</a></li>
</ol>
<h3 id="-é«˜çº§åº”ç”¨"><a class="header" href="#-é«˜çº§åº”ç”¨">ğŸ† é«˜çº§åº”ç”¨</a></h3>
<p>å¦‚æœä½ å¸Œæœ›æŒæ¡é«˜çº§æŠ€å·§ï¼š</p>
<ol>
<li><a href="#æ€§èƒ½ä¼˜åŒ–-8">æ€§èƒ½ä¼˜åŒ–</a></li>
<li><a href="#å¾®å‰ç«¯æ¨¡å—åŒ–">å¾®å‰ç«¯æ¨¡å—åŒ–</a></li>
<li><a href="#å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡">å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡</a></li>
</ol>
<h2 id="ç‰¹è‰²å†…å®¹"><a class="header" href="#ç‰¹è‰²å†…å®¹">ç‰¹è‰²å†…å®¹</a></h2>
<ul>
<li>âœ… <strong>ç†è®ºä¸å®è·µå¹¶é‡</strong>: æ—¢æœ‰æ·±å…¥çš„åŸç†è§£æï¼Œä¹Ÿæœ‰ä¸°å¯Œçš„ä»£ç ç¤ºä¾‹</li>
<li>âœ… <strong>è¦†ç›–ä¸»æµæŠ€æœ¯</strong>: åŒ…å«æ‰€æœ‰ä¸»è¦çš„æ¨¡å—ç³»ç»Ÿå’Œå·¥å…·é“¾</li>
<li>âœ… <strong>å‰ç»æ€§å†…å®¹</strong>: æ¶µç›–æœ€æ–°çš„æŠ€æœ¯è¶‹åŠ¿å’Œå‘å±•æ–¹å‘</li>
<li>âœ… <strong>ä¸­æ–‡å‹å¥½</strong>: é’ˆå¯¹ä¸­æ–‡å¼€å‘è€…çš„é˜…è¯»ä¹ æƒ¯ä¼˜åŒ–</li>
</ul>
<h2 id="å¦‚ä½•ä½¿ç”¨æœ¬ä¹¦"><a class="header" href="#å¦‚ä½•ä½¿ç”¨æœ¬ä¹¦">å¦‚ä½•ä½¿ç”¨æœ¬ä¹¦</a></h2>
<ul>
<li><strong>æŒ‰ç« èŠ‚é¡ºåºé˜…è¯»</strong>: é€‚åˆç³»ç»Ÿå­¦ä¹ æ¨¡å—åŒ–çŸ¥è¯†</li>
<li><strong>ä½œä¸ºå‚è€ƒæ‰‹å†Œ</strong>: é‡åˆ°å…·ä½“é—®é¢˜æ—¶å¿«é€ŸæŸ¥é˜…ç›¸å…³ç« èŠ‚</li>
<li><strong>ç»“åˆå®è·µ</strong>: å»ºè®®è¾¹é˜…è¯»è¾¹åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨</li>
</ul>
<h2 id="åé¦ˆä¸è´¡çŒ®"><a class="header" href="#åé¦ˆä¸è´¡çŒ®">åé¦ˆä¸è´¡çŒ®</a></h2>
<p>å¦‚æœä½ åœ¨é˜…è¯»è¿‡ç¨‹ä¸­å‘ç°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼åé¦ˆï¼š</p>
<ul>
<li>åœ¨ä»£ç ä»“åº“ä¸­æäº¤ Issue</li>
<li>å‘é€é‚®ä»¶è‡³ä½œè€…</li>
<li>å‚ä¸ç¤¾åŒºè®¨è®º</li>
</ul>
<p>è®©æˆ‘ä»¬ä¸€èµ·æ„å»ºæ›´å¥½çš„ JavaScript æ¨¡å—åŒ–ç”Ÿæ€ï¼</p>
<hr>
<p><strong>å¼€å§‹é˜…è¯»</strong>: <a href="#æ¨¡å—åŒ–å‘å±•å†å²">æ¨¡å—åŒ–å‘å±•å†å²</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ¨¡å—åŒ–å‘å±•å†å²"><a class="header" href="#æ¨¡å—åŒ–å‘å±•å†å²">æ¨¡å—åŒ–å‘å±•å†å²</a></h1>
<h2 id="æ—©æœŸçš„å…¨å±€å˜é‡æ—¶ä»£"><a class="header" href="#æ—©æœŸçš„å…¨å±€å˜é‡æ—¶ä»£">æ—©æœŸçš„å…¨å±€å˜é‡æ—¶ä»£</a></h2>
<p>åœ¨ JavaScript è¯ç”Ÿä¹‹åˆï¼Œæ‰€æœ‰çš„ä»£ç éƒ½è¿è¡Œåœ¨å…¨å±€ä½œç”¨åŸŸä¸­ã€‚</p>
<pre><code class="language-javascript">// æ—©æœŸçš„ä»£ç ç»„ç»‡æ–¹å¼
var userName = 'John';
var userAge = 25;

function getUserInfo() {
    return userName + ' is ' + userAge + ' years old';
}
</code></pre>
<h3 id="å­˜åœ¨çš„é—®é¢˜"><a class="header" href="#å­˜åœ¨çš„é—®é¢˜">å­˜åœ¨çš„é—®é¢˜</a></h3>
<ul>
<li>å…¨å±€å‘½åç©ºé—´æ±¡æŸ“</li>
<li>å˜é‡åå†²çª</li>
<li>ä¾èµ–å…³ç³»ä¸æ˜ç¡®</li>
<li>ä»£ç éš¾ä»¥ç»´æŠ¤å’Œå¤ç”¨</li>
</ul>
<h2 id="å‘½åç©ºé—´æ¨¡å¼"><a class="header" href="#å‘½åç©ºé—´æ¨¡å¼">å‘½åç©ºé—´æ¨¡å¼</a></h2>
<p>ä¸ºäº†è§£å†³å…¨å±€å˜é‡å†²çªé—®é¢˜ï¼Œå¼€å‘è€…å¼€å§‹ä½¿ç”¨å‘½åç©ºé—´æ¨¡å¼ï¼š</p>
<pre><code class="language-javascript">// å‘½åç©ºé—´æ¨¡å¼
var MyApp = {
    models: {},
    views: {},
    controllers: {}
};

MyApp.models.User = function(name) {
    this.name = name;
};
</code></pre>
<h2 id="iife-æ¨¡å¼"><a class="header" href="#iife-æ¨¡å¼">IIFE æ¨¡å¼</a></h2>
<p>ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰æä¾›äº†æ›´å¥½çš„å°è£…ï¼š</p>
<pre><code class="language-javascript">// IIFE æ¨¡å¼
var MyModule = (function() {
    var privateVar = 'hidden';
    
    return {
        publicMethod: function() {
            return privateVar;
        }
    };
})();
</code></pre>
<h2 id="æ¨¡å—åŒ–è§„èŒƒçš„è¯ç”Ÿ"><a class="header" href="#æ¨¡å—åŒ–è§„èŒƒçš„è¯ç”Ÿ">æ¨¡å—åŒ–è§„èŒƒçš„è¯ç”Ÿ</a></h2>
<h3 id="commonjs-2009"><a class="header" href="#commonjs-2009">CommonJS (2009)</a></h3>
<ul>
<li>ä¸»è¦ç”¨äºæœåŠ¡å™¨ç«¯ï¼ˆNode.jsï¼‰</li>
<li>åŒæ­¥åŠ è½½æ¨¡å—</li>
<li>ç®€å•æ˜“ç”¨çš„ <code>require</code> å’Œ <code>module.exports</code></li>
</ul>
<h3 id="amd-2011"><a class="header" href="#amd-2011">AMD (2011)</a></h3>
<ul>
<li>å¼‚æ­¥æ¨¡å—å®šä¹‰</li>
<li>ä¸»è¦ç”¨äºæµè§ˆå™¨ç«¯</li>
<li>RequireJS æ˜¯ä¸»è¦å®ç°</li>
</ul>
<h3 id="umd-2011"><a class="header" href="#umd-2011">UMD (2011)</a></h3>
<ul>
<li>é€šç”¨æ¨¡å—å®šä¹‰</li>
<li>å…¼å®¹ CommonJS å’Œ AMD</li>
<li>å¯åœ¨å¤šç§ç¯å¢ƒä¸‹è¿è¡Œ</li>
</ul>
<h2 id="es6-æ¨¡å—ç³»ç»Ÿ-2015"><a class="header" href="#es6-æ¨¡å—ç³»ç»Ÿ-2015">ES6 æ¨¡å—ç³»ç»Ÿ (2015)</a></h2>
<p>2015å¹´ï¼ŒECMAScript 6 å¼•å…¥äº†åŸç”Ÿçš„æ¨¡å—ç³»ç»Ÿï¼š</p>
<pre><code class="language-javascript">// ES6 æ¨¡å—
import { userName } from './user.js';
export default class User {
    constructor(name) {
        this.name = name;
    }
}
</code></pre>
<h3 id="ä¸»è¦ç‰¹æ€§"><a class="header" href="#ä¸»è¦ç‰¹æ€§">ä¸»è¦ç‰¹æ€§</a></h3>
<ul>
<li>é™æ€ç»“æ„</li>
<li>ç¼–è¯‘æ—¶ç¡®å®šä¾èµ–</li>
<li>æ”¯æŒæ ‘æ‘‡ï¼ˆTree Shakingï¼‰ï¼šè‡ªåŠ¨ç§»é™¤æœªä½¿ç”¨çš„ä»£ç ï¼Œå‡å°æ‰“åŒ…ä½“ç§¯</li>
<li>åŸç”Ÿæµè§ˆå™¨æ”¯æŒ</li>
</ul>
<h2 id="ç°ä»£æ¨¡å—åŒ–å·¥å…·"><a class="header" href="#ç°ä»£æ¨¡å—åŒ–å·¥å…·">ç°ä»£æ¨¡å—åŒ–å·¥å…·</a></h2>
<h3 id="æ‰“åŒ…å·¥å…·"><a class="header" href="#æ‰“åŒ…å·¥å…·">æ‰“åŒ…å·¥å…·</a></h3>
<ul>
<li><strong>Webpack (2012)</strong>: å¼ºå¤§çš„æ¨¡å—æ‰“åŒ…å™¨ï¼Œä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€</li>
<li><strong>Rollup (2015)</strong>: ä¸“æ³¨äºåº“æ‰“åŒ…ï¼Œä¼˜ç§€çš„Tree Shakingæ”¯æŒ</li>
<li><strong>Vite (2020)</strong>: åŸºäºåŸç”Ÿ ESM çš„æ„å»ºå·¥å…·ï¼Œå¼€å‘ä½“éªŒæä½³</li>
<li><strong>Bun (2021)</strong>: æé€Ÿçš„JavaScriptè¿è¡Œæ—¶å’Œæ‰“åŒ…å™¨</li>
<li><strong>Rolldown (2024)</strong>: Rollupçš„Rustå®ç°ï¼Œæ€§èƒ½å¤§å¹…æå‡</li>
</ul>
<h3 id="è½¬è¯‘å·¥å…·"><a class="header" href="#è½¬è¯‘å·¥å…·">è½¬è¯‘å·¥å…·</a></h3>
<ul>
<li><strong>Babel</strong>: å°†ç°ä»£ JavaScript è½¬æ¢ä¸ºå…¼å®¹ç‰ˆæœ¬</li>
<li><strong>TypeScript</strong>: æ·»åŠ ç±»å‹ç³»ç»Ÿçš„ JavaScript è¶…é›†</li>
</ul>
<h2 id="æ—¶é—´çº¿æ€»ç»“"><a class="header" href="#æ—¶é—´çº¿æ€»ç»“">æ—¶é—´çº¿æ€»ç»“</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å¹´ä»½</th><th>é‡Œç¨‹ç¢‘</th><th>è¯´æ˜</th></tr>
</thead>
<tbody>
<tr><td>1995</td><td>JavaScript è¯ç”Ÿ</td><td>å…¨å±€å˜é‡æ—¶ä»£å¼€å§‹</td></tr>
<tr><td>2009</td><td>CommonJS è§„èŒƒ</td><td>æœåŠ¡å™¨ç«¯æ¨¡å—åŒ–æ ‡å‡†</td></tr>
<tr><td>2011</td><td>AMD/UMD è§„èŒƒ</td><td>æµè§ˆå™¨ç«¯å¼‚æ­¥æ¨¡å—åŒ–</td></tr>
<tr><td>2012</td><td>Webpack å‘å¸ƒ</td><td>æ¨¡å—æ‰“åŒ…å·¥å…·é©å‘½</td></tr>
<tr><td>2015</td><td>ES6 æ¨¡å—ç³»ç»Ÿ</td><td>JavaScript åŸç”Ÿæ¨¡å—æ”¯æŒ</td></tr>
<tr><td>2020</td><td>Vite å‘å¸ƒ</td><td>åŸç”Ÿ ESM å¼€å‘ä½“éªŒ</td></tr>
</tbody>
</table>
</div>
<h2 id="å‘å±•è¶‹åŠ¿"><a class="header" href="#å‘å±•è¶‹åŠ¿">å‘å±•è¶‹åŠ¿</a></h2>
<p>ç°ä»£ JavaScript æ¨¡å—åŒ–æ­£æœç€ä»¥ä¸‹æ–¹å‘å‘å±•ï¼š</p>
<ol>
<li><strong>åŸç”Ÿ ESM ä¼˜å…ˆ</strong>: è¶Šæ¥è¶Šå¤šå·¥å…·æ”¯æŒåŸç”Ÿ ES æ¨¡å—</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>: æ›´å¿«çš„æ„å»ºé€Ÿåº¦å’Œæ›´å°çš„åŒ…ä½“ç§¯</li>
<li><strong>å¼€å‘ä½“éªŒ</strong>: æ›´å¥½çš„å¼€å‘å·¥å…·å’Œè°ƒè¯•æ”¯æŒ</li>
<li><strong>æ ‡å‡†åŒ–</strong>: å„ç§ç¯å¢ƒé—´çš„æ¨¡å—åŒ–å·®å¼‚é€æ¸ç¼©å°</li>
</ol>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–">ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–"><a class="header" href="#ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–">ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–</a></h1>
<p>åœ¨ç°ä»£ JavaScript å¼€å‘ä¸­ï¼Œæ¨¡å—åŒ–å·²ç»æˆä¸ºä¸å¯æˆ–ç¼ºçš„å¼€å‘æ¨¡å¼ã€‚æœ¬ç« å°†è¯¦ç»†æ¢è®¨æ¨¡å—åŒ–è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€‚</p>
<h2 id="ä¼ ç»Ÿå¼€å‘æ¨¡å¼çš„é—®é¢˜"><a class="header" href="#ä¼ ç»Ÿå¼€å‘æ¨¡å¼çš„é—®é¢˜">ä¼ ç»Ÿå¼€å‘æ¨¡å¼çš„é—®é¢˜</a></h2>
<h3 id="1-å…¨å±€å‘½åç©ºé—´æ±¡æŸ“"><a class="header" href="#1-å…¨å±€å‘½åç©ºé—´æ±¡æŸ“">1. å…¨å±€å‘½åç©ºé—´æ±¡æŸ“</a></h3>
<pre><code class="language-javascript">// script1.js
var name = 'John';
var age = 25;

// script2.js  
var name = 'Jane'; // è¦†ç›–äº† script1.js ä¸­çš„ name
var address = 'New York';
</code></pre>
<p>åœ¨ä¼ ç»Ÿå¼€å‘æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰å˜é‡éƒ½åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå®¹æ˜“é€ æˆå‘½åå†²çªã€‚</p>
<h3 id="2-ä¾èµ–å…³ç³»æ··ä¹±"><a class="header" href="#2-ä¾èµ–å…³ç³»æ··ä¹±">2. ä¾èµ–å…³ç³»æ··ä¹±</a></h3>
<pre><code class="language-html">&lt;!-- HTML ä¸­çš„è„šæœ¬åŠ è½½é¡ºåº --&gt;
&lt;script src="utils.js"&gt;&lt;/script&gt;
&lt;script src="config.js"&gt;&lt;/script&gt; 
&lt;script src="main.js"&gt;&lt;/script&gt;
&lt;script src="app.js"&gt;&lt;/script&gt;
</code></pre>
<ul>
<li>å¿…é¡»æ‰‹åŠ¨ç®¡ç†è„šæœ¬åŠ è½½é¡ºåº</li>
<li>ä¾èµ–å…³ç³»ä¸æ˜ç¡®</li>
<li>å®¹æ˜“å‡ºç°ä¾èµ–ç¼ºå¤±æˆ–å¾ªç¯ä¾èµ–</li>
</ul>
<h3 id="3-ä»£ç å¤ç”¨å›°éš¾"><a class="header" href="#3-ä»£ç å¤ç”¨å›°éš¾">3. ä»£ç å¤ç”¨å›°éš¾</a></h3>
<pre><code class="language-javascript">// æ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦å¤åˆ¶ç²˜è´´ä»£ç 
function formatDate(date) {
    // 100 è¡Œæ ¼å¼åŒ–ä»£ç ...
}

// åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å¤å®šä¹‰ç›¸åŒåŠŸèƒ½
</code></pre>
<h3 id="4-éš¾ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•"><a class="header" href="#4-éš¾ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•">4. éš¾ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// å…¨å±€å‡½æ•°éš¾ä»¥ç‹¬ç«‹æµ‹è¯•
var userData = {}; // å…¨å±€çŠ¶æ€

function processUser(id) {
    // ä¾èµ–å…¨å±€çŠ¶æ€ï¼Œéš¾ä»¥æµ‹è¯•
    userData[id] = fetchUserData(id);
}
</code></pre>
<h2 id="æ¨¡å—åŒ–å¸¦æ¥çš„å¥½å¤„"><a class="header" href="#æ¨¡å—åŒ–å¸¦æ¥çš„å¥½å¤„">æ¨¡å—åŒ–å¸¦æ¥çš„å¥½å¤„</a></h2>
<h3 id="1-ä½œç”¨åŸŸéš”ç¦»"><a class="header" href="#1-ä½œç”¨åŸŸéš”ç¦»">1. ä½œç”¨åŸŸéš”ç¦»</a></h3>
<pre><code class="language-javascript">// user.js
export class User {
    private name: string; // ç§æœ‰å±æ€§
    
    constructor(name: string) {
        this.name = name;
    }
}

// main.js
import { User } from './user.js';
const user = new User('John'); // ä¸ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸ
</code></pre>
<h3 id="2-æ˜ç¡®çš„ä¾èµ–å…³ç³»"><a class="header" href="#2-æ˜ç¡®çš„ä¾èµ–å…³ç³»">2. æ˜ç¡®çš„ä¾èµ–å…³ç³»</a></h3>
<pre><code class="language-javascript">// math.js
export function add(a, b) {
    return a + b;
}

export function multiply(a, b) {
    return a * b;
}

// calculator.js
import { add, multiply } from './math.js'; // æ˜ç¡®ä¾èµ–

export function calculate(x, y) {
    return multiply(add(x, y), 2);
}
</code></pre>
<h3 id="3-ä»£ç å¤ç”¨å’Œç»´æŠ¤æ€§"><a class="header" href="#3-ä»£ç å¤ç”¨å’Œç»´æŠ¤æ€§">3. ä»£ç å¤ç”¨å’Œç»´æŠ¤æ€§</a></h3>
<pre><code class="language-javascript">// utils/date.js - å¯å¤ç”¨çš„æ—¥æœŸå·¥å…·
export function formatDate(date, format = 'YYYY-MM-DD') {
    // å®ç°æ—¥æœŸæ ¼å¼åŒ–
}

export function parseDate(dateString) {
    // å®ç°æ—¥æœŸè§£æ
}

// åœ¨å¤šä¸ªé¡¹ç›®ä¸­å¤ç”¨
import { formatDate } from '@utils/date';
</code></pre>
<h3 id="4-æ›´å¥½çš„æµ‹è¯•æ”¯æŒ"><a class="header" href="#4-æ›´å¥½çš„æµ‹è¯•æ”¯æŒ">4. æ›´å¥½çš„æµ‹è¯•æ”¯æŒ</a></h3>
<pre><code class="language-javascript">// user-service.js
export class UserService {
    constructor(apiClient) {
        this.apiClient = apiClient;
    }
    
    async getUser(id) {
        return this.apiClient.get(`/users/${id}`);
    }
}

// user-service.test.js
import { UserService } from './user-service.js';

// å¯ä»¥è½»æ¾è¿›è¡Œå•å…ƒæµ‹è¯•
const mockApiClient = { get: jest.fn() };
const userService = new UserService(mockApiClient);
</code></pre>
<h2 id="æ¨¡å—åŒ–çš„æ ¸å¿ƒä»·å€¼"><a class="header" href="#æ¨¡å—åŒ–çš„æ ¸å¿ƒä»·å€¼">æ¨¡å—åŒ–çš„æ ¸å¿ƒä»·å€¼</a></h2>
<h3 id="1-å…³æ³¨ç‚¹åˆ†ç¦»"><a class="header" href="#1-å…³æ³¨ç‚¹åˆ†ç¦»">1. å…³æ³¨ç‚¹åˆ†ç¦»</a></h3>
<p>æ¯ä¸ªæ¨¡å—ä¸“æ³¨äºç‰¹å®šçš„åŠŸèƒ½ï¼š</p>
<pre><code class="language-javascript">// æ•°æ®å±‚
export class UserRepository {
    async findById(id) { /* ... */ }
}

// ä¸šåŠ¡é€»è¾‘å±‚  
export class UserService {
    constructor(userRepo) {
        this.userRepo = userRepo;
    }
}

// è¡¨ç°å±‚
export class UserController {
    constructor(userService) {
        this.userService = userService;
    }
}
</code></pre>
<h3 id="2-å¯æ‰©å±•æ€§"><a class="header" href="#2-å¯æ‰©å±•æ€§">2. å¯æ‰©å±•æ€§</a></h3>
<pre><code class="language-javascript">// åŸºç¡€æ¨¡å—
export class BaseValidator {
    validate(data) {
        // åŸºç¡€éªŒè¯é€»è¾‘
    }
}

// æ‰©å±•æ¨¡å—
import { BaseValidator } from './base-validator.js';

export class EmailValidator extends BaseValidator {
    validate(email) {
        super.validate(email);
        // é‚®ç®±ç‰¹å®šéªŒè¯é€»è¾‘
    }
}
</code></pre>
<h3 id="3-å›¢é˜Ÿåä½œ"><a class="header" href="#3-å›¢é˜Ÿåä½œ">3. å›¢é˜Ÿåä½œ</a></h3>
<pre><code class="language-javascript">// å›¢é˜Ÿæˆå‘˜ A è´Ÿè´£ç”¨æˆ·æ¨¡å—
// user/
//   â”œâ”€â”€ user.model.js
//   â”œâ”€â”€ user.service.js
//   â””â”€â”€ user.controller.js

// å›¢é˜Ÿæˆå‘˜ B è´Ÿè´£è®¢å•æ¨¡å—  
// order/
//   â”œâ”€â”€ order.model.js
//   â”œâ”€â”€ order.service.js
//   â””â”€â”€ order.controller.js
</code></pre>
<h3 id="4-æ€§èƒ½ä¼˜åŒ–"><a class="header" href="#4-æ€§èƒ½ä¼˜åŒ–">4. æ€§èƒ½ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// æŒ‰éœ€åŠ è½½
const loadUserModule = () =&gt; import('./user/user.module.js');
const loadOrderModule = () =&gt; import('./order/order.module.js');

// åªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„æ¨¡å—
if (currentPage === 'user') {
    const userModule = await loadUserModule();
}
</code></pre>
<h2 id="ç°å®åœºæ™¯å¯¹æ¯”"><a class="header" href="#ç°å®åœºæ™¯å¯¹æ¯”">ç°å®åœºæ™¯å¯¹æ¯”</a></h2>
<h3 id="ä¼ ç»Ÿæ–¹å¼å¼€å‘å¤§å‹åº”ç”¨"><a class="header" href="#ä¼ ç»Ÿæ–¹å¼å¼€å‘å¤§å‹åº”ç”¨">ä¼ ç»Ÿæ–¹å¼å¼€å‘å¤§å‹åº”ç”¨</a></h3>
<pre><code class="language-javascript">// ä¸€ä¸ªå·¨å¤§çš„ app.js æ–‡ä»¶
var users = [];
var orders = [];
var products = [];

function addUser() { /* ... */ }
function removeUser() { /* ... */ }
function addOrder() { /* ... */ }
function removeOrder() { /* ... */ }
// ... å‡ åƒè¡Œä»£ç 
</code></pre>
<p><strong>é—®é¢˜</strong>ï¼š</p>
<ul>
<li>æ–‡ä»¶è¿‡å¤§ï¼Œéš¾ä»¥ç»´æŠ¤</li>
<li>åŠŸèƒ½è€¦åˆä¸¥é‡</li>
<li>å›¢é˜Ÿåä½œå›°éš¾</li>
<li>æ€§èƒ½é—®é¢˜ï¼ˆä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰ä»£ç ï¼‰</li>
</ul>
<h3 id="æ¨¡å—åŒ–æ–¹å¼å¼€å‘"><a class="header" href="#æ¨¡å—åŒ–æ–¹å¼å¼€å‘">æ¨¡å—åŒ–æ–¹å¼å¼€å‘</a></h3>
<pre><code class="language-javascript">// æ¸…æ™°çš„æ¨¡å—ç»“æ„
src/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”œâ”€â”€ user.service.js
â”‚   â”‚   â”œâ”€â”€ user.model.js
â”‚   â”‚   â””â”€â”€ user.controller.js
â”‚   â”œâ”€â”€ order/
â”‚   â”‚   â”œâ”€â”€ order.service.js
â”‚   â”‚   â”œâ”€â”€ order.model.js
â”‚   â”‚   â””â”€â”€ order.controller.js
â”‚   â””â”€â”€ product/
â”‚       â”œâ”€â”€ product.service.js
â”‚       â”œâ”€â”€ product.model.js
â”‚       â””â”€â”€ product.controller.js
â””â”€â”€ app.js
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>ä»£ç ç»„ç»‡æ¸…æ™°</li>
<li>åŠŸèƒ½ç‹¬ç«‹ï¼Œæ˜“äºæµ‹è¯•</li>
<li>å›¢é˜Ÿå¯ä»¥å¹¶è¡Œå¼€å‘</li>
<li>æ”¯æŒæŒ‰éœ€åŠ è½½</li>
</ul>
<h2 id="æ€»ç»“"><a class="header" href="#æ€»ç»“">æ€»ç»“</a></h2>
<p>æ¨¡å—åŒ–ä¸ä»…ä»…æ˜¯ä¸€ç§ç¼–ç¨‹æŠ€å·§ï¼Œæ›´æ˜¯ç°ä»£è½¯ä»¶å¼€å‘çš„åŸºç¡€è®¾æ–½ã€‚å®ƒè§£å†³äº†ä¼ ç»Ÿå¼€å‘æ¨¡å¼çš„æ ¸å¿ƒç—›ç‚¹ï¼š</p>
<ul>
<li>âœ… <strong>è§£å†³å‘½åå†²çª</strong>ï¼šæ¯ä¸ªæ¨¡å—æœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸ</li>
<li>âœ… <strong>æ˜ç¡®ä¾èµ–å…³ç³»</strong>ï¼šimport/export æ˜ç¡®å£°æ˜ä¾èµ–</li>
<li>âœ… <strong>æé«˜ä»£ç å¤ç”¨</strong>ï¼šæ¨¡å—å¯ä»¥åœ¨å¤šä¸ªé¡¹ç›®ä¸­ä½¿ç”¨</li>
<li>âœ… <strong>æ”¹å–„å¯æµ‹è¯•æ€§</strong>ï¼šç‹¬ç«‹çš„æ¨¡å—æ˜“äºå•å…ƒæµ‹è¯•</li>
<li>âœ… <strong>æ”¯æŒå›¢é˜Ÿåä½œ</strong>ï¼šä¸åŒæ¨¡å—å¯ä»¥å¹¶è¡Œå¼€å‘</li>
<li>âœ… <strong>æå‡æ€§èƒ½</strong>ï¼šæ”¯æŒæŒ‰éœ€åŠ è½½å’Œæ ‘æ‘‡ä¼˜åŒ–</li>
</ul>
<p>åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥äº†è§£æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µå’Œè®¾è®¡åŸåˆ™ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µ">æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µ</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µ"><a class="header" href="#æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µ">æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µ</a></h1>
<p>æœ¬ç« å°†ä»‹ç» JavaScript æ¨¡å—åŒ–çš„åŸºç¡€æ¦‚å¿µï¼Œå¸®åŠ©ä½ å»ºç«‹å¯¹æ¨¡å—ç³»ç»Ÿçš„æ•´ä½“è®¤çŸ¥ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯æ¨¡å—"><a class="header" href="#ä»€ä¹ˆæ˜¯æ¨¡å—">ä»€ä¹ˆæ˜¯æ¨¡å—</a></h2>
<p><strong>æ¨¡å—ï¼ˆModuleï¼‰</strong> æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ã€å¯å¤ç”¨çš„ä»£ç å•å…ƒï¼Œå®ƒå°è£…äº†ç‰¹å®šçš„åŠŸèƒ½ï¼Œå¹¶å¯ä»¥ä¸å…¶ä»–æ¨¡å—è¿›è¡Œäº¤äº’ã€‚</p>
<h3 id="æ¨¡å—çš„åŸºæœ¬ç‰¹å¾"><a class="header" href="#æ¨¡å—çš„åŸºæœ¬ç‰¹å¾">æ¨¡å—çš„åŸºæœ¬ç‰¹å¾</a></h3>
<ol>
<li><strong>å°è£…æ€§</strong>: æ¨¡å—å†…éƒ¨å®ç°ç»†èŠ‚å¯¹å¤–éƒ¨ä¸å¯è§</li>
<li><strong>ç‹¬ç«‹æ€§</strong>: æ¨¡å—å…·æœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸ</li>
<li><strong>å¯å¤ç”¨æ€§</strong>: å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨åŒä¸€ä¸ªæ¨¡å—</li>
<li><strong>æ¥å£æ˜ç¡®</strong>: é€šè¿‡æ˜ç¡®çš„æ¥å£è¿›è¡Œäº¤äº’</li>
</ol>
<pre><code class="language-javascript">// ä¸€ä¸ªç®€å•çš„æ¨¡å—ç¤ºä¾‹
// math.js
const PI = 3.14159;

function add(a, b) {
    return a + b;
}

function multiply(a, b) {
    return a * b;
}

// å¯¹å¤–æä¾›çš„æ¥å£
export { add, multiply, PI };
</code></pre>
<h2 id="æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒç»„æˆ"><a class="header" href="#æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒç»„æˆ">æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒç»„æˆ</a></h2>
<h3 id="1-æ¨¡å—å®šä¹‰module-definition"><a class="header" href="#1-æ¨¡å—å®šä¹‰module-definition">1. æ¨¡å—å®šä¹‰ï¼ˆModule Definitionï¼‰</a></h3>
<p>æ¨¡å—å®šä¹‰è§„å®šäº†å¦‚ä½•åˆ›å»ºå’Œç»„ç»‡æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">// ES6 æ¨¡å—å®šä¹‰
// user.js
class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    getInfo() {
        return `${this.name} &lt;${this.email}&gt;`;
    }
}

// å¯¼å‡ºæ¨¡å—
export default User;
export { User as UserClass };
</code></pre>
<h3 id="2-æ¨¡å—å¯¼å…¥module-import"><a class="header" href="#2-æ¨¡å—å¯¼å…¥module-import">2. æ¨¡å—å¯¼å…¥ï¼ˆModule Importï¼‰</a></h3>
<p>å®šä¹‰å¦‚ä½•ä½¿ç”¨å…¶ä»–æ¨¡å—çš„åŠŸèƒ½ï¼š</p>
<pre><code class="language-javascript">// app.js
import User from './user.js';              // å¯¼å…¥é»˜è®¤å¯¼å‡º
import { UserClass } from './user.js';     // å¯¼å…¥å‘½åå¯¼å‡º
import * as UserModule from './user.js';   // å¯¼å…¥æ‰€æœ‰å¯¼å‡º

const user = new User('John', 'john@example.com');
</code></pre>
<h3 id="3-æ¨¡å—è§£æmodule-resolution"><a class="header" href="#3-æ¨¡å—è§£æmodule-resolution">3. æ¨¡å—è§£æï¼ˆModule Resolutionï¼‰</a></h3>
<p>è§„å®šå¦‚ä½•æŸ¥æ‰¾å’ŒåŠ è½½æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">// ä¸åŒçš„æ¨¡å—è·¯å¾„è§£æ
import utils from './utils.js';           // ç›¸å¯¹è·¯å¾„
import lodash from 'lodash';              // npm åŒ…
import config from '../config/app.js';   // ç›¸å¯¹è·¯å¾„ï¼ˆä¸Šçº§ç›®å½•ï¼‰
import api from '/src/api/index.js';     // ç»å¯¹è·¯å¾„
</code></pre>
<h3 id="4-æ¨¡å—åŠ è½½module-loading"><a class="header" href="#4-æ¨¡å—åŠ è½½module-loading">4. æ¨¡å—åŠ è½½ï¼ˆModule Loadingï¼‰</a></h3>
<p>æ¨¡å—ç³»ç»Ÿå†³å®šä½•æ—¶ä»¥åŠå¦‚ä½•åŠ è½½æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">// é™æ€å¯¼å…¥ï¼ˆç¼–è¯‘æ—¶ç¡®å®šï¼‰
import { calculateTax } from './tax-utils.js';

// åŠ¨æ€å¯¼å…¥ï¼ˆè¿è¡Œæ—¶ç¡®å®šï¼‰
const loadTaxUtils = async () =&gt; {
    const module = await import('./tax-utils.js');
    return module.calculateTax;
};
</code></pre>
<h2 id="æ¨¡å—çš„ä½œç”¨åŸŸmodule-scope"><a class="header" href="#æ¨¡å—çš„ä½œç”¨åŸŸmodule-scope">æ¨¡å—çš„ä½œç”¨åŸŸï¼ˆModule Scopeï¼‰</a></h2>
<h3 id="ä½œç”¨åŸŸéš”ç¦»"><a class="header" href="#ä½œç”¨åŸŸéš”ç¦»">ä½œç”¨åŸŸéš”ç¦»</a></h3>
<p>æ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œä¸ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸï¼š</p>
<pre><code class="language-javascript">// module1.js
const message = 'Hello from module1';
let counter = 0;

export function increment() {
    counter++;
    console.log(`Module1 counter: ${counter}`);
}

// module2.js  
const message = 'Hello from module2'; // ä¸ä¼šä¸ module1 å†²çª
let counter = 100;

export function increment() {
    counter++;
    console.log(`Module2 counter: ${counter}`);
}
</code></pre>
<h3 id="ç§æœ‰å’Œå…¬å¼€æˆå‘˜"><a class="header" href="#ç§æœ‰å’Œå…¬å¼€æˆå‘˜">ç§æœ‰å’Œå…¬å¼€æˆå‘˜</a></h3>
<pre><code class="language-javascript">// user-service.js
// ç§æœ‰æˆå‘˜ï¼ˆä¸å¯¼å‡ºï¼‰
const API_KEY = 'secret-key';
const cache = new Map();

function validateUser(user) {
    return user &amp;&amp; user.name &amp;&amp; user.email;
}

// å…¬å¼€æˆå‘˜ï¼ˆå¯¼å‡ºï¼‰
export class UserService {
    async getUser(id) {
        if (cache.has(id)) {
            return cache.get(id);
        }
        
        const user = await fetch(`/api/users/${id}`, {
            headers: { 'Authorization': API_KEY }
        }).then(r =&gt; r.json());
        
        if (validateUser(user)) {
            cache.set(id, user);
            return user;
        }
        
        throw new Error('Invalid user data');
    }
}
</code></pre>
<h2 id="æ¨¡å—ä¾èµ–å…³ç³»"><a class="header" href="#æ¨¡å—ä¾èµ–å…³ç³»">æ¨¡å—ä¾èµ–å…³ç³»</a></h2>
<h3 id="ä¾èµ–å›¾dependency-graph"><a class="header" href="#ä¾èµ–å›¾dependency-graph">ä¾èµ–å›¾ï¼ˆDependency Graphï¼‰</a></h3>
<p>æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»æ„æˆäº†ä¸€ä¸ªæœ‰å‘å›¾ï¼š</p>
<pre><code class="language-javascript">// ä¾èµ–å…³ç³»ç¤ºä¾‹
// app.js â†’ user-controller.js â†’ user-service.js â†’ api-client.js

// api-client.js
export class ApiClient {
    async get(url) { /* ... */ }
    async post(url, data) { /* ... */ }
}

// user-service.js
import { ApiClient } from './api-client.js';

export class UserService {
    constructor() {
        this.apiClient = new ApiClient();
    }
}

// user-controller.js
import { UserService } from './user-service.js';

export class UserController {
    constructor() {
        this.userService = new UserService();
    }
}

// app.js
import { UserController } from './user-controller.js';

const userController = new UserController();
</code></pre>
<h3 id="å¾ªç¯ä¾èµ–é—®é¢˜"><a class="header" href="#å¾ªç¯ä¾èµ–é—®é¢˜">å¾ªç¯ä¾èµ–é—®é¢˜</a></h3>
<p>å¾ªç¯ä¾èµ–æ˜¯æ¨¡å—åŒ–ä¸­éœ€è¦é¿å…çš„é—®é¢˜ï¼š</p>
<pre><code class="language-javascript">// é—®é¢˜ç¤ºä¾‹ï¼šå¾ªç¯ä¾èµ–
// moduleA.js
import { functionB } from './moduleB.js';

export function functionA() {
    return functionB() + 1;
}

// moduleB.js
import { functionA } from './moduleA.js'; // å¾ªç¯ä¾èµ–ï¼

export function functionB() {
    return functionA() + 1; // å°†å¯¼è‡´é”™è¯¯
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="language-javascript">// æ–¹æ¡ˆ 1ï¼šæå–å…¬å…±ä¾èµ–
// common.js
export function baseFunction() {
    return 42;
}

// moduleA.js
import { baseFunction } from './common.js';

export function functionA() {
    return baseFunction() + 1;
}

// moduleB.js
import { baseFunction } from './common.js';

export function functionB() {
    return baseFunction() + 2;
}
</code></pre>
<h2 id="æ¨¡å—çš„ç”Ÿå‘½å‘¨æœŸ"><a class="header" href="#æ¨¡å—çš„ç”Ÿå‘½å‘¨æœŸ">æ¨¡å—çš„ç”Ÿå‘½å‘¨æœŸ</a></h2>
<h3 id="1-æ¨¡å—åŠ è½½é˜¶æ®µ"><a class="header" href="#1-æ¨¡å—åŠ è½½é˜¶æ®µ">1. æ¨¡å—åŠ è½½é˜¶æ®µ</a></h3>
<pre><code class="language-javascript">// æ¨¡å—è¢«é¦–æ¬¡å¯¼å…¥æ—¶æ‰§è¡Œ
console.log('Module initializing...');

const config = {
    apiUrl: process.env.API_URL || 'http://localhost:3000'
};

export { config };
</code></pre>
<h3 id="2-æ¨¡å—ç¼“å­˜"><a class="header" href="#2-æ¨¡å—ç¼“å­˜">2. æ¨¡å—ç¼“å­˜</a></h3>
<p>æ¨¡å—åªä¼šè¢«åŠ è½½å’Œæ‰§è¡Œä¸€æ¬¡ï¼Œåç»­å¯¼å…¥ä¼šä½¿ç”¨ç¼“å­˜ï¼š</p>
<pre><code class="language-javascript">// counter.js
let count = 0;

export function increment() {
    return ++count;
}

export function getCount() {
    return count;
}

// main.js
import { increment, getCount } from './counter.js';
import { increment as inc2 } from './counter.js'; // åŒä¸€ä¸ªæ¨¡å—å®ä¾‹

console.log(increment()); // 1
console.log(inc2());      // 2 (å…±äº«çŠ¶æ€)
console.log(getCount());  // 2
</code></pre>
<h2 id="æ¨¡å—åŒ–è®¾è®¡åŸåˆ™"><a class="header" href="#æ¨¡å—åŒ–è®¾è®¡åŸåˆ™">æ¨¡å—åŒ–è®¾è®¡åŸåˆ™</a></h2>
<h3 id="1-å•ä¸€èŒè´£åŸåˆ™srp"><a class="header" href="#1-å•ä¸€èŒè´£åŸåˆ™srp">1. å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰</a></h3>
<p>æ¯ä¸ªæ¨¡å—åº”è¯¥åªæœ‰ä¸€ä¸ªæ˜ç¡®çš„èŒè´£ï¼š</p>
<pre><code class="language-javascript">// å¥½çš„ç¤ºä¾‹ï¼šå•ä¸€èŒè´£
// email-validator.js - åªè´Ÿè´£é‚®ç®±éªŒè¯
export function validateEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}

// password-validator.js - åªè´Ÿè´£å¯†ç éªŒè¯
export function validatePassword(password) {
    return password.length &gt;= 8 &amp;&amp; /[A-Z]/.test(password);
}
</code></pre>
<h3 id="2-æ¥å£éš”ç¦»åŸåˆ™isp"><a class="header" href="#2-æ¥å£éš”ç¦»åŸåˆ™isp">2. æ¥å£éš”ç¦»åŸåˆ™ï¼ˆISPï¼‰</a></h3>
<p>æ¨¡å—åº”è¯¥æä¾›ç²¾ç»†åŒ–çš„æ¥å£ï¼š</p>
<pre><code class="language-javascript">// user-operations.js
export { createUser } from './user-create.js';
export { updateUser } from './user-update.js';
export { deleteUser } from './user-delete.js';
export { findUser } from './user-query.js';

// ä½¿ç”¨è€…å¯ä»¥æŒ‰éœ€å¯¼å…¥
import { createUser, findUser } from './user-operations.js';
</code></pre>
<h3 id="3-ä¾èµ–å€’ç½®åŸåˆ™dip"><a class="header" href="#3-ä¾èµ–å€’ç½®åŸåˆ™dip">3. ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰</a></h3>
<p>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½å±‚æ¨¡å—ï¼Œéƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ï¼š</p>
<pre><code class="language-javascript">// æŠ½è±¡æ¥å£
// storage-interface.js
export class StorageInterface {
    async save(key, value) {
        throw new Error('Method must be implemented');
    }
    
    async load(key) {
        throw new Error('Method must be implemented');
    }
}

// å…·ä½“å®ç°
// local-storage.js
import { StorageInterface } from './storage-interface.js';

export class LocalStorage extends StorageInterface {
    async save(key, value) {
        localStorage.setItem(key, JSON.stringify(value));
    }
    
    async load(key) {
        const item = localStorage.getItem(key);
        return item ? JSON.parse(item) : null;
    }
}

// é«˜å±‚æ¨¡å—
// user-service.js
export class UserService {
    constructor(storage) { // ä¾èµ–æŠ½è±¡ï¼Œè€Œéå…·ä½“å®ç°
        this.storage = storage;
    }
    
    async saveUser(user) {
        await this.storage.save(`user_${user.id}`, user);
    }
}
</code></pre>
<h2 id="ä¸»æµæ¨¡å—ç³»ç»Ÿå¯¹æ¯”"><a class="header" href="#ä¸»æµæ¨¡å—ç³»ç»Ÿå¯¹æ¯”">ä¸»æµæ¨¡å—ç³»ç»Ÿå¯¹æ¯”</a></h2>
<p>åœ¨äº†è§£äº†æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µåï¼Œè®©æˆ‘ä»¬æ¥å¯¹æ¯”ä¸€ä¸‹ JavaScript ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸»è¦æ¨¡å—ç³»ç»Ÿï¼š</p>
<h3 id="åŸºæœ¬ç‰¹æ€§å¯¹æ¯”"><a class="header" href="#åŸºæœ¬ç‰¹æ€§å¯¹æ¯”">åŸºæœ¬ç‰¹æ€§å¯¹æ¯”</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç‰¹æ€§</th><th>ES Modules (ESM)</th><th>CommonJS (CJS)</th><th>AMD</th><th>UMD</th><th>RequireJS</th></tr>
</thead>
<tbody>
<tr><td><strong>æ ‡å‡†çŠ¶æ€</strong></td><td>âœ… ECMAæ ‡å‡†</td><td>âŒ Node.jsäº‹å®æ ‡å‡†</td><td>âŒ ç¤¾åŒºæ ‡å‡†</td><td>âŒ ç¤¾åŒºæ ‡å‡†</td><td>âŒ åº“å®ç°</td></tr>
<tr><td><strong>é¦–æ¬¡å‘å¸ƒ</strong></td><td>2015 (ES6)</td><td>2009</td><td>2011</td><td>2013</td><td>2010</td></tr>
<tr><td><strong>åŠ è½½æ–¹å¼</strong></td><td>é™æ€ + åŠ¨æ€</td><td>åŒæ­¥</td><td>å¼‚æ­¥</td><td>é€šç”¨</td><td>å¼‚æ­¥</td></tr>
<tr><td><strong>è¿è¡Œç¯å¢ƒ</strong></td><td>æµè§ˆå™¨ + Node.js</td><td>Node.js ä¸»è¦</td><td>æµè§ˆå™¨ä¸»è¦</td><td>é€šç”¨</td><td>æµè§ˆå™¨ä¸»è¦</td></tr>
<tr><td><strong>è¯­æ³•å¤æ‚åº¦</strong></td><td>ç®€å•</td><td>ç®€å•</td><td>ä¸­ç­‰</td><td>å¤æ‚</td><td>ä¸­ç­‰</td></tr>
</tbody>
</table>
</div>
<h3 id="è¯­æ³•å¯¹æ¯”"><a class="header" href="#è¯­æ³•å¯¹æ¯”">è¯­æ³•å¯¹æ¯”</a></h3>
<h4 id="æ¨¡å—å®šä¹‰è¯­æ³•"><a class="header" href="#æ¨¡å—å®šä¹‰è¯­æ³•"><strong>æ¨¡å—å®šä¹‰è¯­æ³•</strong></a></h4>
<pre><code class="language-javascript">// ===== ES Modules (ESM) =====
// å‘½åå¯¼å‡º
export const PI = 3.14159;
export function add(a, b) { return a + b; }

// é»˜è®¤å¯¼å‡º
export default class Calculator {
  multiply(a, b) { return a * b; }
}

// ===== CommonJS (CJS) =====
// å¯¼å‡º
const PI = 3.14159;
function add(a, b) { return a + b; }

module.exports = { PI, add };
// æˆ–è€…
exports.PI = PI;
exports.add = add;

// é»˜è®¤å¯¼å‡º
module.exports = class Calculator {
  multiply(a, b) { return a * b; }
};

// ===== AMD =====
define(['dependency1', 'dependency2'], function(dep1, dep2) {
  const PI = 3.14159;
  
  function add(a, b) { return a + b; }
  
  class Calculator {
    multiply(a, b) { return a * b; }
  }
  
  return {
    PI,
    add,
    Calculator
  };
});

// ===== UMD =====
(function (root, factory) {
  if (typeof define === 'function' &amp;&amp; define.amd) {
    // AMD
    define(['dependency'], factory);
  } else if (typeof module === 'object' &amp;&amp; module.exports) {
    // CommonJS
    module.exports = factory(require('dependency'));
  } else {
    // Browser globals
    root.MyModule = factory(root.Dependency);
  }
}(typeof self !== 'undefined' ? self : this, function (dependency) {
  const PI = 3.14159;
  
  function add(a, b) { return a + b; }
  
  return { PI, add };
}));

// ===== RequireJS =====
// å®šä¹‰æ¨¡å—
define('math-utils', ['jquery'], function($) {
  const PI = 3.14159;
  
  function add(a, b) { return a + b; }
  
  return {
    PI: PI,
    add: add
  };
});
</code></pre>
<h4 id="æ¨¡å—å¯¼å…¥è¯­æ³•"><a class="header" href="#æ¨¡å—å¯¼å…¥è¯­æ³•"><strong>æ¨¡å—å¯¼å…¥è¯­æ³•</strong></a></h4>
<pre><code class="language-javascript">// ===== ES Modules (ESM) =====
import Calculator, { PI, add } from './math.js';
import * as MathUtils from './math.js';

// åŠ¨æ€å¯¼å…¥
const module = await import('./math.js');

// ===== CommonJS (CJS) =====
const { PI, add } = require('./math');
const Calculator = require('./math');
const MathUtils = require('./math');

// ===== AMD =====
require(['./math'], function(MathUtils) {
  console.log(MathUtils.PI);
});

// ===== RequireJS =====
requirejs.config({
  paths: {
    'math': './math'
  }
});

requirejs(['math'], function(MathUtils) {
  console.log(MathUtils.PI);
});
</code></pre>
<h3 id="æŠ€æœ¯ç‰¹æ€§å¯¹æ¯”"><a class="header" href="#æŠ€æœ¯ç‰¹æ€§å¯¹æ¯”">æŠ€æœ¯ç‰¹æ€§å¯¹æ¯”</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç‰¹æ€§</th><th>ESM</th><th>CommonJS</th><th>AMD</th><th>UMD</th><th>RequireJS</th></tr>
</thead>
<tbody>
<tr><td><strong>Tree Shaking</strong></td><td>âœ… åŸç”Ÿæ”¯æŒ</td><td>âŒ éœ€å·¥å…·æ”¯æŒ</td><td>âŒ æœ‰é™æ”¯æŒ</td><td>âŒ ä¸æ”¯æŒ</td><td>âŒ ä¸æ”¯æŒ</td></tr>
<tr><td><strong>é™æ€åˆ†æ</strong></td><td>âœ… ç¼–è¯‘æ—¶ç¡®å®š</td><td>âŒ è¿è¡Œæ—¶ç¡®å®š</td><td>âŒ è¿è¡Œæ—¶ç¡®å®š</td><td>âŒ è¿è¡Œæ—¶ç¡®å®š</td><td>âŒ è¿è¡Œæ—¶ç¡®å®š</td></tr>
<tr><td><strong>å¾ªç¯ä¾èµ–</strong></td><td>âœ… åŸç”Ÿå¤„ç†</td><td>âš ï¸ éƒ¨åˆ†æ”¯æŒ</td><td>âš ï¸ éƒ¨åˆ†æ”¯æŒ</td><td>âš ï¸ éƒ¨åˆ†æ”¯æŒ</td><td>âš ï¸ éƒ¨åˆ†æ”¯æŒ</td></tr>
<tr><td><strong>ä»£ç åˆ†å‰²</strong></td><td>âœ… åŠ¨æ€å¯¼å…¥</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… å¼‚æ­¥åŠ è½½</td><td>âŒ å–å†³äºç¯å¢ƒ</td><td>âœ… å¼‚æ­¥åŠ è½½</td></tr>
<tr><td><strong>æµè§ˆå™¨æ”¯æŒ</strong></td><td>âœ… ç°ä»£æµè§ˆå™¨</td><td>âŒ éœ€è¦æ‰“åŒ…</td><td>âœ… ç›´æ¥æ”¯æŒ</td><td>âœ… é€šç”¨æ”¯æŒ</td><td>âœ… ç›´æ¥æ”¯æŒ</td></tr>
<tr><td><strong>Node.jsæ”¯æŒ</strong></td><td>âœ… v12+</td><td>âœ… åŸç”Ÿæ”¯æŒ</td><td>âŒ éœ€è¦åº“</td><td>âœ… é€šè¿‡åŒ…è£…</td><td>âŒ éœ€è¦åº“</td></tr>
<tr><td><strong>æ‰“åŒ…å·¥å…·æ”¯æŒ</strong></td><td>âœ… å¹¿æ³›æ”¯æŒ</td><td>âœ… å¹¿æ³›æ”¯æŒ</td><td>âš ï¸ éƒ¨åˆ†æ”¯æŒ</td><td>âœ… å¹¿æ³›æ”¯æŒ</td><td>âš ï¸ ç‰¹å®šå·¥å…·</td></tr>
</tbody>
</table>
</div>
<h3 id="æ€§èƒ½å¯¹æ¯”"><a class="header" href="#æ€§èƒ½å¯¹æ¯”">æ€§èƒ½å¯¹æ¯”</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>æŒ‡æ ‡</th><th>ESM</th><th>CommonJS</th><th>AMD</th><th>UMD</th><th>RequireJS</th></tr>
</thead>
<tbody>
<tr><td><strong>åŠ è½½æ€§èƒ½</strong></td><td>â­â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­</td></tr>
<tr><td><strong>è§£æé€Ÿåº¦</strong></td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­</td><td>â­â­â­</td></tr>
<tr><td><strong>è¿è¡Œæ—¶å¼€é”€</strong></td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­</td><td>â­â­â­</td></tr>
<tr><td><strong>æ‰“åŒ…ä½“ç§¯</strong></td><td>â­â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­</td><td>â­â­â­</td></tr>
<tr><td><strong>å¯åŠ¨æ—¶é—´</strong></td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­â­</td></tr>
</tbody>
</table>
</div>
<h3 id="é€‚ç”¨åœºæ™¯"><a class="header" href="#é€‚ç”¨åœºæ™¯">é€‚ç”¨åœºæ™¯</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>æ¨¡å—ç³»ç»Ÿ</th><th>æœ€ä½³é€‚ç”¨åœºæ™¯</th><th>ä¸é€‚ç”¨åœºæ™¯</th></tr>
</thead>
<tbody>
<tr><td><strong>ES Modules</strong></td><td>â€¢ ç°ä»£Webåº”ç”¨<br>â€¢ Node.jsæ–°é¡¹ç›®<br>â€¢ éœ€è¦Tree Shaking<br>â€¢ åº“å¼€å‘</td><td>â€¢ æ—§æµè§ˆå™¨æ”¯æŒ<br>â€¢ æ—§ç‰ˆNode.jsé¡¹ç›®</td></tr>
<tr><td><strong>CommonJS</strong></td><td>â€¢ Node.jsæœåŠ¡ç«¯<br>â€¢ ç°æœ‰Node.jsé¡¹ç›®<br>â€¢ npmåŒ…å¼€å‘</td><td>â€¢ æµè§ˆå™¨ç›´æ¥ä½¿ç”¨<br>â€¢ éœ€è¦å¼‚æ­¥åŠ è½½</td></tr>
<tr><td><strong>AMD</strong></td><td>â€¢ æµè§ˆå™¨åº”ç”¨<br>â€¢ éœ€è¦å¼‚æ­¥åŠ è½½<br>â€¢ å¤æ‚ä¾èµ–å…³ç³»</td><td>â€¢ Node.jsç¯å¢ƒ<br>â€¢ ç®€å•é¡¹ç›®</td></tr>
<tr><td><strong>UMD</strong></td><td>â€¢ è·¨å¹³å°åº“<br>â€¢ å‘åå…¼å®¹<br>â€¢ ç¬¬ä¸‰æ–¹åº“å‘å¸ƒ</td><td>â€¢ ç°ä»£åº”ç”¨å¼€å‘<br>â€¢ æ€§èƒ½æ•æ„Ÿåº”ç”¨</td></tr>
<tr><td><strong>RequireJS</strong></td><td>â€¢ æ—§ç‰ˆæµè§ˆå™¨åº”ç”¨<br>â€¢ æ¸è¿›å¼å‡çº§<br>â€¢ æ•™å­¦æ¼”ç¤º</td><td>â€¢ æ–°é¡¹ç›®å¼€å‘<br>â€¢ ç°ä»£å·¥å…·é“¾</td></tr>
</tbody>
</table>
</div>
<h3 id="ç”Ÿæ€ç³»ç»Ÿæ”¯æŒ"><a class="header" href="#ç”Ÿæ€ç³»ç»Ÿæ”¯æŒ">ç”Ÿæ€ç³»ç»Ÿæ”¯æŒ</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>æ–¹é¢</th><th>ESM</th><th>CommonJS</th><th>AMD</th><th>UMD</th><th>RequireJS</th></tr>
</thead>
<tbody>
<tr><td><strong>æ¡†æ¶æ”¯æŒ</strong></td><td>React, Vue, Angularç­‰</td><td>Express, Koaç­‰</td><td>éƒ¨åˆ†æ—§æ¡†æ¶</td><td>é€šç”¨æ”¯æŒ</td><td>æ—§ç‰ˆåº“</td></tr>
<tr><td><strong>å·¥å…·é“¾</strong></td><td>Webpack, Vite, Rollup</td><td>Webpack, Browserify</td><td>r.js, Webpack</td><td>æ‰€æœ‰æ‰“åŒ…å·¥å…·</td><td>r.jsä¼˜åŒ–å™¨</td></tr>
<tr><td><strong>TypeScript</strong></td><td>âœ… å®Œå…¨æ”¯æŒ</td><td>âœ… å®Œå…¨æ”¯æŒ</td><td>âš ï¸ é…ç½®å¤æ‚</td><td>âš ï¸ ç±»å‹æ¨å¯¼éš¾</td><td>âš ï¸ é…ç½®å¤æ‚</td></tr>
<tr><td><strong>æµ‹è¯•å·¥å…·</strong></td><td>Jest, Vitestç­‰</td><td>Jest, Mochaç­‰</td><td>ç‰¹å®šé…ç½®</td><td>éœ€è¦é€‚é…</td><td>ç‰¹å®šé…ç½®</td></tr>
<tr><td><strong>CDNæ”¯æŒ</strong></td><td>Skypack, esm.sh</td><td>éœ€è¦æ‰“åŒ…</td><td>jsDelivrç­‰</td><td>å¹¿æ³›æ”¯æŒ</td><td>jsDelivrç­‰</td></tr>
</tbody>
</table>
</div>
<h3 id="è¿ç§»è·¯å¾„"><a class="header" href="#è¿ç§»è·¯å¾„">è¿ç§»è·¯å¾„</a></h3>
<pre><code class="language-javascript">// ä» CommonJS è¿ç§»åˆ° ESM
// Before (CommonJS)
const express = require('express');
const { createUser } = require('./user-service');

module.exports = {
  startServer: () =&gt; {
    const app = express();
    // ...
  }
};

// After (ESM)
import express from 'express';
import { createUser } from './user-service.js';

export function startServer() {
  const app = express();
  // ...
}

// ä» AMD è¿ç§»åˆ° ESM
// Before (AMD)
define(['lodash', './utils'], function(_, utils) {
  return {
    processData: function(data) {
      return _.map(data, utils.transform);
    }
  };
});

// After (ESM)
import _ from 'lodash';
import { transform } from './utils.js';

export function processData(data) {
  return _.map(data, transform);
}
</code></pre>
<h3 id="æœªæ¥è¶‹åŠ¿"><a class="header" href="#æœªæ¥è¶‹åŠ¿">æœªæ¥è¶‹åŠ¿</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>è¶‹åŠ¿</th><th>è¯´æ˜</th><th>å½±å“</th></tr>
</thead>
<tbody>
<tr><td><strong>ESM æ ‡å‡†åŒ–</strong></td><td>æˆä¸ºå”¯ä¸€æ ‡å‡†</td><td>å…¶ä»–ç³»ç»Ÿé€æ­¥æ·˜æ±°</td></tr>
<tr><td><strong>åŸç”Ÿæ”¯æŒå¢å¼º</strong></td><td>æµè§ˆå™¨å’ŒNode.jså®Œå…¨æ”¯æŒ</td><td>å‡å°‘å·¥å…·ä¾èµ–</td></tr>
<tr><td><strong>Import Maps</strong></td><td>æ ‡å‡†åŒ–æ¨¡å—æ˜ å°„</td><td>ç®€åŒ–ä¾èµ–ç®¡ç†</td></tr>
<tr><td><strong>åŠ¨æ€å¯¼å…¥æ™®åŠ</strong></td><td>ä»£ç åˆ†å‰²æ ‡å‡†åŒ–</td><td>æå‡åº”ç”¨æ€§èƒ½</td></tr>
<tr><td><strong>å·¥å…·é“¾æ•´åˆ</strong></td><td>å›´ç»•ESMæ„å»º</td><td>å¼€å‘ä½“éªŒæå‡</td></tr>
</tbody>
</table>
</div>
<h2 id="æ€»ç»“-1"><a class="header" href="#æ€»ç»“-1">æ€»ç»“</a></h2>
<p>æ¨¡å—åŒ–çš„æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬ï¼š</p>
<ul>
<li>âœ… <strong>æ¨¡å—å®šä¹‰</strong>: å¦‚ä½•åˆ›å»ºå’Œç»„ç»‡æ¨¡å—</li>
<li>âœ… <strong>å¯¼å…¥å¯¼å‡º</strong>: æ¨¡å—é—´çš„æ¥å£äº¤äº’</li>
<li>âœ… <strong>ä½œç”¨åŸŸéš”ç¦»</strong>: ä¿è¯æ¨¡å—ç‹¬ç«‹æ€§</li>
<li>âœ… <strong>ä¾èµ–ç®¡ç†</strong>: æ„å»ºæ¸…æ™°çš„ä¾èµ–å…³ç³»</li>
<li>âœ… <strong>è®¾è®¡åŸåˆ™</strong>: éµå¾ªè‰¯å¥½çš„æ¨¡å—åŒ–å®è·µ</li>
</ul>
<h3 id="é€‰æ‹©å»ºè®®"><a class="header" href="#é€‰æ‹©å»ºè®®">é€‰æ‹©å»ºè®®</a></h3>
<ul>
<li><strong>æ–°é¡¹ç›®</strong>: ä¼˜å…ˆé€‰æ‹© <strong>ES Modules</strong></li>
<li><strong>Node.jsæœåŠ¡</strong>: <strong>CommonJS</strong> ä»ç„¶æ˜¯ä¸»æµï¼Œä½†å¯è€ƒè™‘ <strong>ESM</strong></li>
<li><strong>åº“å¼€å‘</strong>: <strong>ESM</strong> + <strong>UMD</strong> å…¼å®¹å‘å¸ƒ</li>
<li><strong>æ—§é¡¹ç›®ç»´æŠ¤</strong>: æ¸è¿›å¼è¿ç§»åˆ° <strong>ESM</strong></li>
<li><strong>æµè§ˆå™¨å…¼å®¹</strong>: ä½¿ç”¨æ„å»ºå·¥å…·å°† <strong>ESM</strong> è½¬è¯‘ä¸ºåˆé€‚æ ¼å¼</li>
</ul>
<p>ç†è§£è¿™äº›æ ¸å¿ƒæ¦‚å¿µå’Œå„ç³»ç»Ÿçš„ç‰¹ç‚¹æ˜¯æŒæ¡ä»»ä½•æ¨¡å—ç³»ç»Ÿçš„åŸºç¡€ã€‚åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å…·ä½“çš„æ¨¡å—ç³»ç»Ÿå®ç°ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#esæ¨¡å—åŸºç¡€">ESæ¨¡å—åŸºç¡€</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="esæ¨¡å—åŸºç¡€"><a class="header" href="#esæ¨¡å—åŸºç¡€">ESæ¨¡å—åŸºç¡€</a></h1>
<p>ESæ¨¡å—ï¼ˆECMAScript Modulesï¼Œç®€ç§°ESMï¼‰æ˜¯JavaScriptçš„å®˜æ–¹æ¨¡å—ç³»ç»Ÿï¼Œåœ¨ES6ï¼ˆES2015ï¼‰ä¸­æ­£å¼å¼•å…¥ã€‚å®ƒæä¾›äº†ä¸€ç§æ ‡å‡†åŒ–çš„æ–¹å¼æ¥ç»„ç»‡å’Œé‡ç”¨JavaScriptä»£ç ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯esæ¨¡å—"><a class="header" href="#ä»€ä¹ˆæ˜¯esæ¨¡å—">ä»€ä¹ˆæ˜¯ESæ¨¡å—</a></h2>
<p>ESæ¨¡å—æ˜¯JavaScriptè¯­è¨€å±‚é¢çš„æ¨¡å—ç³»ç»Ÿï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>é™æ€ç»“æ„</strong>: æ¨¡å—çš„å¯¼å…¥å¯¼å‡ºå…³ç³»åœ¨ç¼–è¯‘æ—¶ç¡®å®š</li>
<li><strong>ä¸¥æ ¼æ¨¡å¼</strong>: æ¨¡å—ä»£ç è‡ªåŠ¨è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹</li>
<li><strong>é¡¶å±‚ä½œç”¨åŸŸ</strong>: æ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„é¡¶å±‚ä½œç”¨åŸŸ</li>
<li><strong>å¼‚æ­¥åŠ è½½</strong>: æ”¯æŒå¼‚æ­¥æ¨¡å—åŠ è½½</li>
<li><strong>æ ‘æ‘‡å‹å¥½</strong>: æ”¯æŒé™æ€åˆ†æå’Œæ­»ä»£ç æ¶ˆé™¤</li>
</ul>
<h2 id="åŸºæœ¬è¯­æ³•"><a class="header" href="#åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</a></h2>
<h3 id="å¯¼å‡ºexport"><a class="header" href="#å¯¼å‡ºexport">å¯¼å‡ºï¼ˆExportï¼‰</a></h3>
<p>ESæ¨¡å—æä¾›äº†å¤šç§å¯¼å‡ºæ–¹å¼ï¼š</p>
<h4 id="1-å‘½åå¯¼å‡ºnamed-exports"><a class="header" href="#1-å‘½åå¯¼å‡ºnamed-exports">1. å‘½åå¯¼å‡ºï¼ˆNamed Exportsï¼‰</a></h4>
<pre><code class="language-javascript">// math.js

// å¯¼å‡ºå˜é‡
export const PI = 3.14159;
export let counter = 0;

// å¯¼å‡ºå‡½æ•°
export function add(a, b) {
    return a + b;
}

export function multiply(a, b) {
    return a * b;
}

// å¯¼å‡ºç±»
export class Calculator {
    add(a, b) {
        return a + b;
    }
}

// æ‰¹é‡å¯¼å‡º
const subtract = (a, b) =&gt; a - b;
const divide = (a, b) =&gt; a / b;

export { subtract, divide };
</code></pre>
<h4 id="2-é»˜è®¤å¯¼å‡ºdefault-export"><a class="header" href="#2-é»˜è®¤å¯¼å‡ºdefault-export">2. é»˜è®¤å¯¼å‡ºï¼ˆDefault Exportï¼‰</a></h4>
<pre><code class="language-javascript">// user.js

// é»˜è®¤å¯¼å‡ºç±»
export default class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    getInfo() {
        return `${this.name} &lt;${this.email}&gt;`;
    }
}

// æˆ–è€…å¯¼å‡ºå‡½æ•°
// export default function createUser(name, email) {
//     return new User(name, email);
// }

// æˆ–è€…å¯¼å‡ºå€¼
// export default {
//     apiUrl: 'https://api.example.com',
//     timeout: 5000
// };
</code></pre>
<h4 id="3-æ··åˆå¯¼å‡º"><a class="header" href="#3-æ··åˆå¯¼å‡º">3. æ··åˆå¯¼å‡º</a></h4>
<pre><code class="language-javascript">// api.js

// é»˜è®¤å¯¼å‡º
class ApiClient {
    constructor(baseUrl) {
        this.baseUrl = baseUrl;
    }
    
    async get(endpoint) {
        const response = await fetch(`${this.baseUrl}${endpoint}`);
        return response.json();
    }
}

export default ApiClient;

// åŒæ—¶æä¾›å‘½åå¯¼å‡º
export const DEFAULT_TIMEOUT = 5000;
export const HTTP_METHODS = ['GET', 'POST', 'PUT', 'DELETE'];

export function createApiClient(baseUrl) {
    return new ApiClient(baseUrl);
}
</code></pre>
<h3 id="å¯¼å…¥import"><a class="header" href="#å¯¼å…¥import">å¯¼å…¥ï¼ˆImportï¼‰</a></h3>
<h4 id="1-å¯¼å…¥å‘½åå¯¼å‡º"><a class="header" href="#1-å¯¼å…¥å‘½åå¯¼å‡º">1. å¯¼å…¥å‘½åå¯¼å‡º</a></h4>
<pre><code class="language-javascript">// main.js

// å¯¼å…¥ç‰¹å®šçš„å‘½åå¯¼å‡º
import { add, multiply, PI } from './math.js';

console.log(add(2, 3)); // 5
console.log(multiply(4, 5)); // 20
console.log(PI); // 3.14159

// å¯¼å…¥æ—¶é‡å‘½å
import { add as sum, multiply as product } from './math.js';

console.log(sum(2, 3)); // 5
console.log(product(4, 5)); // 20

// å¯¼å…¥æ‰€æœ‰å‘½åå¯¼å‡º
import * as MathUtils from './math.js';

console.log(MathUtils.add(2, 3)); // 5
console.log(MathUtils.PI); // 3.14159
</code></pre>
<h4 id="2-å¯¼å…¥é»˜è®¤å¯¼å‡º"><a class="header" href="#2-å¯¼å…¥é»˜è®¤å¯¼å‡º">2. å¯¼å…¥é»˜è®¤å¯¼å‡º</a></h4>
<pre><code class="language-javascript">// app.js

// å¯¼å…¥é»˜è®¤å¯¼å‡º
import User from './user.js';

const user = new User('John', 'john@example.com');
console.log(user.getInfo());

// é»˜è®¤å¯¼å‡ºå¯ä»¥ç”¨ä»»æ„åç§°
import MyUser from './user.js'; // åŒæ ·æœ‰æ•ˆ
</code></pre>
<h4 id="3-æ··åˆå¯¼å…¥"><a class="header" href="#3-æ··åˆå¯¼å…¥">3. æ··åˆå¯¼å…¥</a></h4>
<pre><code class="language-javascript">// client.js

// åŒæ—¶å¯¼å…¥é»˜è®¤å¯¼å‡ºå’Œå‘½åå¯¼å‡º
import ApiClient, { DEFAULT_TIMEOUT, createApiClient } from './api.js';

const client = new ApiClient('https://api.example.com');
const anotherClient = createApiClient('https://another-api.com');

console.log(`Default timeout: ${DEFAULT_TIMEOUT}ms`);
</code></pre>
<h4 id="4-ä»…å¯¼å…¥æ¨¡å—æ— ç»‘å®š"><a class="header" href="#4-ä»…å¯¼å…¥æ¨¡å—æ— ç»‘å®š">4. ä»…å¯¼å…¥æ¨¡å—ï¼ˆæ— ç»‘å®šï¼‰</a></h4>
<pre><code class="language-javascript">// ä»…æ‰§è¡Œæ¨¡å—ä»£ç ï¼Œä¸å¯¼å…¥ä»»ä½•ç»‘å®š
import './polyfills.js';
import './init-global-config.js';
</code></pre>
<h2 id="æ¨¡å—çš„æ‰§è¡Œç‰¹æ€§"><a class="header" href="#æ¨¡å—çš„æ‰§è¡Œç‰¹æ€§">æ¨¡å—çš„æ‰§è¡Œç‰¹æ€§</a></h2>
<h3 id="1-ä¸¥æ ¼æ¨¡å¼"><a class="header" href="#1-ä¸¥æ ¼æ¨¡å¼">1. ä¸¥æ ¼æ¨¡å¼</a></h3>
<p>ESæ¨¡å—ä»£ç è‡ªåŠ¨è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™å¸¦æ¥äº†æ›´ä¸¥æ ¼çš„è¯­æ³•æ£€æŸ¥å’Œæ›´å®‰å…¨çš„æ‰§è¡Œç¯å¢ƒï¼š</p>
<p><strong>ä¸¥æ ¼æ¨¡å¼çš„ä¸»è¦ç‰¹å¾ï¼š</strong></p>
<ul>
<li>ç¦æ­¢ä½¿ç”¨æœªå£°æ˜çš„å˜é‡</li>
<li>ç¦æ­¢åˆ é™¤ä¸å¯åˆ é™¤çš„å±æ€§</li>
<li>å‡½æ•°å‚æ•°åå¿…é¡»å”¯ä¸€</li>
<li>ç¦æ­¢å…«è¿›åˆ¶å­—é¢é‡</li>
<li><code>this</code>åœ¨å‡½æ•°ä¸­ä¸ä¼šè‡ªåŠ¨æŒ‡å‘å…¨å±€å¯¹è±¡</li>
</ul>
<pre><code class="language-javascript">// module.js
// æ¨¡å—ä»£ç è‡ªåŠ¨è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹

// ä»¥ä¸‹ä»£ç åœ¨æ¨¡å—ä¸­ä¼šæŠ¥é”™
// undeclaredVariable = 'value'; // ReferenceError
// delete Object.prototype; // TypeError

console.log(this); // undefinedï¼ˆéæµè§ˆå™¨ç¯å¢ƒï¼‰
</code></pre>
<h3 id="2-é¡¶å±‚ä½œç”¨åŸŸ"><a class="header" href="#2-é¡¶å±‚ä½œç”¨åŸŸ">2. é¡¶å±‚ä½œç”¨åŸŸ</a></h3>
<pre><code class="language-javascript">// module1.js
var globalVar = 'module1';
let moduleVar = 'private to module1';

export { moduleVar };

// module2.js
var globalVar = 'module2'; // ä¸ä¼šä¸module1å†²çª
let moduleVar = 'private to module2';

export { moduleVar };

// main.js
import { moduleVar as var1 } from './module1.js';
import { moduleVar as var2 } from './module2.js';

console.log(var1); // 'private to module1'
console.log(var2); // 'private to module2'
</code></pre>
<h3 id="3-æ¨¡å—å•ä¾‹"><a class="header" href="#3-æ¨¡å—å•ä¾‹">3. æ¨¡å—å•ä¾‹</a></h3>
<pre><code class="language-javascript">// counter.js
let count = 0;

export function increment() {
    return ++count;
}

export function getCount() {
    return count;
}

// module1.js
import { increment } from './counter.js';
console.log(increment()); // 1

// module2.js
import { increment, getCount } from './counter.js';
console.log(increment()); // 2
console.log(getCount()); // 2
</code></pre>
<h2 id="åœ¨htmlä¸­ä½¿ç”¨esæ¨¡å—"><a class="header" href="#åœ¨htmlä¸­ä½¿ç”¨esæ¨¡å—">åœ¨HTMLä¸­ä½¿ç”¨ESæ¨¡å—</a></h2>
<h3 id="1-åŸºæœ¬ç”¨æ³•"><a class="header" href="#1-åŸºæœ¬ç”¨æ³•">1. åŸºæœ¬ç”¨æ³•</a></h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;ES Modules Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- ä½¿ç”¨type="module"æ ‡è¯†ESæ¨¡å— --&gt;
    &lt;script type="module" src="./main.js"&gt;&lt;/script&gt;
    
    &lt;!-- å†…è”æ¨¡å—è„šæœ¬ --&gt;
    &lt;script type="module"&gt;
        import { greet } from './utils.js';
        greet('World');
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="2-æ¨¡å—è„šæœ¬çš„ç‰¹æ€§"><a class="header" href="#2-æ¨¡å—è„šæœ¬çš„ç‰¹æ€§">2. æ¨¡å—è„šæœ¬çš„ç‰¹æ€§</a></h3>
<pre><code class="language-html">&lt;!-- ESæ¨¡å—è„šæœ¬çš„ç‰¹ç‚¹ --&gt;
&lt;script type="module"&gt;
    // 1. è‡ªåŠ¨å»¶è¿Ÿæ‰§è¡Œï¼ˆç›¸å½“äºdeferï¼‰
    console.log('Module script executed');
    
    // 2. ä¸¥æ ¼æ¨¡å¼
    console.log(this); // undefined
    
    // 3. æ”¯æŒé¡¶å±‚awaitï¼ˆç°ä»£æµè§ˆå™¨ï¼‰
    const data = await fetch('/api/data').then(r =&gt; r.json());
    console.log(data);
&lt;/script&gt;

&lt;!-- ä¼ ç»Ÿè„šæœ¬ï¼ˆç”¨äºå¯¹æ¯”ï¼‰ --&gt;
&lt;script&gt;
    console.log('Regular script executed first');
&lt;/script&gt;
</code></pre>
<h3 id="3-æµè§ˆå™¨å…¼å®¹æ€§å¤„ç†"><a class="header" href="#3-æµè§ˆå™¨å…¼å®¹æ€§å¤„ç†">3. æµè§ˆå™¨å…¼å®¹æ€§å¤„ç†</a></h3>
<pre><code class="language-html">&lt;!-- ç°ä»£æµè§ˆå™¨ä½¿ç”¨ESæ¨¡å— --&gt;
&lt;script type="module" src="./modern-app.js"&gt;&lt;/script&gt;

&lt;!-- æ—§æµè§ˆå™¨é™çº§æ–¹æ¡ˆ --&gt;
&lt;script nomodule src="./legacy-app.js"&gt;&lt;/script&gt;
</code></pre>
<h2 id="nodejsä¸­çš„esæ¨¡å—"><a class="header" href="#nodejsä¸­çš„esæ¨¡å—">Node.jsä¸­çš„ESæ¨¡å—</a></h2>
<h3 id="1-å¯ç”¨esæ¨¡å—"><a class="header" href="#1-å¯ç”¨esæ¨¡å—">1. å¯ç”¨ESæ¨¡å—</a></h3>
<p>æ–¹å¼1ï¼šä½¿ç”¨<code>.mjs</code>æ‰©å±•å</p>
<pre><code class="language-javascript">// app.mjs
import { readFile } from 'fs/promises';

const content = await readFile('./package.json', 'utf-8');
console.log(content);
</code></pre>
<p>æ–¹å¼2ï¼šåœ¨<code>package.json</code>ä¸­è®¾ç½®<code>"type": "module"</code></p>
<pre><code class="language-json">{
  "type": "module",
  "main": "app.js"
}
</code></pre>
<pre><code class="language-javascript">// app.js (ç°åœ¨ä½œä¸ºESæ¨¡å—è¿è¡Œ)
import { readFile } from 'fs/promises';

const content = await readFile('./package.json', 'utf-8');
console.log(content);
</code></pre>
<h3 id="2-å†…ç½®æ¨¡å—çš„å¯¼å…¥"><a class="header" href="#2-å†…ç½®æ¨¡å—çš„å¯¼å…¥">2. å†…ç½®æ¨¡å—çš„å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// Node.jså†…ç½®æ¨¡å—
import { readFile, writeFile } from 'fs/promises';
import { join, dirname } from 'path';
import { fileURLToPath } from 'url';

// è·å–å½“å‰æ–‡ä»¶è·¯å¾„ï¼ˆåœ¨ESæ¨¡å—ä¸­__dirnameä¸å¯ç”¨ï¼‰
const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const filePath = join(__dirname, 'data.txt');
const data = await readFile(filePath, 'utf-8');
</code></pre>
<h2 id="esæ¨¡å—çš„ä¼˜åŠ¿"><a class="header" href="#esæ¨¡å—çš„ä¼˜åŠ¿">ESæ¨¡å—çš„ä¼˜åŠ¿</a></h2>
<h3 id="1-é™æ€åˆ†æ"><a class="header" href="#1-é™æ€åˆ†æ">1. é™æ€åˆ†æ</a></h3>
<pre><code class="language-javascript">// é™æ€ç»“æ„ä½¿å·¥å…·èƒ½å¤Ÿåˆ†æä¾èµ–å…³ç³»
import { usedFunction } from './utils.js';
// import { unusedFunction } from './utils.js'; // å¯ä»¥è¢«å·¥å…·æ£€æµ‹å¹¶ç§»é™¤

// åŠ¨æ€å¯¼å…¥æ— æ³•è¿›è¡Œé™æ€åˆ†æ
// const moduleName = getModuleName();
// import(moduleName); // è¿è¡Œæ—¶ç¡®å®š
</code></pre>
<h3 id="2-æ ‘æ‘‡tree-shaking"><a class="header" href="#2-æ ‘æ‘‡tree-shaking">2. æ ‘æ‘‡ï¼ˆTree Shakingï¼‰</a></h3>
<pre><code class="language-javascript">// utils.js
export function add(a, b) { return a + b; }
export function subtract(a, b) { return a - b; }
export function multiply(a, b) { return a * b; }
export function divide(a, b) { return a / b; }

// main.js
import { add, multiply } from './utils.js';
// æ‰“åŒ…å·¥å…·å¯ä»¥è‡ªåŠ¨ç§»é™¤unusedçš„subtractå’Œdivideå‡½æ•°

console.log(add(2, 3));
console.log(multiply(4, 5));
</code></pre>
<h3 id="3-å¾ªç¯ä¾èµ–å¤„ç†"><a class="header" href="#3-å¾ªç¯ä¾èµ–å¤„ç†">3. å¾ªç¯ä¾èµ–å¤„ç†</a></h3>
<pre><code class="language-javascript">// a.js
import { b } from './b.js';
export const a = 'a';
console.log('a.js:', b);

// b.js
import { a } from './a.js';
export const b = 'b';
console.log('b.js:', a); // undefinedï¼ˆä½†ä¸ä¼šæŠ¥é”™ï¼‰

// ESæ¨¡å—èƒ½å¤Ÿä¼˜é›…å¤„ç†å¾ªç¯ä¾èµ–
</code></pre>
<p><strong>ESæ¨¡å—å¾ªç¯ä¾èµ–å¤„ç†æœºåˆ¶ï¼š</strong></p>
<ol>
<li><strong>æ¨¡å—è®°å½•åˆ›å»º</strong>: åœ¨è§£æé˜¶æ®µï¼Œæ‰€æœ‰æ¨¡å—éƒ½ä¼šåˆ›å»ºæ¨¡å—è®°å½•ï¼Œä½†ä¸ç«‹å³æ‰§è¡Œ</li>
<li><strong>æ·±åº¦ä¼˜å…ˆéå†</strong>: æŒ‰ç…§ä¾èµ–å›¾è¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†ï¼Œç¡®å®šæ‰§è¡Œé¡ºåº</li>
<li><strong>å®æ—¶ç»‘å®š</strong>: é€šè¿‡live bindingæœºåˆ¶ï¼Œå³ä½¿åœ¨å¾ªç¯ä¾èµ–ä¸­ä¹Ÿèƒ½è·å–åˆ°æœ€ç»ˆçš„å¯¼å‡ºå€¼</li>
<li><strong>å»¶è¿Ÿè®¿é—®</strong>: åœ¨æ¨¡å—å®Œå…¨åˆå§‹åŒ–ä¹‹å‰è®¿é—®å¯¼å‡ºå¯èƒ½å¾—åˆ°undefinedï¼Œä½†ä¸ä¼šæŠ›å‡ºé”™è¯¯</li>
</ol>
<p>è¿™ç§æœºåˆ¶ä½¿å¾—ESæ¨¡å—èƒ½å¤Ÿå®‰å…¨åœ°å¤„ç†å¾ªç¯ä¾èµ–ï¼Œè¯¦ç»†å†…å®¹è¯·å‚é˜…<a href="#å¾ªç¯ä¾èµ–å¤„ç†">å¾ªç¯ä¾èµ–ç« èŠ‚</a>ã€‚</p>
<h2 id="å¸¸è§æ¨¡å¼å’Œæœ€ä½³å®è·µ"><a class="header" href="#å¸¸è§æ¨¡å¼å’Œæœ€ä½³å®è·µ">å¸¸è§æ¨¡å¼å’Œæœ€ä½³å®è·µ</a></h2>
<h3 id="1-é‡æ–°å¯¼å‡ºre-exports"><a class="header" href="#1-é‡æ–°å¯¼å‡ºre-exports">1. é‡æ–°å¯¼å‡ºï¼ˆRe-exportsï¼‰</a></h3>
<pre><code class="language-javascript">// components/index.js - ç»Ÿä¸€å¯¼å‡ºæ–‡ä»¶
export { Button } from './Button.js';
export { Input } from './Input.js';
export { Modal } from './Modal.js';

// æˆ–è€…ä½¿ç”¨é€šé…ç¬¦é‡æ–°å¯¼å‡º
export * from './Button.js';
export * from './Input.js';

// é‡æ–°å¯¼å‡ºå¹¶é‡å‘½å
export { default as MyButton } from './Button.js';
</code></pre>
<h3 id="2-æ¡ä»¶å¯¼å‡º"><a class="header" href="#2-æ¡ä»¶å¯¼å‡º">2. æ¡ä»¶å¯¼å‡º</a></h3>
<pre><code class="language-javascript">// config.js
const isDevelopment = process.env.NODE_ENV === 'development';

if (isDevelopment) {
    // åŠ¨æ€å¯¼å…¥å¼€å‘å·¥å…·
    const devTools = await import('./dev-tools.js');
    devTools.setupDevMode();
}

export const config = {
    apiUrl: isDevelopment ? 'http://localhost:3000' : 'https://api.prod.com'
};
</code></pre>
<h3 id="3-å·¥å‚å‡½æ•°æ¨¡å¼"><a class="header" href="#3-å·¥å‚å‡½æ•°æ¨¡å¼">3. å·¥å‚å‡½æ•°æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// database.js
export function createDatabase(config) {
    return {
        connect() {
            console.log(`Connecting to ${config.host}:${config.port}`);
        },
        
        query(sql) {
            console.log(`Executing: ${sql}`);
        }
    };
}

// main.js
import { createDatabase } from './database.js';

const db = createDatabase({
    host: 'localhost',
    port: 5432
});

db.connect();
</code></pre>
<h2 id="live-bindingå®æ—¶ç»‘å®š"><a class="header" href="#live-bindingå®æ—¶ç»‘å®š">Live Bindingï¼ˆå®æ—¶ç»‘å®šï¼‰</a></h2>
<p>Live Bindingæ˜¯ESæ¨¡å—çš„ä¸€ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼Œå®ƒä½¿å¾—å¯¼å…¥çš„ç»‘å®šä¸å¯¼å‡ºçš„ç»‘å®šä¿æŒ<strong>å®æ—¶åŒæ­¥</strong>ã€‚è¿™ä¸CommonJSçš„å€¼å¤åˆ¶å®Œå…¨ä¸åŒã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯live-binding"><a class="header" href="#ä»€ä¹ˆæ˜¯live-binding">ä»€ä¹ˆæ˜¯Live Binding</a></h3>
<p>Live Bindingæ„å‘³ç€å¯¼å…¥çš„å˜é‡æ˜¯å¯¹å¯¼å‡ºå˜é‡çš„<strong>å®æ—¶å¼•ç”¨</strong>ï¼Œè€Œä¸æ˜¯å€¼çš„æ‹·è´ã€‚å½“å¯¼å‡ºæ¨¡å—ä¸­çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯¼å…¥æ¨¡å—ä¸­çš„å¯¹åº”å˜é‡ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ã€‚</p>
<h3 id="live-binding-vs-å€¼å¤åˆ¶"><a class="header" href="#live-binding-vs-å€¼å¤åˆ¶">Live Binding vs å€¼å¤åˆ¶</a></h3>
<h4 id="commonjså€¼å¤åˆ¶"><a class="header" href="#commonjså€¼å¤åˆ¶">CommonJSï¼ˆå€¼å¤åˆ¶ï¼‰</a></h4>
<pre><code class="language-javascript">// counter.js (CommonJS)
let count = 0;

function increment() {
    count++;
}

function getCount() {
    return count;
}

// å¯¼å‡ºçš„æ˜¯å€¼çš„å‰¯æœ¬
module.exports = { count, increment, getCount };
</code></pre>
<pre><code class="language-javascript">// main.js (CommonJS)
const { count, increment, getCount } = require('./counter');

console.log(count); // 0
increment();
console.log(count); // 0 â† è¿˜æ˜¯0ï¼Œå› ä¸ºæ˜¯å€¼å¤åˆ¶
console.log(getCount()); // 1 â† é€šè¿‡å‡½æ•°æ‰èƒ½è·å–æœ€æ–°å€¼
</code></pre>
<h4 id="esæ¨¡å—live-binding"><a class="header" href="#esæ¨¡å—live-binding">ESæ¨¡å—ï¼ˆLive Bindingï¼‰</a></h4>
<pre><code class="language-javascript">// counter.mjs (ESæ¨¡å—)
export let count = 0;

export function increment() {
    count++;
}

export function decrement() {
    count--;
}

export function reset() {
    count = 0;
}
</code></pre>
<pre><code class="language-javascript">// main.mjs (ESæ¨¡å—)
import { count, increment, decrement, reset } from './counter.mjs';

console.log(count); // 0

increment();
console.log(count); // 1 â† è‡ªåŠ¨æ›´æ–°ï¼

increment();
increment();
console.log(count); // 3 â† ç»§ç»­åŒæ­¥ï¼

decrement();
console.log(count); // 2 â† å®æ—¶åæ˜ å˜åŒ–

reset();
console.log(count); // 0 â† é‡ç½®åä¹ŸåŒæ­¥
</code></pre>
<h3 id="live-bindingçš„å·¥ä½œåŸç†"><a class="header" href="#live-bindingçš„å·¥ä½œåŸç†">Live Bindingçš„å·¥ä½œåŸç†</a></h3>
<pre><code class="language-javascript">// æ¼”ç¤ºLive Bindingçš„å†…éƒ¨æœºåˆ¶

// module-a.mjs
export let sharedValue = 'initial';
export let counter = 0;

export function updateValue(newValue) {
    sharedValue = newValue;
    counter++;
    console.log(`æ¨¡å—A: å€¼æ›´æ–°ä¸º ${sharedValue}, è®¡æ•°å™¨: ${counter}`);
}

export function getTimestamp() {
    return Date.now();
}
</code></pre>
<pre><code class="language-javascript">// module-b.mjs  
import { sharedValue, counter, updateValue } from './module-a.mjs';

export function showValues() {
    console.log(`æ¨¡å—Bçœ‹åˆ°: ${sharedValue}, è®¡æ•°å™¨: ${counter}`);
}

export function triggerUpdate() {
    updateValue('ä»æ¨¡å—Bæ›´æ–°');
}
</code></pre>
<pre><code class="language-javascript">// main.mjs
import { sharedValue, counter, updateValue } from './module-a.mjs';
import { showValues, triggerUpdate } from './module-b.mjs';

console.log('=== Live Binding æ¼”ç¤º ===');

console.log(`ä¸»æ¨¡å—åˆå§‹å€¼: ${sharedValue}, è®¡æ•°å™¨: ${counter}`);

// ä»ä¸»æ¨¡å—æ›´æ–°
updateValue('ä»ä¸»æ¨¡å—æ›´æ–°');
console.log(`ä¸»æ¨¡å—æ›´æ–°å: ${sharedValue}, è®¡æ•°å™¨: ${counter}`);

// ä»æ¨¡å—Bæ›´æ–°
triggerUpdate();
console.log(`Bæ¨¡å—æ›´æ–°å: ${sharedValue}, è®¡æ•°å™¨: ${counter}`);

// æ˜¾ç¤ºæ‰€æœ‰æ¨¡å—éƒ½çœ‹åˆ°ç›¸åŒçš„å€¼
showValues();

// æ‰§è¡Œç»“æœï¼š
// ä¸»æ¨¡å—åˆå§‹å€¼: initial, è®¡æ•°å™¨: 0
// æ¨¡å—A: å€¼æ›´æ–°ä¸º ä»ä¸»æ¨¡å—æ›´æ–°, è®¡æ•°å™¨: 1
// ä¸»æ¨¡å—æ›´æ–°å: ä»ä¸»æ¨¡å—æ›´æ–°, è®¡æ•°å™¨: 1
// æ¨¡å—A: å€¼æ›´æ–°ä¸º ä»æ¨¡å—Bæ›´æ–°, è®¡æ•°å™¨: 2
// Bæ¨¡å—æ›´æ–°å: ä»æ¨¡å—Bæ›´æ–°, è®¡æ•°å™¨: 2
// æ¨¡å—Bçœ‹åˆ°: ä»æ¨¡å—Bæ›´æ–°, è®¡æ•°å™¨: 2
</code></pre>
<h3 id="live-bindingçš„é‡è¦ç‰¹å¾"><a class="header" href="#live-bindingçš„é‡è¦ç‰¹å¾">Live Bindingçš„é‡è¦ç‰¹å¾</a></h3>
<h4 id="1-åªè¯»æ€§"><a class="header" href="#1-åªè¯»æ€§">1. åªè¯»æ€§</a></h4>
<pre><code class="language-javascript">// readonly-demo.mjs
export let value = 'original';

export function setValue(newValue) {
    value = newValue;
}
</code></pre>
<pre><code class="language-javascript">// main.mjs
import { value, setValue } from './readonly-demo.mjs';

console.log(value); // 'original'

// ä»¥ä¸‹æ“ä½œä¼šæŠ¥é”™ï¼
// value = 'modified'; // TypeError: Assignment to constant variable.

// åªèƒ½é€šè¿‡å¯¼å‡ºæ¨¡å—çš„å‡½æ•°æ¥ä¿®æ”¹
setValue('modified');
console.log(value); // 'modified' â† Live Bindingç”Ÿæ•ˆ
</code></pre>
<h4 id="2-æ—¶é—´æ•æ„Ÿæ€§"><a class="header" href="#2-æ—¶é—´æ•æ„Ÿæ€§">2. æ—¶é—´æ•æ„Ÿæ€§</a></h4>
<pre><code class="language-javascript">// timing-demo.mjs
export let asyncValue = 'loading...';

// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
setTimeout(() =&gt; {
    asyncValue = 'loaded!';
    console.log('å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå€¼å·²æ›´æ–°');
}, 1000);

export function getCurrentValue() {
    return asyncValue;
}
</code></pre>
<pre><code class="language-javascript">// main.mjs
import { asyncValue, getCurrentValue } from './timing-demo.mjs';

console.log('ç«‹å³è¯»å–:', asyncValue); // 'loading...'

setTimeout(() =&gt; {
    console.log('1ç§’åè¯»å–:', asyncValue); // 'loaded!' â† Live Bindingè‡ªåŠ¨æ›´æ–°
}, 1500);

// ä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°è·å–
setTimeout(() =&gt; {
    console.log('é€šè¿‡å‡½æ•°:', getCurrentValue()); // 'loaded!'
}, 1500);
</code></pre>
<h4 id="3-å¾ªç¯ä¾èµ–ä¸­çš„live-binding"><a class="header" href="#3-å¾ªç¯ä¾èµ–ä¸­çš„live-binding">3. å¾ªç¯ä¾èµ–ä¸­çš„Live Binding</a></h4>
<pre><code class="language-javascript">// circular-a.mjs
import { bValue, setBValue } from './circular-b.mjs';

export let aValue = 'from-a';

export function setAValue(newValue) {
    aValue = newValue;
}

export function showBValue() {
    console.log('Aæ¨¡å—çœ‹åˆ°Bçš„å€¼:', bValue);
}

// åˆå§‹åŒ–æ—¶è°ƒç”¨Bæ¨¡å—çš„å‡½æ•°
setBValue('a-modified-b');
</code></pre>
<pre><code class="language-javascript">// circular-b.mjs  
import { aValue, setAValue } from './circular-a.mjs';

export let bValue = 'from-b';

export function setBValue(newValue) {
    bValue = newValue;
}

export function showAValue() {
    console.log('Bæ¨¡å—çœ‹åˆ°Açš„å€¼:', aValue);
}

// åˆå§‹åŒ–æ—¶è°ƒç”¨Aæ¨¡å—çš„å‡½æ•°
setAValue('b-modified-a');
</code></pre>
<pre><code class="language-javascript">// main.mjs
import { aValue, showBValue } from './circular-a.mjs';
import { bValue, showAValue } from './circular-b.mjs';

console.log('ä¸»æ¨¡å—çœ‹åˆ°:');
console.log('Aå€¼:', aValue); // 'b-modified-a'
console.log('Bå€¼:', bValue); // 'a-modified-b'

showAValue(); // Bæ¨¡å—çœ‹åˆ°Açš„å€¼: b-modified-a
showBValue(); // Aæ¨¡å—çœ‹åˆ°Bçš„å€¼: a-modified-b
</code></pre>
<h3 id="live-bindingçš„ä¼˜åŠ¿"><a class="header" href="#live-bindingçš„ä¼˜åŠ¿">Live Bindingçš„ä¼˜åŠ¿</a></h3>
<h4 id="1-çŠ¶æ€åŒæ­¥"><a class="header" href="#1-çŠ¶æ€åŒæ­¥">1. çŠ¶æ€åŒæ­¥</a></h4>
<pre><code class="language-javascript">// state-manager.mjs
export let appState = {
    user: null,
    theme: 'light',
    language: 'en'
};

export function login(user) {
    appState.user = user;
    console.log('ç”¨æˆ·å·²ç™»å½•:', user.name);
}

export function setTheme(theme) {
    appState.theme = theme;
    console.log('ä¸»é¢˜å·²åˆ‡æ¢:', theme);
}

export function setLanguage(language) {
    appState.language = language;
    console.log('è¯­è¨€å·²åˆ‡æ¢:', language);
}
</code></pre>
<pre><code class="language-javascript">// ui-components.mjs
import { appState } from './state-manager.mjs';

export function renderHeader() {
    const { user, theme } = appState;
    console.log(`æ¸²æŸ“å¤´éƒ¨: ç”¨æˆ·=${user?.name || 'æœªç™»å½•'}, ä¸»é¢˜=${theme}`);
}

export function renderSidebar() {
    const { language, theme } = appState;
    console.log(`æ¸²æŸ“ä¾§è¾¹æ : è¯­è¨€=${language}, ä¸»é¢˜=${theme}`);
}
</code></pre>
<pre><code class="language-javascript">// main.mjs
import { login, setTheme, setLanguage } from './state-manager.mjs';
import { renderHeader, renderSidebar } from './ui-components.mjs';

// åˆå§‹æ¸²æŸ“
renderHeader(); // æ¸²æŸ“å¤´éƒ¨: ç”¨æˆ·=æœªç™»å½•, ä¸»é¢˜=light
renderSidebar(); // æ¸²æŸ“ä¾§è¾¹æ : è¯­è¨€=en, ä¸»é¢˜=light

// çŠ¶æ€å˜åŒ–
login({ name: 'Alice', id: 1 });
renderHeader(); // æ¸²æŸ“å¤´éƒ¨: ç”¨æˆ·=Alice, ä¸»é¢˜=light â† è‡ªåŠ¨æ›´æ–°

setTheme('dark');
renderHeader(); // æ¸²æŸ“å¤´éƒ¨: ç”¨æˆ·=Alice, ä¸»é¢˜=dark â† ç»§ç»­åŒæ­¥
renderSidebar(); // æ¸²æŸ“ä¾§è¾¹æ : è¯­è¨€=en, ä¸»é¢˜=dark â† åŒæ—¶æ›´æ–°
</code></pre>
<h4 id="2-çƒ­é‡è½½æ”¯æŒ"><a class="header" href="#2-çƒ­é‡è½½æ”¯æŒ">2. çƒ­é‡è½½æ”¯æŒ</a></h4>
<pre><code class="language-javascript">// hot-reload-demo.mjs
export let moduleVersion = '1.0.0';
export let featureFlags = {
    newUI: false,
    experimentalAPI: true
};

// æ¨¡æ‹Ÿçƒ­é‡è½½æ›´æ–°
if (import.meta.hot) {
    import.meta.hot.accept(() =&gt; {
        moduleVersion = '1.0.1';
        featureFlags.newUI = true;
        console.log('æ¨¡å—å·²çƒ­é‡è½½æ›´æ–°');
    });
}
</code></pre>
<h3 id="live-bindingçš„æ³¨æ„äº‹é¡¹"><a class="header" href="#live-bindingçš„æ³¨æ„äº‹é¡¹">Live Bindingçš„æ³¨æ„äº‹é¡¹</a></h3>
<h4 id="1-æ€§èƒ½è€ƒè™‘"><a class="header" href="#1-æ€§èƒ½è€ƒè™‘">1. æ€§èƒ½è€ƒè™‘</a></h4>
<pre><code class="language-javascript">// é¿å…åœ¨çƒ­ç‚¹è·¯å¾„ä¸­é¢‘ç¹è®¿é—®Live Binding
import { heavyComputedValue } from './expensive-module.mjs';

// âŒ ä¸å¥½çš„åšæ³•
for (let i = 0; i &lt; 1000000; i++) {
    if (heavyComputedValue &gt; threshold) {
        // æ¯æ¬¡å¾ªç¯éƒ½è®¿é—®Live Binding
    }
}

// âœ… æ›´å¥½çš„åšæ³•
const cachedValue = heavyComputedValue;
for (let i = 0; i &lt; 1000000; i++) {
    if (cachedValue &gt; threshold) {
        // ä½¿ç”¨ç¼“å­˜çš„å€¼
    }
}
</code></pre>
<h4 id="2-è°ƒè¯•æŠ€å·§"><a class="header" href="#2-è°ƒè¯•æŠ€å·§">2. è°ƒè¯•æŠ€å·§</a></h4>
<pre><code class="language-javascript">// debug-utils.mjs
export let debugMode = false;
export let logLevel = 'info';

export function enableDebug() {
    debugMode = true;
    logLevel = 'debug';
}

export function log(message, level = 'info') {
    if (debugMode &amp;&amp; shouldLog(level)) {
        console.log(`[${level.toUpperCase()}] ${message}`);
    }
}

function shouldLog(level) {
    const levels = { debug: 0, info: 1, warn: 2, error: 3 };
    return levels[level] &gt;= levels[logLevel];
}
</code></pre>
<h2 id="æ€»ç»“-2"><a class="header" href="#æ€»ç»“-2">æ€»ç»“</a></h2>
<p>ESæ¨¡å—æ˜¯ç°ä»£JavaScriptå¼€å‘çš„åŸºç¡€è®¾æ–½ï¼Œæä¾›äº†ï¼š</p>
<ul>
<li>âœ… <strong>æ ‡å‡†åŒ–è¯­æ³•</strong>: å®˜æ–¹æ ‡å‡†ï¼Œå¹¿æ³›æ”¯æŒ</li>
<li>âœ… <strong>é™æ€ç»“æ„</strong>: ç¼–è¯‘æ—¶ä¼˜åŒ–ï¼Œæ”¯æŒæ ‘æ‘‡</li>
<li>âœ… <strong>ä¸¥æ ¼æ¨¡å¼</strong>: æ›´å®‰å…¨çš„ä»£ç æ‰§è¡Œç¯å¢ƒ</li>
<li>âœ… <strong>ä½œç”¨åŸŸéš”ç¦»</strong>: é¿å…å…¨å±€å˜é‡æ±¡æŸ“</li>
<li>âœ… <strong>å¼‚æ­¥åŠ è½½</strong>: æ›´å¥½çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ</li>
<li>âœ… <strong>å·¥å…·å‹å¥½</strong>: ä¸°å¯Œçš„å¼€å‘å·¥å…·ç”Ÿæ€</li>
</ul>
<p>æŒæ¡ESæ¨¡å—çš„åŸºç¡€è¯­æ³•å’Œç‰¹æ€§æ˜¯ç°ä»£JavaScriptå¼€å‘çš„å¿…å¤‡æŠ€èƒ½ã€‚åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å¯¼å…¥å¯¼å‡ºçš„é«˜çº§ç”¨æ³•ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#å¯¼å…¥ä¸å¯¼å‡º">å¯¼å…¥ä¸å¯¼å‡º</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="å¯¼å…¥ä¸å¯¼å‡º"><a class="header" href="#å¯¼å…¥ä¸å¯¼å‡º">å¯¼å…¥ä¸å¯¼å‡º</a></h1>
<p>ESæ¨¡å—çš„å¯¼å…¥å’Œå¯¼å‡ºæ˜¯æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨å„ç§å¯¼å…¥å¯¼å‡ºæ¨¡å¼ã€é«˜çº§ç”¨æ³•ä»¥åŠæœ€ä½³å®è·µã€‚</p>
<h2 id="å¯¼å‡ºçš„è¯¦ç»†è¯­æ³•"><a class="header" href="#å¯¼å‡ºçš„è¯¦ç»†è¯­æ³•">å¯¼å‡ºçš„è¯¦ç»†è¯­æ³•</a></h2>
<h3 id="1-å£°æ˜æ—¶å¯¼å‡º"><a class="header" href="#1-å£°æ˜æ—¶å¯¼å‡º">1. å£°æ˜æ—¶å¯¼å‡º</a></h3>
<pre><code class="language-javascript">// declarations.js

// å¯¼å‡ºå˜é‡å£°æ˜
export const API_VERSION = 'v1';
export let currentUser = null;
export var debugMode = false;

// å¯¼å‡ºå‡½æ•°å£°æ˜
export function getUserById(id) {
    return fetch(`/api/users/${id}`);
}

// å¯¼å‡ºå¼‚æ­¥å‡½æ•°
export async function fetchUserData(id) {
    const response = await getUserById(id);
    return response.json();
}

// å¯¼å‡ºç”Ÿæˆå™¨å‡½æ•°
export function* numberGenerator() {
    let i = 0;
    while (true) {
        yield i++;
    }
}

// å¯¼å‡ºç±»å£°æ˜
export class UserManager {
    constructor() {
        this.users = new Map();
    }
    
    addUser(user) {
        this.users.set(user.id, user);
    }
    
    getUser(id) {
        return this.users.get(id);
    }
}
</code></pre>
<h3 id="2-å…ˆå£°æ˜åå¯¼å‡º"><a class="header" href="#2-å…ˆå£°æ˜åå¯¼å‡º">2. å…ˆå£°æ˜åå¯¼å‡º</a></h3>
<pre><code class="language-javascript">// deferred-exports.js

// å…ˆå£°æ˜
const CONFIG = {
    apiUrl: 'https://api.example.com',
    timeout: 5000,
    retryAttempts: 3
};

function validateConfig(config) {
    return config.apiUrl &amp;&amp; config.timeout &gt; 0;
}

class Logger {
    constructor(level = 'info') {
        this.level = level;
    }
    
    log(message) {
        console.log(`[${this.level.toUpperCase()}] ${message}`);
    }
}

// åå¯¼å‡º
export { CONFIG, validateConfig, Logger };

// å¯¼å‡ºæ—¶é‡å‘½å
export { CONFIG as defaultConfig };
export { Logger as EventLogger };
</code></pre>
<h3 id="3-é»˜è®¤å¯¼å‡ºçš„å¤šç§å½¢å¼"><a class="header" href="#3-é»˜è®¤å¯¼å‡ºçš„å¤šç§å½¢å¼">3. é»˜è®¤å¯¼å‡ºçš„å¤šç§å½¢å¼</a></h3>
<pre><code class="language-javascript">// default-exports.js

// æ–¹å¼1ï¼šå¯¼å‡ºç±»
export default class Calculator {
    add(a, b) { return a + b; }
    subtract(a, b) { return a - b; }
}

// æ–¹å¼2ï¼šå¯¼å‡ºå‡½æ•°
// export default function calculate(operation, a, b) {
//     switch (operation) {
//         case 'add': return a + b;
//         case 'subtract': return a - b;
//         default: throw new Error('Unknown operation');
//     }
// }

// æ–¹å¼3ï¼šå¯¼å‡ºç®­å¤´å‡½æ•°
// export default (x, y) =&gt; x + y;

// æ–¹å¼4ï¼šå¯¼å‡ºå¯¹è±¡
// export default {
//     version: '1.0.0',
//     author: 'John Doe',
//     calculate: (a, b) =&gt; a + b
// };

// æ–¹å¼5ï¼šå¯¼å‡ºè¡¨è¾¾å¼
// const multiplier = 2;
// export default multiplier * 10;

// æ–¹å¼6ï¼šå…ˆå£°æ˜åå¯¼å‡º
// class AdvancedCalculator {
//     // ... implementation
// }
// export default AdvancedCalculator;
</code></pre>
<h3 id="4-èšåˆå¯¼å‡ºre-exports"><a class="header" href="#4-èšåˆå¯¼å‡ºre-exports">4. èšåˆå¯¼å‡ºï¼ˆRe-exportsï¼‰</a></h3>
<pre><code class="language-javascript">// utils/index.js - æ¨¡å—èšåˆæ–‡ä»¶

// é‡æ–°å¯¼å‡ºæ‰€æœ‰å‘½åå¯¼å‡º
export * from './string-utils.js';
export * from './number-utils.js';
export * from './date-utils.js';

// é‡æ–°å¯¼å‡ºç‰¹å®šçš„å‘½åå¯¼å‡º
export { debounce, throttle } from './function-utils.js';
export { formatCurrency } from './number-utils.js';

// é‡æ–°å¯¼å‡ºå¹¶é‡å‘½å
export { 
    parseDate as parseDateString,
    formatDate as formatDateString 
} from './date-utils.js';

// é‡æ–°å¯¼å‡ºé»˜è®¤å¯¼å‡º
export { default as StringValidator } from './string-validator.js';
export { default as NumberValidator } from './number-validator.js';

// æ··åˆå¯¼å‡ºï¼šæœ¬åœ°å®šä¹‰ + é‡æ–°å¯¼å‡º
export const UTILS_VERSION = '2.1.0';

export function createUtilsBundle() {
    return {
        strings: './string-utils.js',
        numbers: './number-utils.js',
        dates: './date-utils.js'
    };
}
</code></pre>
<h2 id="å¯¼å…¥çš„è¯¦ç»†è¯­æ³•"><a class="header" href="#å¯¼å…¥çš„è¯¦ç»†è¯­æ³•">å¯¼å…¥çš„è¯¦ç»†è¯­æ³•</a></h2>
<h3 id="1-å‘½åå¯¼å…¥çš„å„ç§å½¢å¼"><a class="header" href="#1-å‘½åå¯¼å…¥çš„å„ç§å½¢å¼">1. å‘½åå¯¼å…¥çš„å„ç§å½¢å¼</a></h3>
<pre><code class="language-javascript">// named-imports.js

// åŸºæœ¬å‘½åå¯¼å…¥
import { API_VERSION, currentUser } from './declarations.js';

// å¯¼å…¥æ—¶é‡å‘½å
import { 
    getUserById as fetchUser,
    UserManager as UserService 
} from './declarations.js';

// æ‰¹é‡å¯¼å…¥å¤šä¸ªå‘½åå¯¼å‡º
import { 
    API_VERSION,
    currentUser,
    getUserById,
    UserManager 
} from './declarations.js';

// å¯¼å…¥æ‰€æœ‰å‘½åå¯¼å‡ºåˆ°å‘½åç©ºé—´å¯¹è±¡
import * as UserAPI from './declarations.js';
console.log(UserAPI.API_VERSION);
const manager = new UserAPI.UserManager();

// æ··åˆå¯¼å…¥ï¼šé»˜è®¤å¯¼å‡º + å‘½åå¯¼å‡º
import Calculator, { 
    API_VERSION, 
    getUserById 
} from './mixed-exports.js';
</code></pre>
<h3 id="2-é»˜è®¤å¯¼å…¥"><a class="header" href="#2-é»˜è®¤å¯¼å…¥">2. é»˜è®¤å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// default-imports.js

// å¯¼å…¥é»˜è®¤å¯¼å‡ºï¼ˆå¯ä»¥ä½¿ç”¨ä»»æ„åç§°ï¼‰
import Calculator from './default-exports.js';
import MyCalculator from './default-exports.js'; // åŒæ ·æœ‰æ•ˆ
import Calc from './default-exports.js'; // ä¹Ÿå¯ä»¥

// ä½¿ç”¨å¯¼å…¥çš„é»˜è®¤å¯¼å‡º
const calc = new Calculator();
console.log(calc.add(2, 3));

// å¦‚æœé»˜è®¤å¯¼å‡ºæ˜¯å‡½æ•°
import calculate from './function-export.js';
const result = calculate('add', 5, 3);

// å¦‚æœé»˜è®¤å¯¼å‡ºæ˜¯å¯¹è±¡
import config from './config-export.js';
console.log(config.version);
</code></pre>
<h3 id="3-å‰¯ä½œç”¨å¯¼å…¥"><a class="header" href="#3-å‰¯ä½œç”¨å¯¼å…¥">3. å‰¯ä½œç”¨å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// side-effect-imports.js

// ä»…æ‰§è¡Œæ¨¡å—ï¼Œä¸å¯¼å…¥ä»»ä½•ç»‘å®š
import './polyfills.js';          // æ‰§è¡Œpolyfillä»£ç 
import './global-styles.css';     // åŠ è½½CSSï¼ˆé€šè¿‡æ„å»ºå·¥å…·å¤„ç†ï¼‰
import './init-app.js';           // æ‰§è¡Œåˆå§‹åŒ–ä»£ç 

// è¿™äº›å¯¼å…¥ä¼šæ‰§è¡Œç›®æ ‡æ¨¡å—çš„ä»£ç ï¼Œä½†ä¸åˆ›å»ºä»»ä½•ç»‘å®š
console.log('All side effects have been applied');
</code></pre>
<h3 id="4-æ¡ä»¶å¯¼å…¥"><a class="header" href="#4-æ¡ä»¶å¯¼å…¥">4. æ¡ä»¶å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// conditional-imports.js

// åœ¨æ¡ä»¶å—ä¸­çš„é™æ€å¯¼å…¥ï¼ˆä¼šè¢«æå‡ï¼‰
if (process.env.NODE_ENV === 'development') {
    // è¿™ä¸ªå¯¼å…¥ä¼šè¢«æå‡åˆ°æ¨¡å—é¡¶éƒ¨æ‰§è¡Œ
    import './dev-tools.js';
}

// æ­£ç¡®çš„æ¡ä»¶å¯¼å…¥æ–¹å¼ï¼šä½¿ç”¨åŠ¨æ€å¯¼å…¥
async function loadDevTools() {
    if (process.env.NODE_ENV === 'development') {
        const devTools = await import('./dev-tools.js');
        devTools.setup();
    }
}

// æˆ–è€…ä½¿ç”¨é¡¶å±‚awaitï¼ˆç°ä»£ç¯å¢ƒï¼‰
if (process.env.NODE_ENV === 'development') {
    const { setup } = await import('./dev-tools.js');
    setup();
}
</code></pre>
<h2 id="æ¨¡å—å¯¼å…¥è§£æè§„åˆ™"><a class="header" href="#æ¨¡å—å¯¼å…¥è§£æè§„åˆ™">æ¨¡å—å¯¼å…¥è§£æè§„åˆ™</a></h2>
<h3 id="1-ç›¸å¯¹è·¯å¾„å¯¼å…¥"><a class="header" href="#1-ç›¸å¯¹è·¯å¾„å¯¼å…¥">1. ç›¸å¯¹è·¯å¾„å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// ç›¸å¯¹è·¯å¾„å¯¼å…¥ç¤ºä¾‹
// æ–‡ä»¶ç»“æ„ï¼š
// src/
//   â”œâ”€â”€ components/
//   â”‚   â”œâ”€â”€ Button.js
//   â”‚   â””â”€â”€ Input.js
//   â”œâ”€â”€ utils/
//   â”‚   â””â”€â”€ helpers.js
//   â””â”€â”€ app.js

// åœ¨ src/app.js ä¸­
import { Button } from './components/Button.js';    // ç›¸å¯¹è·¯å¾„
import { helpers } from './utils/helpers.js';       // ç›¸å¯¹è·¯å¾„

// åœ¨ src/components/Button.js ä¸­
import { helpers } from '../utils/helpers.js';      // ä¸Šçº§ç›®å½•
import { Input } from './Input.js';                 // åŒçº§æ–‡ä»¶
</code></pre>
<h3 id="2-ç»å¯¹è·¯å¾„å’ŒåŒ…å¯¼å…¥"><a class="header" href="#2-ç»å¯¹è·¯å¾„å’ŒåŒ…å¯¼å…¥">2. ç»å¯¹è·¯å¾„å’ŒåŒ…å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// absolute-imports.js

// Node.js å†…ç½®æ¨¡å—
import { readFile } from 'fs/promises';
import { join } from 'path';

// npm åŒ…å¯¼å…¥
import lodash from 'lodash';
import { debounce } from 'lodash';
import React from 'react';
import { useState } from 'react';

// ä½œç”¨åŸŸåŒ…
import { parse } from '@babel/parser';
import { transform } from '@babel/core';

// å­è·¯å¾„å¯¼å…¥
import { format } from 'date-fns/format';
import { isValid } from 'date-fns/isValid';
</code></pre>
<h3 id="3-å¸¦æ‰©å±•åå’Œä¸å¸¦æ‰©å±•å"><a class="header" href="#3-å¸¦æ‰©å±•åå’Œä¸å¸¦æ‰©å±•å">3. å¸¦æ‰©å±•åå’Œä¸å¸¦æ‰©å±•å</a></h3>
<pre><code class="language-javascript">// extensions.js

// æ˜ç¡®æŒ‡å®šæ‰©å±•åï¼ˆæ¨èï¼‰
import { utils } from './utils.js';
import config from './config.json';    // JSONæ–‡ä»¶
import styles from './styles.css';     // CSSæ–‡ä»¶ï¼ˆéœ€æ„å»ºå·¥å…·æ”¯æŒï¼‰

// ä¸æŒ‡å®šæ‰©å±•åï¼ˆä¾èµ–è§£æå™¨é…ç½®ï¼‰
// import { utils } from './utils';     // å¯èƒ½è§£æä¸ºutils.jsæˆ–utils/index.js
// import config from './config';       // å¯èƒ½è§£æä¸ºconfig.jsæˆ–config.json
</code></pre>
<h2 id="å¯¼å…¥å¯¼å‡ºçš„é«˜çº§æ¨¡å¼"><a class="header" href="#å¯¼å…¥å¯¼å‡ºçš„é«˜çº§æ¨¡å¼">å¯¼å…¥å¯¼å‡ºçš„é«˜çº§æ¨¡å¼</a></h2>
<h3 id="1-æ¡ä»¶å¯¼å‡ºpackagejson"><a class="header" href="#1-æ¡ä»¶å¯¼å‡ºpackagejson">1. æ¡ä»¶å¯¼å‡ºï¼ˆpackage.jsonï¼‰</a></h3>
<pre><code class="language-json">{
  "name": "my-package",
  "exports": {
    ".": {
      "import": "./dist/esm/index.js",
      "require": "./dist/cjs/index.js",
      "types": "./dist/types/index.d.ts"
    },
    "./utils": {
      "import": "./dist/esm/utils.js",
      "require": "./dist/cjs/utils.js"
    },
    "./package.json": "./package.json"
  }
}
</code></pre>
<h3 id="2-æ¡¶æ–‡ä»¶æ¨¡å¼barrel-exports"><a class="header" href="#2-æ¡¶æ–‡ä»¶æ¨¡å¼barrel-exports">2. æ¡¶æ–‡ä»¶æ¨¡å¼ï¼ˆBarrel Exportsï¼‰</a></h3>
<pre><code class="language-javascript">// components/index.js - æ¡¶æ–‡ä»¶
export { default as Button } from './Button.js';
export { default as Input } from './Input.js';
export { default as Modal } from './Modal.js';
export { default as Form } from './Form.js';

// ä¹Ÿå¯ä»¥é‡æ–°å¯¼å‡ºç±»å‹ï¼ˆTypeScriptï¼‰
export type { ButtonProps } from './Button.js';
export type { InputProps } from './Input.js';

// ä½¿ç”¨æ¡¶æ–‡ä»¶
// åœ¨å…¶ä»–æ–‡ä»¶ä¸­å¯ä»¥ä»å•ä¸€å…¥å£å¯¼å…¥å¤šä¸ªç»„ä»¶
import { Button, Input, Modal } from './components';
</code></pre>
<h3 id="3-å‘½åç©ºé—´æ¨¡å¼"><a class="header" href="#3-å‘½åç©ºé—´æ¨¡å¼">3. å‘½åç©ºé—´æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// math/index.js - å‘½åç©ºé—´æ¨¡å¼
import * as BasicMath from './basic.js';
import * as AdvancedMath from './advanced.js';
import * as Statistics from './statistics.js';

export const Math = {
    Basic: BasicMath,
    Advanced: AdvancedMath,
    Statistics
};

// ä¹Ÿå¯¼å‡ºå…·ä½“å‡½æ•°ä»¥ä¾¿ç›´æ¥ä½¿ç”¨
export { add, subtract, multiply, divide } from './basic.js';
export { sin, cos, tan, log } from './advanced.js';
export { mean, median, mode } from './statistics.js';

// ä½¿ç”¨æ–¹å¼
// import { Math } from './math';
// Math.Basic.add(1, 2);
// 
// æˆ–è€…
// import { add, sin, mean } from './math';
// add(1, 2);
</code></pre>
<h3 id="4-æ’ä»¶ç³»ç»Ÿæ¨¡å¼"><a class="header" href="#4-æ’ä»¶ç³»ç»Ÿæ¨¡å¼">4. æ’ä»¶ç³»ç»Ÿæ¨¡å¼</a></h3>
<pre><code class="language-javascript">// plugin-system.js

// æ’ä»¶æ³¨å†Œè¡¨
const plugins = new Map();

export function registerPlugin(name, plugin) {
    plugins.set(name, plugin);
}

export function getPlugin(name) {
    return plugins.get(name);
}

export function loadPlugin(name) {
    return import(`./plugins/${name}.js`).then(module =&gt; {
        registerPlugin(name, module.default);
        return module.default;
    });
}

// æ’ä»¶æ¥å£
export class PluginBase {
    constructor(options = {}) {
        this.options = options;
    }
    
    init() {
        throw new Error('Plugin must implement init method');
    }
    
    destroy() {
        // é»˜è®¤æ¸…ç†é€»è¾‘
    }
}

// ä½¿ç”¨ç¤ºä¾‹
// const authPlugin = await loadPlugin('auth');
// authPlugin.init({ apiKey: 'xxx' });
</code></pre>
<h2 id="å¯¼å…¥å¯¼å‡ºçš„æœ€ä½³å®è·µ"><a class="header" href="#å¯¼å…¥å¯¼å‡ºçš„æœ€ä½³å®è·µ">å¯¼å…¥å¯¼å‡ºçš„æœ€ä½³å®è·µ</a></h2>
<h3 id="1-å¯¼å‡ºä¼˜å…ˆçº§"><a class="header" href="#1-å¯¼å‡ºä¼˜å…ˆçº§">1. å¯¼å‡ºä¼˜å…ˆçº§</a></h3>
<pre><code class="language-javascript">// good-exports.js

// 1. ä¼˜å…ˆä½¿ç”¨å‘½åå¯¼å‡º
export function createUser(data) { /* ... */ }
export function updateUser(id, data) { /* ... */ }
export function deleteUser(id) { /* ... */ }

// 2. ä¸»è¦åŠŸèƒ½ä½¿ç”¨é»˜è®¤å¯¼å‡º
export default class UserService {
    constructor() {
        this.cache = new Map();
    }
    
    async getUser(id) {
        if (this.cache.has(id)) {
            return this.cache.get(id);
        }
        // ... fetch logic
    }
}

// 3. å¸¸é‡å’Œé…ç½®ä½¿ç”¨å‘½åå¯¼å‡º
export const DEFAULT_TIMEOUT = 5000;
export const USER_ROLES = ['admin', 'user', 'guest'];
</code></pre>
<h3 id="2-å¯¼å…¥ç»„ç»‡"><a class="header" href="#2-å¯¼å…¥ç»„ç»‡">2. å¯¼å…¥ç»„ç»‡</a></h3>
<pre><code class="language-javascript">// organized-imports.js

// 1. Node.js å†…ç½®æ¨¡å—
import { readFile } from 'fs/promises';
import { join, dirname } from 'path';

// 2. ç¬¬ä¸‰æ–¹ä¾èµ–
import React, { useState, useEffect } from 'react';
import { format } from 'date-fns';
import axios from 'axios';

// 3. å†…éƒ¨æ¨¡å—ï¼ˆæŒ‰å±‚çº§åˆ†ç»„ï¼‰
import { config } from '../config/app.js';
import { UserService } from '../services/user.js';
import { validateInput } from '../utils/validation.js';

// 4. ç›¸å¯¹å¯¼å…¥
import { Button } from './Button.js';
import { Modal } from './Modal.js';
import styles from './UserForm.module.css';
</code></pre>
<h3 id="3-é¿å…å¾ªç¯ä¾èµ–"><a class="header" href="#3-é¿å…å¾ªç¯ä¾èµ–">3. é¿å…å¾ªç¯ä¾èµ–</a></h3>
<pre><code class="language-javascript">// åæ¨¡å¼ï¼šå¾ªç¯ä¾èµ–
// user.js
import { Order } from './order.js';
export class User {
    getOrders() {
        return Order.findByUserId(this.id);
    }
}

// order.js
import { User } from './user.js';  // å¾ªç¯ä¾èµ–ï¼
export class Order {
    getUser() {
        return User.findById(this.userId);
    }
}

// è§£å†³æ–¹æ¡ˆ1ï¼šä¾èµ–æ³¨å…¥
// user.js
export class User {
    getOrders(orderService) {
        return orderService.findByUserId(this.id);
    }
}

// order.js
export class Order {
    getUser(userService) {
        return userService.findById(this.userId);
    }
}

// è§£å†³æ–¹æ¡ˆ2ï¼šæå–åˆ°æœåŠ¡å±‚
// user-order-service.js
import { User } from './user.js';
import { Order } from './order.js';

export class UserOrderService {
    getUserOrders(userId) {
        return Order.findByUserId(userId);
    }
    
    getOrderUser(orderId) {
        const order = Order.findById(orderId);
        return User.findById(order.userId);
    }
}
</code></pre>
<h3 id="4-æ¨¡å—é‡æ–°å¯¼å‡ºç­–ç•¥"><a class="header" href="#4-æ¨¡å—é‡æ–°å¯¼å‡ºç­–ç•¥">4. æ¨¡å—é‡æ–°å¯¼å‡ºç­–ç•¥</a></h3>
<pre><code class="language-javascript">// api/index.js - API æ¨¡å—èšåˆ

// æŒ‰åŠŸèƒ½æ¨¡å—é‡æ–°å¯¼å‡º
export * as Users from './users.js';
export * as Orders from './orders.js';
export * as Products from './products.js';

// å¯¼å‡ºå¸¸ç”¨çš„APIå‡½æ•°
export { 
    createUser, 
    getUserById 
} from './users.js';

export { 
    createOrder, 
    getOrdersByUser 
} from './orders.js';

// å¯¼å‡ºé…ç½®å’Œå¸¸é‡
export { API_BASE_URL, DEFAULT_HEADERS } from './config.js';

// å¯¼å‡ºé»˜è®¤å®¢æˆ·ç«¯
export { default as ApiClient } from './client.js';

// ä½¿ç”¨ç¤ºä¾‹
// æ–¹å¼1ï¼šä½¿ç”¨å‘½åç©ºé—´
// import { Users, Orders } from './api';
// const user = await Users.getUserById(1);
// const orders = await Orders.getOrdersByUser(1);

// æ–¹å¼2ï¼šç›´æ¥å¯¼å…¥å¸¸ç”¨å‡½æ•°
// import { createUser, getOrdersByUser } from './api';
</code></pre>
<h2 id="å¸¸è§é™·é˜±å’Œæ³¨æ„äº‹é¡¹"><a class="header" href="#å¸¸è§é™·é˜±å’Œæ³¨æ„äº‹é¡¹">å¸¸è§é™·é˜±å’Œæ³¨æ„äº‹é¡¹</a></h2>
<h3 id="1-å¯¼å…¥æå‡"><a class="header" href="#1-å¯¼å…¥æå‡">1. å¯¼å…¥æå‡</a></h3>
<pre><code class="language-javascript">// import-hoisting.js

console.log('This runs first');

// è¿™ä¸ªå¯¼å…¥ä¼šè¢«æå‡åˆ°æ¨¡å—é¡¶éƒ¨æ‰§è¡Œ
import { someFunction } from './utils.js';

console.log('This runs second');

// ç›¸å½“äºï¼š
// import { someFunction } from './utils.js';  // &lt;- å®é™…æ‰§è¡Œä½ç½®
// console.log('This runs first');
// console.log('This runs second');
</code></pre>
<h3 id="2-é»˜è®¤å¯¼å‡ºçš„é™·é˜±"><a class="header" href="#2-é»˜è®¤å¯¼å‡ºçš„é™·é˜±">2. é»˜è®¤å¯¼å‡ºçš„é™·é˜±</a></h3>
<pre><code class="language-javascript">// default-export-pitfalls.js

// é™·é˜±1ï¼šé»˜è®¤å¯¼å‡ºçš„é‡å‘½åå®¹æ˜“å‡ºé”™
// math.js
export default function add(a, b) { return a + b; }

// main.js
import subtract from './math.js';  // é”™è¯¯ï¼šä»¥ä¸ºå¯¼å…¥çš„æ˜¯subtractå‡½æ•°
console.log(subtract(5, 3));       // å®é™…ä¸Šæ˜¯addå‡½æ•°ï¼Œç»“æœæ˜¯8è€Œä¸æ˜¯2

// è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å‘½åå¯¼å‡º
// math.js
export function add(a, b) { return a + b; }
export function subtract(a, b) { return a - b; }

// main.js
import { add, subtract } from './math.js';  // æ˜ç¡®çš„å‡½æ•°å
</code></pre>
<h3 id="3-å¯¼å…¥ç»‘å®šçš„æ´»æ€§"><a class="header" href="#3-å¯¼å…¥ç»‘å®šçš„æ´»æ€§">3. å¯¼å…¥ç»‘å®šçš„æ´»æ€§</a></h3>
<pre><code class="language-javascript">// live-bindings.js

// counter.js
export let count = 0;

export function increment() {
    count++;
}

export function getCount() {
    return count;
}

// main.js
import { count, increment } from './counter.js';

console.log(count);    // 0
increment();
console.log(count);    // 1 (ç»‘å®šæ˜¯æ´»çš„ï¼Œä¼šæ›´æ–°)

// ä½†æ˜¯ä¸èƒ½ç›´æ¥ä¿®æ”¹å¯¼å…¥çš„ç»‘å®š
// count = 10;         // TypeError: Assignment to constant variable
</code></pre>
<h2 id="æ€»ç»“-3"><a class="header" href="#æ€»ç»“-3">æ€»ç»“</a></h2>
<p>ESæ¨¡å—çš„å¯¼å…¥å¯¼å‡ºç³»ç»Ÿæä¾›äº†å¼ºå¤§è€Œçµæ´»çš„ä»£ç ç»„ç»‡æ–¹å¼ï¼š</p>
<ul>
<li>âœ… <strong>å¤šæ ·çš„å¯¼å‡ºæ–¹å¼</strong>: å‘½åå¯¼å‡ºã€é»˜è®¤å¯¼å‡ºã€é‡æ–°å¯¼å‡º</li>
<li>âœ… <strong>çµæ´»çš„å¯¼å…¥è¯­æ³•</strong>: æ”¯æŒé‡å‘½åã€å‘½åç©ºé—´ã€æ¡ä»¶å¯¼å…¥</li>
<li>âœ… <strong>é™æ€ç»“æ„</strong>: ä¾¿äºå·¥å…·åˆ†æå’Œä¼˜åŒ–</li>
<li>âœ… <strong>æ´»ç»‘å®š</strong>: å¯¼å…¥çš„ç»‘å®šèƒ½åæ˜ å¯¼å‡ºæ¨¡å—çš„çŠ¶æ€å˜åŒ–</li>
<li>âœ… <strong>è‰¯å¥½çš„é‡ç”¨æ€§</strong>: æ”¯æŒæ¨¡å—èšåˆå’Œé‡æ–°å¯¼å‡ºæ¨¡å¼</li>
</ul>
<p>æŒæ¡è¿™äº›å¯¼å…¥å¯¼å‡ºçš„æŠ€å·§å’Œæœ€ä½³å®è·µï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ æ„å»ºæ›´æ¸…æ™°ã€æ›´å¯ç»´æŠ¤çš„æ¨¡å—åŒ–ä»£ç ã€‚åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ESæ¨¡å—çš„åŠ¨æ€å¯¼å…¥åŠŸèƒ½ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#åŠ¨æ€å¯¼å…¥">åŠ¨æ€å¯¼å…¥</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="åŠ¨æ€å¯¼å…¥"><a class="header" href="#åŠ¨æ€å¯¼å…¥">åŠ¨æ€å¯¼å…¥</a></h1>
<p>åŠ¨æ€å¯¼å…¥ï¼ˆDynamic Importï¼‰æ˜¯ES2020å¼•å…¥çš„åŠŸèƒ½ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½æ¨¡å—ã€‚ä¸é™æ€å¯¼å…¥ä¸åŒï¼ŒåŠ¨æ€å¯¼å…¥æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œæ”¯æŒæ¡ä»¶åŠ è½½ã€æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²ç­‰é«˜çº§ç”¨æ³•ã€‚</p>
<h2 id="åŸºæœ¬è¯­æ³•-1"><a class="header" href="#åŸºæœ¬è¯­æ³•-1">åŸºæœ¬è¯­æ³•</a></h2>
<h3 id="import-å‡½æ•°"><a class="header" href="#import-å‡½æ•°">import() å‡½æ•°</a></h3>
<pre><code class="language-javascript">// åŸºæœ¬åŠ¨æ€å¯¼å…¥è¯­æ³•
import('./module.js')
    .then(module =&gt; {
        // ä½¿ç”¨å¯¼å…¥çš„æ¨¡å—
        console.log(module.default);
        console.log(module.namedExport);
    })
    .catch(err =&gt; {
        console.error('Failed to load module:', err);
    });

// ä½¿ç”¨ async/await
async function loadModule() {
    try {
        const module = await import('./module.js');
        return module;
    } catch (error) {
        console.error('Module loading failed:', error);
        throw error;
    }
}
</code></pre>
<h3 id="é¡¶å±‚-await-ä¸åŠ¨æ€å¯¼å…¥"><a class="header" href="#é¡¶å±‚-await-ä¸åŠ¨æ€å¯¼å…¥">é¡¶å±‚ await ä¸åŠ¨æ€å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// top-level-await.js
// åœ¨æ”¯æŒé¡¶å±‚awaitçš„ç¯å¢ƒä¸­ä½¿ç”¨

// æ¡ä»¶æ€§åŠ è½½æ¨¡å—
const isDevelopment = process.env.NODE_ENV === 'development';

if (isDevelopment) {
    const devTools = await import('./dev-tools.js');
    devTools.setup();
    console.log('Development tools loaded');
}

// åŠ¨æ€é€‰æ‹©å®ç°
const preferredImplementation = getPreferredImplementation();
const implementation = await import(`./implementations/${preferredImplementation}.js`);

export default implementation.default;
</code></pre>
<h2 id="åŠ¨æ€å¯¼å…¥çš„åº”ç”¨åœºæ™¯"><a class="header" href="#åŠ¨æ€å¯¼å…¥çš„åº”ç”¨åœºæ™¯">åŠ¨æ€å¯¼å…¥çš„åº”ç”¨åœºæ™¯</a></h2>
<h3 id="1-æ¡ä»¶åŠ è½½"><a class="header" href="#1-æ¡ä»¶åŠ è½½">1. æ¡ä»¶åŠ è½½</a></h3>
<pre><code class="language-javascript">// conditional-loading.js

// æ ¹æ®ç”¨æˆ·æƒé™åŠ è½½ä¸åŒçš„æ¨¡å—
async function loadUserInterface(userRole) {
    switch (userRole) {
        case 'admin':
            const adminUI = await import('./admin-ui.js');
            return adminUI.default;
            
        case 'moderator':
            const modUI = await import('./moderator-ui.js');
            return modUI.default;
            
        case 'user':
        default:
            const userUI = await import('./user-ui.js');
            return userUI.default;
    }
}

// æ ¹æ®åŠŸèƒ½ç‰¹æ€§åŠ è½½polyfill
async function loadPolyfills() {
    const promises = [];
    
    if (!('IntersectionObserver' in window)) {
        promises.push(import('./polyfills/intersection-observer.js'));
    }
    
    if (!('fetch' in window)) {
        promises.push(import('./polyfills/fetch.js'));
    }
    
    if (!('Promise' in window)) {
        promises.push(import('./polyfills/promise.js'));
    }
    
    return Promise.all(promises);
}

// ä½¿ç”¨ç¤ºä¾‹
const user = getCurrentUser();
const ui = await loadUserInterface(user.role);
ui.render(document.body);
</code></pre>
<h3 id="2-æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²"><a class="header" href="#2-æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²">2. æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²</a></h3>
<pre><code class="language-javascript">// lazy-loading.js

// è·¯ç”±æ‡’åŠ è½½
const routes = {
    '/': () =&gt; import('./pages/Home.js'),
    '/about': () =&gt; import('./pages/About.js'),
    '/contact': () =&gt; import('./pages/Contact.js'),
    '/dashboard': () =&gt; import('./pages/Dashboard.js'),
    '/settings': () =&gt; import('./pages/Settings.js')
};

async function navigateTo(path) {
    const loadPage = routes[path];
    
    if (!loadPage) {
        throw new Error(`No route found for ${path}`);
    }
    
    try {
        const pageModule = await loadPage();
        const page = new pageModule.default();
        
        // æ¸…ç†å½“å‰é¡µé¢
        clearCurrentPage();
        
        // æ¸²æŸ“æ–°é¡µé¢
        page.render(document.getElementById('app'));
        
        // æ›´æ–°æµè§ˆå™¨å†å²
        history.pushState({}, '', path);
    } catch (error) {
        console.error(`Failed to load page ${path}:`, error);
        showErrorPage();
    }
}

// ç»„ä»¶æ‡’åŠ è½½
class ComponentLoader {
    constructor() {
        this.cache = new Map();
    }
    
    async loadComponent(name) {
        // æ£€æŸ¥ç¼“å­˜
        if (this.cache.has(name)) {
            return this.cache.get(name);
        }
        
        try {
            const module = await import(`./components/${name}.js`);
            const component = module.default;
            
            // ç¼“å­˜ç»„ä»¶
            this.cache.set(name, component);
            
            return component;
        } catch (error) {
            console.error(`Failed to load component ${name}:`, error);
            return null;
        }
    }
}

const loader = new ComponentLoader();

// ä½¿ç”¨ç¤ºä¾‹
document.addEventListener('click', async (event) =&gt; {
    if (event.target.dataset.component) {
        const componentName = event.target.dataset.component;
        const Component = await loader.loadComponent(componentName);
        
        if (Component) {
            const instance = new Component();
            instance.mount(event.target.parentElement);
        }
    }
});
</code></pre>
<h3 id="3-æ’ä»¶ç³»ç»Ÿ"><a class="header" href="#3-æ’ä»¶ç³»ç»Ÿ">3. æ’ä»¶ç³»ç»Ÿ</a></h3>
<pre><code class="language-javascript">// plugin-system.js

class PluginManager {
    constructor() {
        this.plugins = new Map();
        this.hooks = new Map();
    }
    
    // åŠ¨æ€åŠ è½½æ’ä»¶
    async loadPlugin(pluginName, config = {}) {
        try {
            const pluginModule = await import(`./plugins/${pluginName}/index.js`);
            const PluginClass = pluginModule.default;
            
            const plugin = new PluginClass(config);
            
            // åˆå§‹åŒ–æ’ä»¶
            if (typeof plugin.init === 'function') {
                await plugin.init();
            }
            
            // æ³¨å†Œæ’ä»¶
            this.plugins.set(pluginName, plugin);
            
            // æ³¨å†Œæ’ä»¶çš„é’©å­
            if (plugin.hooks) {
                Object.entries(plugin.hooks).forEach(([hookName, handler]) =&gt; {
                    this.registerHook(hookName, handler);
                });
            }
            
            console.log(`Plugin ${pluginName} loaded successfully`);
            return plugin;
        } catch (error) {
            console.error(`Failed to load plugin ${pluginName}:`, error);
            throw error;
        }
    }
    
    // å¸è½½æ’ä»¶
    async unloadPlugin(pluginName) {
        const plugin = this.plugins.get(pluginName);
        
        if (!plugin) {
            return false;
        }
        
        // æ‰§è¡Œæ¸…ç†
        if (typeof plugin.destroy === 'function') {
            await plugin.destroy();
        }
        
        // ç§»é™¤é’©å­
        if (plugin.hooks) {
            Object.keys(plugin.hooks).forEach(hookName =&gt; {
                this.unregisterHook(hookName, plugin.hooks[hookName]);
            });
        }
        
        this.plugins.delete(pluginName);
        console.log(`Plugin ${pluginName} unloaded`);
        return true;
    }
    
    registerHook(hookName, handler) {
        if (!this.hooks.has(hookName)) {
            this.hooks.set(hookName, []);
        }
        this.hooks.get(hookName).push(handler);
    }
    
    unregisterHook(hookName, handler) {
        const handlers = this.hooks.get(hookName);
        if (handlers) {
            const index = handlers.indexOf(handler);
            if (index &gt; -1) {
                handlers.splice(index, 1);
            }
        }
    }
    
    // è§¦å‘é’©å­
    async triggerHook(hookName, ...args) {
        const handlers = this.hooks.get(hookName) || [];
        const results = await Promise.all(
            handlers.map(handler =&gt; handler(...args))
        );
        return results;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const pluginManager = new PluginManager();

// åŠ è½½æ’ä»¶
await pluginManager.loadPlugin('analytics', {
    trackingId: 'GA-XXXXXX-X'
});

await pluginManager.loadPlugin('chat-widget', {
    apiKey: 'chat-api-key',
    position: 'bottom-right'
});

// è§¦å‘é’©å­
await pluginManager.triggerHook('user-login', { userId: 123 });
</code></pre>
<h3 id="4-å›½é™…åŒ–å’Œæœ¬åœ°åŒ–"><a class="header" href="#4-å›½é™…åŒ–å’Œæœ¬åœ°åŒ–">4. å›½é™…åŒ–å’Œæœ¬åœ°åŒ–</a></h3>
<pre><code class="language-javascript">// i18n.js

class I18nManager {
    constructor(defaultLocale = 'en') {
        this.currentLocale = defaultLocale;
        this.translations = new Map();
        this.fallbacks = new Map();
    }
    
    // åŠ¨æ€åŠ è½½è¯­è¨€åŒ…
    async loadLocale(locale) {
        if (this.translations.has(locale)) {
            return this.translations.get(locale);
        }
        
        try {
            // å°è¯•åŠ è½½å®Œæ•´è¯­è¨€åŒ…
            const fullModule = await import(`./locales/${locale}.js`);
            this.translations.set(locale, fullModule.default);
            return fullModule.default;
        } catch (error) {
            // å¦‚æœå¤±è´¥ï¼Œå°è¯•åŠ è½½è¯­è¨€çš„åŸºç¡€ç‰ˆæœ¬
            const baseLang = locale.split('-')[0];
            if (baseLang !== locale) {
                try {
                    const baseModule = await import(`./locales/${baseLang}.js`);
                    this.fallbacks.set(locale, baseModule.default);
                    return baseModule.default;
                } catch (baseError) {
                    console.error(`Failed to load locale ${locale} and ${baseLang}:`, error, baseError);
                }
            }
            throw error;
        }
    }
    
    // è®¾ç½®å½“å‰è¯­è¨€
    async setLocale(locale) {
        await this.loadLocale(locale);
        this.currentLocale = locale;
        
        // è§¦å‘è¯­è¨€å˜æ›´äº‹ä»¶
        document.dispatchEvent(new CustomEvent('locale-changed', {
            detail: { locale, translations: this.translations.get(locale) }
        }));
    }
    
    // è·å–ç¿»è¯‘
    t(key, params = {}) {
        const translations = this.translations.get(this.currentLocale) ||
                           this.fallbacks.get(this.currentLocale) ||
                           this.translations.get('en');
        
        if (!translations) {
            return key;
        }
        
        let text = this.getNestedValue(translations, key) || key;
        
        // æ›¿æ¢å‚æ•°
        Object.entries(params).forEach(([param, value]) =&gt; {
            text = text.replace(new RegExp(`\\{\\{${param}\\}\\}`, 'g'), value);
        });
        
        return text;
    }
    
    getNestedValue(obj, path) {
        return path.split('.').reduce((current, key) =&gt; {
            return current &amp;&amp; current[key] !== undefined ? current[key] : null;
        }, obj);
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const i18n = new I18nManager('en');

// æ£€æµ‹ç”¨æˆ·è¯­è¨€å¹¶åŠ è½½
const userLocale = navigator.language || navigator.userLanguage || 'en';
await i18n.setLocale(userLocale);

// åœ¨åº”ç”¨ä¸­ä½¿ç”¨
console.log(i18n.t('welcome.message', { name: 'John' }));
console.log(i18n.t('navigation.home'));

// è¯­è¨€åˆ‡æ¢å™¨
async function switchLanguage(locale) {
    try {
        await i18n.setLocale(locale);
        updateUI();
    } catch (error) {
        console.error('Failed to switch language:', error);
    }
}
</code></pre>
<h2 id="åŠ¨æ€å¯¼å…¥çš„é«˜çº§ç”¨æ³•"><a class="header" href="#åŠ¨æ€å¯¼å…¥çš„é«˜çº§ç”¨æ³•">åŠ¨æ€å¯¼å…¥çš„é«˜çº§ç”¨æ³•</a></h2>
<h3 id="1-å¹¶è¡ŒåŠ è½½å¤šä¸ªæ¨¡å—"><a class="header" href="#1-å¹¶è¡ŒåŠ è½½å¤šä¸ªæ¨¡å—">1. å¹¶è¡ŒåŠ è½½å¤šä¸ªæ¨¡å—</a></h3>
<pre><code class="language-javascript">// parallel-loading.js

// å¹¶è¡ŒåŠ è½½å¤šä¸ªç›¸å…³æ¨¡å—
async function loadDashboardModules() {
    const [
        chartsModule,
        tablesModule,
        filtersModule,
        exportModule
    ] = await Promise.all([
        import('./charts.js'),
        import('./tables.js'),
        import('./filters.js'),
        import('./export.js')
    ]);
    
    return {
        Charts: chartsModule.default,
        Tables: tablesModule.default,
        Filters: filtersModule.default,
        Export: exportModule.default
    };
}

// ä½¿ç”¨Promise.allSettledå¤„ç†éƒ¨åˆ†å¤±è´¥
async function loadOptionalModules() {
    const results = await Promise.allSettled([
        import('./analytics.js'),
        import('./chat.js'),
        import('./notifications.js'),
        import('./help.js')
    ]);
    
    const loadedModules = {};
    
    results.forEach((result, index) =&gt; {
        const moduleNames = ['analytics', 'chat', 'notifications', 'help'];
        const moduleName = moduleNames[index];
        
        if (result.status === 'fulfilled') {
            loadedModules[moduleName] = result.value.default;
            console.log(`${moduleName} module loaded successfully`);
        } else {
            console.warn(`${moduleName} module failed to load:`, result.reason);
        }
    });
    
    return loadedModules;
}
</code></pre>
<h3 id="2-æ¨¡å—é¢„åŠ è½½"><a class="header" href="#2-æ¨¡å—é¢„åŠ è½½">2. æ¨¡å—é¢„åŠ è½½</a></h3>
<pre><code class="language-javascript">// preloading.js

class ModulePreloader {
    constructor() {
        this.preloadCache = new Map();
        this.loadingPromises = new Map();
    }
    
    // é¢„åŠ è½½æ¨¡å—ï¼ˆä½†ä¸æ‰§è¡Œï¼‰
    preload(modulePath) {
        if (this.preloadCache.has(modulePath)) {
            return this.preloadCache.get(modulePath);
        }
        
        // åˆ›å»ºlinkæ ‡ç­¾è¿›è¡Œé¢„åŠ è½½
        const link = document.createElement('link');
        link.rel = 'modulepreload';
        link.href = modulePath;
        document.head.appendChild(link);
        
        const promise = import(modulePath).then(module =&gt; {
            this.preloadCache.set(modulePath, module);
            return module;
        });
        
        this.loadingPromises.set(modulePath, promise);
        return promise;
    }
    
    // ç«‹å³è·å–é¢„åŠ è½½çš„æ¨¡å—
    async getPreloaded(modulePath) {
        if (this.preloadCache.has(modulePath)) {
            return this.preloadCache.get(modulePath);
        }
        
        if (this.loadingPromises.has(modulePath)) {
            return this.loadingPromises.get(modulePath);
        }
        
        return import(modulePath);
    }
    
    // æ‰¹é‡é¢„åŠ è½½
    preloadBatch(modulePaths) {
        return Promise.all(modulePaths.map(path =&gt; this.preload(path)));
    }
    
    // æ™ºèƒ½é¢„åŠ è½½ï¼šæ ¹æ®ç”¨æˆ·è¡Œä¸ºé¢„æµ‹
    intelligentPreload(userBehavior) {
        const predictions = this.predictNextModules(userBehavior);
        return this.preloadBatch(predictions);
    }
    
    predictNextModules(behavior) {
        // ç®€å•çš„é¢„æµ‹é€»è¾‘
        const moduleMap = {
            'viewing-products': ['./cart.js', './checkout.js'],
            'in-cart': ['./payment.js', './shipping.js'],
            'profile-page': ['./settings.js', './orders.js']
        };
        
        return moduleMap[behavior] || [];
    }
}

const preloader = new ModulePreloader();

// åœ¨åº”ç”¨å¯åŠ¨æ—¶é¢„åŠ è½½å…³é”®æ¨¡å—
preloader.preloadBatch([
    './router.js',
    './auth.js',
    './api-client.js'
]);

// æ ¹æ®ç”¨æˆ·è¡Œä¸ºæ™ºèƒ½é¢„åŠ è½½
document.addEventListener('mouseover', (event) =&gt; {
    if (event.target.dataset.preload) {
        preloader.preload(event.target.dataset.preload);
    }
});
</code></pre>
<h3 id="3-å®¹é”™å’Œé‡è¯•æœºåˆ¶"><a class="header" href="#3-å®¹é”™å’Œé‡è¯•æœºåˆ¶">3. å®¹é”™å’Œé‡è¯•æœºåˆ¶</a></h3>
<pre><code class="language-javascript">// error-handling.js

class RobustModuleLoader {
    constructor(options = {}) {
        this.maxRetries = options.maxRetries || 3;
        this.retryDelay = options.retryDelay || 1000;
        this.fallbacks = options.fallbacks || {};
    }
    
    async loadWithRetry(modulePath, retryCount = 0) {
        try {
            return await import(modulePath);
        } catch (error) {
            console.warn(`Failed to load ${modulePath} (attempt ${retryCount + 1}):`, error);
            
            if (retryCount &lt; this.maxRetries) {
                // æŒ‡æ•°é€€é¿
                const delay = this.retryDelay * Math.pow(2, retryCount);
                await this.sleep(delay);
                return this.loadWithRetry(modulePath, retryCount + 1);
            }
            
            // å°è¯•ä½¿ç”¨fallback
            const fallbackPath = this.fallbacks[modulePath];
            if (fallbackPath &amp;&amp; fallbackPath !== modulePath) {
                console.log(`Trying fallback for ${modulePath}: ${fallbackPath}`);
                return this.loadWithRetry(fallbackPath);
            }
            
            throw new Error(`Failed to load module ${modulePath} after ${this.maxRetries} retries`);
        }
    }
    
    async loadWithFallback(primaryPath, fallbackPath) {
        try {
            return await import(primaryPath);
        } catch (error) {
            console.warn(`Primary module ${primaryPath} failed, using fallback:`, error);
            return import(fallbackPath);
        }
    }
    
    sleep(ms) {
        return new Promise(resolve =&gt; setTimeout(resolve, ms));
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const loader = new RobustModuleLoader({
    maxRetries: 3,
    retryDelay: 1000,
    fallbacks: {
        './advanced-charts.js': './basic-charts.js',
        './high-res-images.js': './low-res-images.js'
    }
});

try {
    const chartsModule = await loader.loadWithRetry('./advanced-charts.js');
    console.log('Advanced charts loaded successfully');
} catch (error) {
    console.error('All chart loading attempts failed:', error);
}
</code></pre>
<h2 id="æ€§èƒ½è€ƒè™‘"><a class="header" href="#æ€§èƒ½è€ƒè™‘">æ€§èƒ½è€ƒè™‘</a></h2>
<h3 id="1-æ¨¡å—å¤§å°ä¼˜åŒ–"><a class="header" href="#1-æ¨¡å—å¤§å°ä¼˜åŒ–">1. æ¨¡å—å¤§å°ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// module-optimization.js

// åˆ†å‰²å¤§æ¨¡å—ä¸ºå°å—
// ä»£æ›¿ä¸€ä¸ªå¤§çš„utilsæ¨¡å—ï¼š
// import * as utils from './large-utils.js';

// ä½¿ç”¨æŒ‰éœ€å¯¼å…¥ï¼š
const stringUtils = () =&gt; import('./utils/string.js');
const arrayUtils = () =&gt; import('./utils/array.js');
const dateUtils = () =&gt; import('./utils/date.js');

// åªåœ¨éœ€è¦æ—¶åŠ è½½å…·ä½“åŠŸèƒ½
async function formatUserData(userData) {
    const { format } = await import('./utils/string.js');
    const { sortBy } = await import('./utils/array.js');
    const { formatDate } = await import('./utils/date.js');
    
    return {
        name: format(userData.name),
        dates: userData.dates.map(formatDate),
        sorted: sortBy(userData.items, 'priority')
    };
}
</code></pre>
<h3 id="2-ç¼“å­˜ç­–ç•¥"><a class="header" href="#2-ç¼“å­˜ç­–ç•¥">2. ç¼“å­˜ç­–ç•¥</a></h3>
<pre><code class="language-javascript">// caching.js

class ModuleCache {
    constructor(options = {}) {
        this.cache = new Map();
        this.maxAge = options.maxAge || 300000; // 5åˆ†é’Ÿ
        this.maxSize = options.maxSize || 50;
    }
    
    async loadModule(modulePath) {
        const cacheKey = modulePath;
        const cached = this.cache.get(cacheKey);
        
        if (cached &amp;&amp; this.isValid(cached)) {
            return cached.module;
        }
        
        const module = await import(modulePath);
        
        this.cache.set(cacheKey, {
            module,
            timestamp: Date.now()
        });
        
        this.cleanup();
        return module;
    }
    
    isValid(cached) {
        return Date.now() - cached.timestamp &lt; this.maxAge;
    }
    
    cleanup() {
        if (this.cache.size &lt;= this.maxSize) {
            return;
        }
        
        // ç§»é™¤æœ€æ—§çš„æ¡ç›®
        const entries = Array.from(this.cache.entries());
        entries.sort((a, b) =&gt; a[1].timestamp - b[1].timestamp);
        
        const toRemove = entries.slice(0, this.cache.size - this.maxSize);
        toRemove.forEach(([key]) =&gt; this.cache.delete(key));
    }
    
    clear() {
        this.cache.clear();
    }
}

const moduleCache = new ModuleCache({ maxAge: 600000, maxSize: 100 });
</code></pre>
<h2 id="åŠ¨æ€å¯¼å…¥çš„å±€é™æ€§"><a class="header" href="#åŠ¨æ€å¯¼å…¥çš„å±€é™æ€§">åŠ¨æ€å¯¼å…¥çš„å±€é™æ€§</a></h2>
<h3 id="1-é™æ€åˆ†æé™åˆ¶"><a class="header" href="#1-é™æ€åˆ†æé™åˆ¶">1. é™æ€åˆ†æé™åˆ¶</a></h3>
<pre><code class="language-javascript">// limitations.js

// âŒ è¿™äº›ç”¨æ³•ä¼šä½¿æ‰“åŒ…å·¥å…·æ— æ³•è¿›è¡Œé™æ€åˆ†æ
const moduleName = getUserPreference();
import(moduleName); // å®Œå…¨åŠ¨æ€çš„è·¯å¾„

const modules = ['a', 'b', 'c'];
modules.forEach(name =&gt; import(name)); // å¾ªç¯ä¸­çš„åŠ¨æ€å¯¼å…¥

// âœ… æ›´å¥½çš„åšæ³•ï¼šä½¿ç”¨éƒ¨åˆ†é™æ€è·¯å¾„
const theme = getUserTheme();
import(`./themes/${theme}.js`); // éƒ¨åˆ†é™æ€è·¯å¾„

// âœ… æˆ–ä½¿ç”¨æ˜¾å¼çš„æ¨¡å—æ˜ å°„
const moduleMap = {
    theme1: () =&gt; import('./themes/theme1.js'),
    theme2: () =&gt; import('./themes/theme2.js'),
    theme3: () =&gt; import('./themes/theme3.js')
};

const themeLoader = moduleMap[theme];
if (themeLoader) {
    themeLoader().then(module =&gt; {
        // ä½¿ç”¨ä¸»é¢˜æ¨¡å—
    });
}
</code></pre>
<h3 id="2-é”™è¯¯å¤„ç†çš„é‡è¦æ€§"><a class="header" href="#2-é”™è¯¯å¤„ç†çš„é‡è¦æ€§">2. é”™è¯¯å¤„ç†çš„é‡è¦æ€§</a></h3>
<pre><code class="language-javascript">// error-handling-best-practices.js

// âŒ æ²¡æœ‰é”™è¯¯å¤„ç†
import('./module.js').then(module =&gt; {
    module.default(); // å¦‚æœæ¨¡å—åŠ è½½å¤±è´¥ï¼Œè¿™é‡Œä¼šå‡ºé”™
});

// âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
async function loadAndUseModule() {
    try {
        const module = await import('./module.js');
        
        if (!module || !module.default) {
            throw new Error('Module does not have expected exports');
        }
        
        return module.default();
    } catch (error) {
        console.error('Module loading or execution failed:', error);
        
        // æä¾›fallbacké€»è¾‘
        return useDefaultBehavior();
    }
}

function useDefaultBehavior() {
    // é»˜è®¤è¡Œä¸ºå®ç°
    console.log('Using default behavior due to module loading failure');
}
</code></pre>
<h2 id="æ€»ç»“-4"><a class="header" href="#æ€»ç»“-4">æ€»ç»“</a></h2>
<p>åŠ¨æ€å¯¼å…¥ä¸ºJavaScriptæ¨¡å—ç³»ç»Ÿå¸¦æ¥äº†å¼ºå¤§çš„è¿è¡Œæ—¶çµæ´»æ€§ï¼š</p>
<ul>
<li>âœ… <strong>æŒ‰éœ€åŠ è½½</strong>: å‡å°‘åˆå§‹åŒ…å¤§å°ï¼Œæå‡åº”ç”¨å¯åŠ¨é€Ÿåº¦</li>
<li>âœ… <strong>æ¡ä»¶åŠ è½½</strong>: æ ¹æ®ç”¨æˆ·ç¯å¢ƒã€æƒé™ç­‰æ¡ä»¶åŠ è½½ä¸åŒæ¨¡å—</li>
<li>âœ… <strong>ä»£ç åˆ†å‰²</strong>: è‡ªåŠ¨å°†ä»£ç åˆ†å‰²ä¸ºæ›´å°çš„å—</li>
<li>âœ… <strong>æ’ä»¶ç³»ç»Ÿ</strong>: æ”¯æŒè¿è¡Œæ—¶æ‰©å±•åº”ç”¨åŠŸèƒ½</li>
<li>âœ… <strong>æ‡’åŠ è½½</strong>: å»¶è¿ŸåŠ è½½éå…³é”®åŠŸèƒ½</li>
<li>âœ… <strong>å›½é™…åŒ–</strong>: åŠ¨æ€åŠ è½½è¯­è¨€åŒ…å’Œåœ°åŒºåŒ–å†…å®¹</li>
</ul>
<p>åŠ¨æ€å¯¼å…¥æ˜¯ç°ä»£Webåº”ç”¨æ€§èƒ½ä¼˜åŒ–å’Œæ¶æ„è®¾è®¡çš„é‡è¦å·¥å…·ï¼Œåˆç†ä½¿ç”¨èƒ½å¤Ÿæ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒå’Œåº”ç”¨çš„å¯ç»´æŠ¤æ€§ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ¨¡å—è§£ææœºåˆ¶">æ¨¡å—è§£ææœºåˆ¶</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ¨¡å—è§£ææœºåˆ¶"><a class="header" href="#æ¨¡å—è§£ææœºåˆ¶">æ¨¡å—è§£ææœºåˆ¶</a></h1>
<p>æ¨¡å—è§£æï¼ˆModule Resolutionï¼‰æ˜¯ESæ¨¡å—ç³»ç»Ÿä¸­çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå†³å®šäº†å½“ä½ å†™ä¸‹<code>import './module.js'</code>æ—¶ï¼ŒJavaScriptå¼•æ“å¦‚ä½•æ‰¾åˆ°å¹¶åŠ è½½æ­£ç¡®çš„æ¨¡å—æ–‡ä»¶ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨å„ç§è§£æè§„åˆ™ã€é…ç½®æ–¹å¼å’Œæœ€ä½³å®è·µã€‚</p>
<h2 id="esæ¨¡å—æ‰§è¡Œçš„å››ä¸ªé˜¶æ®µ"><a class="header" href="#esæ¨¡å—æ‰§è¡Œçš„å››ä¸ªé˜¶æ®µ">ESæ¨¡å—æ‰§è¡Œçš„å››ä¸ªé˜¶æ®µ</a></h2>
<p>ESæ¨¡å—ç³»ç»Ÿçš„æ‰§è¡Œè¿‡ç¨‹ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹å››ä¸ªé˜¶æ®µè¿›è¡Œï¼Œè¿™æ˜¯ESæ¨¡å—è§„èŒƒçš„æ ¸å¿ƒï¼š</p>
<h3 id="1-è§£æé˜¶æ®µparse-phase"><a class="header" href="#1-è§£æé˜¶æ®µparse-phase">1. è§£æé˜¶æ®µï¼ˆParse Phaseï¼‰</a></h3>
<p><strong>ç›®æ ‡</strong>: é™æ€åˆ†ææ¨¡å—ä»£ç ï¼Œè¯†åˆ«æ‰€æœ‰çš„å¯¼å…¥å’Œå¯¼å‡ºå£°æ˜</p>
<pre><code class="language-javascript">// åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå¼•æ“ä¼šåˆ†æï¼š
import { utils, config } from './utils.js';     // â† å¯¼å…¥å£°æ˜
import defaultExport from './helper.js';        // â† é»˜è®¤å¯¼å…¥
import * as api from './api.js';               // â† å‘½åç©ºé—´å¯¼å…¥

export const myVar = 'value';                  // â† å¯¼å‡ºå£°æ˜
export { helperFunc };                         // â† é‡æ–°å¯¼å‡º
export default class MyClass {};               // â† é»˜è®¤å¯¼å‡º

// åœ¨è§£æé˜¶æ®µï¼Œä»¥ä¸‹ä»£ç ä¸ä¼šæ‰§è¡Œï¼š
console.log('è¿™è¡Œä»£ç åœ¨è§£æé˜¶æ®µä¸ä¼šæ‰§è¡Œ');
</code></pre>
<p><strong>å…³é”®ç‰¹å¾</strong>ï¼š</p>
<ul>
<li>é™æ€åˆ†æï¼Œä¸æ‰§è¡Œä»£ç </li>
<li>æ„å»ºæ¨¡å—ä¾èµ–å›¾</li>
<li>è¯†åˆ«æ‰€æœ‰import/exportå£°æ˜</li>
<li>éªŒè¯è¯­æ³•æ­£ç¡®æ€§</li>
</ul>
<h3 id="2-åŠ è½½é˜¶æ®µload-phase"><a class="header" href="#2-åŠ è½½é˜¶æ®µload-phase">2. åŠ è½½é˜¶æ®µï¼ˆLoad Phaseï¼‰</a></h3>
<p><strong>ç›®æ ‡</strong>: æ ¹æ®æ¨¡å—æ ‡è¯†ç¬¦è·å–æ‰€æœ‰ä¾èµ–æ¨¡å—çš„æºä»£ç </p>
<pre><code class="language-javascript">// å‡è®¾æ¨¡å—ä¾èµ–å…³ç³»ï¼š
// main.js â†’ utils.js â†’ config.js
// main.js â†’ api.js â†’ shared.js

// åŠ è½½é˜¶æ®µä¼šé€’å½’è·å–æ‰€æœ‰æ¨¡å—çš„æºç ï¼š
/*
åŠ è½½é¡ºåºï¼ˆæ·±åº¦ä¼˜å…ˆï¼‰ï¼š
1. å¼€å§‹åŠ è½½ main.js
2. å‘ç°ä¾èµ– utils.jsï¼Œå¼€å§‹åŠ è½½
3. å‘ç° utils.js ä¾èµ– config.jsï¼Œå¼€å§‹åŠ è½½
4. config.js æ— ä¾èµ–ï¼ŒåŠ è½½å®Œæˆ
5. å›åˆ° utils.jsï¼ŒåŠ è½½å®Œæˆ
6. å‘ç°ä¾èµ– api.jsï¼Œå¼€å§‹åŠ è½½
7. å‘ç° api.js ä¾èµ– shared.jsï¼Œå¼€å§‹åŠ è½½
8. shared.js æ— ä¾èµ–ï¼ŒåŠ è½½å®Œæˆ
9. å›åˆ° api.jsï¼ŒåŠ è½½å®Œæˆ
10. å›åˆ° main.jsï¼ŒåŠ è½½å®Œæˆ
*/
</code></pre>
<p><strong>å…³é”®ç‰¹å¾</strong>ï¼š</p>
<ul>
<li>é€’å½’åŠ è½½æ‰€æœ‰ä¾èµ–</li>
<li>ç½‘ç»œè¯·æ±‚æˆ–æ–‡ä»¶ç³»ç»Ÿè¯»å–</li>
<li>æ·±åº¦ä¼˜å…ˆéå†ä¾èµ–å›¾</li>
<li>å¤„ç†å¾ªç¯ä¾èµ–æ£€æµ‹</li>
</ul>
<h3 id="3-é“¾æ¥é˜¶æ®µlink-phase"><a class="header" href="#3-é“¾æ¥é˜¶æ®µlink-phase">3. é“¾æ¥é˜¶æ®µï¼ˆLink Phaseï¼‰</a></h3>
<p><strong>ç›®æ ‡</strong>: åˆ›å»ºæ¨¡å—è®°å½•ï¼Œå»ºç«‹å¯¼å…¥å¯¼å‡ºç»‘å®šï¼ŒéªŒè¯æ¨¡å—å®Œæ•´æ€§</p>
<pre><code class="language-javascript">// utils.js
export let count = 0;
export function increment() { count++; }

// main.js  
import { count, increment } from './utils.js';

// åœ¨é“¾æ¥é˜¶æ®µï¼š
// 1. ä¸ºæ¯ä¸ªæ¨¡å—åˆ›å»ºæ¨¡å—è®°å½•ï¼ˆModule Recordï¼‰
// 2. éªŒè¯ main.js ä¸­çš„ { count, increment } åœ¨ utils.js ä¸­ç¡®å®å­˜åœ¨
// 3. å»ºç«‹å®æ—¶ç»‘å®šï¼ˆLive Bindingï¼‰
// 4. æ£€æŸ¥æ˜¯å¦æœ‰æœªè§£æçš„å¯¼å…¥
</code></pre>
<p><strong>é“¾æ¥è¿‡ç¨‹è¯¦ç»†æ­¥éª¤</strong>ï¼š</p>
<pre><code class="language-javascript">// 1. åˆ›å»ºæ¨¡å—ç¯å¢ƒè®°å½•
ModuleRecord {
  environment: ModuleEnvironmentRecord,
  namespace: ModuleNamespace,
  status: 'linking'
}

// 2. éªŒè¯å¯¼å…¥å¯¼å‡ºåŒ¹é…
main.js imports: ['count', 'increment']
utils.js exports: ['count', 'increment'] âœ“

// 3. å»ºç«‹ç»‘å®šå…³ç³»
main.count â”€â”€â†’ utils.count (live binding)
main.increment â”€â”€â†’ utils.increment (live binding)
</code></pre>
<p><strong>å…³é”®ç‰¹å¾</strong>ï¼š</p>
<ul>
<li>åˆ›å»ºæ¨¡å—ç¯å¢ƒè®°å½•</li>
<li>éªŒè¯å¯¼å…¥å¯¼å‡ºä¸€è‡´æ€§</li>
<li>å»ºç«‹å®æ—¶ç»‘å®šå…³ç³»</li>
<li>æ£€æµ‹æœªè§£æçš„å¼•ç”¨</li>
</ul>
<h3 id="4-æ±‚å€¼é˜¶æ®µevaluate-phase"><a class="header" href="#4-æ±‚å€¼é˜¶æ®µevaluate-phase">4. æ±‚å€¼é˜¶æ®µï¼ˆEvaluate Phaseï¼‰</a></h3>
<p><strong>ç›®æ ‡</strong>: æŒ‰æ‹“æ‰‘é¡ºåºæ‰§è¡Œæ¨¡å—ä»£ç ï¼Œåˆå§‹åŒ–å¯¼å‡ºå€¼</p>
<pre><code class="language-javascript">// æ‰§è¡Œé¡ºåºéµå¾ªä¾èµ–å…³ç³»ï¼Œæ— ä¾èµ–çš„æ¨¡å—å…ˆæ‰§è¡Œ

// config.js (æ— ä¾èµ–ï¼Œæœ€å…ˆæ‰§è¡Œ)
console.log('1. config.js æ‰§è¡Œ');
export const API_URL = 'https://api.example.com';

// utils.js (ä¾èµ– config.js)
import { API_URL } from './config.js';
console.log('2. utils.js æ‰§è¡Œ');
export const client = createClient(API_URL);

// main.js (ä¾èµ– utils.js)
import { client } from './utils.js';
console.log('3. main.js æ‰§è¡Œ');
client.connect();
</code></pre>
<p><strong>æ±‚å€¼ç‰¹å¾</strong>ï¼š</p>
<pre><code class="language-javascript">// æ‹“æ‰‘æ’åºç¡®å®šæ‰§è¡Œé¡ºåº
ä¾èµ–å›¾: main.js â†’ utils.js â†’ config.js
æ‰§è¡Œé¡ºåº: config.js â†’ utils.js â†’ main.js

// å¾ªç¯ä¾èµ–å¤„ç†
// å¦‚æœ A â†â†’ B å¾ªç¯ä¾èµ–ï¼ŒæŒ‰ç…§é‡åˆ°çš„é¡ºåºæ‰§è¡Œ
// æœªåˆå§‹åŒ–çš„ç»‘å®šåœ¨æ±‚å€¼å®Œæˆå‰å¯èƒ½æ˜¯ undefined
</code></pre>
<p><strong>å…³é”®ç‰¹å¾</strong>ï¼š</p>
<ul>
<li>æŒ‰æ‹“æ‰‘é¡ºåºæ‰§è¡Œä»£ç </li>
<li>åˆå§‹åŒ–å¯¼å‡ºå€¼</li>
<li>å¤„ç†å¾ªç¯ä¾èµ–</li>
<li>å»ºç«‹å®æ—¶ç»‘å®šå…³ç³»</li>
</ul>
<h2 id="é˜¶æ®µé—´çš„å…³ç³»"><a class="header" href="#é˜¶æ®µé—´çš„å…³ç³»">é˜¶æ®µé—´çš„å…³ç³»</a></h2>
<pre><code class="language-mermaid">graph TD
    A[Parse Phase&lt;br/&gt;é™æ€åˆ†æ] --&gt; B[Load Phase&lt;br/&gt;è·å–æºç ]
    B --&gt; C[Link Phase&lt;br/&gt;å»ºç«‹ç»‘å®š]
    C --&gt; D[Evaluate Phase&lt;br/&gt;æ‰§è¡Œä»£ç ]
    
    A --&gt; A1[æ„å»ºä¾èµ–å›¾]
    B --&gt; B1[é€’å½’åŠ è½½ä¾èµ–]
    C --&gt; C1[éªŒè¯å¯¼å…¥å¯¼å‡º]
    D --&gt; D1[æŒ‰é¡ºåºæ‰§è¡Œ]
</code></pre>
<h2 id="å®é™…ç¤ºä¾‹æ¼”ç¤º"><a class="header" href="#å®é™…ç¤ºä¾‹æ¼”ç¤º">å®é™…ç¤ºä¾‹æ¼”ç¤º</a></h2>
<pre><code class="language-javascript">// åˆ›å»ºæµ‹è¯•æ–‡ä»¶æ¥è§‚å¯Ÿå„ä¸ªé˜¶æ®µ
// main.js
console.log('=== main.js å¼€å§‹æ‰§è¡Œ ===');
import { helper } from './helper.js';
console.log('helper imported:', helper);
export const mainValue = 'from-main';

// helper.js  
console.log('=== helper.js å¼€å§‹æ‰§è¡Œ ===');
import { config } from './config.js';
console.log('config imported:', config);
export const helper = 'helper-value';

// config.js
console.log('=== config.js å¼€å§‹æ‰§è¡Œ ===');
export const config = 'config-value';

// æ‰§è¡Œç»“æœå°†æ˜¾ç¤ºæ±‚å€¼é˜¶æ®µçš„é¡ºåºï¼š
// === config.js å¼€å§‹æ‰§è¡Œ ===
// === helper.js å¼€å§‹æ‰§è¡Œ ===  
// config imported: config-value
// === main.js å¼€å§‹æ‰§è¡Œ ===
// helper imported: helper-value
</code></pre>
<p>è¿™å››ä¸ªé˜¶æ®µçš„ä¸¥æ ¼æ‰§è¡Œä¿è¯äº†ESæ¨¡å—çš„é™æ€åˆ†æèƒ½åŠ›ã€ä¾èµ–ç®¡ç†å’Œå¾ªç¯ä¾èµ–å¤„ç†çš„å¯é æ€§ã€‚</p>
<h2 id="ä¸ecmascriptè§„èŒƒçš„å¯¹åº”å…³ç³»"><a class="header" href="#ä¸ecmascriptè§„èŒƒçš„å¯¹åº”å…³ç³»">ä¸ECMAScriptè§„èŒƒçš„å¯¹åº”å…³ç³»</a></h2>
<p>ä¸Šè¿°å››é˜¶æ®µæ¨¡å‹å®Œå…¨ç¬¦åˆECMAScriptè§„èŒƒï¼ˆES2015+ 15.2.1èŠ‚ï¼‰ä¸­å®šä¹‰çš„æ¨¡å—å¤„ç†æµç¨‹ï¼š</p>
<h3 id="è§„èŒƒä¸­çš„æ ¸å¿ƒæ“ä½œ"><a class="header" href="#è§„èŒƒä¸­çš„æ ¸å¿ƒæ“ä½œ">è§„èŒƒä¸­çš„æ ¸å¿ƒæ“ä½œ</a></h3>
<ol>
<li>
<p><strong>ParseModule(sourceText)</strong> â†” <strong>è§£æé˜¶æ®µ</strong></p>
<ul>
<li>è§£ææºç ä¸ºæŠ½è±¡è¯­æ³•æ ‘</li>
<li>æå–å¯¼å…¥å¯¼å‡ºå£°æ˜</li>
<li>åˆ›å»ºæ¨¡å—è®°å½•ï¼ˆSource Text Module Recordï¼‰</li>
</ul>
</li>
<li>
<p><strong>HostResolveImportedModule()</strong> â†” <strong>åŠ è½½é˜¶æ®µ</strong></p>
<ul>
<li>è§£ææ¨¡å—æ ‡è¯†ç¬¦</li>
<li>é€’å½’åŠ è½½ä¾èµ–æ¨¡å—</li>
<li>å®ç°å®šä¹‰çš„å…·ä½“åŠ è½½æœºåˆ¶</li>
</ul>
</li>
<li>
<p><strong>ModuleDeclarationInstantiation()</strong> â†” <strong>é“¾æ¥é˜¶æ®µ</strong></p>
<ul>
<li>åˆ›å»ºæ¨¡å—ç¯å¢ƒè®°å½•</li>
<li>å»ºç«‹å¯¼å…¥å¯¼å‡ºç»‘å®š</li>
<li>éªŒè¯æ‰€æœ‰ä¾èµ–çš„å¯è§£ææ€§</li>
</ul>
</li>
<li>
<p><strong>ModuleEvaluation()</strong> â†” <strong>æ±‚å€¼é˜¶æ®µ</strong></p>
<ul>
<li>æŒ‰ä¾èµ–é¡ºåºé€’å½’æ±‚å€¼</li>
<li>æ‰§è¡Œæ¨¡å—ä»£ç </li>
<li>åˆå§‹åŒ–ç»‘å®šå€¼</li>
</ul>
</li>
</ol>
<h3 id="è§„èŒƒä¿è¯çš„ç‰¹æ€§"><a class="header" href="#è§„èŒƒä¿è¯çš„ç‰¹æ€§">è§„èŒƒä¿è¯çš„ç‰¹æ€§</a></h3>
<pre><code class="language-javascript">// ECMAScriptè§„èŒƒç¡®ä¿çš„è¡Œä¸ºç‰¹å¾ï¼š

// 1. å¹‚ç­‰æ€§ - åŒä¸€æ¨¡å—å¤šæ¬¡åŠ è½½è¿”å›ç›¸åŒå®ä¾‹
const mod1 = await import('./module.js');
const mod2 = await import('./module.js');
console.log(mod1 === mod2); // true

// 2. å¾ªç¯ä¾èµ–æ£€æµ‹ - ResolveExportç®—æ³•é˜²æ­¢æ— é™é€’å½’
// è§„èŒƒä¸­çš„ä¼ªä»£ç ï¼š
// If module and r.[[module]] are the same Module Record 
// and SameValue(exportName, r.[[exportName]]) is true, then
//   Assert: this is a circular import request.
//   Return null.

// 3. é™æ€ç»“æ„ - æ‰€æœ‰ç»‘å®šåœ¨é“¾æ¥é˜¶æ®µç¡®å®š
// åŠ¨æ€å¯¼å…¥åœ¨è¿è¡Œæ—¶è¿›è¡Œï¼Œä½†ä»éµå¾ªå››é˜¶æ®µæµç¨‹
</code></pre>
<p>è¿™ç§è§„èŒƒåŒ–çš„å¤„ç†æµç¨‹æ˜¯ESæ¨¡å—ç›¸å¯¹äºå…¶ä»–æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒä¼˜åŠ¿ã€‚</p>
<h2 id="ä¸‰ç±»æ¨¡å—æ ‡è¯†ç¬¦"><a class="header" href="#ä¸‰ç±»æ¨¡å—æ ‡è¯†ç¬¦">ä¸‰ç±»æ¨¡å—æ ‡è¯†ç¬¦</a></h2>
<h3 id="1-ç›¸å¯¹è·¯å¾„è§£æ"><a class="header" href="#1-ç›¸å¯¹è·¯å¾„è§£æ">1. ç›¸å¯¹è·¯å¾„è§£æ</a></h3>
<pre><code class="language-javascript">// æ–‡ä»¶ç»“æ„ï¼š
// src/
//   â”œâ”€â”€ components/
//   â”‚   â”œâ”€â”€ Button.js
//   â”‚   â”œâ”€â”€ Input.js
//   â”‚   â””â”€â”€ shared/
//   â”‚       â””â”€â”€ utils.js
//   â”œâ”€â”€ pages/
//   â”‚   â”œâ”€â”€ Home.js
//   â”‚   â””â”€â”€ About.js
//   â””â”€â”€ app.js

// åœ¨ src/app.js ä¸­
import { Button } from './components/Button.js';        // ç›¸å¯¹è·¯å¾„ï¼šåŒçº§å­ç›®å½•
import { Home } from './pages/Home.js';               // ç›¸å¯¹è·¯å¾„ï¼šåŒçº§å­ç›®å½•

// åœ¨ src/components/Button.js ä¸­
import { Input } from './Input.js';                   // ç›¸å¯¹è·¯å¾„ï¼šåŒçº§æ–‡ä»¶
import { utils } from './shared/utils.js';           // ç›¸å¯¹è·¯å¾„ï¼šå­ç›®å½•
import { config } from '../config.js';               // ç›¸å¯¹è·¯å¾„ï¼šçˆ¶ç›®å½•

// åœ¨ src/components/shared/utils.js ä¸­
import { Button } from '../Button.js';               // ç›¸å¯¹è·¯å¾„ï¼šçˆ¶ç›®å½•ä¸­çš„æ–‡ä»¶
import { Home } from '../../pages/Home.js';          // ç›¸å¯¹è·¯å¾„ï¼šç¥–çˆ¶ç›®å½•
</code></pre>
<h3 id="2-ç»å¯¹è·¯å¾„å’ŒåŒ…å¯¼å…¥-1"><a class="header" href="#2-ç»å¯¹è·¯å¾„å’ŒåŒ…å¯¼å…¥-1">2. ç»å¯¹è·¯å¾„å’ŒåŒ…å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// ç»å¯¹è·¯å¾„ï¼ˆä»é¡¹ç›®æ ¹ç›®å½•å¼€å§‹ï¼‰
import { utils } from '/src/utils/helpers.js';

// Node.js å†…ç½®æ¨¡å—
import { readFile } from 'fs/promises';
import { join } from 'path';
import { EventEmitter } from 'events';

// npm åŒ…å¯¼å…¥
import React from 'react';                    // åŒ…çš„ä¸»å…¥å£
import { useState } from 'react';             // åŒ…çš„å‘½åå¯¼å‡º
import lodash from 'lodash';                  // æ•´ä¸ªåŒ…
import { debounce } from 'lodash';            // åŒ…çš„éƒ¨åˆ†å¯¼å…¥

// ä½œç”¨åŸŸåŒ…ï¼ˆScoped Packagesï¼‰
import { parse } from '@babel/parser';
import { transform } from '@babel/core';
import { Button } from '@company/ui-components';

// å­è·¯å¾„å¯¼å…¥
import { format } from 'date-fns/format';     // åŒ…çš„å­æ¨¡å—
import { isValid } from 'date-fns/isValid';
</code></pre>
<h3 id="3-è£¸æ¨¡å—æ ‡è¯†ç¬¦-bare-specifiers"><a class="header" href="#3-è£¸æ¨¡å—æ ‡è¯†ç¬¦-bare-specifiers">3. è£¸æ¨¡å—æ ‡è¯†ç¬¦ (Bare Specifiers)</a></h3>
<p>è£¸æ¨¡å—æ ‡è¯†ç¬¦æ˜¯ä¸ä»¥ <code>./</code>ã€<code>../</code> æˆ– <code>/</code> å¼€å¤´çš„æ¨¡å—æ ‡è¯†ç¬¦ï¼Œä¸»è¦ç”¨äºå¯¼å…¥ npm åŒ…æˆ–å†…ç½®æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">// å†…ç½®æ¨¡å—
import { readFile } from 'fs/promises';
import { join } from 'path';
import { EventEmitter } from 'events';

// npm åŒ…å¯¼å…¥
import React from 'react';                    // åŒ…çš„é»˜è®¤å¯¼å‡º
import { useState, useEffect } from 'react';  // åŒ…çš„å‘½åå¯¼å‡º
import lodash from 'lodash';                  // æ•´ä¸ªåŒ…
import { debounce } from 'lodash/debounce';   // åŒ…çš„å­æ¨¡å—

// ä½œç”¨åŸŸåŒ… (Scoped Packages)
import { parse } from '@babel/parser';
import { transform } from '@babel/core';
import { Button } from '@company/ui-components';

// å­è·¯å¾„å¯¼å…¥
import { format } from 'date-fns/format';     // åŒ…çš„å­æ¨¡å—
import { isValid } from 'date-fns/isValid';
import utils from 'my-package/utils';         // è‡ªå®šä¹‰å­è·¯å¾„
</code></pre>
<p><strong>è£¸æ¨¡å—æ ‡è¯†ç¬¦çš„è§£æç‰¹ç‚¹</strong>ï¼š</p>
<pre><code class="language-javascript">// 1. ä¼˜å…ˆçº§é¡ºåº
// Node.js ç¯å¢ƒä¸­çš„è§£æé¡ºåºï¼š
// 1) æ ¸å¿ƒæ¨¡å—ï¼ˆå¦‚ 'fs', 'path', 'http'ï¼‰
// 2) node_modules ä¸­çš„åŒ…
// 3) å…¨å±€å®‰è£…çš„åŒ…ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰

// 2. åŒ…å…¥å£è§£æ
// æŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾åŒ…çš„å…¥å£ï¼š
// - package.json ä¸­çš„ "exports" å­—æ®µï¼ˆç°ä»£æ–¹å¼ï¼‰
// - package.json ä¸­çš„ "module" å­—æ®µï¼ˆESæ¨¡å—å…¥å£ï¼‰
// - package.json ä¸­çš„ "main" å­—æ®µï¼ˆä¼ ç»Ÿå…¥å£ï¼‰
// - index.js æ–‡ä»¶ï¼ˆé»˜è®¤çº¦å®šï¼‰

// 3. å­è·¯å¾„è§£æ
import { helper } from 'my-package/utils';    // è§£æä¸º node_modules/my-package/utils.js
import config from 'my-package/config.json';  // è§£æä¸º node_modules/my-package/config.json

// 4. ä½œç”¨åŸŸåŒ…è§£æ
import { component } from '@company/ui';      // è§£æä¸º node_modules/@company/ui/
</code></pre>
<p><strong>ä¸åŒç¯å¢ƒä¸­çš„è£¸æ¨¡å—æ ‡è¯†ç¬¦</strong>ï¼š</p>
<pre><code class="language-javascript">// Node.js ç¯å¢ƒ
import fs from 'fs';                    // âœ… å†…ç½®æ¨¡å—
import express from 'express';          // âœ… npmåŒ…

// æµè§ˆå™¨ç¯å¢ƒï¼ˆåŸç”Ÿï¼‰
import fs from 'fs';                    // âŒ æµè§ˆå™¨ä¸æ”¯æŒ
import express from 'express';          // âŒ éœ€è¦Import Mapsæˆ–æ„å»ºå·¥å…·

// æµè§ˆå™¨ç¯å¢ƒï¼ˆä½¿ç”¨Import Mapsï¼‰
// &lt;script type="importmap"&gt;
// {
//   "imports": {
//     "lodash": "https://cdn.skypack.dev/lodash",
//     "react": "https://esm.sh/react@18"
//   }
// }
// &lt;/script&gt;
import lodash from 'lodash';            // âœ… é€šè¿‡Import Mapsè§£æ
import React from 'react';             // âœ… é€šè¿‡Import Mapsè§£æ

// æ„å»ºå·¥å…·ç¯å¢ƒï¼ˆWebpack/Viteç­‰ï¼‰
import lodash from 'lodash';            // âœ… æ„å»ºæ—¶è§£æ
import utils from '@/utils';           // âœ… é€šè¿‡åˆ«åé…ç½®
</code></pre>
<h2 id="nodejs-ä¸­çš„æ¨¡å—è§£æ"><a class="header" href="#nodejs-ä¸­çš„æ¨¡å—è§£æ">Node.js ä¸­çš„æ¨¡å—è§£æ</a></h2>
<h3 id="1-è§£æç®—æ³•"><a class="header" href="#1-è§£æç®—æ³•">1. è§£æç®—æ³•</a></h3>
<p>Node.js ä½¿ç”¨å¤æ‚çš„è§£æç®—æ³•æ¥æŸ¥æ‰¾æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">// Node.js æ¨¡å—è§£ææ­¥éª¤ç¤ºä¾‹
// å½“å¯¼å…¥ 'my-package' æ—¶

// 1. æ£€æŸ¥å†…ç½®æ¨¡å—
import { readFile } from 'fs/promises';  // fs æ˜¯å†…ç½®æ¨¡å—ï¼Œç›´æ¥è¿”å›

// 2. å¦‚æœä¸æ˜¯å†…ç½®æ¨¡å—ï¼ŒæŸ¥æ‰¾ node_modules
// æŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾ï¼š
// ./node_modules/my-package/
// ../node_modules/my-package/
// ../../node_modules/my-package/
// ... ä¸€ç›´åˆ°æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•

// 3. åœ¨åŒ…ç›®å½•ä¸­è§£æä¸»å…¥å£
// æŒ‰ä¼˜å…ˆçº§æŸ¥æ‰¾ï¼š
// - package.json ä¸­çš„ "exports" å­—æ®µ
// - package.json ä¸­çš„ "main" å­—æ®µ
// - index.js
// - index.json
// - index.node
</code></pre>
<h3 id="2-packagejson-çš„-exports-å­—æ®µ"><a class="header" href="#2-packagejson-çš„-exports-å­—æ®µ">2. package.json çš„ exports å­—æ®µ</a></h3>
<pre><code class="language-json">{
  "name": "my-library",
  "exports": {
    ".": {
      "import": "./dist/esm/index.js",
      "require": "./dist/cjs/index.js",
      "types": "./dist/types/index.d.ts"
    },
    "./utils": {
      "import": "./dist/esm/utils.js",
      "require": "./dist/cjs/utils.js"
    },
    "./components/*": {
      "import": "./dist/esm/components/*.js",
      "require": "./dist/cjs/components/*.js"
    },
    "./package.json": "./package.json"
  }
}
</code></pre>
<pre><code class="language-javascript">// ä½¿ç”¨ä¸Šè¿°é…ç½®çš„å¯¼å…¥ç¤ºä¾‹
import MyLibrary from 'my-library';           // è§£æåˆ° ./dist/esm/index.js
import { helper } from 'my-library/utils';    // è§£æåˆ° ./dist/esm/utils.js
import { Button } from 'my-library/components/Button';  // è§£æåˆ° ./dist/esm/components/Button.js
</code></pre>
<h3 id="3-æ¡ä»¶å¯¼å‡º"><a class="header" href="#3-æ¡ä»¶å¯¼å‡º">3. æ¡ä»¶å¯¼å‡º</a></h3>
<pre><code class="language-json">{
  "exports": {
    ".": {
      "node": "./dist/node/index.js",
      "browser": "./dist/browser/index.js",
      "import": "./dist/esm/index.js",
      "require": "./dist/cjs/index.js",
      "development": "./src/index.js",
      "production": "./dist/prod/index.js",
      "default": "./dist/esm/index.js"
    }
  }
}
</code></pre>
<h2 id="æµè§ˆå™¨ä¸­çš„æ¨¡å—è§£æ"><a class="header" href="#æµè§ˆå™¨ä¸­çš„æ¨¡å—è§£æ">æµè§ˆå™¨ä¸­çš„æ¨¡å—è§£æ</a></h2>
<h3 id="1-åŸºæœ¬è§„åˆ™"><a class="header" href="#1-åŸºæœ¬è§„åˆ™">1. åŸºæœ¬è§„åˆ™</a></h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Browser Module Resolution&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;script type="module"&gt;
        // ç›¸å¯¹è·¯å¾„å¿…é¡»æ˜ç¡®æŒ‡å®šæ‰©å±•å
        import { utils } from './utils.js';           // âœ… æ­£ç¡®
        // import { utils } from './utils';           // âŒ åœ¨æµè§ˆå™¨ä¸­ä¼šå¤±è´¥
        
        // ç»å¯¹è·¯å¾„
        import { config } from '/js/config.js';       // âœ… ä»ç½‘ç«™æ ¹ç›®å½•
        
        // å®Œæ•´URL
        import { library } from 'https://cdn.skypack.dev/lodash';  // âœ… CDNå¯¼å…¥
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="2-import-maps"><a class="header" href="#2-import-maps">2. Import Maps</a></h3>
<p>Import Maps å…è®¸åœ¨æµè§ˆå™¨ä¸­é…ç½®æ¨¡å—è§£æï¼š</p>
<pre><code class="language-html">&lt;script type="importmap"&gt;
{
  "imports": {
    "react": "https://esm.sh/react@18",
    "react-dom": "https://esm.sh/react-dom@18",
    "lodash": "https://cdn.skypack.dev/lodash",
    "lodash/": "https://cdn.skypack.dev/lodash/",
    "@company/": "/js/packages/company/",
    "utils/": "/js/utils/"
  },
  "scopes": {
    "/js/legacy/": {
      "react": "https://esm.sh/react@17"
    }
  }
}
&lt;/script&gt;

&lt;script type="module"&gt;
    // ç°åœ¨å¯ä»¥ä½¿ç”¨è£¸æ¨¡å—è¯´æ˜ç¬¦
    import React from 'react';                    // è§£æåˆ° https://esm.sh/react@18
    import { debounce } from 'lodash';           // è§£æåˆ° https://cdn.skypack.dev/lodash
    import { merge } from 'lodash/merge';        // è§£æåˆ° https://cdn.skypack.dev/lodash/merge
    import { Button } from '@company/ui';        // è§£æåˆ° /js/packages/company/ui
    import { helper } from 'utils/helper.js';    // è§£æåˆ° /js/utils/helper.js
&lt;/script&gt;
</code></pre>
<h3 id="3-åŠ¨æ€-import-maps"><a class="header" href="#3-åŠ¨æ€-import-maps">3. åŠ¨æ€ Import Maps</a></h3>
<pre><code class="language-javascript">// dynamic-import-maps.js

function createImportMap(dependencies) {
    const importMap = {
        imports: {}
    };
    
    Object.entries(dependencies).forEach(([name, url]) =&gt; {
        importMap.imports[name] = url;
    });
    
    const script = document.createElement('script');
    script.type = 'importmap';
    script.textContent = JSON.stringify(importMap);
    document.head.appendChild(script);
}

// æ ¹æ®ç¯å¢ƒåŠ¨æ€é…ç½®
const isDevelopment = location.hostname === 'localhost';
const dependencies = isDevelopment ? {
    'react': '/node_modules/react/index.js',
    'lodash': '/node_modules/lodash/lodash.js'
} : {
    'react': 'https://cdn.skypack.dev/react',
    'lodash': 'https://cdn.skypack.dev/lodash'
};

createImportMap(dependencies);
</code></pre>
<p><strong>åŠ¨æ€ Import Maps çš„é‡è¦é™åˆ¶</strong>ï¼š</p>
<pre><code class="language-javascript">// å…³é”®åŸåˆ™ï¼šImport Maps åªå½±å“æœªæ¥çš„å¯¼å…¥ï¼Œä¸å½±å“å·²åŠ è½½çš„æ¨¡å—

// 1. æ¨¡å—ç¼“å­˜æœºåˆ¶
console.log('=== æ¼”ç¤ºæ¨¡å—ç¼“å­˜å’Œ Import Maps çš„äº¤äº’ ===');

// é¦–å…ˆåŠ è½½ä¸€ä¸ªæ¨¡å—
import('https://cdn.skypack.dev/lodash').then(lodash1 =&gt; {
    console.log('ç¬¬ä¸€æ¬¡åŠ è½½ lodash:', lodash1.default.VERSION);
    
    // ç„¶åæ·»åŠ  Import Mapï¼ˆå¯¹å·²åŠ è½½çš„æ¨¡å—æ— æ•ˆï¼‰
    const importMap = {
        imports: {
            'lodash': 'https://esm.sh/lodash@4.17.20'  // ä¸åŒçš„URL
        }
    };
    
    const script = document.createElement('script');
    script.type = 'importmap';
    script.textContent = JSON.stringify(importMap);
    document.head.appendChild(script);
    
    // å†æ¬¡ä½¿ç”¨ç›¸åŒURLå¯¼å…¥ - è¿”å›ç¼“å­˜çš„æ¨¡å—
    import('https://cdn.skypack.dev/lodash').then(lodash2 =&gt; {
        console.log('ç›¸åŒURLå†æ¬¡å¯¼å…¥:', lodash2.default.VERSION);
        console.log('æ˜¯åŒä¸€ä¸ªå¯¹è±¡:', lodash1 === lodash2); // true
    });
    
    // ä½¿ç”¨è£¸æ¨¡å—æ ‡è¯†ç¬¦å¯¼å…¥ - ä½¿ç”¨æ–°çš„ Import Map
    import('lodash').then(lodash3 =&gt; {
        console.log('é€šè¿‡Import Mapå¯¼å…¥:', lodash3.default.VERSION);
        console.log('ä¸ç¬¬ä¸€æ¬¡ä¸åŒ:', lodash1 !== lodash3); // å¯èƒ½æ˜¯true
    });
});

// 2. å®‰å…¨çš„åŠ¨æ€é…ç½®æ¨¡å¼
class SafeImportMapManager {
    constructor() {
        this.loadedModules = new Set();
        this.importMapInstalled = false;
    }
    
    // æ£€æŸ¥æ˜¯å¦å¯ä»¥å®‰å…¨æ·»åŠ  Import Map
    canAddImportMap() {
        // Import Maps å¿…é¡»åœ¨ä»»ä½•æ¨¡å—å¯¼å…¥ä¹‹å‰å®šä¹‰
        return !this.importMapInstalled &amp;&amp; this.loadedModules.size === 0;
    }
    
    // å®‰å…¨æ·»åŠ  Import Map
    addImportMap(dependencies) {
        if (!this.canAddImportMap()) {
            console.warn('Cannot add Import Map: modules already loaded or Import Map already exists');
            return false;
        }
        
        const importMap = { imports: dependencies };
        const script = document.createElement('script');
        script.type = 'importmap';
        script.textContent = JSON.stringify(importMap);
        document.head.appendChild(script);
        
        this.importMapInstalled = true;
        return true;
    }
    
    // è·Ÿè¸ªæ¨¡å—åŠ è½½
    async importModule(specifier) {
        const module = await import(specifier);
        this.loadedModules.add(specifier);
        return module;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const importManager = new SafeImportMapManager();

// åœ¨åº”ç”¨å¯åŠ¨æ—¶é…ç½®
if (importManager.canAddImportMap()) {
    importManager.addImportMap({
        'react': 'https://esm.sh/react@18',
        'lodash': 'https://cdn.skypack.dev/lodash'
    });
}

// 3. æ¨¡å—çƒ­æ›´æ–°çš„æ›¿ä»£æ–¹æ¡ˆ
class ModuleVersionManager {
    constructor() {
        this.moduleCache = new Map();
        this.versionCounter = 0;
    }
    
    // é€šè¿‡ç‰ˆæœ¬åŒ–URLç»•è¿‡æ¨¡å—ç¼“å­˜
    async loadFreshModule(baseUrl) {
        this.versionCounter++;
        const versionedUrl = `${baseUrl}?v=${this.versionCounter}&amp;t=${Date.now()}`;
        
        try {
            const module = await import(versionedUrl);
            this.moduleCache.set(baseUrl, { module, url: versionedUrl, timestamp: Date.now() });
            return module;
        } catch (error) {
            console.error(`Failed to load fresh module from ${baseUrl}:`, error);
            throw error;
        }
    }
    
    // è·å–ç¼“å­˜çš„æ¨¡å—ä¿¡æ¯
    getCachedModule(baseUrl) {
        return this.moduleCache.get(baseUrl);
    }
    
    // æ¸…ç†è¿‡æœŸç¼“å­˜
    clearExpiredCache(maxAge = 300000) { // 5åˆ†é’Ÿ
        const now = Date.now();
        for (const [url, info] of this.moduleCache.entries()) {
            if (now - info.timestamp &gt; maxAge) {
                this.moduleCache.delete(url);
            }
        }
    }
}

// 4. å®é™…åº”ç”¨åœºæ™¯
// åœºæ™¯1ï¼šå¼€å‘ç¯å¢ƒ vs ç”Ÿäº§ç¯å¢ƒ
if (typeof window !== 'undefined') {
    const isDev = window.location.hostname === 'localhost';
    
    // åªåœ¨é¡µé¢åŠ è½½æœ€å¼€å§‹é…ç½®Import Map
    if (!document.querySelector('script[type="importmap"]')) {
        const dependencies = isDev ? {
            'react': '/node_modules/react/index.js',
            'react-dom': '/node_modules/react-dom/index.js'
        } : {
            'react': 'https://esm.sh/react@18.2.0',
            'react-dom': 'https://esm.sh/react-dom@18.2.0'
        };
        
        const script = document.createElement('script');
        script.type = 'importmap';
        script.textContent = JSON.stringify({ imports: dependencies });
        document.head.appendChild(script);
    }
}
</code></pre>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ¨¡å—ç¼“å­˜ä¼˜å…ˆçº§æœ€é«˜</strong>: å·²ç»é€šè¿‡ç‰¹å®šURLåŠ è½½çš„æ¨¡å—ä¼šè¢«æ°¸ä¹…ç¼“å­˜ï¼ŒImport Mapsæ— æ³•æ”¹å˜è¿™äº›æ¨¡å—çš„è§£æç»“æœ</p>
</li>
<li>
<p><strong>Import Mapsåªå½±å“æ–°çš„è§£æ</strong>: åªæœ‰å°šæœªè§£æè¿‡çš„æ¨¡å—æ ‡è¯†ç¬¦æ‰ä¼šåº”ç”¨Import Mapsè§„åˆ™</p>
</li>
<li>
<p><strong>æ—¶æœºå…³é”®</strong>: Import Mapså¿…é¡»åœ¨ä»»ä½•ä½¿ç”¨ç›¸å…³æ¨¡å—æ ‡è¯†ç¬¦çš„importè¯­å¥æ‰§è¡Œä¹‹å‰å®šä¹‰</p>
</li>
<li>
<p><strong>ç»•è¿‡ç¼“å­˜çš„æ–¹æ³•</strong>:</p>
<ul>
<li>ä½¿ç”¨ç‰ˆæœ¬åŒ–URL (<code>module.js?v=1.0.1</code>)</li>
<li>æ·»åŠ æ—¶é—´æˆ³ (<code>module.js?t=${Date.now()}</code>)</li>
<li>ä½¿ç”¨åŠ¨æ€importçš„module reloadæŠ€æœ¯</li>
</ul>
</li>
</ol>
<h3 id="æµè§ˆå™¨-module-map-api"><a class="header" href="#æµè§ˆå™¨-module-map-api">æµè§ˆå™¨ Module Map API</a></h3>
<p><strong>ç®€çŸ­å›ç­”ï¼šæµè§ˆå™¨ç›®å‰æ²¡æœ‰æä¾›ç›´æ¥è®¿é—® Module Map çš„æ ‡å‡†APIã€‚</strong></p>
<pre><code class="language-javascript">// âŒ ä¸å­˜åœ¨çš„API
// console.log(window.moduleMap);           // undefined
// console.log(document.moduleCache);       // undefined
// console.log(navigator.loadedModules);    // undefined

// âŒ ä¸å­˜åœ¨çš„æ–¹æ³•
// window.clearModuleCache();               // TypeError
// document.reloadModule('lodash');         // TypeError

// Module Map æ˜¯æµè§ˆå™¨å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œä¸æš´éœ²ç»™å¼€å‘è€…
</code></pre>
<p><strong>Module Map çš„å†…éƒ¨æœºåˆ¶</strong>ï¼š</p>
<pre><code class="language-javascript">// æµè§ˆå™¨å†…éƒ¨ç±»ä¼¼è¿™æ ·çš„ç»“æ„ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼Œå®é™…æ›´å¤æ‚ï¼‰
/*
InternalModuleMap = {
  'https://cdn.skypack.dev/lodash': {
    status: 'evaluated',
    module: ModuleRecord { ... },
    namespace: { default: lodash, ... },
    timestamp: 1640995200000
  },
  'https://esm.sh/react@18': {
    status: 'evaluated', 
    module: ModuleRecord { ... },
    namespace: { default: React, ... },
    timestamp: 1640995201000
  }
}
*/

// å¼€å‘è€…æ— æ³•ç›´æ¥è®¿é—®è¿™ä¸ªå†…éƒ¨ç»“æ„
</code></pre>
<p><strong>é—´æ¥è§‚å¯Ÿ Module Map çš„æ–¹æ³•</strong>ï¼š</p>
<pre><code class="language-javascript">// 1. é€šè¿‡æ€§èƒ½å’Œè¡Œä¸ºæ¨æ–­
class ModuleMapObserver {
    constructor() {
        this.loadTimes = new Map();
        this.loadedModules = new Set();
    }
    
    async observeModuleLoad(specifier) {
        const startTime = performance.now();
        
        try {
            const module = await import(specifier);
            const endTime = performance.now();
            const loadTime = endTime - startTime;
            
            // ç¬¬ä¸€æ¬¡åŠ è½½é€šå¸¸è¾ƒæ…¢ï¼ˆç½‘ç»œè¯·æ±‚ï¼‰
            // åç»­åŠ è½½å¾ˆå¿«ï¼ˆç¼“å­˜å‘½ä¸­ï¼‰
            if (loadTime &lt; 1) { // å°äº1msé€šå¸¸æ˜¯ç¼“å­˜å‘½ä¸­
                console.log(`ğŸ“¦ ${specifier} - ç¼“å­˜å‘½ä¸­ (${loadTime.toFixed(2)}ms)`);
                this.loadedModules.add(specifier);
            } else {
                console.log(`ğŸŒ ${specifier} - ç½‘ç»œåŠ è½½ (${loadTime.toFixed(2)}ms)`);
            }
            
            this.loadTimes.set(specifier, loadTime);
            return module;
        } catch (error) {
            console.error(`âŒ ${specifier} - åŠ è½½å¤±è´¥:`, error);
            throw error;
        }
    }
    
    // æ£€æŸ¥æ¨¡å—æ˜¯å¦å¯èƒ½å·²ç¼“å­˜
    isProbablyCached(specifier) {
        const loadTime = this.loadTimes.get(specifier);
        return loadTime !== undefined &amp;&amp; loadTime &lt; 1;
    }
    
    // è·å–åŠ è½½ç»Ÿè®¡
    getLoadStats() {
        const cached = Array.from(this.loadTimes.entries())
            .filter(([_, time]) =&gt; time &lt; 1).length;
        const total = this.loadTimes.size;
        
        return {
            total,
            cached,
            networkLoaded: total - cached,
            cacheHitRate: total &gt; 0 ? (cached / total * 100).toFixed(2) + '%' : '0%'
        };
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const observer = new ModuleMapObserver();

// ç¬¬ä¸€æ¬¡åŠ è½½
await observer.observeModuleLoad('https://cdn.skypack.dev/lodash');
// è¾“å‡º: ğŸŒ https://cdn.skypack.dev/lodash - ç½‘ç»œåŠ è½½ (245.67ms)

// ç¬¬äºŒæ¬¡åŠ è½½
await observer.observeModuleLoad('https://cdn.skypack.dev/lodash'); 
// è¾“å‡º: ğŸ“¦ https://cdn.skypack.dev/lodash - ç¼“å­˜å‘½ä¸­ (0.23ms)

console.log(observer.getLoadStats());
// è¾“å‡º: { total: 2, cached: 1, networkLoaded: 1, cacheHitRate: '50.00%' }
</code></pre>
<p><strong>Module Map è°ƒè¯•æŠ€å·§</strong>ï¼š</p>
<pre><code class="language-javascript">// 2. Chrome DevTools ä¸­çš„æ¨¡å—è°ƒè¯•
// åœ¨ Chrome DevTools ä¸­å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è§‚å¯Ÿæ¨¡å—:

// Sources â†’ Page â†’ (no domain) â†’ æŸ¥çœ‹å·²åŠ è½½çš„æ¨¡å—
// Network â†’ è¿‡æ»¤ "JS" æŸ¥çœ‹æ¨¡å—ç½‘ç»œè¯·æ±‚
// Application â†’ Frames â†’ æŸ¥çœ‹æ¨¡å—ä¾èµ–å›¾

// 3. è‡ªå®šä¹‰æ¨¡å—åŠ è½½è·Ÿè¸ª
class ModuleLoadTracker {
    constructor() {
        this.modules = new Map();
        this.originalImport = window.eval('import'); // ä¿å­˜åŸå§‹import
        this.setupInterception();
    }
    
    setupInterception() {
        // æ³¨æ„ï¼šè¿™ç§æ–¹æ³•åœ¨å®é™…ä¸­ä¸å¯è¡Œï¼Œå› ä¸ºimportæ˜¯è¯­æ³•å…³é”®å­—
        // è¿™é‡Œåªæ˜¯æ¼”ç¤ºæ¦‚å¿µ
        
        // å®é™…ä¸­å¯ä»¥é€šè¿‡é‡å†™åŠ¨æ€import
        const originalDynamicImport = window.__dynamicImportHandler__;
        if (originalDynamicImport) {
            window.__dynamicImportHandler__ = async (specifier) =&gt; {
                console.log(`ğŸ” å°è¯•å¯¼å…¥: ${specifier}`);
                const result = await originalDynamicImport(specifier);
                this.modules.set(specifier, {
                    timestamp: Date.now(),
                    exports: Object.keys(result)
                });
                return result;
            };
        }
    }
    
    getLoadedModules() {
        return Array.from(this.modules.keys());
    }
    
    getModuleInfo(specifier) {
        return this.modules.get(specifier);
    }
}

// 4. ä½¿ç”¨ Performance Observer ç›‘æ§æ¨¡å—åŠ è½½
if ('PerformanceObserver' in window) {
    const moduleObserver = new PerformanceObserver((list) =&gt; {
        for (const entry of list.getEntries()) {
            if (entry.entryType === 'navigation' || entry.entryType === 'resource') {
                if (entry.name.includes('.js') || entry.name.includes('.mjs')) {
                    console.log(`ğŸ“Š æ¨¡å—èµ„æº: ${entry.name}`);
                    console.log(`   - å¼€å§‹æ—¶é—´: ${entry.startTime}ms`);
                    console.log(`   - æŒç»­æ—¶é—´: ${entry.duration}ms`);
                    console.log(`   - ä¼ è¾“å¤§å°: ${entry.transferSize} bytes`);
                }
            }
        }
    });
    
    moduleObserver.observe({ 
        entryTypes: ['navigation', 'resource'] 
    });
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæµè§ˆå™¨ä¸æš´éœ² Module Map APIï¼Ÿ</strong></p>
<pre><code class="language-javascript">// 1. å®‰å…¨è€ƒè™‘
// æš´éœ²Module Mapå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ï¼š
// - æ¶æ„è„šæœ¬å¯èƒ½æ¸…é™¤å…³é”®æ¨¡å—
// - å¯èƒ½ç»•è¿‡åŒæºç­–ç•¥æ£€æŸ¥
// - æ•æ„Ÿä¿¡æ¯æ³„éœ²

// 2. æ€§èƒ½è€ƒè™‘  
// - Module Mapæ“ä½œå¯èƒ½å¾ˆæ˜‚è´µ
// - æš´éœ²å†…éƒ¨ç»“æ„å¯èƒ½å½±å“å¼•æ“ä¼˜åŒ–
// - é¿å…å¼€å‘è€…æ„å¤–ç ´åæ¨¡å—ç³»ç»Ÿ

// 3. æ ‡å‡†åŒ–å¤æ‚æ€§
// - ä¸åŒæµè§ˆå™¨å®ç°å·®å¼‚
// - APIè®¾è®¡çš„å¤æ‚æ€§
// - å‘åå…¼å®¹æ€§é—®é¢˜

// 4. æ›¿ä»£æ–¹æ¡ˆå­˜åœ¨
// å¼€å‘è€…å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼å®ç°ç±»ä¼¼åŠŸèƒ½ï¼š
class UserLandModuleRegistry {
    constructor() {
        this.registry = new Map();
        this.importWrapper = this.createImportWrapper();
    }
    
    createImportWrapper() {
        return async (specifier) =&gt; {
            if (this.registry.has(specifier)) {
                console.log(`ğŸ“¦ ä»ç”¨æˆ·æ³¨å†Œè¡¨è·å–: ${specifier}`);
                return this.registry.get(specifier);
            }
            
            console.log(`ğŸŒ åŠ¨æ€å¯¼å…¥: ${specifier}`);
            const module = await import(specifier);
            this.registry.set(specifier, module);
            return module;
        };
    }
    
    // ç”¨æˆ·å¯æ§çš„æ¨¡å—ç®¡ç†
    register(specifier, module) {
        this.registry.set(specifier, module);
    }
    
    unregister(specifier) {
        return this.registry.delete(specifier);
    }
    
    has(specifier) {
        return this.registry.has(specifier);
    }
    
    clear() {
        this.registry.clear();
    }
    
    list() {
        return Array.from(this.registry.keys());
    }
}

// ä½¿ç”¨ç”¨æˆ·å±‚æ¨¡å—æ³¨å†Œè¡¨
const moduleRegistry = new UserLandModuleRegistry();
const dynamicImport = moduleRegistry.importWrapper;

// è¿™æ ·å¯ä»¥å®ç°ç±»ä¼¼Module Mapçš„åŠŸèƒ½
await dynamicImport('https://cdn.skypack.dev/lodash');
console.log('å·²æ³¨å†Œæ¨¡å—:', moduleRegistry.list());
</code></pre>
<p><strong>æœªæ¥å¯èƒ½çš„å‘å±•</strong>ï¼š</p>
<pre><code class="language-javascript">// è™½ç„¶ç›®å‰æ²¡æœ‰æ ‡å‡†APIï¼Œä½†å¯èƒ½çš„æœªæ¥æ–¹å‘ï¼š

// 1. Module Reflection API (ææ¡ˆé˜¶æ®µ)
// if ('moduleReflection' in window) {
//     const loadedModules = window.moduleReflection.getLoadedModules();
//     const moduleInfo = window.moduleReflection.getModuleInfo(specifier);
//     const canClear = window.moduleReflection.canClearModule(specifier);
// }

// 2. Performance API æ‰©å±•
// if ('getEntriesByType' in performance) {
//     const moduleEntries = performance.getEntriesByType('module');
//     // è·å–æ¨¡å—æ€§èƒ½æŒ‡æ ‡
// }

// 3. å¼€å‘è€…å·¥å…·é›†æˆ
// æ›´å¥½çš„DevToolsé›†æˆï¼Œæä¾›æ¨¡å—ä¾èµ–å¯è§†åŒ–
</code></pre>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<ul>
<li>âŒ <strong>æ²¡æœ‰ç›´æ¥API</strong>: æµè§ˆå™¨ä¸æä¾›è®¿é—®Module Mapçš„æ ‡å‡†API</li>
<li>ğŸ” <strong>é—´æ¥è§‚å¯Ÿ</strong>: å¯é€šè¿‡æ€§èƒ½ç›‘æ§ã€åŠ è½½æ—¶é—´ç­‰æ–¹å¼æ¨æ–­</li>
<li>ğŸ› ï¸ <strong>æ›¿ä»£æ–¹æ¡ˆ</strong>: å¼€å‘è€…å¯ä»¥æ„å»ºç”¨æˆ·å±‚çš„æ¨¡å—ç®¡ç†ç³»ç»Ÿ</li>
<li>ğŸ”’ <strong>å®‰å…¨è®¾è®¡</strong>: è¿™æ˜¯æœ‰æ„çš„è®¾è®¡é€‰æ‹©ï¼Œå‡ºäºå®‰å…¨å’Œæ€§èƒ½è€ƒè™‘</li>
<li>ğŸš€ <strong>æœªæ¥å‘å±•</strong>: å¯èƒ½ä¼šæœ‰ä¸“é—¨çš„Module Reflection API</li>
</ul>
<h2 id="æ„å»ºå·¥å…·ä¸­çš„æ¨¡å—è§£æ"><a class="header" href="#æ„å»ºå·¥å…·ä¸­çš„æ¨¡å—è§£æ">æ„å»ºå·¥å…·ä¸­çš„æ¨¡å—è§£æ</a></h2>
<h3 id="1-webpack-è§£æé…ç½®"><a class="header" href="#1-webpack-è§£æé…ç½®">1. Webpack è§£æé…ç½®</a></h3>
<pre><code class="language-javascript">// webpack.config.js
module.exports = {
    resolve: {
        // æ¨¡å—æŸ¥æ‰¾ç›®å½•
        modules: ['node_modules', 'src'],
        
        // æ–‡ä»¶æ‰©å±•å
        extensions: ['.js', '.jsx', '.ts', '.tsx', '.json'],
        
        // åˆ«åé…ç½®
        alias: {
            '@': path.resolve(__dirname, 'src'),
            '@components': path.resolve(__dirname, 'src/components'),
            '@utils': path.resolve(__dirname, 'src/utils'),
            '@assets': path.resolve(__dirname, 'src/assets')
        },
        
        // ä¸»å­—æ®µ
        mainFields: ['browser', 'module', 'main'],
        
        // ä¸»æ–‡ä»¶å
        mainFiles: ['index', 'main'],
        
        // æ¡ä»¶å¯¼å‡º
        conditionNames: ['import', 'module', 'browser', 'default']
    }
};

// ä½¿ç”¨åˆ«åçš„å¯¼å…¥ç¤ºä¾‹
// ä»£æ›¿: import { Button } from '../../../components/Button.js'
import { Button } from '@components/Button.js';

// ä»£æ›¿: import { helper } from '../../../utils/helper.js'
import { helper } from '@utils/helper.js';
</code></pre>
<h3 id="2-vite-è§£æé…ç½®"><a class="header" href="#2-vite-è§£æé…ç½®">2. Vite è§£æé…ç½®</a></h3>
<pre><code class="language-javascript">// vite.config.js
import { defineConfig } from 'vite';
import path from 'path';

export default defineConfig({
    resolve: {
        alias: {
            '@': path.resolve(__dirname, 'src'),
            '@components': path.resolve(__dirname, 'src/components'),
            '@utils': path.resolve(__dirname, 'src/utils')
        },
        extensions: ['.js', '.ts', '.jsx', '.tsx', '.json'],
        conditions: ['import', 'module', 'browser', 'default'],
        mainFields: ['module', 'jsnext:main', 'jsnext']
    }
});
</code></pre>
<h3 id="3-typescript-è§£æé…ç½®"><a class="header" href="#3-typescript-è§£æé…ç½®">3. TypeScript è§£æé…ç½®</a></h3>
<pre><code class="language-json">// tsconfig.json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@components/*": ["src/components/*"],
      "@utils/*": ["src/utils/*"],
      "@types/*": ["src/types/*"]
    },
    "moduleResolution": "node",
    "allowSyntheticDefaultImports": true,
    "esModuleInterop": true,
    "resolveJsonModule": true
  }
}
</code></pre>
<h2 id="æ¨¡å—è§£æçš„é«˜çº§ç”¨æ³•"><a class="header" href="#æ¨¡å—è§£æçš„é«˜çº§ç”¨æ³•">æ¨¡å—è§£æçš„é«˜çº§ç”¨æ³•</a></h2>
<h3 id="1-æ¡ä»¶è§£æ"><a class="header" href="#1-æ¡ä»¶è§£æ">1. æ¡ä»¶è§£æ</a></h3>
<pre><code class="language-javascript">// platform-specific.js

// æ ¹æ®å¹³å°åŠ è½½ä¸åŒçš„å®ç°
const platform = process.platform;

let fileSystem;
switch (platform) {
    case 'win32':
        fileSystem = await import('./fs/windows.js');
        break;
    case 'darwin':
        fileSystem = await import('./fs/macos.js');
        break;
    case 'linux':
        fileSystem = await import('./fs/linux.js');
        break;
    default:
        fileSystem = await import('./fs/generic.js');
}

export default fileSystem.default;
</code></pre>
<h3 id="2-ç‰ˆæœ¬åŒ–æ¨¡å—"><a class="header" href="#2-ç‰ˆæœ¬åŒ–æ¨¡å—">2. ç‰ˆæœ¬åŒ–æ¨¡å—</a></h3>
<pre><code class="language-javascript">// versioned-modules.js

class ModuleVersionManager {
    constructor() {
        this.versions = new Map();
    }
    
    async loadVersion(moduleName, version) {
        const versionKey = `${moduleName}@${version}`;
        
        if (this.versions.has(versionKey)) {
            return this.versions.get(versionKey);
        }
        
        try {
            // å°è¯•åŠ è½½æŒ‡å®šç‰ˆæœ¬
            const module = await import(`./modules/${moduleName}/v${version}/index.js`);
            this.versions.set(versionKey, module);
            return module;
        } catch (error) {
            console.warn(`Failed to load ${versionKey}, trying latest`);
            return this.loadLatest(moduleName);
        }
    }
    
    async loadLatest(moduleName) {
        const latestKey = `${moduleName}@latest`;
        
        if (this.versions.has(latestKey)) {
            return this.versions.get(latestKey);
        }
        
        const module = await import(`./modules/${moduleName}/latest/index.js`);
        this.versions.set(latestKey, module);
        return module;
    }
    
    async loadCompatible(moduleName, semverRange) {
        // ç®€åŒ–çš„è¯­ä¹‰ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥
        const availableVersions = await this.getAvailableVersions(moduleName);
        const compatibleVersion = this.findCompatibleVersion(availableVersions, semverRange);
        
        if (compatibleVersion) {
            return this.loadVersion(moduleName, compatibleVersion);
        }
        
        throw new Error(`No compatible version found for ${moduleName}@${semverRange}`);
    }
    
    async getAvailableVersions(moduleName) {
        // å®é™…å®ç°ä¸­å¯èƒ½éœ€è¦æŸ¥è¯¢APIæˆ–æ–‡ä»¶ç³»ç»Ÿ
        return ['1.0.0', '1.1.0', '1.2.0', '2.0.0'];
    }
    
    findCompatibleVersion(versions, range) {
        // ç®€åŒ–çš„è¯­ä¹‰ç‰ˆæœ¬åŒ¹é…é€»è¾‘
        return versions.find(version =&gt; this.satisfies(version, range));
    }
    
    satisfies(version, range) {
        // å®é™…å®ç°ä¸­åº”ä½¿ç”¨ä¸“ä¸šçš„semveråº“
        return version.startsWith(range.replace('^', '').split('.')[0]);
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const versionManager = new ModuleVersionManager();

// åŠ è½½ç‰¹å®šç‰ˆæœ¬
const moduleV1 = await versionManager.loadVersion('my-library', '1.0.0');

// åŠ è½½å…¼å®¹ç‰ˆæœ¬
const moduleCompat = await versionManager.loadCompatible('my-library', '^1.0.0');
</code></pre>
<h3 id="3-æ¨¡å—è§£æä¸­é—´ä»¶"><a class="header" href="#3-æ¨¡å—è§£æä¸­é—´ä»¶">3. æ¨¡å—è§£æä¸­é—´ä»¶</a></h3>
<pre><code class="language-javascript">// resolution-middleware.js

class ModuleResolutionMiddleware {
    constructor() {
        this.middlewares = [];
    }
    
    use(middleware) {
        this.middlewares.push(middleware);
    }
    
    async resolve(specifier, context = {}) {
        let result = { specifier, context };
        
        for (const middleware of this.middlewares) {
            result = await middleware(result.specifier, result.context) || result;
        }
        
        return result.specifier;
    }
}

// ä¸­é—´ä»¶ç¤ºä¾‹
const aliasMiddleware = (aliases) =&gt; (specifier, context) =&gt; {
    for (const [alias, target] of Object.entries(aliases)) {
        if (specifier.startsWith(alias)) {
            return {
                specifier: specifier.replace(alias, target),
                context
            };
        }
    }
};

const environmentMiddleware = (specifier, context) =&gt; {
    if (specifier.includes('{{env}}')) {
        return {
            specifier: specifier.replace('{{env}}', process.env.NODE_ENV || 'development'),
            context
        };
    }
};

const loggingMiddleware = (specifier, context) =&gt; {
    console.log(`Resolving: ${specifier}`);
    // ä¸ä¿®æ”¹specifierï¼Œåªæ˜¯è®°å½•æ—¥å¿—
};

// ä½¿ç”¨ä¸­é—´ä»¶
const resolver = new ModuleResolutionMiddleware();

resolver.use(aliasMiddleware({
    '@/': './src/',
    '@components/': './src/components/',
    '@utils/': './src/utils/'
}));

resolver.use(environmentMiddleware);
resolver.use(loggingMiddleware);

// è§£ææ¨¡å—
const resolvedPath = await resolver.resolve('@components/Button');
// è¾“å‡º: Resolving: ./src/components/Button
</code></pre>
<h2 id="è§£ææ€§èƒ½ä¼˜åŒ–"><a class="header" href="#è§£ææ€§èƒ½ä¼˜åŒ–">è§£ææ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="1-ç¼“å­˜æœºåˆ¶"><a class="header" href="#1-ç¼“å­˜æœºåˆ¶">1. ç¼“å­˜æœºåˆ¶</a></h3>
<pre><code class="language-javascript">// resolution-cache.js

class ResolutionCache {
    constructor(options = {}) {
        this.cache = new Map();
        this.maxSize = options.maxSize || 1000;
        this.ttl = options.ttl || 300000; // 5åˆ†é’Ÿ
    }
    
    get(specifier) {
        const entry = this.cache.get(specifier);
        
        if (!entry) {
            return null;
        }
        
        if (Date.now() - entry.timestamp &gt; this.ttl) {
            this.cache.delete(specifier);
            return null;
        }
        
        return entry.resolved;
    }
    
    set(specifier, resolved) {
        if (this.cache.size &gt;= this.maxSize) {
            // åˆ é™¤æœ€æ—§çš„æ¡ç›®
            const oldestKey = this.cache.keys().next().value;
            this.cache.delete(oldestKey);
        }
        
        this.cache.set(specifier, {
            resolved,
            timestamp: Date.now()
        });
    }
    
    clear() {
        this.cache.clear();
    }
    
    size() {
        return this.cache.size;
    }
}

const resolutionCache = new ResolutionCache({ maxSize: 500, ttl: 600000 });

async function resolveWithCache(specifier) {
    // æ£€æŸ¥ç¼“å­˜
    const cached = resolutionCache.get(specifier);
    if (cached) {
        return cached;
    }
    
    // æ‰§è¡Œå®é™…è§£æ
    const resolved = await actualResolve(specifier);
    
    // ç¼“å­˜ç»“æœ
    resolutionCache.set(specifier, resolved);
    
    return resolved;
}
</code></pre>
<h3 id="2-é¢„è§£æ"><a class="header" href="#2-é¢„è§£æ">2. é¢„è§£æ</a></h3>
<pre><code class="language-javascript">// pre-resolution.js

class ModulePreResolver {
    constructor() {
        this.preresolved = new Map();
    }
    
    // é¢„è§£æå¸¸ç”¨æ¨¡å—
    async preresolveCommonModules(modules) {
        const promises = modules.map(async (specifier) =&gt; {
            try {
                const resolved = await this.resolve(specifier);
                this.preresolved.set(specifier, resolved);
            } catch (error) {
                console.warn(`Failed to preresolve ${specifier}:`, error);
            }
        });
        
        await Promise.all(promises);
    }
    
    async resolve(specifier) {
        // æ£€æŸ¥é¢„è§£æç»“æœ
        if (this.preresolved.has(specifier)) {
            return this.preresolved.get(specifier);
        }
        
        // æ‰§è¡Œå®é™…è§£æ
        return this.actualResolve(specifier);
    }
    
    async actualResolve(specifier) {
        // å®é™…çš„è§£æé€»è¾‘
        return new Promise((resolve) =&gt; {
            setTimeout(() =&gt; resolve(`resolved:${specifier}`), 10);
        });
    }
}

// åœ¨åº”ç”¨å¯åŠ¨æ—¶é¢„è§£æå¸¸ç”¨æ¨¡å—
const preresolver = new ModulePreResolver();

await preresolver.preresolveCommonModules([
    'react',
    'lodash',
    '@company/ui-components',
    './utils/helpers.js'
]);
</code></pre>
<h2 id="å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ"><a class="header" href="#å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ">å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</a></h2>
<h3 id="1-è·¯å¾„è§£æé—®é¢˜"><a class="header" href="#1-è·¯å¾„è§£æé—®é¢˜">1. è·¯å¾„è§£æé—®é¢˜</a></h3>
<pre><code class="language-javascript">// é—®é¢˜ï¼šæ·±å±‚åµŒå¥—çš„ç›¸å¯¹è·¯å¾„
// âŒ éš¾ä»¥ç»´æŠ¤
import { utils } from '../../../utils/helpers.js';
import { Button } from '../../../../components/Button.js';

// è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆå¦‚æœå·¥å…·æ”¯æŒï¼‰
import { utils } from '/src/utils/helpers.js';
import { Button } from '/src/components/Button.js';

// è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨è·¯å¾„åˆ«å
import { utils } from '@utils/helpers.js';
import { Button } from '@components/Button.js';

// è§£å†³æ–¹æ¡ˆ3ï¼šåˆ›å»ºæ¡¶æ–‡ä»¶
// src/index.js
export * from './utils/helpers.js';
export * from './components/Button.js';

// åœ¨å…¶ä»–æ–‡ä»¶ä¸­
import { utils, Button } from '@/index.js';
</code></pre>
<h3 id="2-å¾ªç¯ä¾èµ–è§£æ"><a class="header" href="#2-å¾ªç¯ä¾èµ–è§£æ">2. å¾ªç¯ä¾èµ–è§£æ</a></h3>
<pre><code class="language-javascript">// æ£€æµ‹å¾ªç¯ä¾èµ–çš„å·¥å…·
class CircularDependencyDetector {
    constructor() {
        this.visiting = new Set();
        this.visited = new Set();
        this.dependencies = new Map();
    }
    
    addDependency(from, to) {
        if (!this.dependencies.has(from)) {
            this.dependencies.set(from, new Set());
        }
        this.dependencies.get(from).add(to);
    }
    
    detectCycles() {
        const cycles = [];
        
        for (const module of this.dependencies.keys()) {
            if (!this.visited.has(module)) {
                const cycle = this.dfs(module, []);
                if (cycle) {
                    cycles.push(cycle);
                }
            }
        }
        
        return cycles;
    }
    
    dfs(module, path) {
        if (this.visiting.has(module)) {
            // æ‰¾åˆ°å¾ªç¯
            const cycleStart = path.indexOf(module);
            return path.slice(cycleStart).concat(module);
        }
        
        if (this.visited.has(module)) {
            return null;
        }
        
        this.visiting.add(module);
        path.push(module);
        
        const deps = this.dependencies.get(module) || new Set();
        for (const dep of deps) {
            const cycle = this.dfs(dep, [...path]);
            if (cycle) {
                return cycle;
            }
        }
        
        this.visiting.delete(module);
        this.visited.add(module);
        
        return null;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const detector = new CircularDependencyDetector();
detector.addDependency('A', 'B');
detector.addDependency('B', 'C');
detector.addDependency('C', 'A'); // å¾ªç¯ä¾èµ–

const cycles = detector.detectCycles();
console.log('Detected cycles:', cycles); // [['A', 'B', 'C', 'A']]
</code></pre>
<h2 id="æ€»ç»“-5"><a class="header" href="#æ€»ç»“-5">æ€»ç»“</a></h2>
<p>æ¨¡å—è§£ææœºåˆ¶æ˜¯ESæ¨¡å—ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç†è§£å…¶å·¥ä½œåŸç†æœ‰åŠ©äºï¼š</p>
<ul>
<li>âœ… <strong>æ­£ç¡®ç»„ç»‡é¡¹ç›®ç»“æ„</strong>: åˆç†çš„è·¯å¾„è®¾è®¡å’Œåˆ«åé…ç½®</li>
<li>âœ… <strong>ä¼˜åŒ–æ„å»ºé…ç½®</strong>: é…ç½®é€‚å½“çš„è§£æè§„åˆ™æå‡æ„å»ºæ€§èƒ½</li>
<li>âœ… <strong>è°ƒè¯•å¯¼å…¥é—®é¢˜</strong>: å¿«é€Ÿå®šä½å’Œè§£å†³æ¨¡å—æ‰¾ä¸åˆ°çš„é—®é¢˜</li>
<li>âœ… <strong>è®¾è®¡å¯é‡ç”¨æ¨¡å—</strong>: åˆ›å»ºæ˜“äºå¯¼å…¥å’Œä½¿ç”¨çš„æ¨¡å—æ¥å£</li>
<li>âœ… <strong>æ€§èƒ½ä¼˜åŒ–</strong>: é€šè¿‡ç¼“å­˜å’Œé¢„è§£ææå‡è§£ææ€§èƒ½</li>
</ul>
<p>æŒæ¡æ¨¡å—è§£ææœºåˆ¶ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ æ„å»ºæ›´åŠ å¥å£®å’Œé«˜æ•ˆçš„æ¨¡å—åŒ–åº”ç”¨ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#çƒ­æ¨¡å—é‡è½½-hot-module-reload">çƒ­æ¨¡å—é‡è½½</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="çƒ­æ¨¡å—é‡è½½-hot-module-reload"><a class="header" href="#çƒ­æ¨¡å—é‡è½½-hot-module-reload">çƒ­æ¨¡å—é‡è½½ (Hot Module Reload)</a></h1>
<p>çƒ­æ¨¡å—é‡è½½(HMR)æ˜¯ç°ä»£å‰ç«¯å¼€å‘ä¸­çš„é‡è¦ç‰¹æ€§ï¼Œå…è®¸åœ¨ä¸åˆ·æ–°æ•´ä¸ªé¡µé¢çš„æƒ…å†µä¸‹æ›´æ–°æ¨¡å—ã€‚å®ƒé€šè¿‡å·§å¦™åœ°ç»•è¿‡æµè§ˆå™¨çš„æ¨¡å—ç¼“å­˜æœºåˆ¶æ¥å®ç°å®æ—¶å¼€å‘ä½“éªŒã€‚</p>
<h2 id="hmråŸºç¡€æ¦‚å¿µ"><a class="header" href="#hmråŸºç¡€æ¦‚å¿µ">HMRåŸºç¡€æ¦‚å¿µ</a></h2>
<h3 id="æ ¸å¿ƒä»·å€¼"><a class="header" href="#æ ¸å¿ƒä»·å€¼">æ ¸å¿ƒä»·å€¼</a></h3>
<p>HMRè§£å†³äº†ä¼ ç»Ÿå¼€å‘ä¸­çš„å‡ ä¸ªå…³é”®ç—›ç‚¹ï¼š</p>
<pre><code class="language-javascript">// ä¼ ç»Ÿå¼€å‘æµç¨‹çš„é—®é¢˜
// 1. ä¿®æ”¹ä»£ç  â†’ 2. ä¿å­˜æ–‡ä»¶ â†’ 3. æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨ â†’ 4. é‡æ–°å¡«å†™è¡¨å•/å¯¼èˆªåˆ°æµ‹è¯•é¡µé¢
// ç»“æœï¼šå¼€å‘æ•ˆç‡ä½ä¸‹ï¼Œæµ‹è¯•çŠ¶æ€ä¸¢å¤±

// HMRå¼€å‘æµç¨‹
// 1. ä¿®æ”¹ä»£ç  â†’ 2. ä¿å­˜æ–‡ä»¶ â†’ 3. æ¨¡å—è‡ªåŠ¨æ›´æ–°ï¼ŒçŠ¶æ€ä¿æŒ
// ç»“æœï¼šå³æ—¶åé¦ˆï¼Œå¼€å‘ä½“éªŒæ˜¾è‘—æå‡
</code></pre>
<h3 id="æµè§ˆå™¨æ¨¡å—ç¼“å­˜æœºåˆ¶"><a class="header" href="#æµè§ˆå™¨æ¨¡å—ç¼“å­˜æœºåˆ¶">æµè§ˆå™¨æ¨¡å—ç¼“å­˜æœºåˆ¶</a></h3>
<pre><code class="language-javascript">// æµè§ˆå™¨æ¨¡å—ç¼“å­˜çš„å·¥ä½œåŸç†
const moduleCache = new Map();

// é¦–æ¬¡å¯¼å…¥
import('./utils.js').then(module =&gt; {
    moduleCache.set('./utils.js', module); // ç¼“å­˜æ¨¡å—
});

// åç»­å¯¼å…¥ç›´æ¥ä»ç¼“å­˜è¿”å›
import('./utils.js').then(module =&gt; {
    // è¿”å›ç¼“å­˜çš„æ¨¡å—ï¼Œå³ä½¿æ–‡ä»¶å·²æ”¹å˜
});

// HMRçš„æ ¸å¿ƒï¼šç»•è¿‡ç¼“å­˜
const versionedURL = `./utils.js?hmr_version=${Date.now()}`;
import(versionedURL).then(newModule =&gt; {
    // å¼ºåˆ¶è·å–æ–°ç‰ˆæœ¬æ¨¡å—
});
</code></pre>
<h2 id="hmrçš„æŠ€æœ¯å®ç°"><a class="header" href="#hmrçš„æŠ€æœ¯å®ç°">HMRçš„æŠ€æœ¯å®ç°</a></h2>
<h3 id="ç‰ˆæœ¬åŒ–urlå’Œwebsocketé€šä¿¡"><a class="header" href="#ç‰ˆæœ¬åŒ–urlå’Œwebsocketé€šä¿¡">ç‰ˆæœ¬åŒ–URLå’ŒWebSocketé€šä¿¡</a></h3>
<pre><code class="language-javascript">class HMRManager {
    constructor() {
        this.moduleVersions = new Map();
        this.moduleSubscribers = new Map();
        this.websocket = this.createWebSocket();
    }
    
    // ç”Ÿæˆç‰ˆæœ¬åŒ–çš„æ¨¡å—URL
    createVersionedURL(originalURL) {
        const version = this.moduleVersions.get(originalURL) || 0;
        const newVersion = version + 1;
        this.moduleVersions.set(originalURL, newVersion);
        
        // æ·»åŠ ç‰ˆæœ¬å‚æ•°ç»•è¿‡æµè§ˆå™¨ç¼“å­˜
        const url = new URL(originalURL, window.location.origin);
        url.searchParams.set('hmr_version', newVersion.toString());
        url.searchParams.set('timestamp', Date.now().toString());
        
        return url.toString();
    }
    
    // çƒ­é‡è½½æŒ‡å®šæ¨¡å—
    async hotReload(modulePath) {
        console.log(`ğŸ”¥ çƒ­é‡è½½æ¨¡å—: ${modulePath}`);
        
        try {
            const versionedURL = this.createVersionedURL(modulePath);
            const newModule = await import(versionedURL);
            
            // é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…
            const subscribers = this.moduleSubscribers.get(modulePath) || [];
            subscribers.forEach(callback =&gt; {
                try {
                    callback(newModule, modulePath);
                } catch (error) {
                    console.error(`HMR callback failed for ${modulePath}:`, error);
                }
            });
            
            return newModule;
        } catch (error) {
            console.error(`çƒ­é‡è½½å¤±è´¥ ${modulePath}:`, error);
            throw error;
        }
    }
    
    createWebSocket() {
        const ws = new WebSocket('ws://localhost:3000/hmr');
        
        ws.onmessage = (event) =&gt; {
            const message = JSON.parse(event.data);
            if (message.type === 'file-changed') {
                this.hotReload(message.path);
            }
        };
        
        ws.onopen = () =&gt; console.log('ğŸ”— HMR WebSocketè¿æ¥å·²å»ºç«‹');
        ws.onerror = (error) =&gt; console.error('âŒ HMR WebSocketé”™è¯¯:', error);
        
        return ws;
    }
}
</code></pre>
<h2 id="live-bindingé—®é¢˜ä¸proxyè§£å†³æ–¹æ¡ˆ"><a class="header" href="#live-bindingé—®é¢˜ä¸proxyè§£å†³æ–¹æ¡ˆ">Live Bindingé—®é¢˜ä¸Proxyè§£å†³æ–¹æ¡ˆ</a></h2>
<h3 id="live-bindingåœ¨hmrä¸­çš„æ ¸å¿ƒé—®é¢˜"><a class="header" href="#live-bindingåœ¨hmrä¸­çš„æ ¸å¿ƒé—®é¢˜">Live Bindingåœ¨HMRä¸­çš„æ ¸å¿ƒé—®é¢˜</a></h3>
<pre><code class="language-mermaid">graph TD
    A[Module A&lt;br/&gt;é™æ€å¯¼å…¥] --&gt; B[Module B&lt;br/&gt;æ—§ç‰ˆæœ¬]
    C[HMRæ›´æ–°] --&gt; D[Module B'&lt;br/&gt;æ–°ç‰ˆæœ¬]
    
    A -.-&gt;|âŒ ä»ç„¶å¼•ç”¨| B
    D -.-&gt;|âœ… éœ€è¦é‡æ–°ç»‘å®š| A
    
    style B fill:#ff9999
    style D fill:#99ff99
    style A fill:#ffcc99
</code></pre>
<pre><code class="language-javascript">// é—®é¢˜ï¼šé™æ€å¯¼å…¥çš„live bindingåœ¨HMRä¸­å¤±æ•ˆ
import { calculateTotal, formatCurrency } from './utils.js';

class ProblematicShoppingCart {
    render() {
        // âŒ è¿™äº›å‡½æ•°å¼•ç”¨åœ¨HMRåä»ç„¶æŒ‡å‘æ—§ç‰ˆæœ¬ï¼
        const total = calculateTotal(this.items);      // æ—§ç‰ˆæœ¬
        const formattedTotal = formatCurrency(total);  // æ—§ç‰ˆæœ¬
    }
}

// HMRæ›´æ–°åï¼Œå³ä½¿utils.jsæ–‡ä»¶å†…å®¹æ”¹å˜äº†ï¼Œ
// calculateTotalå’ŒformatCurrencyä»ç„¶æ˜¯åˆå§‹å¯¼å…¥æ—¶çš„æ—§ç‰ˆæœ¬å‡½æ•°å¼•ç”¨
</code></pre>
<h3 id="åŸºäºproxyçš„live-bindingè§£å†³æ–¹æ¡ˆ"><a class="header" href="#åŸºäºproxyçš„live-bindingè§£å†³æ–¹æ¡ˆ">åŸºäºProxyçš„Live Bindingè§£å†³æ–¹æ¡ˆ</a></h3>
<pre><code class="language-javascript">// æ ¸å¿ƒï¼šæ¨¡å—ä»£ç†ç±»
class ModuleProxy {
    constructor(modulePath) {
        this.modulePath = modulePath;
        this.currentModule = null;
        this.isLoading = false;
        this.loadInitialModule();
    }
    
    async loadInitialModule() {
        this.currentModule = await import(this.modulePath);
    }
    
    // åˆ›å»ºä»£ç†å¯¹è±¡ï¼ŒåŠ¨æ€è½¬å‘åˆ°å½“å‰æ¨¡å—
    createProxy() {
        return new Proxy(this, {
            get(target, prop) {
                // å¤„ç†ç‰¹æ®Šå±æ€§
                if (prop === Symbol.toPrimitive || prop === 'valueOf' || prop === 'toString') {
                    return () =&gt; `[ModuleProxy: ${target.modulePath}]`;
                }
                
                if (target.currentModule &amp;&amp; prop in target.currentModule) {
                    const value = target.currentModule[prop];
                    
                    // å¦‚æœæ˜¯å‡½æ•°ï¼Œç»‘å®šæ­£ç¡®çš„thiså¹¶ä¿æŒä¸Šä¸‹æ–‡
                    if (typeof value === 'function') {
                        return function(...args) {
                            return value.apply(target.currentModule, args);
                        };
                    }
                    
                    // è¿”å›å…¶ä»–ç±»å‹çš„å€¼ï¼ˆå˜é‡ã€å¯¹è±¡ç­‰ï¼‰
                    return value;
                }
                
                return undefined;
            },
            
            // æ”¯æŒ 'prop' in proxy æ£€æŸ¥
            has(target, prop) {
                return target.currentModule &amp;&amp; prop in target.currentModule;
            },
            
            // æ”¯æŒ Object.keys(proxy) ç­‰æ“ä½œ
            ownKeys(target) {
                return target.currentModule ? Object.keys(target.currentModule) : [];
            },
            
            getOwnPropertyDescriptor(target, prop) {
                if (target.currentModule &amp;&amp; prop in target.currentModule) {
                    return Object.getOwnPropertyDescriptor(target.currentModule, prop);
                }
                return undefined;
            }
        });
    }
    
    // HMRæ›´æ–°æ—¶è°ƒç”¨
    async updateModule() {
        if (this.isLoading) return;
        
        this.isLoading = true;
        try {
            const versionedURL = `${this.modulePath}?hmr_version=${Date.now()}`;
            const newModule = await import(versionedURL);
            
            // ä¿å­˜æ—§æ¨¡å—ç”¨äºå¯¹æ¯”
            const oldModule = this.currentModule;
            this.currentModule = newModule;
            
            console.log('âœ… æ¨¡å—ä»£ç†å·²æ›´æ–°ï¼Œlive bindingå·²æ¢å¤');
            
            // å¯é€‰ï¼šè¾“å‡ºå˜æ›´ä¿¡æ¯
            this.logChanges(oldModule, newModule);
            
        } catch (error) {
            console.error('âŒ æ¨¡å—ä»£ç†æ›´æ–°å¤±è´¥:', error);
            throw error;
        } finally {
            this.isLoading = false;
        }
    }
    
    // å¯¹æ¯”å¹¶è¾“å‡ºæ¨¡å—å˜æ›´
    logChanges(oldModule, newModule) {
        if (!oldModule) return;
        
        const oldKeys = Object.keys(oldModule);
        const newKeys = Object.keys(newModule);
        
        const added = newKeys.filter(key =&gt; !oldKeys.includes(key));
        const removed = oldKeys.filter(key =&gt; !newKeys.includes(key));
        const changed = oldKeys.filter(key =&gt; {
            return newKeys.includes(key) &amp;&amp; oldModule[key] !== newModule[key];
        });
        
        if (added.length &gt; 0) console.log('â• æ–°å¢å¯¼å‡º:', added);
        if (removed.length &gt; 0) console.log('â– ç§»é™¤å¯¼å‡º:', removed);
        if (changed.length &gt; 0) console.log('ğŸ”„ å˜æ›´å¯¼å‡º:', changed);
    }
}
</code></pre>
<h3 id="å®é™…åº”ç”¨ç¤ºä¾‹"><a class="header" href="#å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</a></h3>
<pre><code class="language-javascript">// Module B: utils.js (è¢«ä¾èµ–çš„æ¨¡å—)
export function calculateTotal(items) {
    return items.reduce((sum, item) =&gt; sum + item.price * item.quantity, 0);
}

export function formatCurrency(amount) {
    return new Intl.NumberFormat('zh-CN', {
        style: 'currency',
        currency: 'CNY'
    }).format(amount);
}

// HMRå¤„ç†
if (import.meta.hot) {
    import.meta.hot.accept((newModule) =&gt; {
        console.log('ğŸ”„ utils.js å·²æ›´æ–°');
    });
}
</code></pre>
<pre><code class="language-javascript">// Module A: index.js - ä½¿ç”¨Proxyæ–¹æ¡ˆ
// åˆ›å»ºæ¨¡å—ä»£ç†
const utilsProxy = new ModuleProxy('./utils.js');
const utils = utilsProxy.createProxy();

class SmartShoppingCart {
    constructor() {
        this.items = [
            { id: 1, name: 'å•†å“A', price: 100, quantity: 2 },
            { id: 2, name: 'å•†å“B', price: 50, quantity: 1 }
        ];
        this.render();
    }
    
    render() {
        // âœ… é€šè¿‡ä»£ç†è®¿é—®ï¼Œå§‹ç»ˆè·å–æœ€æ–°ç‰ˆæœ¬çš„å‡½æ•°
        const total = utils.calculateTotal(this.items);
        const formattedTotal = utils.formatCurrency(total);
        
        document.getElementById('cart').innerHTML = `
            &lt;div&gt;è´­ç‰©è½¦æ€»è®¡: ${formattedTotal}&lt;/div&gt;
            &lt;div&gt;å•†å“æ•°é‡: ${this.items.length}&lt;/div&gt;
        `;
    }
}

// å…¨å±€å®ä¾‹ç®¡ç†
if (!window.__SMART_CART_INSTANCES__) {
    window.__SMART_CART_INSTANCES__ = [];
}

export function createShoppingCart() {
    const cart = new SmartShoppingCart();
    window.__SMART_CART_INSTANCES__.push(cart);
    return cart;
}

// HMRå¤„ç† - ä½¿ç”¨Proxyæ–¹æ¡ˆ
if (import.meta.hot) {
    import.meta.hot.accept(['./utils.js'], async () =&gt; {
        console.log('ğŸ“¦ utils.js å·²æ›´æ–°ï¼Œæ›´æ–°æ¨¡å—ä»£ç†...');
        
        // æ›´æ–°ä»£ç†æŒ‡å‘çš„æ¨¡å—
        await utilsProxy.updateModule();
        
        // é‡æ–°æ¸²æŸ“æ‰€æœ‰å®ä¾‹ï¼Œç°åœ¨ä¼šä½¿ç”¨æ–°ç‰ˆæœ¬çš„å‡½æ•°
        window.__SMART_CART_INSTANCES__.forEach(cart =&gt; {
            cart.render();
        });
    });
}
</code></pre>
<h3 id="å¢å¼ºç‰ˆproxyå·¥å‚"><a class="header" href="#å¢å¼ºç‰ˆproxyå·¥å‚">å¢å¼ºç‰ˆProxyå·¥å‚</a></h3>
<pre><code class="language-javascript">// é«˜çº§æ¨¡å—ä»£ç†å·¥å‚
class HMRModuleFactory {
    constructor() {
        this.proxies = new Map();
        this.hmrManager = new HMRManager();
    }
    
    // åˆ›å»ºæˆ–è·å–æ¨¡å—ä»£ç†
    create(modulePath) {
        if (this.proxies.has(modulePath)) {
            return this.proxies.get(modulePath);
        }
        
        const moduleProxy = new ModuleProxy(modulePath);
        const proxy = moduleProxy.createProxy();
        
        // æ³¨å†ŒHMRå›è°ƒ
        this.hmrManager.moduleSubscribers.set(modulePath, [
            async () =&gt; {
                await moduleProxy.updateModule();
                this.notifyUpdate(modulePath);
            }
        ]);
        
        this.proxies.set(modulePath, { proxy, moduleProxy });
        return proxy;
    }
    
    // é€šçŸ¥æ¨¡å—æ›´æ–°
    notifyUpdate(modulePath) {
        const event = new CustomEvent('hmr-module-updated', {
            detail: { modulePath, timestamp: Date.now() }
        });
        window.dispatchEvent(event);
    }
    
    // è·å–æ‰€æœ‰ä»£ç†çš„çŠ¶æ€
    getProxyStatus() {
        const status = {};
        for (const [path, { moduleProxy }] of this.proxies) {
            status[path] = {
                isLoaded: !!moduleProxy.currentModule,
                isLoading: moduleProxy.isLoading,
                exports: moduleProxy.currentModule ? Object.keys(moduleProxy.currentModule) : []
            };
        }
        return status;
    }
}

// å…¨å±€å·¥å‚å®ä¾‹
const moduleFactory = new HMRModuleFactory();

// ä¾¿æ·çš„æ¨¡å—å¯¼å…¥å‡½æ•°
function hmrImport(modulePath) {
    return moduleFactory.create(modulePath);
}

// ä½¿ç”¨ç¤ºä¾‹
const utils = hmrImport('./utils.js');
const config = hmrImport('./config.js');
const helpers = hmrImport('./helpers.js');

// ç›‘å¬æ¨¡å—æ›´æ–°äº‹ä»¶
window.addEventListener('hmr-module-updated', (event) =&gt; {
    console.log(`ğŸ“¦ æ¨¡å— ${event.detail.modulePath} å·²é€šè¿‡HMRæ›´æ–°`);
});
</code></pre>
<h2 id="hmrçš„é€‚ç”¨åœºæ™¯"><a class="header" href="#hmrçš„é€‚ç”¨åœºæ™¯">HMRçš„é€‚ç”¨åœºæ™¯</a></h2>
<h3 id="æŠ€æœ¯æ€§å˜æ›´-æ¨èä½¿ç”¨hmr"><a class="header" href="#æŠ€æœ¯æ€§å˜æ›´-æ¨èä½¿ç”¨hmr">æŠ€æœ¯æ€§å˜æ›´ (æ¨èä½¿ç”¨HMR)</a></h3>
<pre><code class="language-javascript">// âœ… æ€§èƒ½ä¼˜åŒ– - APIä¿æŒä¸å˜
// ä¼˜åŒ–å‰
export function calculateTotal(items) {
    let total = 0;
    for (let i = 0; i &lt; items.length; i++) {
        total += items[i].price * items[i].quantity;
    }
    return total;
}

// ä¼˜åŒ–å - ä½¿ç”¨æ›´é«˜æ•ˆçš„reduce
export function calculateTotal(items) {
    return items.reduce((sum, item) =&gt; sum + item.price * item.quantity, 0);
}
</code></pre>
<h3 id="ä¸é€‚ç”¨çš„åœºæ™¯-æ¨èå®Œæ•´åˆ·æ–°"><a class="header" href="#ä¸é€‚ç”¨çš„åœºæ™¯-æ¨èå®Œæ•´åˆ·æ–°">ä¸é€‚ç”¨çš„åœºæ™¯ (æ¨èå®Œæ•´åˆ·æ–°)</a></h3>
<pre><code class="language-javascript">// âŒ APIç­¾åå˜æ›´
// å˜æ›´å‰
export function calculateTotal(items) {
    return items.reduce((sum, item) =&gt; sum + item.price, 0);
}

// å˜æ›´å - ç­¾åæ”¹å˜ï¼Œè¿”å›å€¼ç±»å‹æ”¹å˜
export function calculateTotal(items, options = {}) {
    const { tax = 0, discount = 0 } = options;
    const subtotal = items.reduce((sum, item) =&gt; sum + item.price, 0);
    return {
        subtotal,
        tax: subtotal * tax,
        total: subtotal * (1 + tax - discount)
    };
}
</code></pre>
<h3 id="hmrå†³ç­–ç®¡ç†å™¨"><a class="header" href="#hmrå†³ç­–ç®¡ç†å™¨">HMRå†³ç­–ç®¡ç†å™¨</a></h3>
<p>// FIXME replace with markdown table</p>
<pre><code class="language-javascript">class HMRDecisionManager {
    shouldUseHMR(changeType, moduleInfo) {
        const reasons = {
            // æŠ€æœ¯æ€§å˜æ›´ - é€‚åˆHMR
            'performance_optimization': { useHMR: true, reason: 'æ€§èƒ½ä¼˜åŒ–ï¼ŒAPIä¸å˜' },
            'bug_fix': { useHMR: true, reason: 'Bugä¿®å¤ï¼Œé€»è¾‘ä¸€è‡´' },
            'code_refactoring': { useHMR: true, reason: 'ä»£ç é‡æ„ï¼Œæ¥å£ç¨³å®š' },
            'style_update': { useHMR: true, reason: 'æ ·å¼æ›´æ–°ï¼Œæ— å‰¯ä½œç”¨' },
            
            // ä¸šåŠ¡å˜æ›´ - éœ€è¦å®Œæ•´åˆ·æ–°
            'api_signature_change': { useHMR: false, reason: 'APIå˜æ›´ï¼Œé¿å…ç±»å‹é”™è¯¯' },
            'business_logic_change': { useHMR: false, reason: 'ä¸šåŠ¡é€»è¾‘å˜æ›´ï¼Œç¡®ä¿ä¸€è‡´æ€§' },
            'data_structure_change': { useHMR: false, reason: 'æ•°æ®ç»“æ„å˜æ›´ï¼Œé¿å…çŠ¶æ€å†²çª' }
        };
        
        const decision = reasons[changeType] || { 
            useHMR: true, 
            reason: 'é»˜è®¤å°è¯•HMRï¼Œå¤±è´¥æ—¶é™çº§' 
        };
        
        console.log(`ğŸ“‹ å˜æ›´ç±»å‹: ${changeType}`);
        console.log(`ğŸ¯ å†³ç­–: ${decision.useHMR ? 'ä½¿ç”¨HMR' : 'å®Œæ•´åˆ·æ–°'}`);
        console.log(`ğŸ’¡ åŸå› : ${decision.reason}`);
        
        return decision;
    }
}
</code></pre>
<h2 id="æ€»ç»“-6"><a class="header" href="#æ€»ç»“-6">æ€»ç»“</a></h2>
<p>çƒ­æ¨¡å—é‡è½½é€šè¿‡ä»¥ä¸‹æ ¸å¿ƒæœºåˆ¶å·¥ä½œï¼š</p>
<ol>
<li><strong>ğŸ”„ ç‰ˆæœ¬åŒ–URL</strong>: ç»•è¿‡æµè§ˆå™¨æ¨¡å—ç¼“å­˜ï¼Œç¡®ä¿è·å–æœ€æ–°æ¨¡å—</li>
<li><strong>ğŸ“¡ WebSocketé€šä¿¡</strong>: å®æ—¶æ–‡ä»¶å˜æ›´é€šçŸ¥ï¼Œä¿æŒå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ­¥</li>
<li><strong>ğŸ¯ Proxyä»£ç†</strong>: è§£å†³ESæ¨¡å—live bindingé—®é¢˜ï¼Œç¡®ä¿å¼•ç”¨å§‹ç»ˆæŒ‡å‘æœ€æ–°ç‰ˆæœ¬</li>
<li><strong>ğŸ’¾ çŠ¶æ€ä¿æŒ</strong>: ç»´æŒåº”ç”¨è¿è¡Œæ—¶çŠ¶æ€ï¼Œé¿å…å¼€å‘æ—¶æ•°æ®ä¸¢å¤±</li>
</ol>
<h3 id="å…³é”®ä¼˜åŠ¿"><a class="header" href="#å…³é”®ä¼˜åŠ¿">å…³é”®ä¼˜åŠ¿</a></h3>
<ul>
<li><strong>âš¡ å¿«é€Ÿåé¦ˆ</strong>: ä»£ç å˜æ›´å³æ—¶å¯è§</li>
<li><strong>ğŸ¯ ç²¾ç¡®æ›´æ–°</strong>: åªæ›´æ–°ä¿®æ”¹çš„æ¨¡å—</li>
<li><strong>ğŸ’¾ çŠ¶æ€ä¿æŒ</strong>: ä¿æŒåº”ç”¨çŠ¶æ€ä¸ä¸¢å¤±</li>
<li><strong>ğŸ”§ Live Binding</strong>: é€šè¿‡Proxyç¡®ä¿å§‹ç»ˆè®¿é—®æœ€æ–°æ¨¡å—</li>
</ul>
<h3 id="ä½¿ç”¨å»ºè®®"><a class="header" href="#ä½¿ç”¨å»ºè®®">ä½¿ç”¨å»ºè®®</a></h3>
<ol>
<li><strong>Proxyæ–¹æ¡ˆ</strong>: å¯¹äºå¤æ‚åº”ç”¨ï¼Œä½¿ç”¨åŸºäºProxyçš„æ¨¡å—ä»£ç†è§£å†³live bindingé—®é¢˜</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: ä¼˜å…ˆç”¨äºæŠ€æœ¯æ€§å˜æ›´ï¼ˆæ€§èƒ½ä¼˜åŒ–ã€bugä¿®å¤ã€ä»£ç é‡æ„ï¼‰</li>
<li><strong>è°¨æ…ä½¿ç”¨</strong>: é¿å…åœ¨ä¸šåŠ¡é€»è¾‘å˜æ›´å’ŒAPIç­¾åå˜åŒ–æ—¶ä½¿ç”¨HMR</li>
<li><strong>é”™è¯¯å¤„ç†</strong>: å®ç°å®Œå–„çš„é™çº§ç­–ç•¥å’Œé”™è¯¯æ¢å¤æœºåˆ¶</li>
</ol>
<p>HMRæ˜¯ç°ä»£å‰ç«¯å¼€å‘ä¸å¯æˆ–ç¼ºçš„å·¥å…·ï¼Œè€ŒåŸºäºProxyçš„live bindingè§£å†³æ–¹æ¡ˆä½¿å…¶åœ¨å¤æ‚åº”ç”¨ä¸­ä¹Ÿèƒ½ç¨³å®šå¯é åœ°å·¥ä½œã€‚</p>
<hr>
<p><strong>ä¸Šä¸€ç« </strong>: â† <a href="#æ¨¡å—è§£ææœºåˆ¶">æ¨¡å—è§£ææœºåˆ¶</a></p>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#å¾ªç¯ä¾èµ–å¤„ç†">å¾ªç¯ä¾èµ–å¤„ç†</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="å¾ªç¯ä¾èµ–å¤„ç†"><a class="header" href="#å¾ªç¯ä¾èµ–å¤„ç†">å¾ªç¯ä¾èµ–å¤„ç†</a></h1>
<p>å¾ªç¯ä¾èµ–æ˜¯æ¨¡å—åŒ–å¼€å‘ä¸­å¸¸è§ä½†å¤æ‚çš„é—®é¢˜ã€‚å½“ä¸¤ä¸ªæˆ–å¤šä¸ªæ¨¡å—ç›¸äº’ä¾èµ–æ—¶ï¼Œå°±å½¢æˆäº†å¾ªç¯ä¾èµ–ã€‚ESæ¨¡å—ç³»ç»Ÿå…·æœ‰å¤„ç†å¾ªç¯ä¾èµ–çš„èƒ½åŠ›ï¼Œä½†ç†è§£å…¶æœºåˆ¶å¹¶é‡‡ç”¨æ­£ç¡®çš„è®¾è®¡æ¨¡å¼å¯¹äºæ„å»ºå¥å£®çš„åº”ç”¨è‡³å…³é‡è¦ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–"><a class="header" href="#ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–">ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–</a></h2>
<h3 id="åŸºæœ¬æ¦‚å¿µ"><a class="header" href="#åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</a></h3>
<pre><code class="language-javascript">// ç®€å•çš„å¾ªç¯ä¾èµ–ç¤ºä¾‹

// moduleA.js
import { functionB } from './moduleB.js';

export function functionA() {
    console.log('Function A called');
    return functionB();
}

// moduleB.js  
import { functionA } from './moduleA.js';  // å¾ªç¯ä¾èµ–ï¼

export function functionB() {
    console.log('Function B called');
    return 'Result from B';
}

// main.js
import { functionA } from './moduleA.js';
functionA(); // è¿™å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜
</code></pre>
<h3 id="å¾ªç¯ä¾èµ–çš„ç±»å‹"><a class="header" href="#å¾ªç¯ä¾èµ–çš„ç±»å‹">å¾ªç¯ä¾èµ–çš„ç±»å‹</a></h3>
<pre><code class="language-javascript">// 1. ç›´æ¥å¾ªç¯ä¾èµ–ï¼ˆA â†’ B â†’ Aï¼‰
// a.js
import { b } from './b.js';
export const a = 'a';

// b.js
import { a } from './a.js';
export const b = 'b';

// 2. é—´æ¥å¾ªç¯ä¾èµ–ï¼ˆA â†’ B â†’ C â†’ Aï¼‰
// a.js
import { b } from './b.js';
export const a = 'a';

// b.js
import { c } from './c.js';
export const b = 'b';

// c.js
import { a } from './a.js';
export const c = 'c';

// 3. å¤æ‚å¾ªç¯ä¾èµ–ï¼ˆå¤šä¸ªæ¨¡å—å½¢æˆç¯ï¼‰
// user.js
import { Order } from './order.js';
import { Product } from './product.js';

// order.js
import { User } from './user.js';
import { Product } from './product.js';

// product.js
import { User } from './user.js';
import { Order } from './order.js';
</code></pre>
<h2 id="esæ¨¡å—ä¸­å¾ªç¯ä¾èµ–çš„è¡Œä¸º"><a class="header" href="#esæ¨¡å—ä¸­å¾ªç¯ä¾èµ–çš„è¡Œä¸º">ESæ¨¡å—ä¸­å¾ªç¯ä¾èµ–çš„è¡Œä¸º</a></h2>
<h3 id="1-æ¨¡å—åŠ è½½é¡ºåº"><a class="header" href="#1-æ¨¡å—åŠ è½½é¡ºåº">1. æ¨¡å—åŠ è½½é¡ºåº</a></h3>
<pre><code class="language-javascript">// æ¼”ç¤ºESæ¨¡å—å¦‚ä½•å¤„ç†å¾ªç¯ä¾èµ–

// a.js
console.log('a.js start');
import { b } from './b.js';
console.log('a.js - b imported:', b);
export const a = 'value-a';
console.log('a.js end');

// b.js
console.log('b.js start');
import { a } from './a.js';
// æ³¨æ„ï¼šåœ¨ç°ä»£Node.jsä¸­ï¼Œç›´æ¥è®¿é—®aä¼šæŠ›å‡ºReferenceError
// console.log('b.js - a imported:', a); // ReferenceError: Cannot access 'a' before initialization

// ä½¿ç”¨å‡½æ•°å»¶è¿Ÿè®¿é—®æ¥é¿å…TDZé”™è¯¯
export function getA() {
    return a; // è¿™é‡Œå¯ä»¥å®‰å…¨è®¿é—®ï¼Œå› ä¸ºè°ƒç”¨æ—¶aå·²ç»åˆå§‹åŒ–
}

export const b = 'value-b';
console.log('b.js end');

// main.js
import { a } from './a.js';
import { getA } from './b.js';
console.log('main.js - a:', a);
console.log('main.js - getA():', getA());

// æ‰§è¡Œç»“æœï¼š
// b.js start
// b.js end
// a.js start
// a.js - b imported: value-b
// a.js end
// main.js - a: value-a
// main.js - getA(): value-a
</code></pre>
<blockquote>
<p><strong>é‡è¦æç¤º</strong>:</p>
<ul>
<li>åœ¨ç°ä»£JavaScriptå¼•æ“ï¼ˆå¦‚Node.js v14+ï¼‰ä¸­ï¼Œç›´æ¥è®¿é—®æœªåˆå§‹åŒ–çš„ç»‘å®šä¼šæŠ›å‡º<code>ReferenceError</code>ï¼Œè¿™æ˜¯ç”±äºTemporal Dead Zone (TDZ)çš„ä¿æŠ¤æœºåˆ¶</li>
<li>æ—©æœŸçš„ESæ¨¡å—å®ç°å¯èƒ½è¿”å›<code>undefined</code>ï¼Œä½†ç°ä»£å®ç°æ›´åŠ ä¸¥æ ¼</li>
<li>æ¨èä½¿ç”¨å‡½æ•°å»¶è¿Ÿè®¿é—®æˆ–é‡æ„ä»£ç æ¥é¿å…å¾ªç¯ä¾èµ–é—®é¢˜</li>
</ul>
</blockquote>
<h4 id="æ‰§è¡Œé¡ºåºè§£æ"><a class="header" href="#æ‰§è¡Œé¡ºåºè§£æ">æ‰§è¡Œé¡ºåºè§£æ</a></h4>
<p>ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼š<strong>ä¸ºä»€ä¹ˆæ‰§è¡Œé¡ºåºæ˜¯ <code>b.js start</code> â†’ <code>a.js start</code> â†’ <code>main.js</code>ï¼Ÿ</strong></p>
<p>è¿™æ˜¯ESæ¨¡å—<strong>æ·±åº¦ä¼˜å…ˆåŠ è½½ç­–ç•¥</strong>çš„ç»“æœï¼š</p>
<ol>
<li><strong>main.js</strong> å¼€å§‹æ‰§è¡Œï¼Œé‡åˆ° <code>import { a } from './a.js'</code></li>
<li>å¼•æ“æš‚åœ main.jsï¼Œå¼€å§‹åŠ è½½ <strong>a.js</strong></li>
<li><strong>a.js</strong> æ‰§è¡Œï¼Œé‡åˆ° <code>import { b } from './b.js'</code></li>
<li>å¼•æ“æš‚åœ a.jsï¼Œå¼€å§‹åŠ è½½ <strong>b.js</strong></li>
<li><strong>b.js</strong> æ‰§è¡Œï¼Œé‡åˆ° <code>import { a } from './a.js'</code></li>
<li>å¼•æ“æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–ï¼ˆa.js å·²åœ¨åŠ è½½ä¸­ï¼‰ï¼Œåˆ›å»ºæœªåˆå§‹åŒ–ç»‘å®š</li>
<li><strong>b.js</strong> ç»§ç»­æ‰§è¡Œå®Œæˆ â†’ è¾“å‡º â€œb.js startâ€ å’Œ â€œb.js endâ€</li>
<li>è¿”å› <strong>a.js</strong> ç»§ç»­æ‰§è¡Œ â†’ è¾“å‡º â€œa.js startâ€ å’Œ â€œa.js endâ€</li>
<li>è¿”å› <strong>main.js</strong> ç»§ç»­æ‰§è¡Œ â†’ è¾“å‡ºæœ€ç»ˆç»“æœ</li>
</ol>
<p><strong>è°ƒç”¨æ ˆæ¼”ç¤ºï¼š</strong></p>
<pre><code>æ—¶é—´çº¿    è°ƒç”¨æ ˆçŠ¶æ€
T1:      [main.js]
T2:      [main.js, a.js]
T3:      [main.js, a.js, b.js]
T4:      [main.js, a.js, b.js] â† æ£€æµ‹å¾ªç¯ä¾èµ–
T5:      [main.js, a.js] â† b.js å®Œæˆ
T6:      [main.js] â† a.js å®Œæˆ
T7:      [] â† main.js å®Œæˆ
</code></pre>
<p>è¿™ç§<strong>åè¿›å…ˆå‡º</strong>çš„æ‰§è¡Œé¡ºåºæ˜¯ESæ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒç‰¹å¾ä¹‹ä¸€ã€‚</p>
<h3 id="2-ç»‘å®šçš„æ´»æ€§live-bindings"><a class="header" href="#2-ç»‘å®šçš„æ´»æ€§live-bindings">2. ç»‘å®šçš„æ´»æ€§ï¼ˆLive Bindingsï¼‰</a></h3>
<pre><code class="language-javascript">// å±•ç¤ºESæ¨¡å—æ´»ç»‘å®šå¦‚ä½•å¸®åŠ©å¤„ç†å¾ªç¯ä¾èµ–

// counter.js
console.log('counter.js loading');
import { increment } from './utils.js';

export let count = 0;

export function getCount() {
    return count;
}

export function setCount(value) {
    count = value;
}

// åˆå§‹åŒ–æ—¶è°ƒç”¨increment
increment();

// utils.js
console.log('utils.js loading');
import { count, setCount } from './counter.js';

export function increment() {
    console.log('increment called, current count:', count); // åˆå§‹æ—¶å¯èƒ½æ˜¯0
    setCount(count + 1);
}

// main.js
import { getCount } from './counter.js';
import { increment } from './utils.js';

console.log('Initial count:', getCount()); // 1
increment();
console.log('After increment:', getCount()); // 2
</code></pre>
<h2 id="æ£€æµ‹å¾ªç¯ä¾èµ–"><a class="header" href="#æ£€æµ‹å¾ªç¯ä¾èµ–">æ£€æµ‹å¾ªç¯ä¾èµ–</a></h2>
<h3 id="1-é™æ€åˆ†æå·¥å…·"><a class="header" href="#1-é™æ€åˆ†æå·¥å…·">1. é™æ€åˆ†æå·¥å…·</a></h3>
<pre><code class="language-javascript">// dependency-analyzer.js

class DependencyAnalyzer {
    constructor() {
        this.dependencies = new Map();
        this.visited = new Set();
        this.visiting = new Set();
    }
    
    addDependency(from, to) {
        if (!this.dependencies.has(from)) {
            this.dependencies.set(from, new Set());
        }
        this.dependencies.get(from).add(to);
    }
    
    findCircularDependencies() {
        const cycles = [];
        
        for (const module of this.dependencies.keys()) {
            if (!this.visited.has(module)) {
                const path = [];
                const cycle = this.dfs(module, path);
                if (cycle) {
                    cycles.push(cycle);
                }
            }
        }
        
        return cycles;
    }
    
    dfs(module, path) {
        if (this.visiting.has(module)) {
            // æ‰¾åˆ°å¾ªç¯ä¾èµ–
            const cycleStart = path.indexOf(module);
            return path.slice(cycleStart).concat([module]);
        }
        
        if (this.visited.has(module)) {
            return null;
        }
        
        this.visiting.add(module);
        path.push(module);
        
        const dependencies = this.dependencies.get(module) || new Set();
        for (const dep of dependencies) {
            const cycle = this.dfs(dep, [...path]);
            if (cycle) {
                return cycle;
            }
        }
        
        this.visiting.delete(module);
        this.visited.add(module);
        path.pop();
        
        return null;
    }
    
    generateReport() {
        const cycles = this.findCircularDependencies();
        
        if (cycles.length === 0) {
            return 'No circular dependencies found.';
        }
        
        let report = `Found ${cycles.length} circular dependency(ies):\n\n`;
        
        cycles.forEach((cycle, index) =&gt; {
            report += `${index + 1}. ${cycle.join(' â†’ ')}\n`;
        });
        
        return report;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const analyzer = new DependencyAnalyzer();

// æ·»åŠ ä¾èµ–å…³ç³»
analyzer.addDependency('user.js', 'order.js');
analyzer.addDependency('order.js', 'product.js');
analyzer.addDependency('product.js', 'user.js');

console.log(analyzer.generateReport());
// è¾“å‡º: Found 1 circular dependency(ies):
//       1. user.js â†’ order.js â†’ product.js â†’ user.js
</code></pre>
<h3 id="2-è¿è¡Œæ—¶æ£€æµ‹"><a class="header" href="#2-è¿è¡Œæ—¶æ£€æµ‹">2. è¿è¡Œæ—¶æ£€æµ‹</a></h3>
<pre><code class="language-javascript">// runtime-cycle-detector.js

class RuntimeCycleDetector {
    constructor() {
        this.importStack = [];
        this.importGraph = new Map();
    }
    
    beforeImport(modulePath, currentModule) {
        // æ£€æŸ¥æ˜¯å¦å½¢æˆå¾ªç¯
        if (this.importStack.includes(modulePath)) {
            const cycleStart = this.importStack.indexOf(modulePath);
            const cycle = this.importStack.slice(cycleStart).concat([modulePath]);
            
            console.warn('ğŸ”„ Circular dependency detected:', cycle.join(' â†’ '));
            
            // è®°å½•åˆ°å›¾ä¸­
            this.recordCycle(cycle);
            
            return true; // æ£€æµ‹åˆ°å¾ªç¯
        }
        
        this.importStack.push(modulePath);
        return false; // æœªæ£€æµ‹åˆ°å¾ªç¯
    }
    
    afterImport(modulePath) {
        const index = this.importStack.indexOf(modulePath);
        if (index !== -1) {
            this.importStack.splice(index, 1);
        }
    }
    
    recordCycle(cycle) {
        const cycleKey = cycle.slice().sort().join('|');
        if (!this.importGraph.has(cycleKey)) {
            this.importGraph.set(cycleKey, {
                cycle: cycle,
                count: 1,
                firstDetected: new Date()
            });
        } else {
            this.importGraph.get(cycleKey).count++;
        }
    }
    
    getReport() {
        const cycles = Array.from(this.importGraph.values());
        
        if (cycles.length === 0) {
            return 'No circular dependencies detected during runtime.';
        }
        
        let report = 'Runtime Circular Dependencies Report:\n\n';
        
        cycles.forEach((info, index) =&gt; {
            report += `${index + 1}. ${info.cycle.join(' â†’ ')}\n`;
            report += `   Detected ${info.count} time(s)\n`;
            report += `   First detected: ${info.firstDetected.toISOString()}\n\n`;
        });
        
        return report;
    }
}

// åˆ›å»ºå…¨å±€æ£€æµ‹å™¨å®ä¾‹
const cycleDetector = new RuntimeCycleDetector();

// æ¨¡æ‹Ÿå¯¼å…¥é’©å­ï¼ˆå®é™…å®ç°å¯èƒ½éœ€è¦æ„å»ºå·¥å…·æ”¯æŒï¼‰
function importWithDetection(modulePath, currentModule) {
    const hasCycle = cycleDetector.beforeImport(modulePath, currentModule);
    
    if (hasCycle) {
        console.log(`âš ï¸  Proceeding with import despite circular dependency: ${modulePath}`);
    }
    
    // æ‰§è¡Œå®é™…å¯¼å…¥
    const result = import(modulePath);
    
    cycleDetector.afterImport(modulePath);
    
    return result;
}
</code></pre>
<h2 id="å¾ªç¯ä¾èµ–çš„è§£å†³æ–¹æ¡ˆ"><a class="header" href="#å¾ªç¯ä¾èµ–çš„è§£å†³æ–¹æ¡ˆ">å¾ªç¯ä¾èµ–çš„è§£å†³æ–¹æ¡ˆ</a></h2>
<h3 id="1-é‡æ„æ¶ˆé™¤å¾ªç¯ä¾èµ–"><a class="header" href="#1-é‡æ„æ¶ˆé™¤å¾ªç¯ä¾èµ–">1. é‡æ„æ¶ˆé™¤å¾ªç¯ä¾èµ–</a></h3>
<pre><code class="language-javascript">// é—®é¢˜ï¼šç”¨æˆ·å’Œè®¢å•æ¨¡å—ç›¸äº’ä¾èµ–

// åŸå§‹è®¾è®¡ï¼ˆæœ‰å¾ªç¯ä¾èµ–ï¼‰
// user.js
import { Order } from './order.js';

export class User {
    constructor(id, name) {
        this.id = id;
        this.name = name;
    }
    
    getOrders() {
        return Order.findByUserId(this.id);
    }
}

// order.js
import { User } from './user.js';

export class Order {
    constructor(id, userId, amount) {
        this.id = id;
        this.userId = userId;
        this.amount = amount;
    }
    
    getUser() {
        return User.findById(this.userId);
    }
    
    static findByUserId(userId) {
        // æŸ¥æ‰¾é€»è¾‘
        return [];
    }
}

// è§£å†³æ–¹æ¡ˆ1ï¼šæå–åˆ°æœåŠ¡å±‚
// user.js
export class User {
    constructor(id, name) {
        this.id = id;
        this.name = name;
    }
}

// order.js
export class Order {
    constructor(id, userId, amount) {
        this.id = id;
        this.userId = userId;
        this.amount = amount;
    }
}

// user-service.js
import { User } from './user.js';
import { Order } from './order.js';

export class UserService {
    static async getUserWithOrders(userId) {
        const user = await User.findById(userId);
        const orders = await Order.findByUserId(userId);
        
        return {
            user,
            orders
        };
    }
    
    static async getOrderWithUser(orderId) {
        const order = await Order.findById(orderId);
        const user = await User.findById(order.userId);
        
        return {
            order,
            user
        };
    }
}
</code></pre>
<h3 id="2-ä¾èµ–æ³¨å…¥æ¨¡å¼"><a class="header" href="#2-ä¾èµ–æ³¨å…¥æ¨¡å¼">2. ä¾èµ–æ³¨å…¥æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// dependency-injection.js

// ç”¨æˆ·ä»“åº“
export class UserRepository {
    async findById(id) {
        // æ•°æ®åº“æŸ¥è¯¢é€»è¾‘
        return { id, name: `User ${id}` };
    }
    
    async findByIds(ids) {
        return ids.map(id =&gt; ({ id, name: `User ${id}` }));
    }
}

// è®¢å•ä»“åº“
export class OrderRepository {
    async findById(id) {
        return { id, userId: 1, amount: 100 };
    }
    
    async findByUserId(userId) {
        return [
            { id: 1, userId, amount: 100 },
            { id: 2, userId, amount: 200 }
        ];
    }
}

// ç”¨æˆ·æœåŠ¡ï¼ˆæ³¨å…¥è®¢å•ä»“åº“ï¼‰
export class UserService {
    constructor(orderRepository) {
        this.orderRepository = orderRepository;
    }
    
    async getUserOrders(userId) {
        return this.orderRepository.findByUserId(userId);
    }
}

// è®¢å•æœåŠ¡ï¼ˆæ³¨å…¥ç”¨æˆ·ä»“åº“ï¼‰
export class OrderService {
    constructor(userRepository) {
        this.userRepository = userRepository;
    }
    
    async getOrderUser(orderId) {
        const order = await this.findById(orderId);
        return this.userRepository.findById(order.userId);
    }
}

// åº”ç”¨ç»„è£…å™¨ï¼ˆæ— å¾ªç¯ä¾èµ–ï¼‰
// app.js
import { UserRepository } from './user-repository.js';
import { OrderRepository } from './order-repository.js';
import { UserService } from './user-service.js';
import { OrderService } from './order-service.js';

export function createServices() {
    const userRepository = new UserRepository();
    const orderRepository = new OrderRepository();
    
    const userService = new UserService(orderRepository);
    const orderService = new OrderService(userRepository);
    
    return {
        userService,
        orderService,
        userRepository,
        orderRepository
    };
}
</code></pre>
<h3 id="3-äº‹ä»¶é©±åŠ¨æ¨¡å¼"><a class="header" href="#3-äº‹ä»¶é©±åŠ¨æ¨¡å¼">3. äº‹ä»¶é©±åŠ¨æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// event-driven.js

// äº‹ä»¶æ€»çº¿
class EventBus {
    constructor() {
        this.listeners = new Map();
    }
    
    on(event, callback) {
        if (!this.listeners.has(event)) {
            this.listeners.set(event, []);
        }
        this.listeners.get(event).push(callback);
    }
    
    off(event, callback) {
        const callbacks = this.listeners.get(event);
        if (callbacks) {
            const index = callbacks.indexOf(callback);
            if (index &gt; -1) {
                callbacks.splice(index, 1);
            }
        }
    }
    
    emit(event, data) {
        const callbacks = this.listeners.get(event) || [];
        callbacks.forEach(callback =&gt; callback(data));
    }
}

export const eventBus = new EventBus();

// ç”¨æˆ·æ¨¡å—ï¼ˆä¸ç›´æ¥ä¾èµ–è®¢å•ï¼‰
import { eventBus } from './event-bus.js';

export class User {
    constructor(id, name) {
        this.id = id;
        this.name = name;
    }
    
    static create(userData) {
        const user = new User(userData.id, userData.name);
        
        // å‘å¸ƒç”¨æˆ·åˆ›å»ºäº‹ä»¶
        eventBus.emit('user:created', user);
        
        return user;
    }
    
    delete() {
        // å‘å¸ƒç”¨æˆ·åˆ é™¤äº‹ä»¶
        eventBus.emit('user:deleted', { userId: this.id });
    }
}

// è®¢å•æ¨¡å—ï¼ˆé€šè¿‡äº‹ä»¶å“åº”ç”¨æˆ·å˜åŒ–ï¼‰
import { eventBus } from './event-bus.js';

export class Order {
    constructor(id, userId, amount) {
        this.id = id;
        this.userId = userId;
        this.amount = amount;
    }
    
    static init() {
        // ç›‘å¬ç”¨æˆ·åˆ é™¤äº‹ä»¶
        eventBus.on('user:deleted', Order.handleUserDeleted);
    }
    
    static handleUserDeleted(data) {
        console.log(`Handling deletion of orders for user ${data.userId}`);
        // å¤„ç†ç”¨æˆ·åˆ é™¤åçš„è®¢å•æ¸…ç†é€»è¾‘
    }
}

// åˆå§‹åŒ–
Order.init();
</code></pre>
<h3 id="4-å»¶è¿Ÿå¯¼å…¥æ¨¡å¼"><a class="header" href="#4-å»¶è¿Ÿå¯¼å…¥æ¨¡å¼">4. å»¶è¿Ÿå¯¼å…¥æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// lazy-import.js

// ç”¨æˆ·æ¨¡å—
export class User {
    constructor(id, name) {
        this.id = id;
        this.name = name;
    }
    
    async getOrders() {
        // å»¶è¿Ÿå¯¼å…¥è®¢å•æ¨¡å—
        const { OrderService } = await import('./order-service.js');
        return OrderService.findByUserId(this.id);
    }
}

// è®¢å•æ¨¡å—
export class Order {
    constructor(id, userId, amount) {
        this.id = id;
        this.userId = userId;
        this.amount = amount;
    }
    
    async getUser() {
        // å»¶è¿Ÿå¯¼å…¥ç”¨æˆ·æ¨¡å—
        const { UserService } = await import('./user-service.js');
        return UserService.findById(this.userId);
    }
}

// è®¢å•æœåŠ¡
export class OrderService {
    static findByUserId(userId) {
        // æŸ¥æ‰¾é€»è¾‘
        return Promise.resolve([
            new Order(1, userId, 100),
            new Order(2, userId, 200)
        ]);
    }
}

// ç”¨æˆ·æœåŠ¡
export class UserService {
    static findById(userId) {
        // æŸ¥æ‰¾é€»è¾‘
        return Promise.resolve(new User(userId, `User ${userId}`));
    }
}
</code></pre>
<h3 id="5-ä¸­ä»‹è€…æ¨¡å¼"><a class="header" href="#5-ä¸­ä»‹è€…æ¨¡å¼">5. ä¸­ä»‹è€…æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// mediator-pattern.js

// ä¸­ä»‹è€…
export class AppMediator {
    constructor() {
        this.userService = null;
        this.orderService = null;
    }
    
    setUserService(userService) {
        this.userService = userService;
    }
    
    setOrderService(orderService) {
        this.orderService = orderService;
    }
    
    async getUserOrders(userId) {
        return this.orderService.findByUserId(userId);
    }
    
    async getOrderUser(orderId) {
        const order = await this.orderService.findById(orderId);
        return this.userService.findById(order.userId);
    }
    
    async getUserWithOrders(userId) {
        const user = await this.userService.findById(userId);
        const orders = await this.orderService.findByUserId(userId);
        
        return { user, orders };
    }
}

// åˆ›å»ºå…¨å±€ä¸­ä»‹è€…å®ä¾‹
export const mediator = new AppMediator();

// ç”¨æˆ·æœåŠ¡
import { mediator } from './mediator.js';

export class UserService {
    constructor() {
        mediator.setUserService(this);
    }
    
    async findById(id) {
        return { id, name: `User ${id}` };
    }
    
    async getUserOrders(userId) {
        return mediator.getUserOrders(userId);
    }
}

// è®¢å•æœåŠ¡
import { mediator } from './mediator.js';

export class OrderService {
    constructor() {
        mediator.setOrderService(this);
    }
    
    async findById(id) {
        return { id, userId: 1, amount: 100 };
    }
    
    async findByUserId(userId) {
        return [
            { id: 1, userId, amount: 100 },
            { id: 2, userId, amount: 200 }
        ];
    }
    
    async getOrderUser(orderId) {
        return mediator.getOrderUser(orderId);
    }
}
</code></pre>
<h2 id="æœ€ä½³å®è·µ"><a class="header" href="#æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</a></h2>
<h3 id="1-è®¾è®¡åŸåˆ™"><a class="header" href="#1-è®¾è®¡åŸåˆ™">1. è®¾è®¡åŸåˆ™</a></h3>
<pre><code class="language-javascript">// design-principles.js

// åŸåˆ™1ï¼šå•å‘ä¾èµ–
// âœ… å¥½çš„è®¾è®¡
// domain/user.js
export class User {
    constructor(id, name) {
        this.id = id;
        this.name = name;
    }
}

// domain/order.js
import { User } from './user.js';  // åªä¾èµ–Userï¼ŒUserä¸ä¾èµ–Order

export class Order {
    constructor(id, user, amount) {
        this.id = id;
        this.user = user;  // ç»„åˆå…³ç³»
        this.amount = amount;
    }
}

// åŸåˆ™2ï¼šä¾èµ–äºæŠ½è±¡è€Œéå…·ä½“å®ç°
// services/user-service.js
export class UserService {
    constructor(userRepository) {  // ä¾èµ–æŠ½è±¡æ¥å£
        this.userRepository = userRepository;
    }
    
    async createUser(userData) {
        return this.userRepository.save(userData);
    }
}

// åŸåˆ™3ï¼šåˆ†å±‚æ¶æ„
// è¡¨ç°å±‚ â†’ åº”ç”¨å±‚ â†’ é¢†åŸŸå±‚ â†’ åŸºç¡€è®¾æ–½å±‚
// ä¸Šå±‚å¯ä»¥ä¾èµ–ä¸‹å±‚ï¼Œä¸‹å±‚ä¸åº”ä¾èµ–ä¸Šå±‚
</code></pre>
<h3 id="2-æ¨¡å—ç»„ç»‡ç­–ç•¥"><a class="header" href="#2-æ¨¡å—ç»„ç»‡ç­–ç•¥">2. æ¨¡å—ç»„ç»‡ç­–ç•¥</a></h3>
<pre><code class="language-javascript">// module-organization.js

// ç­–ç•¥1ï¼šæŒ‰ç‰¹æ€§åˆ†ç»„ï¼ˆFeature-basedï¼‰
// features/
//   â”œâ”€â”€ user/
//   â”‚   â”œâ”€â”€ user.model.js
//   â”‚   â”œâ”€â”€ user.service.js
//   â”‚   â””â”€â”€ user.controller.js
//   â”œâ”€â”€ order/
//   â”‚   â”œâ”€â”€ order.model.js
//   â”‚   â”œâ”€â”€ order.service.js
//   â”‚   â””â”€â”€ order.controller.js
//   â””â”€â”€ shared/
//       â”œâ”€â”€ event-bus.js
//       â””â”€â”€ database.js

// ç­–ç•¥2ï¼šæŒ‰å±‚åˆ†ç»„ï¼ˆLayer-basedï¼‰
// src/
//   â”œâ”€â”€ models/
//   â”‚   â”œâ”€â”€ user.js
//   â”‚   â””â”€â”€ order.js
//   â”œâ”€â”€ services/
//   â”‚   â”œâ”€â”€ user-service.js
//   â”‚   â””â”€â”€ order-service.js
//   â”œâ”€â”€ controllers/
//   â”‚   â”œâ”€â”€ user-controller.js
//   â”‚   â””â”€â”€ order-controller.js
//   â””â”€â”€ shared/
//       â””â”€â”€ interfaces.js

// ç­–ç•¥3ï¼šæ··åˆæ–¹å¼
// src/
//   â”œâ”€â”€ core/              # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
//   â”‚   â”œâ”€â”€ user/
//   â”‚   â””â”€â”€ order/
//   â”œâ”€â”€ infrastructure/    # åŸºç¡€è®¾æ–½
//   â”‚   â”œâ”€â”€ database/
//   â”‚   â””â”€â”€ external-apis/
//   â”œâ”€â”€ application/       # åº”ç”¨æœåŠ¡
//   â”‚   â””â”€â”€ use-cases/
//   â””â”€â”€ presentation/      # è¡¨ç°å±‚
//       â””â”€â”€ controllers/
</code></pre>
<h3 id="3-å·¥å…·å’Œé…ç½®"><a class="header" href="#3-å·¥å…·å’Œé…ç½®">3. å·¥å…·å’Œé…ç½®</a></h3>
<pre><code class="language-javascript">// tools-config.js

// ESLinté…ç½®æ£€æµ‹å¾ªç¯å¯¼å…¥
// .eslintrc.js
module.exports = {
    plugins: ['import'],
    rules: {
        'import/no-cycle': ['error', { 
            maxDepth: 10,
            ignoreExternal: true 
        }]
    }
};

// Webpacké…ç½®æ˜¾ç¤ºå¾ªç¯ä¾èµ–è­¦å‘Š
// webpack.config.js
const CircularDependencyPlugin = require('circular-dependency-plugin');

module.exports = {
    plugins: [
        new CircularDependencyPlugin({
            exclude: /node_modules/,
            failOnError: true,
            allowAsyncCycles: false,
            cwd: process.cwd(),
        })
    ]
};

// è‡ªå®šä¹‰æ£€æµ‹è„šæœ¬
// scripts/check-cycles.js
const madge = require('madge');

madge('./src')
    .then((res) =&gt; {
        const circular = res.circular();
        if (circular.length &gt; 0) {
            console.error('Circular dependencies found:');
            circular.forEach((cycle) =&gt; {
                console.error('  ', cycle.join(' â†’ '));
            });
            process.exit(1);
        } else {
            console.log('âœ… No circular dependencies found');
        }
    })
    .catch((err) =&gt; {
        console.error('Error analyzing dependencies:', err);
        process.exit(1);
    });
</code></pre>
<h2 id="æ€»ç»“-7"><a class="header" href="#æ€»ç»“-7">æ€»ç»“</a></h2>
<p>å¾ªç¯ä¾èµ–è™½ç„¶åœ¨ESæ¨¡å—ä¸­ä¸ä¼šç›´æ¥å¯¼è‡´é”™è¯¯ï¼Œä½†ä¼šå¢åŠ ä»£ç çš„å¤æ‚æ€§å’Œç»´æŠ¤éš¾åº¦ï¼š</p>
<ul>
<li>âœ… <strong>ç†è§£ESæ¨¡å—è¡Œä¸º</strong>: æŒæ¡æ¨¡å—åŠ è½½é¡ºåºå’Œæ´»ç»‘å®šæœºåˆ¶</li>
<li>âœ… <strong>åŠæ—©æ£€æµ‹</strong>: ä½¿ç”¨å·¥å…·åœ¨å¼€å‘é˜¶æ®µå‘ç°å¾ªç¯ä¾èµ–</li>
<li>âœ… <strong>é‡æ„è®¾è®¡</strong>: é€šè¿‡åˆ†å±‚ã€ä¾èµ–æ³¨å…¥ç­‰æ¨¡å¼æ¶ˆé™¤å¾ªç¯ä¾èµ–</li>
<li>âœ… <strong>é‡‡ç”¨æœ€ä½³å®è·µ</strong>: éµå¾ªå•å‘ä¾èµ–å’Œåˆ†å±‚æ¶æ„åŸåˆ™</li>
<li>âœ… <strong>é€‰æ‹©åˆé€‚ç­–ç•¥</strong>: æ ¹æ®é¡¹ç›®ç‰¹ç‚¹é€‰æ‹©é€‚å½“çš„è§£å†³æ–¹æ¡ˆ</li>
</ul>
<p>è‰¯å¥½çš„æ¨¡å—è®¾è®¡åº”è¯¥é¿å…å¾ªç¯ä¾èµ–ï¼Œè¿™ä¸ä»…æé«˜äº†ä»£ç çš„å¯æµ‹è¯•æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä¹Ÿä½¿åº”ç”¨æ¶æ„æ›´åŠ æ¸…æ™°å’Œç¨³å®šã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#commonjsåŸºç¡€">CommonJSåŸºç¡€</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="commonjsåŸºç¡€"><a class="header" href="#commonjsåŸºç¡€">CommonJSåŸºç¡€</a></h1>
<p>CommonJSæ˜¯Node.jsé‡‡ç”¨çš„æ¨¡å—ç³»ç»Ÿï¼Œä¹Ÿæ˜¯JavaScriptæ¨¡å—åŒ–å†å²ä¸Šæœ€é‡è¦çš„è§„èŒƒä¹‹ä¸€ã€‚è™½ç„¶ESæ¨¡å—æ˜¯ç°ä»£æ ‡å‡†ï¼Œä½†ç†è§£CommonJSä»ç„¶è‡³å…³é‡è¦ï¼Œå› ä¸ºå¤§é‡çš„Node.jsä»£ç å’ŒnpmåŒ…ä»åœ¨ä½¿ç”¨è¿™ç§æ¨¡å—ç³»ç»Ÿã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯commonjs"><a class="header" href="#ä»€ä¹ˆæ˜¯commonjs">ä»€ä¹ˆæ˜¯CommonJS</a></h2>
<h3 id="èƒŒæ™¯å’Œå†å²"><a class="header" href="#èƒŒæ™¯å’Œå†å²">èƒŒæ™¯å’Œå†å²</a></h3>
<p>CommonJSè§„èŒƒäº2009å¹´è¯ç”Ÿï¼Œç›®æ ‡æ˜¯ä¸ºJavaScriptæä¾›ä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„æ¨¡å—ç³»ç»Ÿã€‚åœ¨ES6æ¨¡å—å‡ºç°ä¹‹å‰ï¼ŒCommonJSæ˜¯JavaScriptæ¨¡å—åŒ–çš„äº‹å®æ ‡å‡†ã€‚</p>
<pre><code class="language-javascript">// CommonJSçš„æ ¸å¿ƒç†å¿µ
// 1. æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªæ¨¡å—
// 2. æ¨¡å—å†…çš„å˜é‡å’Œå‡½æ•°é»˜è®¤æ˜¯ç§æœ‰çš„
// 3. é€šè¿‡module.exportså¯¼å‡º
// 4. é€šè¿‡require()å¯¼å…¥
// 5. åŒæ­¥åŠ è½½æ¨¡å—
</code></pre>
<h3 id="æ ¸å¿ƒç‰¹æ€§"><a class="header" href="#æ ¸å¿ƒç‰¹æ€§">æ ¸å¿ƒç‰¹æ€§</a></h3>
<ul>
<li><strong>åŒæ­¥åŠ è½½</strong>: æ¨¡å—åœ¨requireæ—¶åŒæ­¥åŠ è½½å’Œæ‰§è¡Œ</li>
<li><strong>ç¼“å­˜æœºåˆ¶</strong>: æ¨¡å—åªæ‰§è¡Œä¸€æ¬¡ï¼Œåç»­requireè¿”å›ç¼“å­˜ç»“æœ</li>
<li><strong>åŠ¨æ€åŠ è½½</strong>: å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€requireæ¨¡å—</li>
<li><strong>ç®€å•æ˜“ç”¨</strong>: è¯­æ³•ç®€æ´ï¼Œå­¦ä¹ æˆæœ¬ä½</li>
<li><strong>Node.jsåŸç”Ÿæ”¯æŒ</strong>: Node.jså†…ç½®æ”¯æŒï¼Œæ— éœ€é¢å¤–é…ç½®</li>
</ul>
<h2 id="åŸºæœ¬è¯­æ³•-2"><a class="header" href="#åŸºæœ¬è¯­æ³•-2">åŸºæœ¬è¯­æ³•</a></h2>
<h3 id="1-æ¨¡å—å¯¼å‡º"><a class="header" href="#1-æ¨¡å—å¯¼å‡º">1. æ¨¡å—å¯¼å‡º</a></h3>
<pre><code class="language-javascript">// math.js - åŸºæœ¬å¯¼å‡ºç¤ºä¾‹

// æ–¹å¼1: ç›´æ¥ç»™exportsæ·»åŠ å±æ€§
exports.add = function(a, b) {
    return a + b;
};

exports.subtract = function(a, b) {
    return a - b;
};

exports.PI = 3.14159;

// æ–¹å¼2: ä½¿ç”¨module.exports
module.exports.multiply = function(a, b) {
    return a * b;
};

// æ–¹å¼3: æ•´ä½“æ›¿æ¢module.exports
module.exports = {
    divide: function(a, b) {
        if (b === 0) {
            throw new Error('Division by zero');
        }
        return a / b;
    },
    power: function(base, exponent) {
        return Math.pow(base, exponent);
    }
};

// æ³¨æ„: ä¸€æ—¦æ•´ä½“æ›¿æ¢module.exportsï¼Œä¹‹å‰çš„exports.*éƒ½ä¼šå¤±æ•ˆ
</code></pre>
<h3 id="2-æ¨¡å—å¯¼å…¥"><a class="header" href="#2-æ¨¡å—å¯¼å…¥">2. æ¨¡å—å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// app.js - åŸºæœ¬å¯¼å…¥ç¤ºä¾‹

// å¯¼å…¥æ•´ä¸ªæ¨¡å—
const math = require('./math');
console.log(math.add(2, 3)); // 5

// è§£æ„å¯¼å…¥ç‰¹å®šå‡½æ•°
const { add, subtract, PI } = require('./math');
console.log(add(5, 3)); // 8
console.log(PI); // 3.14159

// å¯¼å…¥å¹¶é‡å‘½å
const { add: sum, subtract: diff } = require('./math');
console.log(sum(10, 5)); // 15
console.log(diff(10, 5)); // 5

// å¯¼å…¥å†…ç½®æ¨¡å—
const fs = require('fs');
const path = require('path');
const http = require('http');

// å¯¼å…¥npmåŒ…
const lodash = require('lodash');
const express = require('express');
</code></pre>
<h3 id="3-ä¸åŒçš„å¯¼å‡ºæ¨¡å¼"><a class="header" href="#3-ä¸åŒçš„å¯¼å‡ºæ¨¡å¼">3. ä¸åŒçš„å¯¼å‡ºæ¨¡å¼</a></h3>
<pre><code class="language-javascript">// user.js - ç±»å¯¼å‡ºç¤ºä¾‹
class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    getInfo() {
        return `${this.name} &lt;${this.email}&gt;`;
    }
}

// å¯¼å‡ºç±»
module.exports = User;

// config.js - å¯¹è±¡å¯¼å‡ºç¤ºä¾‹
const config = {
    database: {
        host: 'localhost',
        port: 5432,
        name: 'myapp'
    },
    server: {
        port: 3000,
        env: process.env.NODE_ENV || 'development'
    },
    secrets: {
        jwtSecret: process.env.JWT_SECRET || 'default-secret'
    }
};

module.exports = config;

// utils.js - å‡½æ•°é›†åˆå¯¼å‡º
function formatDate(date) {
    return date.toISOString().split('T')[0];
}

function isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function generateId() {
    return Math.random().toString(36).substr(2, 9);
}

// æ‰¹é‡å¯¼å‡º
module.exports = {
    formatDate,
    isValidEmail,
    generateId
};

// logger.js - å•å‡½æ•°å¯¼å‡º
function createLogger(level = 'info') {
    return {
        info: (message) =&gt; console.log(`[INFO] ${message}`),
        warn: (message) =&gt; console.warn(`[WARN] ${message}`),
        error: (message) =&gt; console.error(`[ERROR] ${message}`)
    };
}

module.exports = createLogger;
</code></pre>
<h2 id="exports-vs-moduleexports"><a class="header" href="#exports-vs-moduleexports">exports vs module.exports</a></h2>
<h3 id="ç†è§£ä¸¤è€…çš„å…³ç³»"><a class="header" href="#ç†è§£ä¸¤è€…çš„å…³ç³»">ç†è§£ä¸¤è€…çš„å…³ç³»</a></h3>
<pre><code class="language-javascript">// ç†è§£exportså’Œmodule.exportsçš„å…³ç³»

// Node.jså†…éƒ¨çš„æ¨¡å—åŒ…è£…å™¨å¤§è‡´å¦‚ä¸‹ï¼š
function wrapModule(moduleCode) {
    return `
    (function(exports, require, module, __filename, __dirname) {
        ${moduleCode}
        return module.exports;
    });
    `;
}

// åˆå§‹çŠ¶æ€ä¸‹ï¼šexports === module.exports
console.log(exports === module.exports); // true

// exportsæ˜¯module.exportsçš„å¼•ç”¨
// æ‰€ä»¥ä¸‹é¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ï¼š
exports.hello = 'world';
module.exports.hello = 'world';
</code></pre>
<h3 id="å¸¸è§é™·é˜±"><a class="header" href="#å¸¸è§é™·é˜±">å¸¸è§é™·é˜±</a></h3>
<pre><code class="language-javascript">// trap.js - å¸¸è§é™·é˜±ç¤ºä¾‹

// âŒ é”™è¯¯ç”¨æ³•1: ç›´æ¥ç»™exportsèµ‹å€¼
exports = {
    name: 'John',
    age: 30
};
// è¿™æ ·åšåªæ˜¯æ”¹å˜äº†exportsçš„æŒ‡å‘ï¼Œä¸ä¼šå½±å“module.exports

// âŒ é”™è¯¯ç”¨æ³•2: æ··ç”¨exportså’Œmodule.exports
exports.method1 = function() { return 'method1'; };
module.exports = {
    method2: function() { return 'method2'; }
};
// module.exportsä¼šè¦†ç›–exportsçš„è®¾ç½®

// âœ… æ­£ç¡®ç”¨æ³•1: å§‹ç»ˆä½¿ç”¨exportsæ·»åŠ å±æ€§
exports.method1 = function() { return 'method1'; };
exports.method2 = function() { return 'method2'; };

// âœ… æ­£ç¡®ç”¨æ³•2: å§‹ç»ˆä½¿ç”¨module.exports
module.exports = {
    method1: function() { return 'method1'; },
    method2: function() { return 'method2'; }
};

// âœ… æ­£ç¡®ç”¨æ³•3: å…ˆè®¾ç½®module.exportsï¼Œå†ä½¿ç”¨exports
module.exports = {};
exports.method1 = function() { return 'method1'; };
exports.method2 = function() { return 'method2'; };
</code></pre>
<h2 id="æ¨¡å—åŠ è½½æœºåˆ¶"><a class="header" href="#æ¨¡å—åŠ è½½æœºåˆ¶">æ¨¡å—åŠ è½½æœºåˆ¶</a></h2>
<h3 id="1-åŒæ­¥åŠ è½½"><a class="header" href="#1-åŒæ­¥åŠ è½½">1. åŒæ­¥åŠ è½½</a></h3>
<pre><code class="language-javascript">// sync-loading.js

console.log('Before require');

// requireæ˜¯åŒæ­¥çš„ï¼Œä¼šé˜»å¡ä»£ç æ‰§è¡Œ
const largeModule = require('./large-module');

console.log('After require');

// large-module.js
console.log('Large module loading...');
// æ¨¡æ‹Ÿå¤§é‡è®¡ç®—
for (let i = 0; i &lt; 1000000; i++) {
    // å¤§é‡è®¡ç®—
}
console.log('Large module loaded');

module.exports = {
    data: 'some data'
};

// è¾“å‡ºé¡ºåºï¼š
// Before require
// Large module loading...
// Large module loaded
// After require
</code></pre>
<h3 id="2-æ¨¡å—ç¼“å­˜-1"><a class="header" href="#2-æ¨¡å—ç¼“å­˜-1">2. æ¨¡å—ç¼“å­˜</a></h3>
<pre><code class="language-javascript">// cache-demo.js

// ç¬¬ä¸€æ¬¡requireä¼šæ‰§è¡Œæ¨¡å—ä»£ç 
const module1 = require('./counter');
console.log('First require:', module1.getCount()); // 0

module1.increment();
console.log('After increment:', module1.getCount()); // 1

// ç¬¬äºŒæ¬¡requireè¿”å›ç¼“å­˜çš„æ¨¡å—
const module2 = require('./counter');
console.log('Second require:', module2.getCount()); // 1 (ä¸æ˜¯0ï¼)

console.log(module1 === module2); // true (åŒä¸€ä¸ªå¯¹è±¡)

// counter.js
console.log('Counter module executing...');

let count = 0;

module.exports = {
    increment() {
        count++;
    },
    getCount() {
        return count;
    }
};
</code></pre>
<h3 id="3-æ¸…é™¤æ¨¡å—ç¼“å­˜"><a class="header" href="#3-æ¸…é™¤æ¨¡å—ç¼“å­˜">3. æ¸…é™¤æ¨¡å—ç¼“å­˜</a></h3>
<pre><code class="language-javascript">// cache-management.js

// æŸ¥çœ‹æ¨¡å—ç¼“å­˜
console.log('Cached modules:', Object.keys(require.cache));

// åŠ è½½æ¨¡å—
const myModule = require('./my-module');

// æ¸…é™¤ç‰¹å®šæ¨¡å—ç¼“å­˜
delete require.cache[require.resolve('./my-module')];

// é‡æ–°åŠ è½½æ¨¡å—ï¼ˆä¼šé‡æ–°æ‰§è¡Œæ¨¡å—ä»£ç ï¼‰
const reloadedModule = require('./my-module');

// æ¸…é™¤æ‰€æœ‰ç¼“å­˜ï¼ˆä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼‰
function clearAllCache() {
    Object.keys(require.cache).forEach(key =&gt; {
        delete require.cache[key];
    });
}

// å®‰å…¨çš„æ¨¡å—é‡è½½å‡½æ•°
function safeReload(modulePath) {
    try {
        // è§£ææ¨¡å—è·¯å¾„
        const resolvedPath = require.resolve(modulePath);
        
        // åˆ é™¤ç¼“å­˜
        delete require.cache[resolvedPath];
        
        // é‡æ–°åŠ è½½
        return require(modulePath);
    } catch (error) {
        console.error('Failed to reload module:', error);
        return null;
    }
}
</code></pre>
<h2 id="æ¨¡å—è§£æç®—æ³•"><a class="header" href="#æ¨¡å—è§£æç®—æ³•">æ¨¡å—è§£æç®—æ³•</a></h2>
<h3 id="1-è§£æè§„åˆ™"><a class="header" href="#1-è§£æè§„åˆ™">1. è§£æè§„åˆ™</a></h3>
<pre><code class="language-javascript">// Node.jsæ¨¡å—è§£æç®—æ³•ç¤ºä¾‹

// 1. æ ¸å¿ƒæ¨¡å—ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
const fs = require('fs');          // ç›´æ¥åŠ è½½Node.jså†…ç½®æ¨¡å—
const path = require('path');      // å†…ç½®æ¨¡å—ä¸éœ€è¦è·¯å¾„

// 2. ç›¸å¯¹è·¯å¾„æ¨¡å—
const myModule = require('./my-module');     // ./my-module.js
const subModule = require('./sub/module');   // ./sub/module.js
const parentModule = require('../parent');   // ../parent.js

// 3. ç»å¯¹è·¯å¾„æ¨¡å—
const absoluteModule = require('/home/user/app/module');

// 4. node_modulesä¸­çš„æ¨¡å—
const lodash = require('lodash');           // node_modules/lodash
const express = require('express');         // node_modules/express

// Node.jsæŸ¥æ‰¾node_modulesçš„é¡ºåºï¼š
// ./node_modules/module-name
// ../node_modules/module-name
// ../../node_modules/module-name
// ... ä¸€ç›´åˆ°æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•
</code></pre>
<h3 id="2-æ–‡ä»¶æ‰©å±•åè§£æ"><a class="header" href="#2-æ–‡ä»¶æ‰©å±•åè§£æ">2. æ–‡ä»¶æ‰©å±•åè§£æ</a></h3>
<pre><code class="language-javascript">// extension-resolution.js

// Node.jsä¼šæŒ‰ä»¥ä¸‹é¡ºåºå°è¯•æ‰©å±•åï¼š

// require('./module') ä¼šä¾æ¬¡å°è¯•ï¼š
// 1. ./module.js
// 2. ./module.json
// 3. ./module.node

// å¦‚æœä¸Šè¿°éƒ½ä¸å­˜åœ¨ï¼Œä¼šå°è¯•ç›®å½•ï¼š
// 4. ./module/package.json (æŸ¥æ‰¾mainå­—æ®µ)
// 5. ./module/index.js
// 6. ./module/index.json
// 7. ./module/index.node

// æ¼”ç¤ºä¸åŒç±»å‹çš„æ¨¡å—åŠ è½½
const jsModule = require('./utils');        // utils.js
const jsonConfig = require('./config');     // config.json
const packageModule = require('./my-package'); // my-package/index.js

// config.json
{
    "name": "my-app",
    "version": "1.0.0",
    "database": {
        "host": "localhost",
        "port": 5432
    }
}

// my-package/package.json
{
    "name": "my-package",
    "main": "lib/index.js"
}
</code></pre>
<h3 id="3-packagejsonçš„ä½œç”¨"><a class="header" href="#3-packagejsonçš„ä½œç”¨">3. package.jsonçš„ä½œç”¨</a></h3>
<pre><code class="language-javascript">// package-resolution.js

// package.jsonç¤ºä¾‹
{
    "name": "my-library",
    "version": "1.0.0",
    "main": "dist/index.js",        // CommonJSå…¥å£
    "module": "dist/index.esm.js",  // ESæ¨¡å—å…¥å£
    "exports": {                     // æ–°çš„å¯¼å‡ºå­—æ®µ
        ".": {
            "require": "./dist/index.js",
            "import": "./dist/index.esm.js"
        },
        "./utils": "./dist/utils.js"
    },
    "files": ["dist/"]
}

// å½“require('my-library')æ—¶ï¼ŒNode.jsä¼šï¼š
// 1. æŸ¥æ‰¾node_modules/my-library/package.json
// 2. è¯»å–mainå­—æ®µå€¼ï¼šdist/index.js
// 3. åŠ è½½node_modules/my-library/dist/index.js
</code></pre>
<h2 id="commonjsçš„é«˜çº§ç‰¹æ€§"><a class="header" href="#commonjsçš„é«˜çº§ç‰¹æ€§">CommonJSçš„é«˜çº§ç‰¹æ€§</a></h2>
<h3 id="1-åŠ¨æ€require"><a class="header" href="#1-åŠ¨æ€require">1. åŠ¨æ€require</a></h3>
<pre><code class="language-javascript">// dynamic-require.js

// åŸºäºæ¡ä»¶çš„åŠ¨æ€åŠ è½½
const environment = process.env.NODE_ENV || 'development';

let config;
if (environment === 'production') {
    config = require('./config/production');
} else if (environment === 'test') {
    config = require('./config/test');
} else {
    config = require('./config/development');
}

// åŸºäºç”¨æˆ·è¾“å…¥çš„åŠ¨æ€åŠ è½½
function loadPlugin(pluginName) {
    try {
        const plugin = require(`./plugins/${pluginName}`);
        return plugin;
    } catch (error) {
        console.error(`Failed to load plugin: ${pluginName}`, error);
        return null;
    }
}

// æ‰¹é‡åŠ è½½æ¨¡å—
function loadModules(moduleNames) {
    const modules = {};
    
    moduleNames.forEach(name =&gt; {
        try {
            modules[name] = require(`./modules/${name}`);
        } catch (error) {
            console.warn(`Failed to load module: ${name}`);
        }
    });
    
    return modules;
}

// ä½¿ç”¨ç¤ºä¾‹
const plugins = ['auth', 'logger', 'database'];
const loadedModules = loadModules(plugins);
</code></pre>
<h3 id="2-æ¡ä»¶å¯¼å‡º-1"><a class="header" href="#2-æ¡ä»¶å¯¼å‡º-1">2. æ¡ä»¶å¯¼å‡º</a></h3>
<pre><code class="language-javascript">// conditional-exports.js

// åŸºäºç¯å¢ƒçš„æ¡ä»¶å¯¼å‡º
if (process.env.NODE_ENV === 'development') {
    // å¼€å‘ç¯å¢ƒï¼šå¯¼å‡ºè¯¦ç»†çš„è°ƒè¯•ç‰ˆæœ¬
    module.exports = {
        log: console.log,
        debug: console.debug,
        warn: console.warn,
        error: console.error,
        trace: console.trace
    };
} else {
    // ç”Ÿäº§ç¯å¢ƒï¼šå¯¼å‡ºç®€åŒ–ç‰ˆæœ¬
    module.exports = {
        log: () =&gt; {}, // ç©ºæ“ä½œ
        debug: () =&gt; {},
        warn: console.warn,
        error: console.error,
        trace: () =&gt; {}
    };
}

// åŸºäºåŠŸèƒ½æ£€æµ‹çš„æ¡ä»¶å¯¼å‡º
const hasFileSystem = (() =&gt; {
    try {
        require('fs');
        return true;
    } catch {
        return false;
    }
})();

if (hasFileSystem) {
    module.exports = require('./file-storage');
} else {
    module.exports = require('./memory-storage');
}
</code></pre>
<h3 id="3-æ¨¡å—å·¥å‚æ¨¡å¼"><a class="header" href="#3-æ¨¡å—å·¥å‚æ¨¡å¼">3. æ¨¡å—å·¥å‚æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// factory-pattern.js

// æ¨¡å—å·¥å‚ï¼šæ ¹æ®å‚æ•°åˆ›å»ºä¸åŒçš„å®ä¾‹
function createLogger(options = {}) {
    const {
        level = 'info',
        prefix = '',
        timestamp = true
    } = options;
    
    const levels = {
        debug: 0,
        info: 1,
        warn: 2,
        error: 3
    };
    
    const currentLevel = levels[level] || 1;
    
    function log(targetLevel, message) {
        if (levels[targetLevel] &gt;= currentLevel) {
            const time = timestamp ? new Date().toISOString() : '';
            const fullMessage = `${time} ${prefix} [${targetLevel.toUpperCase()}] ${message}`;
            console.log(fullMessage);
        }
    }
    
    return {
        debug: (msg) =&gt; log('debug', msg),
        info: (msg) =&gt; log('info', msg),
        warn: (msg) =&gt; log('warn', msg),
        error: (msg) =&gt; log('error', msg)
    };
}

module.exports = createLogger;

// ä½¿ç”¨å·¥å‚æ¨¡å¼
const logger = require('./logger-factory')({
    level: 'debug',
    prefix: '[MyApp]',
    timestamp: true
});

logger.info('Application started');
</code></pre>
<h3 id="4-æ¨¡å—å•ä¾‹æ¨¡å¼"><a class="header" href="#4-æ¨¡å—å•ä¾‹æ¨¡å¼">4. æ¨¡å—å•ä¾‹æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// singleton-pattern.js

// å•ä¾‹æ•°æ®åº“è¿æ¥
class Database {
    constructor() {
        if (Database.instance) {
            return Database.instance;
        }
        
        this.connection = null;
        this.connected = false;
        Database.instance = this;
    }
    
    connect(connectionString) {
        if (!this.connected) {
            console.log('Connecting to database...');
            this.connection = { connectionString };
            this.connected = true;
        }
        return this.connection;
    }
    
    query(sql) {
        if (!this.connected) {
            throw new Error('Database not connected');
        }
        console.log(`Executing query: ${sql}`);
        return Promise.resolve([]);
    }
}

// å¯¼å‡ºå•ä¾‹å®ä¾‹
module.exports = new Database();

// åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹
const db1 = require('./database');
const db2 = require('./database');
console.log(db1 === db2); // true
</code></pre>
<h2 id="nodejsç‰¹æœ‰åŠŸèƒ½"><a class="header" href="#nodejsç‰¹æœ‰åŠŸèƒ½">Node.jsç‰¹æœ‰åŠŸèƒ½</a></h2>
<h3 id="1-å…¨å±€å˜é‡"><a class="header" href="#1-å…¨å±€å˜é‡">1. å…¨å±€å˜é‡</a></h3>
<pre><code class="language-javascript">// globals-demo.js

console.log('Module information:');
console.log('__filename:', __filename);    // å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
console.log('__dirname:', __dirname);      // å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„
console.log('module.id:', module.id);      // æ¨¡å—æ ‡è¯†ç¬¦
console.log('module.filename:', module.filename); // åŒ__filename
console.log('module.loaded:', module.loaded);     // æ¨¡å—æ˜¯å¦å·²åŠ è½½å®Œæˆ
console.log('module.parent:', module.parent);     // çˆ¶æ¨¡å—
console.log('module.children:', module.children); // å­æ¨¡å—åˆ—è¡¨

// requireå¯¹è±¡çš„å±æ€§
console.log('require.main:', require.main);       // ä¸»æ¨¡å—
console.log('require.cache keys:', Object.keys(require.cache)); // æ¨¡å—ç¼“å­˜
console.log('require.resolve("./utils"):', require.resolve('./utils')); // è§£ææ¨¡å—è·¯å¾„

// å®ç”¨çš„è·¯å¾„æ“ä½œ
const path = require('path');

// è·å–å½“å‰æ¨¡å—æ‰€åœ¨ç›®å½•çš„å…¶ä»–æ–‡ä»¶
const configPath = path.join(__dirname, 'config.json');
const utilsPath = path.join(__dirname, 'utils', 'helpers.js');

console.log('Config path:', configPath);
console.log('Utils path:', utilsPath);
</code></pre>
<h3 id="2-requireresolve"><a class="header" href="#2-requireresolve">2. require.resolve</a></h3>
<pre><code class="language-javascript">// resolve-demo.js

// require.resolveè¿”å›æ¨¡å—çš„ç»å¯¹è·¯å¾„ï¼Œä½†ä¸åŠ è½½æ¨¡å—
const modulePath = require.resolve('./my-module');
console.log('Module path:', modulePath);

// æ£€æŸ¥æ¨¡å—æ˜¯å¦å­˜åœ¨
function moduleExists(moduleName) {
    try {
        require.resolve(moduleName);
        return true;
    } catch (error) {
        return false;
    }
}

console.log('lodash exists:', moduleExists('lodash'));
console.log('non-existent exists:', moduleExists('non-existent-module'));

// è§£ænpmåŒ…çš„å­æ¨¡å—
const lodashMapPath = require.resolve('lodash/map');
console.log('Lodash map path:', lodashMapPath);

// åŠ¨æ€åŠ è½½å¯é€‰ä¾èµ–
function loadOptionalModule(moduleName) {
    try {
        const modulePath = require.resolve(moduleName);
        return require(modulePath);
    } catch (error) {
        console.warn(`Optional module ${moduleName} not found`);
        return null;
    }
}

const optionalModule = loadOptionalModule('optional-dependency');
</code></pre>
<h3 id="3-æ¨¡å—çƒ­é‡è½½"><a class="header" href="#3-æ¨¡å—çƒ­é‡è½½">3. æ¨¡å—çƒ­é‡è½½</a></h3>
<pre><code class="language-javascript">// hot-reload.js

const fs = require('fs');
const path = require('path');

class ModuleHotReloader {
    constructor() {
        this.watchers = new Map();
    }
    
    watch(modulePath, callback) {
        const absolutePath = require.resolve(modulePath);
        
        if (this.watchers.has(absolutePath)) {
            return;
        }
        
        const watcher = fs.watchFile(absolutePath, (curr, prev) =&gt; {
            if (curr.mtime &gt; prev.mtime) {
                console.log(`Module ${modulePath} changed, reloading...`);
                
                // æ¸…é™¤ç¼“å­˜
                delete require.cache[absolutePath];
                
                // é‡æ–°åŠ è½½
                try {
                    const reloadedModule = require(modulePath);
                    callback(reloadedModule);
                } catch (error) {
                    console.error('Failed to reload module:', error);
                }
            }
        });
        
        this.watchers.set(absolutePath, watcher);
    }
    
    unwatch(modulePath) {
        const absolutePath = require.resolve(modulePath);
        const watcher = this.watchers.get(absolutePath);
        
        if (watcher) {
            fs.unwatchFile(absolutePath);
            this.watchers.delete(absolutePath);
        }
    }
    
    unwatchAll() {
        this.watchers.forEach((watcher, path) =&gt; {
            fs.unwatchFile(path);
        });
        this.watchers.clear();
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const reloader = new ModuleHotReloader();

reloader.watch('./config', (newConfig) =&gt; {
    console.log('Config reloaded:', newConfig);
    // æ›´æ–°åº”ç”¨é…ç½®
});
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="1-å»¶è¿ŸåŠ è½½"><a class="header" href="#1-å»¶è¿ŸåŠ è½½">1. å»¶è¿ŸåŠ è½½</a></h3>
<pre><code class="language-javascript">// lazy-loading.js

// å»¶è¿ŸåŠ è½½å¤§å‹æ¨¡å—
class LazyLoader {
    constructor() {
        this._cache = new Map();
    }
    
    lazy(modulePath) {
        return new Proxy({}, {
            get: (target, prop) =&gt; {
                if (!this._cache.has(modulePath)) {
                    console.log(`Lazy loading: ${modulePath}`);
                    this._cache.set(modulePath, require(modulePath));
                }
                
                const module = this._cache.get(modulePath);
                return module[prop];
            }
        });
    }
}

const loader = new LazyLoader();

// åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ä¼šåŠ è½½æ¨¡å—
const heavyModule = loader.lazy('./heavy-computation');

// è¿™è¡Œä»£ç æ‰ä¼šè§¦å‘æ¨¡å—åŠ è½½
console.log(heavyModule.calculate(100));
</code></pre>
<h3 id="2-æ¨¡å—é¢„åŠ è½½-1"><a class="header" href="#2-æ¨¡å—é¢„åŠ è½½-1">2. æ¨¡å—é¢„åŠ è½½</a></h3>
<pre><code class="language-javascript">// preload.js

class ModulePreloader {
    constructor() {
        this.preloaded = new Map();
    }
    
    preload(modules) {
        modules.forEach(modulePath =&gt; {
            setImmediate(() =&gt; {
                try {
                    this.preloaded.set(modulePath, require(modulePath));
                    console.log(`Preloaded: ${modulePath}`);
                } catch (error) {
                    console.warn(`Failed to preload: ${modulePath}`, error);
                }
            });
        });
    }
    
    get(modulePath) {
        if (this.preloaded.has(modulePath)) {
            return this.preloaded.get(modulePath);
        }
        return require(modulePath);
    }
}

// åº”ç”¨å¯åŠ¨æ—¶é¢„åŠ è½½å¸¸ç”¨æ¨¡å—
const preloader = new ModulePreloader();
preloader.preload([
    'lodash',
    'moment',
    './utils/helpers',
    './config/database'
]);

// åç»­ä½¿ç”¨é¢„åŠ è½½çš„æ¨¡å—
setTimeout(() =&gt; {
    const lodash = preloader.get('lodash');
    const helpers = preloader.get('./utils/helpers');
}, 1000);
</code></pre>
<h2 id="æœ€ä½³å®è·µ-1"><a class="header" href="#æœ€ä½³å®è·µ-1">æœ€ä½³å®è·µ</a></h2>
<h3 id="1-æ¨¡å—å¯¼å‡ºç­–ç•¥"><a class="header" href="#1-æ¨¡å—å¯¼å‡ºç­–ç•¥">1. æ¨¡å—å¯¼å‡ºç­–ç•¥</a></h3>
<pre><code class="language-javascript">// export-strategies.js

// âœ… æ¨èï¼šæ˜ç¡®çš„å¯¼å‡º
module.exports = {
    // æ˜ç¡®åˆ—å‡ºæ‰€æœ‰å¯¼å‡º
    createUser,
    updateUser,
    deleteUser,
    UserValidationError
};

// âœ… æ¨èï¼šå•ä¸€èŒè´£å¯¼å‡º
module.exports = class UserService {
    constructor(database) {
        this.db = database;
    }
    
    async createUser(userData) {
        // å®ç°
    }
};

// âŒ é¿å…ï¼šæ··ç”¨exportså’Œmodule.exports
exports.method1 = () =&gt; {};
module.exports.method2 = () =&gt; {}; // ä¸ä¸€è‡´

// âŒ é¿å…ï¼šå¯¼å‡ºè¿‡å¤šå†…å®¹
module.exports = {
    // å¯¼å‡ºäº†å¤ªå¤šä¸ç›¸å…³çš„å†…å®¹
    UserService,
    ProductService,
    OrderService,
    DatabaseConnection,
    Logger,
    Config,
    Utils
};
</code></pre>
<h3 id="2-é”™è¯¯å¤„ç†"><a class="header" href="#2-é”™è¯¯å¤„ç†">2. é”™è¯¯å¤„ç†</a></h3>
<pre><code class="language-javascript">// error-handling.js

// âœ… æ¨èï¼šä¼˜é›…çš„é”™è¯¯å¤„ç†
function safeRequire(modulePath, fallback = null) {
    try {
        return require(modulePath);
    } catch (error) {
        if (error.code === 'MODULE_NOT_FOUND') {
            console.warn(`Module not found: ${modulePath}`);
            return fallback;
        }
        throw error; // é‡æ–°æŠ›å‡ºå…¶ä»–ç±»å‹çš„é”™è¯¯
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const optionalConfig = safeRequire('./optional-config', {});
const logger = safeRequire('./logger', console);

// âœ… æ¨èï¼šæ¨¡å—åˆå§‹åŒ–é”™è¯¯å¤„ç†
function createDatabaseModule() {
    let connection = null;
    
    function connect() {
        if (!connection) {
            try {
                connection = require('./database-connection')();
            } catch (error) {
                console.error('Failed to initialize database:', error);
                throw new Error('Database module initialization failed');
            }
        }
        return connection;
    }
    
    return {
        connect,
        query: (sql) =&gt; connect().query(sql)
    };
}

module.exports = createDatabaseModule();
</code></pre>
<h3 id="3-æ¨¡å—æµ‹è¯•"><a class="header" href="#3-æ¨¡å—æµ‹è¯•">3. æ¨¡å—æµ‹è¯•</a></h3>
<pre><code class="language-javascript">// testable-module.js

// âœ… å¯æµ‹è¯•çš„æ¨¡å—è®¾è®¡
class UserService {
    constructor(dependencies = {}) {
        // ä¾èµ–æ³¨å…¥ï¼Œä¾¿äºæµ‹è¯•
        this.database = dependencies.database || require('./database');
        this.logger = dependencies.logger || require('./logger');
        this.emailService = dependencies.emailService || require('./email-service');
    }
    
    async createUser(userData) {
        try {
            // éªŒè¯æ•°æ®
            this.validateUserData(userData);
            
            // åˆ›å»ºç”¨æˆ·
            const user = await this.database.users.create(userData);
            
            // å‘é€æ¬¢è¿é‚®ä»¶
            await this.emailService.sendWelcomeEmail(user.email);
            
            this.logger.info(`User created: ${user.id}`);
            return user;
        } catch (error) {
            this.logger.error('Failed to create user:', error);
            throw error;
        }
    }
    
    validateUserData(userData) {
        if (!userData.email) {
            throw new Error('Email is required');
        }
        // æ›´å¤šéªŒè¯é€»è¾‘
    }
}

module.exports = UserService;

// user-service.test.js
const UserService = require('./user-service');

describe('UserService', () =&gt; {
    it('should create user successfully', async () =&gt; {
        // æ¨¡æ‹Ÿä¾èµ–
        const mockDatabase = {
            users: {
                create: jest.fn().mockResolvedValue({ id: 1, email: 'test@example.com' })
            }
        };
        
        const mockLogger = {
            info: jest.fn(),
            error: jest.fn()
        };
        
        const mockEmailService = {
            sendWelcomeEmail: jest.fn().mockResolvedValue(true)
        };
        
        // æ³¨å…¥æ¨¡æ‹Ÿä¾èµ–
        const userService = new UserService({
            database: mockDatabase,
            logger: mockLogger,
            emailService: mockEmailService
        });
        
        const userData = { email: 'test@example.com', name: 'Test User' };
        const result = await userService.createUser(userData);
        
        expect(result.id).toBe(1);
        expect(mockDatabase.users.create).toHaveBeenCalledWith(userData);
        expect(mockEmailService.sendWelcomeEmail).toHaveBeenCalledWith('test@example.com');
    });
});
</code></pre>
<h2 id="æ€»ç»“-8"><a class="header" href="#æ€»ç»“-8">æ€»ç»“</a></h2>
<p>CommonJSä½œä¸ºNode.jsçš„åŸç”Ÿæ¨¡å—ç³»ç»Ÿï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>âœ… <strong>ç®€å•æ˜“ç”¨</strong>: è¯­æ³•ç®€æ´ï¼Œå­¦ä¹ æˆæœ¬ä½</li>
<li>âœ… <strong>åŒæ­¥åŠ è½½</strong>: é€‚åˆæœåŠ¡å™¨ç«¯å¼€å‘ï¼Œæ¨¡å—åŠ è½½å¯é¢„æœŸ</li>
<li>âœ… <strong>åŠ¨æ€ç‰¹æ€§</strong>: æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ¨¡å—</li>
<li>âœ… <strong>æˆç†Ÿç”Ÿæ€</strong>: å¤§é‡npmåŒ…åŸºäºCommonJSæ„å»º</li>
<li>âœ… <strong>å·¥å…·æ”¯æŒ</strong>: ä¸°å¯Œçš„å¼€å‘å·¥å…·å’Œè°ƒè¯•æ”¯æŒ</li>
</ul>
<p>ç†è§£CommonJSå¯¹äºNode.jså¼€å‘å’Œç†è§£JavaScriptæ¨¡å—åŒ–æ¼”è¿›å†ç¨‹éƒ½éå¸¸é‡è¦ã€‚è™½ç„¶ESæ¨¡å—æ˜¯æœªæ¥è¶‹åŠ¿ï¼Œä½†CommonJSä»åœ¨ç°ä»£å¼€å‘ä¸­æ‰®æ¼”é‡è¦è§’è‰²ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#requireä¸moduleexports">requireä¸module.exports</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="requireä¸moduleexports"><a class="header" href="#requireä¸moduleexports">requireä¸module.exports</a></h1>
<p>æœ¬ç« æ·±å…¥æ¢è®¨CommonJSæ¨¡å—ç³»ç»Ÿçš„ä¸¤ä¸ªæ ¸å¿ƒæœºåˆ¶ï¼š<code>require()</code>å‡½æ•°å’Œ<code>module.exports</code>å¯¹è±¡ã€‚ç†è§£å®ƒä»¬çš„å·¥ä½œåŸç†å’Œæœ€ä½³å®è·µå¯¹äºç¼–å†™é«˜è´¨é‡çš„Node.jsä»£ç è‡³å…³é‡è¦ã€‚</p>
<h2 id="requireå‡½æ•°æ·±å…¥è§£æ"><a class="header" href="#requireå‡½æ•°æ·±å…¥è§£æ">require()å‡½æ•°æ·±å…¥è§£æ</a></h2>
<h3 id="requireçš„å·¥ä½œæµç¨‹"><a class="header" href="#requireçš„å·¥ä½œæµç¨‹">require()çš„å·¥ä½œæµç¨‹</a></h3>
<pre><code class="language-javascript">// require()çš„å†…éƒ¨å·¥ä½œæµç¨‹ç¤ºä¾‹

// 1. è·¯å¾„è§£æ
const resolvedPath = require.resolve('./my-module');

// 2. æ£€æŸ¥ç¼“å­˜
if (require.cache[resolvedPath]) {
    return require.cache[resolvedPath].exports;
}

// 3. åˆ›å»ºæ–°æ¨¡å—å¯¹è±¡
const module = {
    id: resolvedPath,
    filename: resolvedPath,
    loaded: false,
    parent: currentModule,
    children: [],
    exports: {}
};

// 4. åŠ è½½å¹¶æ‰§è¡Œæ¨¡å—
const moduleWrapper = NativeModule.wrap(moduleContent);
const compiledWrapper = vm.runInThisContext(moduleWrapper);
compiledWrapper.call(module.exports, module.exports, require, module, __filename, __dirname);

// 5. æ ‡è®°æ¨¡å—å·²åŠ è½½
module.loaded = true;

// 6. ç¼“å­˜æ¨¡å—
require.cache[resolvedPath] = module;

// 7. è¿”å›exports
return module.exports;
</code></pre>
<h3 id="requireçš„ä¸åŒç”¨æ³•"><a class="header" href="#requireçš„ä¸åŒç”¨æ³•">require()çš„ä¸åŒç”¨æ³•</a></h3>
<pre><code class="language-javascript">// require-usage.js

// 1. åŸºæœ¬ç”¨æ³•
const fs = require('fs');
const path = require('path');
const myModule = require('./my-module');

// 2. æ¡ä»¶require
let config;
if (process.env.NODE_ENV === 'production') {
    config = require('./config/production.json');
} else {
    config = require('./config/development.json');
}

// 3. åŠ¨æ€require
function loadModule(moduleName) {
    try {
        return require(moduleName);
    } catch (error) {
        console.log(`Module ${moduleName} not found`);
        return null;
    }
}

// 4. requireè¡¨è¾¾å¼è®¡ç®—
const moduleName = './modules/' + process.argv[2];
const dynamicModule = require(moduleName);

// 5. è§£æ„require
const { readFile, writeFile } = require('fs/promises');
const { join, dirname } = require('path');

// 6. require JSONæ–‡ä»¶
const packageInfo = require('./package.json');
const config = require('./config.json');

// 7. require.resolve - ä»…è§£æè·¯å¾„ä¸åŠ è½½
const modulePath = require.resolve('lodash');
console.log('Lodash path:', modulePath);

// 8. æ£€æŸ¥æ¨¡å—æ˜¯å¦å­˜åœ¨
function moduleExists(name) {
    try {
        require.resolve(name);
        return true;
    } catch (e) {
        return false;
    }
}
</code></pre>
<h3 id="requireç¼“å­˜æœºåˆ¶"><a class="header" href="#requireç¼“å­˜æœºåˆ¶">requireç¼“å­˜æœºåˆ¶</a></h3>
<pre><code class="language-javascript">// require-cache.js

// æ¼”ç¤ºæ¨¡å—ç¼“å­˜
console.log('=== æ¨¡å—ç¼“å­˜æ¼”ç¤º ===');

// ç¬¬ä¸€æ¬¡require - æ‰§è¡Œæ¨¡å—ä»£ç 
console.log('First require:');
const module1 = require('./counter-module');
console.log('Counter value:', module1.getValue()); // 0

// å¢åŠ è®¡æ•°
module1.increment();
module1.increment();
console.log('After increment:', module1.getValue()); // 2

// ç¬¬äºŒæ¬¡require - è¿”å›ç¼“å­˜
console.log('Second require:');
const module2 = require('./counter-module');
console.log('Counter value:', module2.getValue()); // 2 (ä¸æ˜¯0!)

// éªŒè¯æ˜¯åŒä¸€ä¸ªå¯¹è±¡
console.log('Same object?', module1 === module2); // true

// counter-module.js
console.log('Counter module executing...');

let counter = 0;

module.exports = {
    increment() {
        counter++;
    },
    getValue() {
        return counter;
    }
};

// ç¼“å­˜æ“ä½œ
console.log('\n=== ç¼“å­˜æ“ä½œ ===');

// æŸ¥çœ‹ç¼“å­˜çš„æ¨¡å—
console.log('Cached modules:');
Object.keys(require.cache).forEach(key =&gt; {
    console.log(key);
});

// åˆ é™¤ç¼“å­˜å¹¶é‡æ–°åŠ è½½
const modulePath = require.resolve('./counter-module');
delete require.cache[modulePath];

console.log('After clearing cache:');
const module3 = require('./counter-module');
console.log('Counter value:', module3.getValue()); // 0 (é‡æ–°æ‰§è¡Œäº†æ¨¡å—)
</code></pre>
<h3 id="requireçš„é”™è¯¯å¤„ç†"><a class="header" href="#requireçš„é”™è¯¯å¤„ç†">require()çš„é”™è¯¯å¤„ç†</a></h3>
<pre><code class="language-javascript">// require-error-handling.js

// åŸºæœ¬é”™è¯¯å¤„ç†
function safeRequire(modulePath, defaultValue = null) {
    try {
        return require(modulePath);
    } catch (error) {
        console.log(`Failed to require ${modulePath}:`, error.message);
        return defaultValue;
    }
}

// åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯
function detailedRequire(modulePath) {
    try {
        return require(modulePath);
    } catch (error) {
        switch (error.code) {
            case 'MODULE_NOT_FOUND':
                console.log(`Module not found: ${modulePath}`);
                break;
            case 'ENOENT':
                console.log(`File not found: ${modulePath}`);
                break;
            default:
                console.log(`Error loading module: ${error.message}`);
                throw error; // é‡æ–°æŠ›å‡ºæœªçŸ¥é”™è¯¯
        }
        return null;
    }
}

// å¯é€‰ä¾èµ–åŠ è½½
function loadOptionalDependencies(dependencies) {
    const loaded = {};
    
    dependencies.forEach(dep =&gt; {
        try {
            loaded[dep] = require(dep);
            console.log(`âœ… Loaded: ${dep}`);
        } catch (error) {
            console.log(`âš ï¸  Optional dependency not found: ${dep}`);
            loaded[dep] = null;
        }
    });
    
    return loaded;
}

// ä½¿ç”¨ç¤ºä¾‹
const optionalDeps = loadOptionalDependencies([
    'colors',
    'moment',
    'non-existent-package'
]);

// å¸¦é‡è¯•çš„require
function requireWithRetry(modulePath, maxRetries = 3) {
    for (let i = 0; i &lt; maxRetries; i++) {
        try {
            return require(modulePath);
        } catch (error) {
            if (i === maxRetries - 1) {
                throw error;
            }
            console.log(`Retry ${i + 1} for ${modulePath}`);
        }
    }
}
</code></pre>
<h2 id="moduleexportsè¯¦è§£"><a class="header" href="#moduleexportsè¯¦è§£">module.exportsè¯¦è§£</a></h2>
<h3 id="moduleexports-vs-exports"><a class="header" href="#moduleexports-vs-exports">module.exports vs exports</a></h3>
<pre><code class="language-javascript">// exports-comparison.js

// ç†è§£module.exportså’Œexportsçš„å…³ç³»
console.log('åˆå§‹çŠ¶æ€:');
console.log('exports === module.exports:', exports === module.exports); // true

// exportsæ˜¯module.exportsçš„å¼•ç”¨
exports.method1 = function() {
    return 'method1 from exports';
};

module.exports.method2 = function() {
    return 'method2 from module.exports';
};

console.log('æ·»åŠ æ–¹æ³•å:');
console.log('exports === module.exports:', exports === module.exports); // ä»ç„¶æ˜¯true

// å±é™©æ“ä½œï¼šé‡æ–°èµ‹å€¼exports
exports = {
    method3: function() {
        return 'method3';
    }
};

console.log('é‡æ–°èµ‹å€¼exportså:');
console.log('exports === module.exports:', exports === module.exports); // false!

// æ­¤æ—¶module.exportsä»ç„¶åŒ…å«method1å’Œmethod2
// ä½†exportsæŒ‡å‘äº†æ–°å¯¹è±¡ï¼ŒåŒ…å«method3

// æ­£ç¡®çš„é‡æ–°èµ‹å€¼æ–¹å¼
module.exports = {
    method4: function() {
        return 'method4';
    }
};

// ç°åœ¨module.exportsåªåŒ…å«method4äº†
</code></pre>
<h3 id="ä¸åŒçš„å¯¼å‡ºæ¨¡å¼"><a class="header" href="#ä¸åŒçš„å¯¼å‡ºæ¨¡å¼">ä¸åŒçš„å¯¼å‡ºæ¨¡å¼</a></h3>
<pre><code class="language-javascript">// export-patterns.js

// 1. å¯¹è±¡å¯¼å‡ºæ¨¡å¼
module.exports = {
    name: 'MyModule',
    version: '1.0.0',
    
    init() {
        console.log(`${this.name} v${this.version} initialized`);
    },
    
    process(data) {
        return data.toUpperCase();
    }
};

// 2. ç±»å¯¼å‡ºæ¨¡å¼
class Calculator {
    add(a, b) { return a + b; }
    subtract(a, b) { return a - b; }
    multiply(a, b) { return a * b; }
    divide(a, b) { 
        if (b === 0) throw new Error('Division by zero');
        return a / b; 
    }
}

module.exports = Calculator;

// 3. å‡½æ•°å¯¼å‡ºæ¨¡å¼
function createLogger(level = 'info') {
    const levels = ['debug', 'info', 'warn', 'error'];
    const currentLevel = levels.indexOf(level);
    
    return {
        log(message, msgLevel = 'info') {
            const msgIndex = levels.indexOf(msgLevel);
            if (msgIndex &gt;= currentLevel) {
                console.log(`[${msgLevel.toUpperCase()}] ${message}`);
            }
        }
    };
}

module.exports = createLogger;

// 4. æ··åˆå¯¼å‡ºæ¨¡å¼
function mainFunction() {
    return 'Main functionality';
}

// å°†å‡½æ•°æœ¬èº«ä½œä¸ºé»˜è®¤å¯¼å‡º
module.exports = mainFunction;

// æ·»åŠ é¢å¤–çš„å±æ€§å’Œæ–¹æ³•
module.exports.helper = function() {
    return 'Helper functionality';
};

module.exports.constant = 42;

module.exports.SubClass = class {
    constructor() {
        this.name = 'SubClass';
    }
};

// 5. æ¡ä»¶å¯¼å‡ºæ¨¡å¼
if (process.env.NODE_ENV === 'development') {
    module.exports = {
        log: console.log,
        warn: console.warn,
        error: console.error,
        debug: console.debug
    };
} else {
    module.exports = {
        log() {}, // ç”Ÿäº§ç¯å¢ƒé™é»˜
        warn: console.warn,
        error: console.error,
        debug() {}
    };
}
</code></pre>
<h3 id="æ¸è¿›å¼å¯¼å‡º"><a class="header" href="#æ¸è¿›å¼å¯¼å‡º">æ¸è¿›å¼å¯¼å‡º</a></h3>
<pre><code class="language-javascript">// progressive-exports.js

// å¯ä»¥é€æ­¥æ„å»ºexportså¯¹è±¡

// å…ˆåˆ›å»ºåŸºç¡€ç»“æ„
module.exports = {};

// æ·»åŠ å¸¸é‡
module.exports.VERSION = '2.1.0';
module.exports.DEFAULT_CONFIG = {
    timeout: 5000,
    retries: 3
};

// æ·»åŠ å·¥å…·å‡½æ•°
module.exports.utils = {};

module.exports.utils.formatDate = function(date) {
    return date.toISOString().split('T')[0];
};

module.exports.utils.generateId = function() {
    return Math.random().toString(36).substr(2, 9);
};

// æ·»åŠ ä¸»è¦åŠŸèƒ½
module.exports.createClient = function(config = {}) {
    const finalConfig = { ...module.exports.DEFAULT_CONFIG, ...config };
    
    return {
        config: finalConfig,
        
        async request(url) {
            console.log(`Requesting ${url} with timeout ${finalConfig.timeout}ms`);
            // æ¨¡æ‹Ÿè¯·æ±‚
            return { status: 200, data: 'response data' };
        }
    };
};

// æ·»åŠ é”™è¯¯ç±»
class ClientError extends Error {
    constructor(message, code) {
        super(message);
        this.name = 'ClientError';
        this.code = code;
    }
}

module.exports.ClientError = ClientError;

// æ·»åŠ éªŒè¯å‡½æ•°
module.exports.validate = {
    url(url) {
        try {
            new URL(url);
            return true;
        } catch {
            return false;
        }
    },
    
    config(config) {
        if (typeof config !== 'object') return false;
        if (config.timeout &amp;&amp; typeof config.timeout !== 'number') return false;
        if (config.retries &amp;&amp; typeof config.retries !== 'number') return false;
        return true;
    }
};
</code></pre>
<h2 id="é«˜çº§æ¨¡å¼å’ŒæŠ€å·§"><a class="header" href="#é«˜çº§æ¨¡å¼å’ŒæŠ€å·§">é«˜çº§æ¨¡å¼å’ŒæŠ€å·§</a></h2>
<h3 id="1-æ¨¡å—å·¥å‚æ¨¡å¼"><a class="header" href="#1-æ¨¡å—å·¥å‚æ¨¡å¼">1. æ¨¡å—å·¥å‚æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// module-factory.js

// å·¥å‚å‡½æ•°åˆ›å»ºé…ç½®åŒ–çš„æ¨¡å—
function createDatabase(options = {}) {
    const {
        host = 'localhost',
        port = 5432,
        database = 'myapp',
        pool = { min: 2, max: 10 }
    } = options;
    
    let connection = null;
    
    return {
        async connect() {
            if (!connection) {
                console.log(`Connecting to ${host}:${port}/${database}`);
                connection = { 
                    host, 
                    port, 
                    database, 
                    connected: true 
                };
            }
            return connection;
        },
        
        async query(sql, params = []) {
            const conn = await this.connect();
            console.log(`Executing: ${sql}`, params);
            return { rows: [], rowCount: 0 };
        },
        
        async close() {
            if (connection) {
                console.log('Closing database connection');
                connection.connected = false;
                connection = null;
            }
        },
        
        getConfig() {
            return { host, port, database, pool };
        }
    };
}

module.exports = createDatabase;

// ä½¿ç”¨å·¥å‚æ¨¡å¼
// const db = require('./database-factory')({
//     host: 'prod-server',
//     port: 5432,
//     database: 'production_db'
// });
</code></pre>
<h3 id="2-å•ä¾‹æ¨¡å¼"><a class="header" href="#2-å•ä¾‹æ¨¡å¼">2. å•ä¾‹æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// singleton-pattern.js

// å•ä¾‹é…ç½®ç®¡ç†å™¨
let instance = null;

class ConfigManager {
    constructor() {
        if (instance) {
            return instance;
        }
        
        this.config = {};
        this.loaded = false;
        instance = this;
    }
    
    load(configPath) {
        if (!this.loaded) {
            try {
                this.config = require(configPath);
                this.loaded = true;
                console.log('Configuration loaded');
            } catch (error) {
                console.error('Failed to load configuration:', error);
                this.config = {};
            }
        }
        return this;
    }
    
    get(key, defaultValue = null) {
        return this.getNestedValue(this.config, key, defaultValue);
    }
    
    set(key, value) {
        this.setNestedValue(this.config, key, value);
    }
    
    getNestedValue(obj, path, defaultValue) {
        const keys = path.split('.');
        let current = obj;
        
        for (const key of keys) {
            if (current === null || current === undefined || !(key in current)) {
                return defaultValue;
            }
            current = current[key];
        }
        
        return current;
    }
    
    setNestedValue(obj, path, value) {
        const keys = path.split('.');
        const lastKey = keys.pop();
        let current = obj;
        
        for (const key of keys) {
            if (!(key in current)) {
                current[key] = {};
            }
            current = current[key];
        }
        
        current[lastKey] = value;
    }
}

// å¯¼å‡ºå•ä¾‹å®ä¾‹
module.exports = new ConfigManager();

// æ— è®ºåœ¨å“ªé‡Œrequireï¼Œéƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹
// const config1 = require('./config-manager');
// const config2 = require('./config-manager');
// console.log(config1 === config2); // true
</code></pre>
<h3 id="3-æ’ä»¶ç³»ç»Ÿ-1"><a class="header" href="#3-æ’ä»¶ç³»ç»Ÿ-1">3. æ’ä»¶ç³»ç»Ÿ</a></h3>
<pre><code class="language-javascript">// plugin-system.js

class PluginManager {
    constructor() {
        this.plugins = new Map();
        this.hooks = new Map();
    }
    
    register(name, plugin) {
        if (typeof plugin !== 'object') {
            throw new Error('Plugin must be an object');
        }
        
        if (typeof plugin.init !== 'function') {
            throw new Error('Plugin must have an init method');
        }
        
        this.plugins.set(name, plugin);
        console.log(`Plugin registered: ${name}`);
        
        // åˆå§‹åŒ–æ’ä»¶
        plugin.init(this);
        
        // æ³¨å†Œæ’ä»¶çš„é’©å­
        if (plugin.hooks) {
            Object.entries(plugin.hooks).forEach(([hookName, handler]) =&gt; {
                this.addHook(hookName, handler);
            });
        }
    }
    
    addHook(name, handler) {
        if (!this.hooks.has(name)) {
            this.hooks.set(name, []);
        }
        this.hooks.get(name).push(handler);
    }
    
    async executeHook(name, ...args) {
        const handlers = this.hooks.get(name) || [];
        const results = [];
        
        for (const handler of handlers) {
            try {
                const result = await handler(...args);
                results.push(result);
            } catch (error) {
                console.error(`Hook ${name} error:`, error);
            }
        }
        
        return results;
    }
    
    getPlugin(name) {
        return this.plugins.get(name);
    }
    
    unregister(name) {
        const plugin = this.plugins.get(name);
        if (plugin &amp;&amp; typeof plugin.destroy === 'function') {
            plugin.destroy();
        }
        this.plugins.delete(name);
        console.log(`Plugin unregistered: ${name}`);
    }
}

// å¯¼å‡ºæ’ä»¶ç®¡ç†å™¨
const pluginManager = new PluginManager();

// æä¾›ä¾¿æ·çš„æ’ä»¶åŠ è½½å‡½æ•°
function loadPlugin(pluginPath) {
    try {
        const plugin = require(pluginPath);
        const name = plugin.name || require('path').basename(pluginPath);
        pluginManager.register(name, plugin);
        return plugin;
    } catch (error) {
        console.error(`Failed to load plugin ${pluginPath}:`, error);
        return null;
    }
}

module.exports = {
    pluginManager,
    loadPlugin
};
</code></pre>
<h3 id="4-å»¶è¿Ÿåˆå§‹åŒ–"><a class="header" href="#4-å»¶è¿Ÿåˆå§‹åŒ–">4. å»¶è¿Ÿåˆå§‹åŒ–</a></h3>
<pre><code class="language-javascript">// lazy-initialization.js

// å»¶è¿Ÿåˆå§‹åŒ–çš„æ•°æ®åº“è¿æ¥
let _connection = null;
let _connecting = false;
let _connectionPromise = null;

async function getConnection() {
    if (_connection) {
        return _connection;
    }
    
    if (_connecting) {
        return _connectionPromise;
    }
    
    _connecting = true;
    _connectionPromise = initializeConnection();
    
    try {
        _connection = await _connectionPromise;
        return _connection;
    } finally {
        _connecting = false;
        _connectionPromise = null;
    }
}

async function initializeConnection() {
    console.log('Initializing database connection...');
    
    // æ¨¡æ‹Ÿå¼‚æ­¥è¿æ¥è¿‡ç¨‹
    await new Promise(resolve =&gt; setTimeout(resolve, 1000));
    
    const connection = {
        id: Math.random().toString(36),
        connected: true,
        
        async query(sql) {
            if (!this.connected) {
                throw new Error('Connection closed');
            }
            console.log(`Executing: ${sql}`);
            return { rows: [], count: 0 };
        },
        
        async close() {
            this.connected = false;
            _connection = null;
            console.log('Connection closed');
        }
    };
    
    console.log('Database connection established');
    return connection;
}

// å¯¼å‡ºæ¥å£
module.exports = {
    async query(sql) {
        const conn = await getConnection();
        return conn.query(sql);
    },
    
    async close() {
        if (_connection) {
            await _connection.close();
        }
    },
    
    isConnected() {
        return _connection &amp;&amp; _connection.connected;
    }
};
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–æŠ€å·§"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–æŠ€å·§">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</a></h2>
<h3 id="1-æ¡ä»¶require"><a class="header" href="#1-æ¡ä»¶require">1. æ¡ä»¶require</a></h3>
<pre><code class="language-javascript">// conditional-require.js

// é¿å…ä¸å¿…è¦çš„require
let heavyModule = null;

function getHeavyModule() {
    if (!heavyModule) {
        console.log('Loading heavy module...');
        heavyModule = require('./heavy-computation');
    }
    return heavyModule;
}

// åªæœ‰åœ¨éœ€è¦æ—¶æ‰åŠ è½½
function performHeavyOperation(data) {
    const heavy = getHeavyModule();
    return heavy.process(data);
}

// åŸºäºåŠŸèƒ½æ£€æµ‹çš„æ¡ä»¶require
let cryptoModule = null;

function getCrypto() {
    if (!cryptoModule) {
        try {
            cryptoModule = require('crypto');
        } catch (error) {
            // å›é€€åˆ°å…¶ä»–å®ç°
            cryptoModule = require('./crypto-fallback');
        }
    }
    return cryptoModule;
}

// åŸºäºç¯å¢ƒçš„æ¡ä»¶require
const debugMode = process.env.NODE_ENV === 'development';

let debugUtils = null;
if (debugMode) {
    debugUtils = require('./debug-utils');
}

function debug(message) {
    if (debugMode &amp;&amp; debugUtils) {
        debugUtils.log(message);
    }
}

module.exports = {
    performHeavyOperation,
    getCrypto,
    debug
};
</code></pre>
<h3 id="2-requireç¼“å­˜ä¼˜åŒ–"><a class="header" href="#2-requireç¼“å­˜ä¼˜åŒ–">2. requireç¼“å­˜ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// cache-optimization.js

// æ‰‹åŠ¨ç®¡ç†requireç¼“å­˜
class RequireCache {
    static clear(modulePath) {
        const resolvedPath = require.resolve(modulePath);
        delete require.cache[resolvedPath];
    }
    
    static clearPattern(pattern) {
        const regex = new RegExp(pattern);
        Object.keys(require.cache).forEach(key =&gt; {
            if (regex.test(key)) {
                delete require.cache[key];
            }
        });
    }
    
    static preload(modules) {
        modules.forEach(modulePath =&gt; {
            try {
                require(modulePath);
                console.log(`Preloaded: ${modulePath}`);
            } catch (error) {
                console.warn(`Failed to preload: ${modulePath}`);
            }
        });
    }
    
    static getStats() {
        const cached = Object.keys(require.cache);
        return {
            count: cached.length,
            modules: cached.map(path =&gt; ({
                path,
                loaded: require.cache[path].loaded
            }))
        };
    }
}

// æ™ºèƒ½requireå°è£…
function smartRequire(modulePath, options = {}) {
    const { cache = true, reload = false } = options;
    
    if (reload) {
        RequireCache.clear(modulePath);
    }
    
    const module = require(modulePath);
    
    if (!cache) {
        // ç«‹å³æ¸…é™¤ç¼“å­˜
        setImmediate(() =&gt; {
            RequireCache.clear(modulePath);
        });
    }
    
    return module;
}

module.exports = {
    RequireCache,
    smartRequire
};
</code></pre>
<h2 id="è°ƒè¯•å’Œç›‘æ§"><a class="header" href="#è°ƒè¯•å’Œç›‘æ§">è°ƒè¯•å’Œç›‘æ§</a></h2>
<h3 id="1-requireè·Ÿè¸ª"><a class="header" href="#1-requireè·Ÿè¸ª">1. requireè·Ÿè¸ª</a></h3>
<pre><code class="language-javascript">// require-tracer.js

// è·Ÿè¸ªrequireè°ƒç”¨
const originalRequire = module.constructor.prototype.require;

module.constructor.prototype.require = function(id) {
    const start = Date.now();
    console.log(`ğŸ“¦ Requiring: ${id}`);
    
    try {
        const result = originalRequire.call(this, id);
        const duration = Date.now() - start;
        console.log(`âœ… Loaded: ${id} (${duration}ms)`);
        return result;
    } catch (error) {
        const duration = Date.now() - start;
        console.log(`âŒ Failed: ${id} (${duration}ms) - ${error.message}`);
        throw error;
    }
};

// ä½¿ç”¨ç¤ºä¾‹
const fs = require('fs');        // ğŸ“¦ Requiring: fs / âœ… Loaded: fs (1ms)
const path = require('path');    // ğŸ“¦ Requiring: path / âœ… Loaded: path (0ms)

// æ¢å¤åŸå§‹require
function restoreRequire() {
    module.constructor.prototype.require = originalRequire;
}

module.exports = { restoreRequire };
</code></pre>
<h3 id="2-æ¨¡å—ä¾èµ–åˆ†æ"><a class="header" href="#2-æ¨¡å—ä¾èµ–åˆ†æ">2. æ¨¡å—ä¾èµ–åˆ†æ</a></h3>
<pre><code class="language-javascript">// dependency-analyzer.js

class DependencyAnalyzer {
    constructor() {
        this.dependencies = new Map();
        this.loadTimes = new Map();
    }
    
    analyze() {
        Object.entries(require.cache).forEach(([path, moduleObj]) =&gt; {
            const deps = moduleObj.children.map(child =&gt; child.filename);
            this.dependencies.set(path, deps);
        });
        
        return this.generateReport();
    }
    
    generateReport() {
        const report = {
            totalModules: this.dependencies.size,
            dependencies: {},
            circularDependencies: this.findCircularDependencies(),
            heaviestModules: this.findHeaviestModules()
        };
        
        this.dependencies.forEach((deps, module) =&gt; {
            report.dependencies[module] = {
                dependsOn: deps,
                dependentCount: deps.length
            };
        });
        
        return report;
    }
    
    findCircularDependencies() {
        // ç®€åŒ–çš„å¾ªç¯ä¾èµ–æ£€æµ‹
        const visited = new Set();
        const visiting = new Set();
        const cycles = [];
        
        const dfs = (module, path = []) =&gt; {
            if (visiting.has(module)) {
                const cycleStart = path.indexOf(module);
                cycles.push(path.slice(cycleStart).concat(module));
                return;
            }
            
            if (visited.has(module)) return;
            
            visiting.add(module);
            path.push(module);
            
            const deps = this.dependencies.get(module) || [];
            deps.forEach(dep =&gt; dfs(dep, [...path]));
            
            visiting.delete(module);
            visited.add(module);
        };
        
        this.dependencies.forEach((_, module) =&gt; {
            if (!visited.has(module)) {
                dfs(module);
            }
        });
        
        return cycles;
    }
    
    findHeaviestModules(top = 10) {
        const modules = Array.from(this.dependencies.entries())
            .map(([module, deps]) =&gt; ({
                module,
                dependencyCount: deps.length
            }))
            .sort((a, b) =&gt; b.dependencyCount - a.dependencyCount)
            .slice(0, top);
        
        return modules;
    }
}

module.exports = DependencyAnalyzer;
</code></pre>
<h2 id="æ€»ç»“-9"><a class="header" href="#æ€»ç»“-9">æ€»ç»“</a></h2>
<p><code>require()</code>å’Œ<code>module.exports</code>æ˜¯CommonJSæ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒï¼š</p>
<ul>
<li>âœ… <strong>require()</strong>: åŒæ­¥åŠ è½½ã€ç¼“å­˜æœºåˆ¶ã€è·¯å¾„è§£æ</li>
<li>âœ… <strong>module.exports</strong>: çµæ´»çš„å¯¼å‡ºæ–¹å¼ã€ä¸exportsçš„å…³ç³»</li>
<li>âœ… <strong>é«˜çº§æ¨¡å¼</strong>: å·¥å‚æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€æ’ä»¶ç³»ç»Ÿ</li>
<li>âœ… <strong>æ€§èƒ½ä¼˜åŒ–</strong>: æ¡ä»¶åŠ è½½ã€ç¼“å­˜ç®¡ç†ã€å»¶è¿Ÿåˆå§‹åŒ–</li>
<li>âœ… <strong>è°ƒè¯•å·¥å…·</strong>: ä¾èµ–è·Ÿè¸ªã€æ€§èƒ½ç›‘æ§ã€å¾ªç¯ä¾èµ–æ£€æµ‹</li>
</ul>
<p>ç†è§£è¿™äº›æœºåˆ¶æœ‰åŠ©äºç¼–å†™æ›´é«˜æ•ˆã€æ›´å¯ç»´æŠ¤çš„Node.jsåº”ç”¨ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#commonjsæ¨¡å—ç¼“å­˜æœºåˆ¶">æ¨¡å—ç¼“å­˜æœºåˆ¶</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="commonjsæ¨¡å—ç¼“å­˜æœºåˆ¶"><a class="header" href="#commonjsæ¨¡å—ç¼“å­˜æœºåˆ¶">CommonJSæ¨¡å—ç¼“å­˜æœºåˆ¶</a></h1>
<p>CommonJSæ¨¡å—ç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯æ¨¡å—ç¼“å­˜ï¼ˆModule Cachingï¼‰ã€‚ç†è§£ç¼“å­˜æœºåˆ¶å¯¹äºä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€é¿å…é‡å¤æ‰§è¡Œä»£ç ä»¥åŠç®¡ç†æ¨¡å—çŠ¶æ€è‡³å…³é‡è¦ã€‚</p>
<h2 id="æ¨¡å—ç¼“å­˜åŸç†"><a class="header" href="#æ¨¡å—ç¼“å­˜åŸç†">æ¨¡å—ç¼“å­˜åŸç†</a></h2>
<h3 id="1-ç¼“å­˜æœºåˆ¶æ¦‚è¿°"><a class="header" href="#1-ç¼“å­˜æœºåˆ¶æ¦‚è¿°">1. ç¼“å­˜æœºåˆ¶æ¦‚è¿°</a></h3>
<pre><code class="language-javascript">// math.js
console.log('math.jsè¢«æ‰§è¡Œ');

let counter = 0;

function add(a, b) {
    counter++;
    return a + b;
}

function getCounter() {
    return counter;
}

module.exports = { add, getCounter };
</code></pre>
<pre><code class="language-javascript">// app.js
const math1 = require('./math'); // è¾“å‡º: math.jsè¢«æ‰§è¡Œ
const math2 = require('./math'); // ä¸ä¼šå†æ¬¡è¾“å‡º

console.log(math1 === math2); // true - åŒä¸€ä¸ªå¯¹è±¡
console.log(math1.add(2, 3)); // 5
console.log(math1.getCounter()); // 1
console.log(math2.getCounter()); // 1 - å…±äº«çŠ¶æ€
</code></pre>
<h3 id="2-requirecacheå¯¹è±¡"><a class="header" href="#2-requirecacheå¯¹è±¡">2. require.cacheå¯¹è±¡</a></h3>
<p>Node.jså°†æ‰€æœ‰åŠ è½½çš„æ¨¡å—å­˜å‚¨åœ¨<code>require.cache</code>å¯¹è±¡ä¸­ï¼š</p>
<pre><code class="language-javascript">// cache-demo.js
console.log('åŠ è½½å‰çš„ç¼“å­˜:', Object.keys(require.cache));

const fs = require('fs');
const path = require('path');
const myModule = require('./my-module');

console.log('åŠ è½½åçš„ç¼“å­˜:', Object.keys(require.cache));

// æŸ¥çœ‹ç‰¹å®šæ¨¡å—çš„ç¼“å­˜ä¿¡æ¯
const modulePath = require.resolve('./my-module');
console.log('æ¨¡å—è·¯å¾„:', modulePath);
console.log('ç¼“å­˜å¯¹è±¡:', require.cache[modulePath]);
</code></pre>
<h3 id="3-ç¼“å­˜é”®è§„åˆ™"><a class="header" href="#3-ç¼“å­˜é”®è§„åˆ™">3. ç¼“å­˜é”®è§„åˆ™</a></h3>
<p>ç¼“å­˜çš„é”®æ˜¯æ¨¡å—çš„<strong>ç»å¯¹è·¯å¾„</strong>ï¼š</p>
<pre><code class="language-javascript">// ç›¸åŒæ¨¡å—çš„ä¸åŒå¼•ç”¨æ–¹å¼
const mod1 = require('./utils');
const mod2 = require('./utils.js');
const mod3 = require(path.resolve(__dirname, 'utils.js'));

// è¿™äº›éƒ½æŒ‡å‘åŒä¸€ä¸ªç¼“å­˜æ¡ç›®ï¼ˆå¦‚æœè§£æä¸ºç›¸åŒçš„ç»å¯¹è·¯å¾„ï¼‰
console.log(mod1 === mod2); // true
console.log(mod2 === mod3); // true
</code></pre>
<h2 id="ç¼“å­˜æ“ä½œ"><a class="header" href="#ç¼“å­˜æ“ä½œ">ç¼“å­˜æ“ä½œ</a></h2>
<h3 id="1-æŸ¥çœ‹ç¼“å­˜"><a class="header" href="#1-æŸ¥çœ‹ç¼“å­˜">1. æŸ¥çœ‹ç¼“å­˜</a></h3>
<pre><code class="language-javascript">// cache-inspector.js
function showCache() {
    console.log('å½“å‰ç¼“å­˜çš„æ¨¡å—:');
    Object.keys(require.cache).forEach(path =&gt; {
        console.log(`  ${path}`);
    });
}

function showModuleInfo(modulePath) {
    const resolvedPath = require.resolve(modulePath);
    const cachedModule = require.cache[resolvedPath];
    
    if (cachedModule) {
        console.log(`æ¨¡å—ä¿¡æ¯: ${modulePath}`);
        console.log(`  ç»å¯¹è·¯å¾„: ${resolvedPath}`);
        console.log(`  æ˜¯å¦å·²åŠ è½½: true`);
        console.log(`  å¯¼å‡ºå¯¹è±¡:`, cachedModule.exports);
        console.log(`  å­æ¨¡å—:`, cachedModule.children.map(child =&gt; child.id));
        console.log(`  çˆ¶æ¨¡å—:`, cachedModule.parent ? cachedModule.parent.id : 'none');
    }
}

showCache();
require('./utils');
showModuleInfo('./utils');
</code></pre>
<h3 id="2-æ¸…é™¤ç¼“å­˜"><a class="header" href="#2-æ¸…é™¤ç¼“å­˜">2. æ¸…é™¤ç¼“å­˜</a></h3>
<pre><code class="language-javascript">// cache-cleaner.js
function clearModuleCache(modulePath) {
    const resolvedPath = require.resolve(modulePath);
    
    // åˆ é™¤ç¼“å­˜æ¡ç›®
    delete require.cache[resolvedPath];
    
    console.log(`å·²æ¸…é™¤æ¨¡å—ç¼“å­˜: ${resolvedPath}`);
}

function clearAllCache() {
    Object.keys(require.cache).forEach(path =&gt; {
        delete require.cache[path];
    });
    console.log('å·²æ¸…é™¤æ‰€æœ‰æ¨¡å—ç¼“å­˜');
}

// ä½¿ç”¨ç¤ºä¾‹
const math1 = require('./math'); // é¦–æ¬¡åŠ è½½
clearModuleCache('./math');
const math2 = require('./math'); // é‡æ–°åŠ è½½

console.log(math1 === math2); // false - ä¸åŒçš„å¯¹è±¡å®ä¾‹
</code></pre>
<h3 id="3-é‡æ–°åŠ è½½æ¨¡å—"><a class="header" href="#3-é‡æ–°åŠ è½½æ¨¡å—">3. é‡æ–°åŠ è½½æ¨¡å—</a></h3>
<pre><code class="language-javascript">// hot-reload.js
function reloadModule(modulePath) {
    // æ¸…é™¤ç¼“å­˜
    const resolvedPath = require.resolve(modulePath);
    delete require.cache[resolvedPath];
    
    // é‡æ–°åŠ è½½
    return require(modulePath);
}

// ä½¿ç”¨ç¤ºä¾‹
let config = require('./config');
console.log('åŸå§‹é…ç½®:', config);

// æ¨¡æ‹Ÿé…ç½®æ–‡ä»¶æ›´æ”¹åé‡æ–°åŠ è½½
setTimeout(() =&gt; {
    config = reloadModule('./config');
    console.log('é‡æ–°åŠ è½½çš„é…ç½®:', config);
}, 1000);
</code></pre>
<h2 id="ç¼“å­˜æ¨¡å¼å’Œæœ€ä½³å®è·µ"><a class="header" href="#ç¼“å­˜æ¨¡å¼å’Œæœ€ä½³å®è·µ">ç¼“å­˜æ¨¡å¼å’Œæœ€ä½³å®è·µ</a></h2>
<h3 id="1-å•ä¾‹æ¨¡å¼"><a class="header" href="#1-å•ä¾‹æ¨¡å¼">1. å•ä¾‹æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// database.js - æ•°æ®åº“è¿æ¥å•ä¾‹
let dbConnection = null;

function createConnection() {
    console.log('åˆ›å»ºæ–°çš„æ•°æ®åº“è¿æ¥');
    return {
        query: (sql) =&gt; console.log(`æ‰§è¡ŒSQL: ${sql}`),
        close: () =&gt; console.log('å…³é—­æ•°æ®åº“è¿æ¥')
    };
}

function getConnection() {
    if (!dbConnection) {
        dbConnection = createConnection();
    }
    return dbConnection;
}

module.exports = { getConnection };
</code></pre>
<pre><code class="language-javascript">// app.js
const db1 = require('./database').getConnection();
const db2 = require('./database').getConnection();

console.log(db1 === db2); // true - åŒä¸€ä¸ªè¿æ¥å®ä¾‹
</code></pre>
<h3 id="2-å·¥å‚æ¨¡å¼"><a class="header" href="#2-å·¥å‚æ¨¡å¼">2. å·¥å‚æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// logger-factory.js
const loggers = new Map();

function createLogger(name) {
    return {
        name,
        log: (message) =&gt; console.log(`[${name}] ${message}`),
        error: (message) =&gt; console.error(`[${name}] ERROR: ${message}`)
    };
}

function getLogger(name) {
    if (!loggers.has(name)) {
        loggers.set(name, createLogger(name));
    }
    return loggers.get(name);
}

module.exports = { getLogger };
</code></pre>
<h3 id="3-é…ç½®æ¨¡å—"><a class="header" href="#3-é…ç½®æ¨¡å—">3. é…ç½®æ¨¡å—</a></h3>
<pre><code class="language-javascript">// config.js
const config = {
    database: {
        host: process.env.DB_HOST || 'localhost',
        port: process.env.DB_PORT || 5432
    },
    api: {
        port: process.env.PORT || 3000,
        timeout: 30000
    }
};

// æä¾›æ›´æ–°é…ç½®çš„æ–¹æ³•
function updateConfig(updates) {
    Object.assign(config, updates);
}

module.exports = {
    ...config,
    updateConfig
};
</code></pre>
<h2 id="ç¼“å­˜ç›¸å…³é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ"><a class="header" href="#ç¼“å­˜ç›¸å…³é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ">ç¼“å­˜ç›¸å…³é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</a></h2>
<h3 id="1-å¾ªç¯ä¾èµ–ä¸­çš„ç¼“å­˜"><a class="header" href="#1-å¾ªç¯ä¾èµ–ä¸­çš„ç¼“å­˜">1. å¾ªç¯ä¾èµ–ä¸­çš„ç¼“å­˜</a></h3>
<pre><code class="language-javascript">// a.js
console.log('a.jså¼€å§‹æ‰§è¡Œ');
exports.name = 'module-a';

const b = require('./b');
console.log('a.jsä¸­bçš„å€¼:', b);

exports.getValue = () =&gt; `a-${b.name}`;
console.log('a.jsæ‰§è¡Œå®Œæˆ');
</code></pre>
<pre><code class="language-javascript">// b.js
console.log('b.jså¼€å§‹æ‰§è¡Œ');
exports.name = 'module-b';

const a = require('./a');
console.log('b.jsä¸­açš„å€¼:', a); // æ­¤æ—¶aå¯èƒ½æ˜¯éƒ¨åˆ†å¯¼å‡ºçš„å¯¹è±¡

exports.getValue = () =&gt; `b-${a.name || 'undefined'}`;
console.log('b.jsæ‰§è¡Œå®Œæˆ');
</code></pre>
<h3 id="2-å¼€å‘ç¯å¢ƒçƒ­é‡è½½"><a class="header" href="#2-å¼€å‘ç¯å¢ƒçƒ­é‡è½½">2. å¼€å‘ç¯å¢ƒçƒ­é‡è½½</a></h3>
<pre><code class="language-javascript">// dev-hot-reload.js
const fs = require('fs');
const path = require('path');

class ModuleHotReloader {
    constructor() {
        this.watchers = new Map();
    }
    
    watch(modulePath, callback) {
        const resolvedPath = require.resolve(modulePath);
        
        if (this.watchers.has(resolvedPath)) {
            return; // å·²ç»åœ¨ç›‘å¬
        }
        
        const watcher = fs.watch(resolvedPath, (eventType) =&gt; {
            if (eventType === 'change') {
                console.log(`æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–: ${resolvedPath}`);
                
                // æ¸…é™¤ç¼“å­˜
                delete require.cache[resolvedPath];
                
                // æ‰§è¡Œå›è°ƒ
                if (callback) {
                    try {
                        const newModule = require(modulePath);
                        callback(newModule, null);
                    } catch (error) {
                        callback(null, error);
                    }
                }
            }
        });
        
        this.watchers.set(resolvedPath, watcher);
    }
    
    stopWatching(modulePath) {
        const resolvedPath = require.resolve(modulePath);
        const watcher = this.watchers.get(resolvedPath);
        
        if (watcher) {
            watcher.close();
            this.watchers.delete(resolvedPath);
        }
    }
    
    stopAll() {
        this.watchers.forEach(watcher =&gt; watcher.close());
        this.watchers.clear();
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const hotReloader = new ModuleHotReloader();

hotReloader.watch('./config', (newConfig, error) =&gt; {
    if (error) {
        console.error('é‡æ–°åŠ è½½é…ç½®å¤±è´¥:', error);
    } else {
        console.log('é…ç½®å·²æ›´æ–°:', newConfig);
    }
});
</code></pre>
<h3 id="3-å†…å­˜æ³„æ¼é¢„é˜²"><a class="header" href="#3-å†…å­˜æ³„æ¼é¢„é˜²">3. å†…å­˜æ³„æ¼é¢„é˜²</a></h3>
<pre><code class="language-javascript">// memory-management.js
class ModuleCacheManager {
    constructor() {
        this.moduleUsage = new Map();
    }
    
    trackModule(modulePath) {
        const resolvedPath = require.resolve(modulePath);
        const usage = this.moduleUsage.get(resolvedPath) || 0;
        this.moduleUsage.set(resolvedPath, usage + 1);
    }
    
    cleanup() {
        // æ¸…ç†å¾ˆå°‘ä½¿ç”¨çš„æ¨¡å—
        this.moduleUsage.forEach((usage, path) =&gt; {
            if (usage &lt; 2 &amp;&amp; require.cache[path]) {
                delete require.cache[path];
                this.moduleUsage.delete(path);
                console.log(`æ¸…ç†ä½ä½¿ç”¨ç‡æ¨¡å—: ${path}`);
            }
        });
    }
    
    getStats() {
        return {
            totalCached: Object.keys(require.cache).length,
            tracked: this.moduleUsage.size,
            usage: Array.from(this.moduleUsage.entries())
        };
    }
}

const cacheManager = new ModuleCacheManager();

// å®šæœŸæ¸…ç†
setInterval(() =&gt; {
    cacheManager.cleanup();
}, 60000); // æ¯åˆ†é’Ÿæ¸…ç†ä¸€æ¬¡
</code></pre>
<h2 id="é«˜çº§ç¼“å­˜æŠ€å·§"><a class="header" href="#é«˜çº§ç¼“å­˜æŠ€å·§">é«˜çº§ç¼“å­˜æŠ€å·§</a></h2>
<h3 id="1-æ¡ä»¶ç¼“å­˜"><a class="header" href="#1-æ¡ä»¶ç¼“å­˜">1. æ¡ä»¶ç¼“å­˜</a></h3>
<pre><code class="language-javascript">// conditional-cache.js
function requireWithCondition(modulePath, condition) {
    if (!condition) {
        // å¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œä¸´æ—¶æ¸…é™¤ç¼“å­˜
        const resolvedPath = require.resolve(modulePath);
        const cached = require.cache[resolvedPath];
        delete require.cache[resolvedPath];
        
        try {
            return require(modulePath);
        } finally {
            // æ¢å¤ç¼“å­˜ï¼ˆå¦‚æœä¹‹å‰å­˜åœ¨ï¼‰
            if (cached) {
                require.cache[resolvedPath] = cached;
            }
        }
    }
    
    return require(modulePath);
}

// ä½¿ç”¨ç¤ºä¾‹
const isDevelopment = process.env.NODE_ENV === 'development';
const config = requireWithCondition('./config', !isDevelopment);
</code></pre>
<h3 id="2-ç¼“å­˜ä»£ç†"><a class="header" href="#2-ç¼“å­˜ä»£ç†">2. ç¼“å­˜ä»£ç†</a></h3>
<pre><code class="language-javascript">// cache-proxy.js
function createCacheProxy(require) {
    const originalRequire = require;
    const loadTimes = new Map();
    
    return function proxiedRequire(modulePath) {
        const startTime = Date.now();
        const module = originalRequire(modulePath);
        const loadTime = Date.now() - startTime;
        
        const resolvedPath = originalRequire.resolve(modulePath);
        const times = loadTimes.get(resolvedPath) || [];
        times.push(loadTime);
        loadTimes.set(resolvedPath, times);
        
        // æ·»åŠ æ€§èƒ½ç»Ÿè®¡æ–¹æ³•
        if (!module.__performance) {
            Object.defineProperty(module, '__performance', {
                value: {
                    getLoadTimes: () =&gt; loadTimes.get(resolvedPath) || [],
                    getAverageLoadTime: () =&gt; {
                        const times = loadTimes.get(resolvedPath) || [];
                        return times.reduce((sum, time) =&gt; sum + time, 0) / times.length;
                    }
                },
                enumerable: false
            });
        }
        
        return module;
    };
}

// ä½¿ç”¨ä»£ç†
const proxiedRequire = createCacheProxy(require);
const utils = proxiedRequire('./utils');
console.log('å¹³å‡åŠ è½½æ—¶é—´:', utils.__performance.getAverageLoadTime(), 'ms');
</code></pre>
<h2 id="æµ‹è¯•ä¸­çš„ç¼“å­˜ç®¡ç†"><a class="header" href="#æµ‹è¯•ä¸­çš„ç¼“å­˜ç®¡ç†">æµ‹è¯•ä¸­çš„ç¼“å­˜ç®¡ç†</a></h2>
<h3 id="1-æµ‹è¯•éš”ç¦»"><a class="header" href="#1-æµ‹è¯•éš”ç¦»">1. æµ‹è¯•éš”ç¦»</a></h3>
<pre><code class="language-javascript">// test-helper.js
class TestCacheManager {
    constructor() {
        this.originalCache = null;
    }
    
    // å¤‡ä»½å½“å‰ç¼“å­˜
    backup() {
        this.originalCache = { ...require.cache };
    }
    
    // æ¢å¤å¤‡ä»½çš„ç¼“å­˜
    restore() {
        if (this.originalCache) {
            // æ¸…é™¤å½“å‰ç¼“å­˜
            Object.keys(require.cache).forEach(key =&gt; {
                delete require.cache[key];
            });
            
            // æ¢å¤åŸå§‹ç¼“å­˜
            Object.assign(require.cache, this.originalCache);
        }
    }
    
    // æ¸…é™¤ç‰¹å®šæ¨¡å—çš„ç¼“å­˜
    clearModule(modulePath) {
        const resolvedPath = require.resolve(modulePath);
        delete require.cache[resolvedPath];
    }
    
    // æ¨¡æ‹Ÿæ–°é²œç¯å¢ƒ
    isolate(callback) {
        this.backup();
        try {
            // æ¸…é™¤æ‰€æœ‰ç”¨æˆ·æ¨¡å—ç¼“å­˜ï¼ˆä¿ç•™Node.jså†…ç½®æ¨¡å—ï¼‰
            Object.keys(require.cache).forEach(path =&gt; {
                if (!path.includes('node_modules') &amp;&amp; !path.includes('internal')) {
                    delete require.cache[path];
                }
            });
            
            return callback();
        } finally {
            this.restore();
        }
    }
}

// åœ¨æµ‹è¯•ä¸­ä½¿ç”¨
const testCache = new TestCacheManager();

describe('Module tests', () =&gt; {
    beforeEach(() =&gt; {
        testCache.backup();
    });
    
    afterEach(() =&gt; {
        testCache.restore();
    });
    
    it('should load module fresh', () =&gt; {
        testCache.clearModule('./my-module');
        const module = require('./my-module');
        // æµ‹è¯•é€»è¾‘
    });
});
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–-1"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-1">æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="1-ç¼“å­˜é¢„çƒ­"><a class="header" href="#1-ç¼“å­˜é¢„çƒ­">1. ç¼“å­˜é¢„çƒ­</a></h3>
<pre><code class="language-javascript">// cache-warmup.js
function warmupCache(modules) {
    console.log('å¼€å§‹ç¼“å­˜é¢„çƒ­...');
    const startTime = Date.now();
    
    modules.forEach(modulePath =&gt; {
        try {
            require(modulePath);
            console.log(`âœ“ é¢„çƒ­å®Œæˆ: ${modulePath}`);
        } catch (error) {
            console.error(`âœ— é¢„çƒ­å¤±è´¥: ${modulePath}`, error.message);
        }
    });
    
    const warmupTime = Date.now() - startTime;
    console.log(`ç¼“å­˜é¢„çƒ­å®Œæˆï¼Œè€—æ—¶: ${warmupTime}ms`);
}

// åº”ç”¨å¯åŠ¨æ—¶é¢„çƒ­
const criticalModules = [
    './database',
    './cache',
    './logger',
    './config',
    './utils'
];

warmupCache(criticalModules);
</code></pre>
<h3 id="2-æ™ºèƒ½ç¼“å­˜æ¸…ç†"><a class="header" href="#2-æ™ºèƒ½ç¼“å­˜æ¸…ç†">2. æ™ºèƒ½ç¼“å­˜æ¸…ç†</a></h3>
<pre><code class="language-javascript">// smart-cache-cleaner.js
class SmartCacheManager {
    constructor(options = {}) {
        this.maxCacheSize = options.maxCacheSize || 100;
        this.maxAge = options.maxAge || 3600000; // 1å°æ—¶
        this.accessTimes = new Map();
        this.loadTimes = new Map();
    }
    
    trackAccess(modulePath) {
        const resolvedPath = require.resolve(modulePath);
        this.accessTimes.set(resolvedPath, Date.now());
    }
    
    shouldEvict(modulePath) {
        const resolvedPath = require.resolve(modulePath);
        const lastAccess = this.accessTimes.get(resolvedPath);
        
        if (!lastAccess) return true;
        
        // è¶…è¿‡æœ€å¤§å¹´é¾„
        if (Date.now() - lastAccess &gt; this.maxAge) {
            return true;
        }
        
        return false;
    }
    
    cleanup() {
        const cachedModules = Object.keys(require.cache);
        
        // å¦‚æœç¼“å­˜æ•°é‡è¶…è¿‡é™åˆ¶
        if (cachedModules.length &gt; this.maxCacheSize) {
            const candidates = cachedModules
                .filter(path =&gt; this.shouldEvict(path))
                .sort((a, b) =&gt; {
                    const aTime = this.accessTimes.get(a) || 0;
                    const bTime = this.accessTimes.get(b) || 0;
                    return aTime - bTime; // æœ€å°‘æœ€è¿‘ä½¿ç”¨
                });
            
            // æ¸…ç†æœ€è€çš„æ¨¡å—
            const toRemove = candidates.slice(0, Math.floor(this.maxCacheSize * 0.1));
            toRemove.forEach(path =&gt; {
                delete require.cache[path];
                this.accessTimes.delete(path);
                console.log(`æ™ºèƒ½æ¸…ç†æ¨¡å—: ${path}`);
            });
        }
    }
    
    getStats() {
        return {
            cacheSize: Object.keys(require.cache).length,
            trackedAccess: this.accessTimes.size,
            maxCacheSize: this.maxCacheSize,
            oldestAccess: Math.min(...this.accessTimes.values()),
            newestAccess: Math.max(...this.accessTimes.values())
        };
    }
}
</code></pre>
<h2 id="æ€»ç»“-10"><a class="header" href="#æ€»ç»“-10">æ€»ç»“</a></h2>
<p>CommonJSæ¨¡å—ç¼“å­˜æœºåˆ¶æ˜¯Node.jsæ€§èƒ½ä¼˜åŒ–çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼š</p>
<ul>
<li>âœ… <strong>è‡ªåŠ¨ç¼“å­˜</strong>: æ¨¡å—é¦–æ¬¡åŠ è½½åè‡ªåŠ¨ç¼“å­˜ï¼Œæé«˜æ€§èƒ½</li>
<li>âœ… <strong>çŠ¶æ€å…±äº«</strong>: æ”¯æŒæ¨¡å—é—´çŠ¶æ€å…±äº«å’Œå•ä¾‹æ¨¡å¼</li>
<li>âœ… <strong>çµæ´»æ§åˆ¶</strong>: å¯ä»¥æ‰‹åŠ¨æ¸…é™¤å’Œé‡æ–°åŠ è½½æ¨¡å—</li>
<li>âœ… <strong>å¼€å‘å‹å¥½</strong>: æ”¯æŒçƒ­é‡è½½å’Œæµ‹è¯•éš”ç¦»</li>
<li>âš ï¸ <strong>å†…å­˜ç®¡ç†</strong>: éœ€è¦æ³¨æ„å†…å­˜æ³„æ¼å’Œç¼“å­˜æ¸…ç†</li>
<li>âš ï¸ <strong>å¾ªç¯ä¾èµ–</strong>: åœ¨å¾ªç¯ä¾èµ–ä¸­éœ€è¦ç‰¹åˆ«å°å¿ƒç¼“å­˜æ—¶æœº</li>
</ul>
<p>ç†è§£å’Œå–„ç”¨ç¼“å­˜æœºåˆ¶èƒ½å¤Ÿæ˜¾è‘—æå‡Node.jsåº”ç”¨çš„æ€§èƒ½å’Œå¼€å‘ä½“éªŒã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ¨¡å—äº’æ“ä½œæ€§">æ¨¡å—äº’æ“ä½œæ€§</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ¨¡å—äº’æ“ä½œæ€§"><a class="header" href="#æ¨¡å—äº’æ“ä½œæ€§">æ¨¡å—äº’æ“ä½œæ€§</a></h1>
<p>åœ¨ç°ä»£JavaScriptå¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ä¸åŒçš„æ¨¡å—ç³»ç»Ÿã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨CommonJSä¸ESæ¨¡å—çš„äº’æ“ä½œæ€§ï¼Œä»¥åŠå¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­å¤„ç†æ¨¡å—ç³»ç»Ÿçš„æ··åˆä½¿ç”¨ã€‚</p>
<h2 id="commonjsä¸esæ¨¡å—çš„å·®å¼‚"><a class="header" href="#commonjsä¸esæ¨¡å—çš„å·®å¼‚">CommonJSä¸ESæ¨¡å—çš„å·®å¼‚</a></h2>
<h3 id="1-è¯­æ³•å·®å¼‚"><a class="header" href="#1-è¯­æ³•å·®å¼‚">1. è¯­æ³•å·®å¼‚</a></h3>
<pre><code class="language-javascript">// CommonJS
const fs = require('fs');
const { readFile } = require('fs');
module.exports = { utility };
exports.helper = function() {};

// ESæ¨¡å—
import fs from 'fs';
import { readFile } from 'fs';
export { utility };
export const helper = function() {};
export default utility;
</code></pre>
<h3 id="2-æ‰§è¡Œæ—¶æœºå·®å¼‚"><a class="header" href="#2-æ‰§è¡Œæ—¶æœºå·®å¼‚">2. æ‰§è¡Œæ—¶æœºå·®å¼‚</a></h3>
<pre><code class="language-javascript">// CommonJS - åŒæ­¥åŠ è½½
console.log('å¼€å§‹');
const utils = require('./utils'); // åŒæ­¥æ‰§è¡Œ
console.log('ç»“æŸ');

// ESæ¨¡å— - é™æ€åˆ†æ
console.log('å¼€å§‹');
import utils from './utils.js'; // ç¼–è¯‘æ—¶ç¡®å®š
console.log('ç»“æŸ');
</code></pre>
<h3 id="3-å€¼å¤åˆ¶-vs-å®æ—¶ç»‘å®š"><a class="header" href="#3-å€¼å¤åˆ¶-vs-å®æ—¶ç»‘å®š">3. å€¼å¤åˆ¶ vs å®æ—¶ç»‘å®š</a></h3>
<pre><code class="language-javascript">// CommonJS - å€¼å¤åˆ¶
// counter.js (CommonJS)
let count = 0;
function increment() {
    count++;
}
function getCount() {
    return count;
}
module.exports = { count, increment, getCount };

// main.js
const { count, increment, getCount } = require('./counter');
console.log(count); // 0
increment();
console.log(count); // 0 (å€¼å¤åˆ¶ï¼Œä¸ä¼šæ›´æ–°)
console.log(getCount()); // 1 (é€šè¿‡å‡½æ•°è·å–æœ€æ–°å€¼)
</code></pre>
<pre><code class="language-javascript">// ESæ¨¡å— - å®æ—¶ç»‘å®š
// counter.mjs (ESæ¨¡å—)
let count = 0;
export function increment() {
    count++;
}
export { count };

// main.mjs
import { count, increment } from './counter.mjs';
console.log(count); // 0
increment();
console.log(count); // 1 (å®æ—¶ç»‘å®šï¼Œä¼šæ›´æ–°)
</code></pre>
<h2 id="nodejsä¸­çš„äº’æ“ä½œæ€§"><a class="header" href="#nodejsä¸­çš„äº’æ“ä½œæ€§">Node.jsä¸­çš„äº’æ“ä½œæ€§</a></h2>
<h3 id="1-esæ¨¡å—å¯¼å…¥commonjs"><a class="header" href="#1-esæ¨¡å—å¯¼å…¥commonjs">1. ESæ¨¡å—å¯¼å…¥CommonJS</a></h3>
<pre><code class="language-javascript">// utils.js (CommonJS)
function add(a, b) {
    return a + b;
}

function multiply(a, b) {
    return a * b;
}

module.exports = {
    add,
    multiply,
    default: { add, multiply } // å¯é€‰ï¼šæ˜¾å¼é»˜è®¤å¯¼å‡º
};
</code></pre>
<pre><code class="language-javascript">// main.mjs (ESæ¨¡å—)

// æ–¹å¼1ï¼šé»˜è®¤å¯¼å…¥
import utils from './utils.js';
console.log(utils.add(2, 3)); // 5

// æ–¹å¼2ï¼šå‘½åå¯¼å…¥ï¼ˆå¦‚æœCommonJSæ¨¡å—æ”¯æŒï¼‰
import { add, multiply } from './utils.js';
console.log(add(2, 3)); // 5

// æ–¹å¼3ï¼šå‘½åç©ºé—´å¯¼å…¥
import * as utils from './utils.js';
console.log(utils.add(2, 3)); // 5
</code></pre>
<h3 id="2-commonjså¯¼å…¥esæ¨¡å—"><a class="header" href="#2-commonjså¯¼å…¥esæ¨¡å—">2. CommonJSå¯¼å…¥ESæ¨¡å—</a></h3>
<p>CommonJSä¸èƒ½ç›´æ¥ä½¿ç”¨<code>import</code>ï¼Œéœ€è¦ä½¿ç”¨åŠ¨æ€å¯¼å…¥ï¼š</p>
<pre><code class="language-javascript">// math.mjs (ESæ¨¡å—)
export function add(a, b) {
    return a + b;
}

export function subtract(a, b) {
    return a - b;
}

export default {
    version: '1.0.0'
};
</code></pre>
<pre><code class="language-javascript">// app.js (CommonJS)

// æ–¹å¼1ï¼šä½¿ç”¨åŠ¨æ€import
async function main() {
    const math = await import('./math.mjs');
    console.log(math.add(2, 3)); // 5
    console.log(math.default.version); // '1.0.0'
    
    // è§£æ„å¯¼å…¥
    const { add, subtract } = await import('./math.mjs');
    console.log(add(5, 3)); // 8
}

main();

// æ–¹å¼2ï¼šä½¿ç”¨import()è¡¨è¾¾å¼
import('./math.mjs').then(math =&gt; {
    console.log(math.add(2, 3));
});

// æ–¹å¼3ï¼šåœ¨å‡½æ•°ä¸­ä½¿ç”¨
function loadMath() {
    return import('./math.mjs');
}
</code></pre>
<h3 id="3-æ··åˆä½¿ç”¨ç¤ºä¾‹"><a class="header" href="#3-æ··åˆä½¿ç”¨ç¤ºä¾‹">3. æ··åˆä½¿ç”¨ç¤ºä¾‹</a></h3>
<pre><code class="language-javascript">// config.js (CommonJS)
const defaults = {
    port: 3000,
    host: 'localhost'
};

function createConfig(overrides = {}) {
    return { ...defaults, ...overrides };
}

module.exports = { defaults, createConfig };
</code></pre>
<pre><code class="language-javascript">// server.mjs (ESæ¨¡å—)
import express from 'express';
import configModule from './config.js';

const { createConfig } = configModule;

const config = createConfig({
    port: process.env.PORT || 8080
});

const app = express();

app.listen(config.port, () =&gt; {
    console.log(`Server running on port ${config.port}`);
});
</code></pre>
<h2 id="æ‰“åŒ…å·¥å…·ä¸­çš„äº’æ“ä½œæ€§"><a class="header" href="#æ‰“åŒ…å·¥å…·ä¸­çš„äº’æ“ä½œæ€§">æ‰“åŒ…å·¥å…·ä¸­çš„äº’æ“ä½œæ€§</a></h2>
<h3 id="1-webpacké…ç½®"><a class="header" href="#1-webpacké…ç½®">1. Webpacké…ç½®</a></h3>
<pre><code class="language-javascript">// webpack.config.js
module.exports = {
    entry: './src/index.js',
    module: {
        rules: [
            {
                test: /\.m?js$/,
                exclude: /node_modules/,
                use: {
                    loader: 'babel-loader',
                    options: {
                        presets: [
                            ['@babel/preset-env', {
                                modules: false // ä¿æŒESæ¨¡å—ç”¨äºtree shaking
                            }]
                        ]
                    }
                }
            }
        ]
    },
    resolve: {
        extensions: ['.js', '.mjs', '.cjs']
    }
};
</code></pre>
<h3 id="2-rollupé…ç½®"><a class="header" href="#2-rollupé…ç½®">2. Rollupé…ç½®</a></h3>
<pre><code class="language-javascript">// rollup.config.js
import { nodeResolve } from '@rollup/plugin-node-resolve';
import commonjs from '@rollup/plugin-commonjs';

export default {
    input: 'src/index.js',
    output: {
        file: 'dist/bundle.js',
        format: 'esm'
    },
    plugins: [
        nodeResolve({
            preferBuiltins: false
        }),
        commonjs({
            // å°†CommonJSæ¨¡å—è½¬æ¢ä¸ºESæ¨¡å—
            transformMixedEsModules: true
        })
    ]
};
</code></pre>
<h3 id="3-viteé…ç½®"><a class="header" href="#3-viteé…ç½®">3. Viteé…ç½®</a></h3>
<pre><code class="language-javascript">// vite.config.js
import { defineConfig } from 'vite';

export default defineConfig({
    build: {
        rollupOptions: {
            output: {
                format: 'esm'
            }
        }
    },
    optimizeDeps: {
        include: ['legacy-commonjs-package']
    }
});
</code></pre>
<h2 id="å®é™…äº’æ“ä½œæ¨¡å¼"><a class="header" href="#å®é™…äº’æ“ä½œæ¨¡å¼">å®é™…äº’æ“ä½œæ¨¡å¼</a></h2>
<h3 id="1-æ¸è¿›å¼è¿ç§»"><a class="header" href="#1-æ¸è¿›å¼è¿ç§»">1. æ¸è¿›å¼è¿ç§»</a></h3>
<pre><code class="language-javascript">// æ­¥éª¤1ï¼šåˆ›å»ºå…¼å®¹å±‚
// compat.js
const legacyUtils = require('./legacy-utils');

// åŒ…è£…CommonJSæ¨¡å—ä¸ºESæ¨¡å—å‹å¥½çš„æ ¼å¼
export const { helper1, helper2 } = legacyUtils;
export default legacyUtils;
</code></pre>
<pre><code class="language-javascript">// æ­¥éª¤2ï¼šæ–°ä»£ç ä½¿ç”¨ESæ¨¡å—
// new-feature.mjs
import { helper1 } from './compat.js';
import modernUtil from './modern-util.mjs';

export function newFeature() {
    return helper1() + modernUtil();
}
</code></pre>
<h3 id="2-åŒæ¨¡å¼åŒ…"><a class="header" href="#2-åŒæ¨¡å¼åŒ…">2. åŒæ¨¡å¼åŒ…</a></h3>
<p>åˆ›å»ºåŒæ—¶æ”¯æŒCommonJSå’ŒESæ¨¡å—çš„åŒ…ï¼š</p>
<pre><code class="language-json">// package.json
{
  "name": "my-dual-package",
  "version": "1.0.0",
  "type": "module",
  "main": "./dist/index.cjs",
  "module": "./dist/index.mjs",
  "exports": {
    ".": {
      "import": "./dist/index.mjs",
      "require": "./dist/index.cjs"
    }
  }
}
</code></pre>
<pre><code class="language-javascript">// src/index.js (æºç )
export function utility() {
    return 'Hello from utility';
}

export default {
    utility
};
</code></pre>
<pre><code class="language-javascript">// build/build-cjs.js (æ„å»ºCommonJSç‰ˆæœ¬)
const fs = require('fs');

const esmCode = `
export function utility() {
    return 'Hello from utility';
}

export default {
    utility
};
`;

const cjsCode = `
function utility() {
    return 'Hello from utility';
}

module.exports = {
    utility,
    default: { utility }
};
`;

fs.writeFileSync('./dist/index.cjs', cjsCode);
fs.writeFileSync('./dist/index.mjs', esmCode);
</code></pre>
<h3 id="3-æ¡ä»¶å¯¼å…¥"><a class="header" href="#3-æ¡ä»¶å¯¼å…¥">3. æ¡ä»¶å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// dynamic-loader.js
async function loadModule(modulePath) {
    try {
        // å°è¯•ESæ¨¡å—å¯¼å…¥
        return await import(modulePath);
    } catch (error) {
        // é™çº§åˆ°CommonJS
        if (error.code === 'ERR_REQUIRE_ESM') {
            return require(modulePath);
        }
        throw error;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
async function main() {
    const module = await loadModule('./some-module');
    console.log(module.default || module);
}
</code></pre>
<h2 id="å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ-1"><a class="header" href="#å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ-1">å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</a></h2>
<h3 id="1-__dirnameå’Œ__filenameåœ¨esæ¨¡å—ä¸­çš„æ›¿ä»£"><a class="header" href="#1-__dirnameå’Œ__filenameåœ¨esæ¨¡å—ä¸­çš„æ›¿ä»£">1. __dirnameå’Œ__filenameåœ¨ESæ¨¡å—ä¸­çš„æ›¿ä»£</a></h3>
<pre><code class="language-javascript">// utils.mjs
import { fileURLToPath } from 'url';
import { dirname } from 'path';

// ESæ¨¡å—ä¸­è·å–å½“å‰æ–‡ä»¶è·¯å¾„
const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

export { __filename, __dirname };
</code></pre>
<pre><code class="language-javascript">// å…¼å®¹å‡½æ•°
// path-utils.mjs
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

export function getCurrentDir(importMetaUrl) {
    return dirname(fileURLToPath(importMetaUrl));
}

export function resolvePath(importMetaUrl, ...paths) {
    const currentDir = getCurrentDir(importMetaUrl);
    return join(currentDir, ...paths);
}

// ä½¿ç”¨
import { resolvePath } from './path-utils.mjs';
const configPath = resolvePath(import.meta.url, 'config.json');
</code></pre>
<h3 id="2-requireresolveåœ¨esæ¨¡å—ä¸­çš„æ›¿ä»£"><a class="header" href="#2-requireresolveåœ¨esæ¨¡å—ä¸­çš„æ›¿ä»£">2. require.resolveåœ¨ESæ¨¡å—ä¸­çš„æ›¿ä»£</a></h3>
<pre><code class="language-javascript">// resolve-utils.mjs
import { createRequire } from 'module';

// åˆ›å»ºrequireå‡½æ•°
const require = createRequire(import.meta.url);

export function resolveModule(modulePath) {
    return require.resolve(modulePath);
}

export function importModule(modulePath) {
    return require(modulePath);
}

// ä½¿ç”¨ç¤ºä¾‹
const modulePath = resolveModule('lodash');
console.log(modulePath); // ç»å¯¹è·¯å¾„
</code></pre>
<h3 id="3-åŠ¨æ€requireåœ¨esæ¨¡å—ä¸­çš„å®ç°"><a class="header" href="#3-åŠ¨æ€requireåœ¨esæ¨¡å—ä¸­çš„å®ç°">3. åŠ¨æ€requireåœ¨ESæ¨¡å—ä¸­çš„å®ç°</a></h3>
<pre><code class="language-javascript">// dynamic-require.mjs
import { createRequire } from 'module';

const require = createRequire(import.meta.url);

export function dynamicRequire(modulePath) {
    return require(modulePath);
}

export async function universalImport(modulePath) {
    try {
        // é¦–å…ˆå°è¯•ESæ¨¡å—å¯¼å…¥
        return await import(modulePath);
    } catch (esError) {
        try {
            // é™çº§åˆ°CommonJS
            return { default: require(modulePath) };
        } catch (cjsError) {
            throw new Error(`æ— æ³•åŠ è½½æ¨¡å— ${modulePath}: ${esError.message}`);
        }
    }
}
</code></pre>
<h3 id="4-æ¨¡å—ç±»å‹æ£€æµ‹"><a class="header" href="#4-æ¨¡å—ç±»å‹æ£€æµ‹">4. æ¨¡å—ç±»å‹æ£€æµ‹</a></h3>
<pre><code class="language-javascript">// module-detector.mjs
import { readFileSync } from 'fs';
import { resolve } from 'path';

export function isESModule(packagePath) {
    try {
        const packageJsonPath = resolve(packagePath, 'package.json');
        const packageJson = JSON.parse(readFileSync(packageJsonPath, 'utf8'));
        return packageJson.type === 'module';
    } catch {
        return false;
    }
}

export function getModuleType(filePath) {
    if (filePath.endsWith('.mjs')) return 'esm';
    if (filePath.endsWith('.cjs')) return 'commonjs';
    
    // æ£€æŸ¥package.json
    const packageDir = findPackageDir(filePath);
    return isESModule(packageDir) ? 'esm' : 'commonjs';
}

function findPackageDir(startPath) {
    let currentPath = resolve(startPath);
    while (currentPath !== resolve(currentPath, '..')) {
        try {
            readFileSync(resolve(currentPath, 'package.json'));
            return currentPath;
        } catch {
            currentPath = resolve(currentPath, '..');
        }
    }
    return null;
}
</code></pre>
<h2 id="æœ€ä½³å®è·µ-2"><a class="header" href="#æœ€ä½³å®è·µ-2">æœ€ä½³å®è·µ</a></h2>
<h3 id="1-æ–°é¡¹ç›®å»ºè®®"><a class="header" href="#1-æ–°é¡¹ç›®å»ºè®®">1. æ–°é¡¹ç›®å»ºè®®</a></h3>
<pre><code class="language-javascript">// æ¨èçš„é¡¹ç›®ç»“æ„
project/
â”œâ”€â”€ package.json          // type: "module"
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.mjs         // ESæ¨¡å—å…¥å£
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ modern.mjs    // æ–°ä»£ç ä½¿ç”¨ESæ¨¡å—
â”‚   â”‚   â””â”€â”€ legacy.cjs    // æ—§ä»£ç ä¿æŒCommonJS
â”‚   â””â”€â”€ compat/
â”‚       â””â”€â”€ require-wrapper.mjs // CommonJSå…¼å®¹å±‚
â””â”€â”€ build/
    â”œâ”€â”€ build-dual.js     // æ„å»ºåŒæ¨¡å¼åŒ…
    â””â”€â”€ test-compat.js    // å…¼å®¹æ€§æµ‹è¯•
</code></pre>
<h3 id="2-è¿ç§»ç­–ç•¥"><a class="header" href="#2-è¿ç§»ç­–ç•¥">2. è¿ç§»ç­–ç•¥</a></h3>
<pre><code class="language-javascript">// é˜¶æ®µ1ï¼šå‡†å¤‡é˜¶æ®µ
// package.json
{
  "type": "module",
  "exports": {
    ".": {
      "import": "./dist/index.mjs",
      "require": "./dist/index.cjs"
    }
  }
}

// é˜¶æ®µ2ï¼šæ¸è¿›è¿ç§»
// ä¿æŒCommonJSæ¥å£ä¸å˜ï¼Œå†…éƒ¨é€æ­¥è¿ç§»
// é˜¶æ®µ3ï¼šå®Œå…¨åˆ‡æ¢
// ç§»é™¤CommonJSå…¼å®¹å±‚
</code></pre>
<h3 id="3-åº“å¼€å‘å»ºè®®"><a class="header" href="#3-åº“å¼€å‘å»ºè®®">3. åº“å¼€å‘å»ºè®®</a></h3>
<pre><code class="language-javascript">// lib/index.js (æºç ä½¿ç”¨ESæ¨¡å—)
export function utility() {
    return 'utility function';
}

export class Helper {
    constructor(options) {
        this.options = options;
    }
    
    process() {
        return 'processed';
    }
}

export default {
    utility,
    Helper
};
</code></pre>
<pre><code class="language-javascript">// scripts/build-dual.js
import { rollup } from 'rollup';

async function buildDual() {
    // æ„å»ºESæ¨¡å—ç‰ˆæœ¬
    const esmBundle = await rollup({
        input: 'lib/index.js',
        external: ['fs', 'path']
    });
    
    await esmBundle.write({
        file: 'dist/index.mjs',
        format: 'esm'
    });
    
    // æ„å»ºCommonJSç‰ˆæœ¬
    const cjsBundle = await rollup({
        input: 'lib/index.js',
        external: ['fs', 'path']
    });
    
    await cjsBundle.write({
        file: 'dist/index.cjs',
        format: 'cjs'
    });
}

buildDual();
</code></pre>
<h2 id="æ€»ç»“-11"><a class="header" href="#æ€»ç»“-11">æ€»ç»“</a></h2>
<p>æ¨¡å—äº’æ“ä½œæ€§æ˜¯ç°ä»£JavaScriptå¼€å‘çš„é‡è¦è¯é¢˜ï¼š</p>
<ul>
<li>
<p>âœ… <strong>æ¸è¿›è¿ç§»</strong>: å¯ä»¥é€æ­¥ä»CommonJSè¿ç§»åˆ°ESæ¨¡å—</p>
</li>
<li>
<p>âœ… <strong>å·¥å…·æ”¯æŒ</strong>: ç°ä»£æ„å»ºå·¥å…·æä¾›äº†è‰¯å¥½çš„äº’æ“ä½œæ”¯æŒ</p>
</li>
<li>
<p>âœ… <strong>åŒæ¨¡å¼åŒ…</strong>: å¯ä»¥åˆ›å»ºåŒæ—¶æ”¯æŒä¸¤ç§æ¨¡å—ç³»ç»Ÿçš„åŒ…</p>
</li>
<li>
<p>âœ… <strong>åŠ¨æ€å¯¼å…¥</strong>: æä¾›äº†è¿è¡Œæ—¶æ¨¡å—åŠ è½½çš„çµæ´»æ€§</p>
</li>
<li>
<p>âš ï¸ <strong>æ€§èƒ½è€ƒè™‘</strong>: é¢‘ç¹çš„åŠ¨æ€å¯¼å…¥å¯èƒ½å½±å“æ€§èƒ½</p>
</li>
<li>
<p>âš ï¸ <strong>å¤æ‚æ€§</strong>: æ··åˆä½¿ç”¨å¢åŠ äº†é¡¹ç›®çš„å¤æ‚æ€§</p>
</li>
<li>
<p>âš ï¸ <strong>è°ƒè¯•å›°éš¾</strong>: äº’æ“ä½œé—®é¢˜å¯èƒ½éš¾ä»¥è°ƒè¯•</p>
</li>
</ul>
<p>ç†è§£å’ŒæŒæ¡æ¨¡å—äº’æ“ä½œæ€§å¯¹äºç»´æŠ¤ç°æœ‰é¡¹ç›®å’Œå¼€å‘æ–°é¡¹ç›®éƒ½è‡³å…³é‡è¦ã€‚éšç€ç”Ÿæ€ç³»ç»Ÿçš„å‘å±•ï¼ŒESæ¨¡å—æ­£åœ¨æˆä¸ºä¸»æµï¼Œä½†CommonJSä»å°†åœ¨ç›¸å½“é•¿çš„æ—¶é—´å†…å­˜åœ¨ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#amdæ¨¡å—ç³»ç»ŸåŸºç¡€">AMDæ¨¡å—ç³»ç»Ÿ</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="amdæ¨¡å—ç³»ç»ŸåŸºç¡€"><a class="header" href="#amdæ¨¡å—ç³»ç»ŸåŸºç¡€">AMDæ¨¡å—ç³»ç»ŸåŸºç¡€</a></h1>
<p>AMDï¼ˆAsynchronous Module Definitionï¼Œå¼‚æ­¥æ¨¡å—å®šä¹‰ï¼‰æ˜¯ä¸€ç§ä¸ºæµè§ˆå™¨ç¯å¢ƒè®¾è®¡çš„JavaScriptæ¨¡å—æ ¼å¼ã€‚å®ƒæ”¯æŒå¼‚æ­¥åŠ è½½ã€ä¾èµ–ç®¡ç†å’Œæ¨¡å—åŒ–å¼€å‘ï¼Œæ˜¯æ—©æœŸè§£å†³æµè§ˆå™¨ç«¯æ¨¡å—åŒ–é—®é¢˜çš„é‡è¦æ–¹æ¡ˆã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯amd"><a class="header" href="#ä»€ä¹ˆæ˜¯amd">ä»€ä¹ˆæ˜¯AMD</a></h2>
<p>AMDæ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰æ¨¡å—çš„JavaScript APIï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>å¼‚æ­¥åŠ è½½</strong>: æ”¯æŒæ¨¡å—çš„å¼‚æ­¥åŠ è½½ï¼Œä¸é˜»å¡é¡µé¢æ¸²æŸ“</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>: æ˜ç¡®å£°æ˜æ¨¡å—ä¾èµ–ï¼Œè‡ªåŠ¨å¤„ç†åŠ è½½é¡ºåº</li>
<li><strong>æµè§ˆå™¨å‹å¥½</strong>: ä¸“ä¸ºæµè§ˆå™¨ç¯å¢ƒè®¾è®¡ï¼Œæ— éœ€æ„å»ºå·¥å…·</li>
<li><strong>æ’ä»¶ç³»ç»Ÿ</strong>: æ”¯æŒåŠ è½½å„ç§ç±»å‹çš„èµ„æº</li>
<li><strong>é…ç½®çµæ´»</strong>: æä¾›ä¸°å¯Œçš„é…ç½®é€‰é¡¹</li>
</ul>
<h2 id="amd-api"><a class="header" href="#amd-api">AMD API</a></h2>
<h3 id="1-defineå‡½æ•°"><a class="header" href="#1-defineå‡½æ•°">1. defineå‡½æ•°</a></h3>
<p><code>define</code>æ˜¯AMDçš„æ ¸å¿ƒå‡½æ•°ï¼Œç”¨äºå®šä¹‰æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">// åŸºæœ¬è¯­æ³•
define(id?, dependencies?, factory);
</code></pre>
<h4 id="æ— ä¾èµ–æ¨¡å—"><a class="header" href="#æ— ä¾èµ–æ¨¡å—">æ— ä¾èµ–æ¨¡å—</a></h4>
<pre><code class="language-javascript">// math.js - ç®€å•çš„æ•°å­¦å·¥å…·æ¨¡å—
define(function() {
    function add(a, b) {
        return a + b;
    }
    
    function multiply(a, b) {
        return a * b;
    }
    
    // è¿”å›æ¨¡å—çš„å…¬å…±æ¥å£
    return {
        add: add,
        multiply: multiply,
        PI: 3.14159
    };
});
</code></pre>
<h4 id="æœ‰ä¾èµ–çš„æ¨¡å—"><a class="header" href="#æœ‰ä¾èµ–çš„æ¨¡å—">æœ‰ä¾èµ–çš„æ¨¡å—</a></h4>
<pre><code class="language-javascript">// calculator.js - ä¾èµ–mathæ¨¡å—çš„è®¡ç®—å™¨
define(['math'], function(math) {
    function calculate(operation, a, b) {
        switch(operation) {
            case 'add':
                return math.add(a, b);
            case 'multiply':
                return math.multiply(a, b);
            case 'circle-area':
                return math.PI * a * a;
            default:
                throw new Error('Unknown operation: ' + operation);
        }
    }
    
    return {
        calculate: calculate
    };
});
</code></pre>
<h4 id="å‘½åæ¨¡å—"><a class="header" href="#å‘½åæ¨¡å—">å‘½åæ¨¡å—</a></h4>
<pre><code class="language-javascript">// æŒ‡å®šæ¨¡å—ID
define('utils/string', [], function() {
    function capitalize(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
    }
    
    function trim(str) {
        return str.replace(/^\s+|\s+$/g, '');
    }
    
    return {
        capitalize: capitalize,
        trim: trim
    };
});
</code></pre>
<h3 id="2-requireå‡½æ•°"><a class="header" href="#2-requireå‡½æ•°">2. requireå‡½æ•°</a></h3>
<p><code>require</code>ç”¨äºåŠ¨æ€åŠ è½½å’Œä½¿ç”¨æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">// å¼‚æ­¥åŠ è½½æ¨¡å—
require(['calculator', 'utils/string'], function(calc, stringUtils) {
    var result = calc.calculate('add', 5, 3);
    var message = stringUtils.capitalize('result is: ' + result);
    console.log(message); // "Result is: 8"
});
</code></pre>
<h4 id="é”™è¯¯å¤„ç†"><a class="header" href="#é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†</a></h4>
<pre><code class="language-javascript">require(['module1', 'module2'], 
    function(mod1, mod2) {
        // æˆåŠŸå›è°ƒ
        console.log('Modules loaded successfully');
    },
    function(error) {
        // é”™è¯¯å›è°ƒ
        console.error('Failed to load modules:', error);
    }
);
</code></pre>
<h3 id="3-requireconfigé…ç½®"><a class="header" href="#3-requireconfigé…ç½®">3. require.configé…ç½®</a></h3>
<pre><code class="language-javascript">require.config({
    // åŸºç¡€è·¯å¾„
    baseUrl: 'js/lib',
    
    // è·¯å¾„æ˜ å°„
    paths: {
        'jquery': 'jquery-3.6.0.min',
        'underscore': 'underscore-1.13.1.min',
        'backbone': 'backbone-1.4.0.min',
        'utils': '../utils',
        'components': '../components'
    },
    
    // æ¨¡å—ä¾èµ–é…ç½®ï¼ˆç”¨äºéAMDåº“ï¼‰
    shim: {
        'backbone': {
            deps: ['underscore', 'jquery'],
            exports: 'Backbone'
        },
        'underscore': {
            exports: '_'
        }
    },
    
    // è¶…æ—¶è®¾ç½®
    waitSeconds: 15,
    
    // URLå‚æ•°
    urlArgs: 'bust=' + (new Date()).getTime()
});
</code></pre>
<h2 id="å¸¸è§æ¨¡å¼"><a class="header" href="#å¸¸è§æ¨¡å¼">å¸¸è§æ¨¡å¼</a></h2>
<h3 id="1-ç®€å•å·¥å‚æ¨¡å¼"><a class="header" href="#1-ç®€å•å·¥å‚æ¨¡å¼">1. ç®€å•å·¥å‚æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// logger.js
define(function() {
    function createLogger(name) {
        return {
            name: name,
            log: function(message) {
                console.log('[' + this.name + '] ' + message);
            },
            error: function(message) {
                console.error('[' + this.name + '] ERROR: ' + message);
            }
        };
    }
    
    return {
        create: createLogger
    };
});
</code></pre>
<h3 id="2-å•ä¾‹æ¨¡å¼-1"><a class="header" href="#2-å•ä¾‹æ¨¡å¼-1">2. å•ä¾‹æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// config.js
define(function() {
    var instance = null;
    
    function Config() {
        if (instance) {
            return instance;
        }
        
        this.settings = {
            apiUrl: '/api',
            timeout: 5000,
            debug: false
        };
        
        instance = this;
        return this;
    }
    
    Config.prototype.get = function(key) {
        return this.settings[key];
    };
    
    Config.prototype.set = function(key, value) {
        this.settings[key] = value;
    };
    
    return new Config();
});
</code></pre>
<h3 id="3-æ¨¡å—ç»§æ‰¿"><a class="header" href="#3-æ¨¡å—ç»§æ‰¿">3. æ¨¡å—ç»§æ‰¿</a></h3>
<pre><code class="language-javascript">// base-view.js
define(function() {
    function BaseView(element) {
        this.element = element;
        this.initialize();
    }
    
    BaseView.prototype.initialize = function() {
        // åŸºç¡€åˆå§‹åŒ–é€»è¾‘
    };
    
    BaseView.prototype.render = function() {
        throw new Error('render method must be implemented');
    };
    
    BaseView.prototype.destroy = function() {
        this.element = null;
    };
    
    return BaseView;
});

// user-view.js
define(['base-view'], function(BaseView) {
    function UserView(element, user) {
        BaseView.call(this, element);
        this.user = user;
    }
    
    // ç»§æ‰¿BaseView
    UserView.prototype = Object.create(BaseView.prototype);
    UserView.prototype.constructor = UserView;
    
    UserView.prototype.render = function() {
        this.element.innerHTML = '&lt;h1&gt;' + this.user.name + '&lt;/h1&gt;';
        return this;
    };
    
    return UserView;
});
</code></pre>
<h3 id="4-æ’ä»¶æ¨¡å¼"><a class="header" href="#4-æ’ä»¶æ¨¡å¼">4. æ’ä»¶æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// textæ’ä»¶ - åŠ è½½æ–‡æœ¬æ–‡ä»¶
define('text', function() {
    return {
        load: function(name, req, onload, config) {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', name, true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        onload(xhr.responseText);
                    } else {
                        onload.error(xhr);
                    }
                }
            };
            xhr.send();
        }
    };
});

// ä½¿ç”¨textæ’ä»¶
define(['text!templates/user.html'], function(userTemplate) {
    return {
        render: function(user) {
            return userTemplate.replace('{{name}}', user.name);
        }
    };
});
</code></pre>
<h2 id="å®é™…åº”ç”¨ç¤ºä¾‹-1"><a class="header" href="#å®é™…åº”ç”¨ç¤ºä¾‹-1">å®é™…åº”ç”¨ç¤ºä¾‹</a></h2>
<h3 id="1-æ¨¡å—åŒ–åº”ç”¨ç»“æ„"><a class="header" href="#1-æ¨¡å—åŒ–åº”ç”¨ç»“æ„">1. æ¨¡å—åŒ–åº”ç”¨ç»“æ„</a></h3>
<pre><code class="language-javascript">// app.js - åº”ç”¨å…¥å£
require.config({
    baseUrl: 'js',
    paths: {
        'jquery': 'lib/jquery-3.6.0.min',
        'router': 'app/router',
        'views': 'app/views',
        'models': 'app/models',
        'utils': 'app/utils'
    }
});

require(['jquery', 'router'], function($, Router) {
    $(document).ready(function() {
        var router = new Router();
        router.start();
    });
});
</code></pre>
<pre><code class="language-javascript">// app/router.js
define(['jquery', 'views/home', 'views/user'], function($, HomeView, UserView) {
    function Router() {
        this.routes = {
            '': 'home',
            'user/:id': 'user'
        };
        this.views = {
            home: HomeView,
            user: UserView
        };
    }
    
    Router.prototype.start = function() {
        this.bindEvents();
        this.navigate(window.location.hash);
    };
    
    Router.prototype.bindEvents = function() {
        var self = this;
        $(window).on('hashchange', function() {
            self.navigate(window.location.hash);
        });
    };
    
    Router.prototype.navigate = function(hash) {
        var route = hash.replace('#', '');
        var viewName = this.matchRoute(route);
        if (viewName &amp;&amp; this.views[viewName]) {
            var View = this.views[viewName];
            new View().render();
        }
    };
    
    Router.prototype.matchRoute = function(route) {
        // ç®€åŒ–çš„è·¯ç”±åŒ¹é…
        for (var pattern in this.routes) {
            if (pattern === route || pattern === '') {
                return this.routes[pattern];
            }
        }
        return null;
    };
    
    return Router;
});
</code></pre>
<h3 id="2-ç»„ä»¶åŒ–å¼€å‘"><a class="header" href="#2-ç»„ä»¶åŒ–å¼€å‘">2. ç»„ä»¶åŒ–å¼€å‘</a></h3>
<pre><code class="language-javascript">// components/modal.js
define(['jquery'], function($) {
    function Modal(options) {
        this.options = $.extend({
            title: '',
            content: '',
            closable: true,
            width: 400,
            height: 300
        }, options);
        
        this.element = null;
        this.isVisible = false;
    }
    
    Modal.prototype.create = function() {
        if (this.element) {
            return this;
        }
        
        this.element = $('&lt;div class="modal"&gt;')
            .css({
                position: 'fixed',
                top: '50%',
                left: '50%',
                width: this.options.width,
                height: this.options.height,
                marginTop: -this.options.height / 2,
                marginLeft: -this.options.width / 2,
                backgroundColor: 'white',
                border: '1px solid #ccc',
                boxShadow: '0 4px 8px rgba(0,0,0,0.1)',
                zIndex: 1000,
                display: 'none'
            });
        
        var header = $('&lt;div class="modal-header"&gt;')
            .css({
                padding: '10px',
                borderBottom: '1px solid #eee',
                fontWeight: 'bold'
            })
            .text(this.options.title);
        
        var content = $('&lt;div class="modal-content"&gt;')
            .css({
                padding: '10px',
                height: this.options.height - 80
            })
            .html(this.options.content);
        
        this.element.append(header, content);
        
        if (this.options.closable) {
            var closeBtn = $('&lt;button&gt;Ã—&lt;/button&gt;')
                .css({
                    position: 'absolute',
                    top: '5px',
                    right: '10px',
                    border: 'none',
                    background: 'none',
                    fontSize: '18px',
                    cursor: 'pointer'
                })
                .click(this.hide.bind(this));
            header.append(closeBtn);
        }
        
        $('body').append(this.element);
        return this;
    };
    
    Modal.prototype.show = function() {
        if (!this.element) {
            this.create();
        }
        this.element.fadeIn();
        this.isVisible = true;
        return this;
    };
    
    Modal.prototype.hide = function() {
        if (this.element) {
            this.element.fadeOut();
        }
        this.isVisible = false;
        return this;
    };
    
    Modal.prototype.destroy = function() {
        if (this.element) {
            this.element.remove();
            this.element = null;
        }
        this.isVisible = false;
        return this;
    };
    
    return Modal;
});

// ä½¿ç”¨Modalç»„ä»¶
require(['components/modal'], function(Modal) {
    var modal = new Modal({
        title: 'Welcome',
        content: '&lt;p&gt;Welcome to our application!&lt;/p&gt;',
        width: 500,
        height: 200
    });
    
    $('#open-modal').click(function() {
        modal.show();
    });
});
</code></pre>
<h3 id="3-æ•°æ®æ¨¡å‹"><a class="header" href="#3-æ•°æ®æ¨¡å‹">3. æ•°æ®æ¨¡å‹</a></h3>
<pre><code class="language-javascript">// models/user.js
define(['utils/ajax'], function(ajax) {
    function User(data) {
        this.id = data.id || null;
        this.name = data.name || '';
        this.email = data.email || '';
        this.createdAt = data.createdAt || null;
    }
    
    User.prototype.save = function() {
        var url = this.id ? '/api/users/' + this.id : '/api/users';
        var method = this.id ? 'PUT' : 'POST';
        
        return ajax.request({
            url: url,
            method: method,
            data: this.toJSON()
        }).then(function(response) {
            this.id = response.id;
            return this;
        }.bind(this));
    };
    
    User.prototype.destroy = function() {
        if (!this.id) {
            return Promise.reject(new Error('Cannot delete user without ID'));
        }
        
        return ajax.request({
            url: '/api/users/' + this.id,
            method: 'DELETE'
        });
    };
    
    User.prototype.toJSON = function() {
        return {
            id: this.id,
            name: this.name,
            email: this.email,
            createdAt: this.createdAt
        };
    };
    
    // é™æ€æ–¹æ³•
    User.findById = function(id) {
        return ajax.request({
            url: '/api/users/' + id,
            method: 'GET'
        }).then(function(data) {
            return new User(data);
        });
    };
    
    User.findAll = function() {
        return ajax.request({
            url: '/api/users',
            method: 'GET'
        }).then(function(data) {
            return data.map(function(userData) {
                return new User(userData);
            });
        });
    };
    
    return User;
});
</code></pre>
<h2 id="amd-vs-å…¶ä»–æ¨¡å—ç³»ç»Ÿ"><a class="header" href="#amd-vs-å…¶ä»–æ¨¡å—ç³»ç»Ÿ">AMD vs å…¶ä»–æ¨¡å—ç³»ç»Ÿ</a></h2>
<h3 id="1-amd-vs-commonjs"><a class="header" href="#1-amd-vs-commonjs">1. AMD vs CommonJS</a></h3>
<pre><code class="language-javascript">// CommonJS (åŒæ­¥)
var math = require('./math');
var result = math.add(2, 3);

// AMD (å¼‚æ­¥)
define(['math'], function(math) {
    var result = math.add(2, 3);
});
</code></pre>
<h3 id="2-amd-vs-esæ¨¡å—"><a class="header" href="#2-amd-vs-esæ¨¡å—">2. AMD vs ESæ¨¡å—</a></h3>
<pre><code class="language-javascript">// ESæ¨¡å—
import { add } from './math.js';
const result = add(2, 3);

// AMD
define(['math'], function(math) {
    var result = math.add(2, 3);
});
</code></pre>
<h2 id="ä¼˜ç¼ºç‚¹åˆ†æ"><a class="header" href="#ä¼˜ç¼ºç‚¹åˆ†æ">ä¼˜ç¼ºç‚¹åˆ†æ</a></h2>
<h3 id="ä¼˜ç‚¹"><a class="header" href="#ä¼˜ç‚¹">ä¼˜ç‚¹</a></h3>
<ul>
<li>âœ… <strong>å¼‚æ­¥åŠ è½½</strong>: ä¸é˜»å¡é¡µé¢æ¸²æŸ“ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</li>
<li>âœ… <strong>ä¾èµ–ç®¡ç†</strong>: è‡ªåŠ¨å¤„ç†æ¨¡å—ä¾èµ–é¡ºåº</li>
<li>âœ… <strong>æµè§ˆå™¨åŸç”Ÿ</strong>: æ— éœ€é¢„ç¼–è¯‘ï¼Œç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ</li>
<li>âœ… <strong>æ’ä»¶ç³»ç»Ÿ</strong>: æ”¯æŒåŠ è½½å„ç§èµ„æºç±»å‹</li>
<li>âœ… <strong>é…ç½®çµæ´»</strong>: ä¸°å¯Œçš„é…ç½®é€‰é¡¹æ»¡è¶³ä¸åŒéœ€æ±‚</li>
</ul>
<h3 id="ç¼ºç‚¹"><a class="header" href="#ç¼ºç‚¹">ç¼ºç‚¹</a></h3>
<ul>
<li>âŒ <strong>è¯­æ³•å¤æ‚</strong>: ç›¸æ¯”ESæ¨¡å—è¯­æ³•è¾ƒä¸ºç¹ç</li>
<li>âŒ <strong>å›è°ƒåµŒå¥—</strong>: å¤æ‚ä¾èµ–å¯èƒ½å¯¼è‡´å›è°ƒåœ°ç‹±</li>
<li>âŒ <strong>æ€§èƒ½å¼€é”€</strong>: è¿è¡Œæ—¶ä¾èµ–è§£ææœ‰ä¸€å®šæ€§èƒ½æˆæœ¬</li>
<li>âŒ <strong>è°ƒè¯•å›°éš¾</strong>: å¼‚æ­¥åŠ è½½å¢åŠ è°ƒè¯•å¤æ‚åº¦</li>
<li>âŒ <strong>ç”Ÿæ€è¡°è½</strong>: ç°ä»£å¼€å‘æ›´å€¾å‘äºESæ¨¡å—</li>
</ul>
<h2 id="æ€»ç»“-12"><a class="header" href="#æ€»ç»“-12">æ€»ç»“</a></h2>
<p>AMDä½œä¸ºæ—©æœŸçš„æ¨¡å—åŒ–è§£å†³æ–¹æ¡ˆï¼Œä¸ºæµè§ˆå™¨ç«¯JavaScriptæ¨¡å—åŒ–å¼€å‘åšå‡ºäº†é‡è¦è´¡çŒ®ï¼š</p>
<ul>
<li>ğŸ¯ <strong>é€‚ç”¨åœºæ™¯</strong>: éœ€è¦æµè§ˆå™¨ç«¯å¼‚æ­¥åŠ è½½çš„ä¼ ç»Ÿé¡¹ç›®</li>
<li>ğŸ¯ <strong>å­¦ä¹ ä»·å€¼</strong>: ç†è§£æ¨¡å—åŒ–å‘å±•å†ç¨‹å’Œè®¾è®¡æ€æƒ³</li>
<li>ğŸ¯ <strong>ç°çŠ¶</strong>: é€æ¸è¢«ESæ¨¡å—å’Œç°ä»£æ„å»ºå·¥å…·å–ä»£</li>
</ul>
<p>è™½ç„¶AMDåœ¨ç°ä»£å¼€å‘ä¸­ä½¿ç”¨è¾ƒå°‘ï¼Œä½†ç†è§£å…¶è®¾è®¡åŸç†å¯¹äºæŒæ¡JavaScriptæ¨¡å—åŒ–å‘å±•å†ç¨‹ä»ç„¶å¾ˆæœ‰ä»·å€¼ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#requirejsè¯¦è§£">RequireJSè¯¦è§£</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="requirejsè¯¦è§£"><a class="header" href="#requirejsè¯¦è§£">RequireJSè¯¦è§£</a></h1>
<p>RequireJSæ˜¯AMDï¼ˆAsynchronous Module Definitionï¼‰è§„èŒƒæœ€æµè¡Œçš„å®ç°ï¼Œä¹Ÿæ˜¯æ—©æœŸæµè§ˆå™¨ç«¯æ¨¡å—åŒ–å¼€å‘çš„é‡è¦å·¥å…·ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨RequireJSçš„ä½¿ç”¨æ–¹æ³•ã€é…ç½®é€‰é¡¹ã€æœ€ä½³å®è·µå’Œå®é™…åº”ç”¨ã€‚</p>
<h2 id="requirejsç®€ä»‹"><a class="header" href="#requirejsç®€ä»‹">RequireJSç®€ä»‹</a></h2>
<p>RequireJSæ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶å’Œæ¨¡å—åŠ è½½å™¨ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>å¼‚æ­¥åŠ è½½</strong>: å¼‚æ­¥åŠ è½½JavaScriptæ–‡ä»¶ï¼Œæå‡é¡µé¢æ€§èƒ½</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>: è‡ªåŠ¨è§£æå’ŒåŠ è½½æ¨¡å—ä¾èµ–</li>
<li><strong>è·¨æµè§ˆå™¨</strong>: æ”¯æŒæ‰€æœ‰ç°ä»£æµè§ˆå™¨</li>
<li><strong>æ’ä»¶ç³»ç»Ÿ</strong>: ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ï¼Œæ”¯æŒåŠ è½½å„ç§èµ„æº</li>
<li><strong>ä¼˜åŒ–å·¥å…·</strong>: æä¾›r.jsä¼˜åŒ–å™¨è¿›è¡Œä»£ç åˆå¹¶å’Œå‹ç¼©</li>
</ul>
<h2 id="å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨"><a class="header" href="#å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨">å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨</a></h2>
<h3 id="1-å¼•å…¥requirejs"><a class="header" href="#1-å¼•å…¥requirejs">1. å¼•å…¥RequireJS</a></h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;RequireJS Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="app"&gt;&lt;/div&gt;
    
    &lt;!-- å¼•å…¥RequireJS --&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"&gt;&lt;/script&gt;
    
    &lt;!-- æˆ–è€…ä»æœ¬åœ°å¼•å…¥ --&gt;
    &lt;!-- &lt;script src="js/lib/require.js"&gt;&lt;/script&gt; --&gt;
    
    &lt;!-- æŒ‡å®šä¸»æ¨¡å— --&gt;
    &lt;script src="js/lib/require.js" data-main="js/app"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="2-åŸºæœ¬æ¨¡å—å®šä¹‰"><a class="header" href="#2-åŸºæœ¬æ¨¡å—å®šä¹‰">2. åŸºæœ¬æ¨¡å—å®šä¹‰</a></h3>
<pre><code class="language-javascript">// js/utils/math.js
define(function() {
    'use strict';
    
    return {
        add: function(a, b) {
            return a + b;
        },
        
        subtract: function(a, b) {
            return a - b;
        },
        
        multiply: function(a, b) {
            return a * b;
        },
        
        divide: function(a, b) {
            if (b === 0) {
                throw new Error('Division by zero');
            }
            return a / b;
        }
    };
});
</code></pre>
<h3 id="3-ä½¿ç”¨æ¨¡å—"><a class="header" href="#3-ä½¿ç”¨æ¨¡å—">3. ä½¿ç”¨æ¨¡å—</a></h3>
<pre><code class="language-javascript">// js/app.js - ä¸»åº”ç”¨æ–‡ä»¶
require(['utils/math'], function(math) {
    console.log('2 + 3 =', math.add(2, 3));
    console.log('10 - 4 =', math.subtract(10, 4));
    console.log('5 * 6 =', math.multiply(5, 6));
    console.log('15 / 3 =', math.divide(15, 3));
});
</code></pre>
<h2 id="é…ç½®ç³»ç»Ÿ"><a class="header" href="#é…ç½®ç³»ç»Ÿ">é…ç½®ç³»ç»Ÿ</a></h2>
<h3 id="1-åŸºç¡€é…ç½®"><a class="header" href="#1-åŸºç¡€é…ç½®">1. åŸºç¡€é…ç½®</a></h3>
<pre><code class="language-javascript">// js/config.js
require.config({
    // è®¾ç½®åŸºç¡€è·¯å¾„
    baseUrl: 'js',
    
    // è·¯å¾„æ˜ å°„
    paths: {
        // ç¬¬ä¸‰æ–¹åº“
        'jquery': 'lib/jquery-3.6.0.min',
        'underscore': 'lib/underscore-1.13.1.min',
        'backbone': 'lib/backbone-1.4.0.min',
        
        // åº”ç”¨æ¨¡å—
        'app': 'app',
        'models': 'app/models',
        'views': 'app/views',
        'collections': 'app/collections',
        'templates': '../templates'
    },
    
    // è¶…æ—¶è®¾ç½®ï¼ˆç§’ï¼‰
    waitSeconds: 30,
    
    // URLæŸ¥è¯¢å‚æ•°ï¼ˆç”¨äºç¼“å­˜ç ´åï¼‰
    urlArgs: 'v=' + (new Date()).getTime()
});

// å¯åŠ¨åº”ç”¨
require(['app/main'], function(main) {
    main.init();
});
</code></pre>
<h3 id="2-shimé…ç½®å…¼å®¹éamdåº“"><a class="header" href="#2-shimé…ç½®å…¼å®¹éamdåº“">2. Shimé…ç½®ï¼ˆå…¼å®¹éAMDåº“ï¼‰</a></h3>
<pre><code class="language-javascript">require.config({
    baseUrl: 'js',
    
    paths: {
        'jquery': 'lib/jquery-3.6.0.min',
        'underscore': 'lib/underscore-1.13.1.min',
        'backbone': 'lib/backbone-1.4.0.min',
        'bootstrap': 'lib/bootstrap-4.6.0.min',
        'd3': 'lib/d3-7.3.0.min'
    },
    
    // ä¸ºéAMDåº“é…ç½®ä¾èµ–å’Œå¯¼å‡º
    shim: {
        'underscore': {
            exports: '_'
        },
        'backbone': {
            deps: ['underscore', 'jquery'],
            exports: 'Backbone'
        },
        'bootstrap': {
            deps: ['jquery']
        },
        'd3': {
            exports: 'd3'
        }
    }
});
</code></pre>
<h3 id="3-é«˜çº§é…ç½®é€‰é¡¹"><a class="header" href="#3-é«˜çº§é…ç½®é€‰é¡¹">3. é«˜çº§é…ç½®é€‰é¡¹</a></h3>
<pre><code class="language-javascript">require.config({
    baseUrl: 'js',
    
    // æ˜ å°„é…ç½® - ä¸ºä¸åŒä¸Šä¸‹æ–‡ä½¿ç”¨ä¸åŒç‰ˆæœ¬
    map: {
        '*': {
            'jquery': 'jquery-3.6.0'
        },
        'legacy-module': {
            'jquery': 'jquery-1.12.4'
        }
    },
    
    // åŒ…é…ç½®
    packages: [
        {
            name: 'dojo',
            location: 'lib/dojo',
            main: 'main'
        }
    ],
    
    // é…ç½®æ–‡ä»¶
    config: {
        'app/config': {
            apiUrl: 'https://api.example.com',
            debug: true
        }
    },
    
    // å¼ºåˆ¶å®šä¹‰
    enforceDefine: true,
    
    // Node.jsé€‚é…
    nodeIdCompat: true
});
</code></pre>
<h2 id="æ’ä»¶ç³»ç»Ÿ"><a class="header" href="#æ’ä»¶ç³»ç»Ÿ">æ’ä»¶ç³»ç»Ÿ</a></h2>
<h3 id="1-textæ’ä»¶---åŠ è½½æ–‡æœ¬æ–‡ä»¶"><a class="header" href="#1-textæ’ä»¶---åŠ è½½æ–‡æœ¬æ–‡ä»¶">1. textæ’ä»¶ - åŠ è½½æ–‡æœ¬æ–‡ä»¶</a></h3>
<pre><code class="language-javascript">// å®‰è£…ï¼šä¸‹è½½text.jsåˆ°js/lib/ç›®å½•

// é…ç½®
require.config({
    paths: {
        'text': 'lib/text'
    }
});

// ä½¿ç”¨textæ’ä»¶åŠ è½½HTMLæ¨¡æ¿
define(['text!templates/user.html'], function(userTemplate) {
    return {
        render: function(user) {
            var html = userTemplate
                .replace('{{name}}', user.name)
                .replace('{{email}}', user.email);
            return html;
        }
    };
});
</code></pre>
<h3 id="2-domreadyæ’ä»¶---domå°±ç»ª"><a class="header" href="#2-domreadyæ’ä»¶---domå°±ç»ª">2. domReadyæ’ä»¶ - DOMå°±ç»ª</a></h3>
<pre><code class="language-javascript">// ä½¿ç”¨domReadyæ’ä»¶
require(['domReady!'], function() {
    // DOMå·²ç»å‡†å¤‡å°±ç»ª
    console.log('DOM is ready');
    
    // å¯ä»¥å®‰å…¨åœ°æ“ä½œDOM
    document.getElementById('app').innerHTML = 'Hello, World!';
});

// æˆ–è€…åœ¨æ¨¡å—ä¸­ä½¿ç”¨
define(['domReady!', 'jquery'], function(doc, $) {
    // DOMå’ŒjQueryéƒ½å·²å‡†å¤‡å°±ç»ª
    return {
        init: function() {
            $('#app').text('Application initialized');
        }
    };
});
</code></pre>
<h3 id="3-i18næ’ä»¶---å›½é™…åŒ–"><a class="header" href="#3-i18næ’ä»¶---å›½é™…åŒ–">3. i18næ’ä»¶ - å›½é™…åŒ–</a></h3>
<pre><code class="language-javascript">// é…ç½®i18n
require.config({
    config: {
        i18n: {
            locale: 'zh-cn' // è®¾ç½®é»˜è®¤è¯­è¨€
        }
    }
});

// åˆ›å»ºè¯­è¨€æ–‡ä»¶
// nls/messages.js
define({
    root: {
        greeting: 'Hello',
        goodbye: 'Goodbye'
    },
    'zh-cn': true,
    'en-us': true
});

// nls/zh-cn/messages.js
define({
    greeting: 'ä½ å¥½',
    goodbye: 'å†è§'
});

// ä½¿ç”¨i18n
define(['i18n!nls/messages'], function(messages) {
    return {
        greet: function() {
            return messages.greeting;
        }
    };
});
</code></pre>
<h3 id="4-cssæ’ä»¶---åŠ è½½css"><a class="header" href="#4-cssæ’ä»¶---åŠ è½½css">4. cssæ’ä»¶ - åŠ è½½CSS</a></h3>
<pre><code class="language-javascript">// ä½¿ç”¨cssæ’ä»¶
define(['css!styles/main.css'], function() {
    // CSSå·²ç»åŠ è½½
    return {
        init: function() {
            console.log('Styles loaded');
        }
    };
});
</code></pre>
<h3 id="5-è‡ªå®šä¹‰æ’ä»¶"><a class="header" href="#5-è‡ªå®šä¹‰æ’ä»¶">5. è‡ªå®šä¹‰æ’ä»¶</a></h3>
<pre><code class="language-javascript">// plugins/json.js - åŠ è½½JSONæ–‡ä»¶çš„æ’ä»¶
define(function() {
    return {
        load: function(name, req, onload, config) {
            if (config.isBuild) {
                // æ„å»ºæ—¶çš„å¤„ç†
                onload(null);
                return;
            }
            
            var xhr = new XMLHttpRequest();
            xhr.open('GET', name + '.json', true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        try {
                            var data = JSON.parse(xhr.responseText);
                            onload(data);
                        } catch (e) {
                            onload.error(e);
                        }
                    } else {
                        onload.error(new Error('HTTP ' + xhr.status));
                    }
                }
            };
            xhr.send();
        }
    };
});

// ä½¿ç”¨è‡ªå®šä¹‰æ’ä»¶
define(['json!data/config'], function(config) {
    console.log('Loaded config:', config);
});
</code></pre>
<h2 id="å®é™…é¡¹ç›®åº”ç”¨"><a class="header" href="#å®é™…é¡¹ç›®åº”ç”¨">å®é™…é¡¹ç›®åº”ç”¨</a></h2>
<h3 id="1-å¤§å‹å•é¡µåº”ç”¨æ¶æ„"><a class="header" href="#1-å¤§å‹å•é¡µåº”ç”¨æ¶æ„">1. å¤§å‹å•é¡µåº”ç”¨æ¶æ„</a></h3>
<pre><code class="language-javascript">// js/app/main.js - åº”ç”¨å…¥å£
define([
    'jquery',
    'backbone',
    'app/router',
    'app/models/user',
    'app/views/layout'
], function($, Backbone, Router, User, LayoutView) {
    
    var App = {
        Models: {},
        Views: {},
        Collections: {},
        Router: null,
        
        init: function() {
            // åˆå§‹åŒ–å¸ƒå±€
            this.layout = new LayoutView({
                el: '#app'
            });
            
            // åˆå§‹åŒ–è·¯ç”±
            this.router = new Router();
            
            // å¯åŠ¨åº”ç”¨
            this.start();
        },
        
        start: function() {
            // æ¸²æŸ“å¸ƒå±€
            this.layout.render();
            
            // å¯åŠ¨Backboneè·¯ç”±
            Backbone.history.start({
                pushState: true,
                root: '/'
            });
            
            console.log('Application started');
        }
    };
    
    return App;
});
</code></pre>
<pre><code class="language-javascript">// js/app/router.js - è·¯ç”±å™¨
define([
    'backbone',
    'app/views/home',
    'app/views/users',
    'app/views/profile'
], function(Backbone, HomeView, UsersView, ProfileView) {
    
    var Router = Backbone.Router.extend({
        routes: {
            '': 'home',
            'users': 'users',
            'users/:id': 'profile',
            '*notfound': 'notFound'
        },
        
        home: function() {
            var view = new HomeView();
            this.showView(view);
        },
        
        users: function() {
            var view = new UsersView();
            this.showView(view);
        },
        
        profile: function(id) {
            var view = new ProfileView({ userId: id });
            this.showView(view);
        },
        
        notFound: function() {
            console.log('404 - Page not found');
        },
        
        showView: function(view) {
            // æ¸…ç†ä¹‹å‰çš„è§†å›¾
            if (this.currentView) {
                this.currentView.remove();
            }
            
            // æ˜¾ç¤ºæ–°è§†å›¾
            this.currentView = view;
            view.render();
        }
    });
    
    return Router;
});
</code></pre>
<h3 id="2-æ¨¡å—åŒ–ç»„ä»¶ç³»ç»Ÿ"><a class="header" href="#2-æ¨¡å—åŒ–ç»„ä»¶ç³»ç»Ÿ">2. æ¨¡å—åŒ–ç»„ä»¶ç³»ç»Ÿ</a></h3>
<pre><code class="language-javascript">// js/components/base-component.js - åŸºç¡€ç»„ä»¶
define(['jquery'], function($) {
    
    function BaseComponent(options) {
        this.options = $.extend(true, {}, this.defaults, options);
        this.element = null;
        this.initialized = false;
        
        this.init();
    }
    
    BaseComponent.prototype = {
        defaults: {},
        
        init: function() {
            this.createElement();
            this.bindEvents();
            this.initialized = true;
        },
        
        createElement: function() {
            throw new Error('createElement must be implemented');
        },
        
        bindEvents: function() {
            // å­ç±»å¯ä»¥é‡å†™
        },
        
        render: function() {
            throw new Error('render must be implemented');
        },
        
        destroy: function() {
            if (this.element) {
                this.element.remove();
            }
            this.initialized = false;
        }
    };
    
    return BaseComponent;
});

// js/components/data-table.js - æ•°æ®è¡¨ç»„ä»¶
define([
    'components/base-component',
    'text!templates/data-table.html'
], function(BaseComponent, tableTemplate) {
    
    function DataTable(options) {
        BaseComponent.call(this, options);
    }
    
    // ç»§æ‰¿BaseComponent
    DataTable.prototype = Object.create(BaseComponent.prototype);
    DataTable.prototype.constructor = DataTable;
    
    DataTable.prototype.defaults = {
        columns: [],
        data: [],
        sortable: true,
        pageable: true,
        pageSize: 10
    };
    
    DataTable.prototype.createElement = function() {
        this.element = $(tableTemplate);
    };
    
    DataTable.prototype.bindEvents = function() {
        var self = this;
        
        // æ’åºäº‹ä»¶
        if (this.options.sortable) {
            this.element.on('click', 'th[data-sortable]', function() {
                var column = $(this).data('column');
                self.sort(column);
            });
        }
        
        // åˆ†é¡µäº‹ä»¶
        if (this.options.pageable) {
            this.element.on('click', '.pagination a', function(e) {
                e.preventDefault();
                var page = $(this).data('page');
                self.goToPage(page);
            });
        }
    };
    
    DataTable.prototype.render = function() {
        this.renderHeader();
        this.renderBody();
        this.renderPagination();
        return this;
    };
    
    DataTable.prototype.renderHeader = function() {
        var headerHtml = '&lt;tr&gt;';
        this.options.columns.forEach(function(column) {
            var sortable = column.sortable !== false ? 'data-sortable data-column="' + column.field + '"' : '';
            headerHtml += '&lt;th ' + sortable + '&gt;' + column.title + '&lt;/th&gt;';
        });
        headerHtml += '&lt;/tr&gt;';
        
        this.element.find('thead').html(headerHtml);
    };
    
    DataTable.prototype.renderBody = function() {
        var self = this;
        var bodyHtml = '';
        
        var data = this.getCurrentPageData();
        data.forEach(function(row) {
            bodyHtml += '&lt;tr&gt;';
            self.options.columns.forEach(function(column) {
                var value = row[column.field];
                if (column.formatter) {
                    value = column.formatter(value, row);
                }
                bodyHtml += '&lt;td&gt;' + value + '&lt;/td&gt;';
            });
            bodyHtml += '&lt;/tr&gt;';
        });
        
        this.element.find('tbody').html(bodyHtml);
    };
    
    DataTable.prototype.getCurrentPageData = function() {
        if (!this.options.pageable) {
            return this.options.data;
        }
        
        var start = (this.currentPage - 1) * this.options.pageSize;
        var end = start + this.options.pageSize;
        return this.options.data.slice(start, end);
    };
    
    DataTable.prototype.sort = function(column) {
        // æ’åºé€»è¾‘
        console.log('Sorting by:', column);
    };
    
    DataTable.prototype.goToPage = function(page) {
        this.currentPage = page;
        this.render();
    };
    
    return DataTable;
});
</code></pre>
<h3 id="3-apié›†æˆ"><a class="header" href="#3-apié›†æˆ">3. APIé›†æˆ</a></h3>
<pre><code class="language-javascript">// js/services/api.js - APIæœåŠ¡
define(['jquery'], function($) {
    
    var Api = {
        baseUrl: '/api/v1',
        
        request: function(options) {
            var defaults = {
                url: '',
                method: 'GET',
                data: null,
                headers: {
                    'Content-Type': 'application/json'
                },
                timeout: 30000
            };
            
            var config = $.extend(true, {}, defaults, options);
            config.url = this.baseUrl + config.url;
            
            // æ·»åŠ è®¤è¯å¤´
            var token = this.getAuthToken();
            if (token) {
                config.headers['Authorization'] = 'Bearer ' + token;
            }
            
            return $.ajax(config).fail(function(xhr, status, error) {
                console.error('API request failed:', error);
                
                // å¤„ç†è®¤è¯å¤±è´¥
                if (xhr.status === 401) {
                    Api.handleAuthError();
                }
            });
        },
        
        get: function(url, params) {
            return this.request({
                url: url,
                method: 'GET',
                data: params
            });
        },
        
        post: function(url, data) {
            return this.request({
                url: url,
                method: 'POST',
                data: JSON.stringify(data)
            });
        },
        
        put: function(url, data) {
            return this.request({
                url: url,
                method: 'PUT',
                data: JSON.stringify(data)
            });
        },
        
        delete: function(url) {
            return this.request({
                url: url,
                method: 'DELETE'
            });
        },
        
        getAuthToken: function() {
            return localStorage.getItem('auth_token');
        },
        
        setAuthToken: function(token) {
            localStorage.setItem('auth_token', token);
        },
        
        clearAuthToken: function() {
            localStorage.removeItem('auth_token');
        },
        
        handleAuthError: function() {
            this.clearAuthToken();
            window.location.href = '/login';
        }
    };
    
    return Api;
});

// js/models/user.js - ç”¨æˆ·æ¨¡å‹
define(['services/api'], function(Api) {
    
    function User(data) {
        this.id = data.id || null;
        this.name = data.name || '';
        this.email = data.email || '';
        this.role = data.role || 'user';
        this.createdAt = data.createdAt || null;
    }
    
    User.prototype.save = function() {
        var url = this.id ? '/users/' + this.id : '/users';
        var method = this.id ? 'put' : 'post';
        
        return Api[method](url, this.toJSON()).then(function(response) {
            if (!this.id) {
                this.id = response.id;
            }
            return this;
        }.bind(this));
    };
    
    User.prototype.destroy = function() {
        if (!this.id) {
            return Promise.reject(new Error('Cannot delete user without ID'));
        }
        
        return Api.delete('/users/' + this.id);
    };
    
    User.prototype.toJSON = function() {
        return {
            id: this.id,
            name: this.name,
            email: this.email,
            role: this.role
        };
    };
    
    // é™æ€æ–¹æ³•
    User.findById = function(id) {
        return Api.get('/users/' + id).then(function(data) {
            return new User(data);
        });
    };
    
    User.findAll = function(params) {
        return Api.get('/users', params).then(function(data) {
            return data.map(function(userData) {
                return new User(userData);
            });
        });
    };
    
    return User;
});
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–-2"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-2">æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="1-rjsæ„å»ºä¼˜åŒ–"><a class="header" href="#1-rjsæ„å»ºä¼˜åŒ–">1. r.jsæ„å»ºä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// build.js - r.jsæ„å»ºé…ç½®
({
    appDir: '../src',
    baseUrl: 'js',
    dir: '../dist',
    
    // æ¨¡å—é…ç½®
    modules: [
        {
            name: 'app/main',
            include: [
                'app/router',
                'app/models/user',
                'app/views/layout'
            ]
        }
    ],
    
    // è·¯å¾„é…ç½®
    paths: {
        'jquery': 'lib/jquery-3.6.0.min',
        'underscore': 'lib/underscore-1.13.1.min',
        'backbone': 'lib/backbone-1.4.0.min'
    },
    
    // æ–‡ä»¶æ’é™¤
    fileExclusionRegExp: /^(r|build)\.js$/,
    
    // ä¼˜åŒ–é€‰é¡¹
    optimize: 'uglify2',
    preserveLicenseComments: false,
    generateSourceMaps: true,
    
    // ç§»é™¤console.log
    uglify2: {
        output: {
            beautify: false
        },
        compress: {
            drop_console: true
        }
    }
})
</code></pre>
<h3 id="2-è¿è¡Œæ—¶ä¼˜åŒ–"><a class="header" href="#2-è¿è¡Œæ—¶ä¼˜åŒ–">2. è¿è¡Œæ—¶ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// æ‡’åŠ è½½ç­–ç•¥
define(['jquery'], function($) {
    
    var LazyLoader = {
        cache: {},
        
        loadModule: function(moduleName) {
            if (this.cache[moduleName]) {
                return Promise.resolve(this.cache[moduleName]);
            }
            
            return new Promise(function(resolve, reject) {
                require([moduleName], function(module) {
                    this.cache[moduleName] = module;
                    resolve(module);
                }.bind(this), reject);
            }.bind(this));
        },
        
        preloadModules: function(moduleNames) {
            var promises = moduleNames.map(function(name) {
                return this.loadModule(name);
            }.bind(this));
            
            return Promise.all(promises);
        }
    };
    
    return LazyLoader;
});

// ä»£ç åˆ†å‰²
require.config({
    bundles: {
        'bundle-admin': ['app/admin/dashboard', 'app/admin/users'],
        'bundle-public': ['app/public/home', 'app/public/about']
    }
});
</code></pre>
<h2 id="è°ƒè¯•å’Œæµ‹è¯•"><a class="header" href="#è°ƒè¯•å’Œæµ‹è¯•">è°ƒè¯•å’Œæµ‹è¯•</a></h2>
<h3 id="1-å¼€å‘ç¯å¢ƒé…ç½®"><a class="header" href="#1-å¼€å‘ç¯å¢ƒé…ç½®">1. å¼€å‘ç¯å¢ƒé…ç½®</a></h3>
<pre><code class="language-javascript">// js/config-dev.js
require.config({
    baseUrl: 'js',
    
    paths: {
        'jquery': 'lib/jquery-3.6.0',  // ä½¿ç”¨æœªå‹ç¼©ç‰ˆæœ¬
        'underscore': 'lib/underscore-1.13.1',
        'backbone': 'lib/backbone-1.4.0'
    },
    
    // ç¦ç”¨ç¼“å­˜
    urlArgs: 'bust=' + (new Date()).getTime(),
    
    // å¯ç”¨è¯¦ç»†é”™è¯¯
    enforceDefine: true,
    
    // ç¼©çŸ­è¶…æ—¶ä»¥å¿«é€Ÿå‘ç°é—®é¢˜
    waitSeconds: 7
});

// å…¨å±€é”™è¯¯å¤„ç†
requirejs.onError = function(err) {
    console.error('RequireJS Error:', err);
    console.error('Error type:', err.requireType);
    console.error('Error modules:', err.requireModules);
    
    if (err.requireType === 'timeout') {
        console.error('Modules that timed out:', err.requireModules);
    }
};
</code></pre>
<h3 id="2-å•å…ƒæµ‹è¯•"><a class="header" href="#2-å•å…ƒæµ‹è¯•">2. å•å…ƒæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// test/test-main.js - æµ‹è¯•é…ç½®
require.config({
    baseUrl: '../js',
    
    paths: {
        'jasmine': '../test/lib/jasmine-2.9.1/jasmine',
        'jasmine-html': '../test/lib/jasmine-2.9.1/jasmine-html',
        'jasmine-boot': '../test/lib/jasmine-2.9.1/boot',
        
        // åº”ç”¨æ¨¡å—
        'utils': 'utils',
        'models': 'app/models'
    },
    
    shim: {
        'jasmine-html': ['jasmine'],
        'jasmine-boot': ['jasmine', 'jasmine-html']
    }
});

// åŠ è½½æµ‹è¯•
require(['jasmine-boot'], function() {
    require([
        'test/utils/math-test',
        'test/models/user-test'
    ], function() {
        // å¯åŠ¨æµ‹è¯•
        window.onload();
    });
});

// test/utils/math-test.js
define(['utils/math'], function(math) {
    describe('Math Utils', function() {
        it('should add two numbers', function() {
            expect(math.add(2, 3)).toBe(5);
        });
        
        it('should subtract two numbers', function() {
            expect(math.subtract(5, 3)).toBe(2);
        });
        
        it('should throw error on division by zero', function() {
            expect(function() {
                math.divide(10, 0);
            }).toThrow();
        });
    });
});
</code></pre>
<h2 id="æ€»ç»“-13"><a class="header" href="#æ€»ç»“-13">æ€»ç»“</a></h2>
<p>RequireJSä½œä¸ºAMDè§„èŒƒçš„ä¸»è¦å®ç°ï¼Œæä¾›äº†å®Œæ•´çš„æ¨¡å—åŒ–è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>
<p>âœ… <strong>æˆç†Ÿç¨³å®š</strong>: ç»è¿‡å¤§é‡é¡¹ç›®éªŒè¯çš„å¯é å·¥å…·</p>
</li>
<li>
<p>âœ… <strong>åŠŸèƒ½ä¸°å¯Œ</strong>: å®Œæ•´çš„é…ç½®ç³»ç»Ÿå’Œæ’ä»¶ç”Ÿæ€</p>
</li>
<li>
<p>âœ… <strong>å·¥å…·å®Œå–„</strong>: æä¾›æ„å»ºä¼˜åŒ–å’Œè°ƒè¯•æ”¯æŒ</p>
</li>
<li>
<p>âœ… <strong>æ–‡æ¡£è¯¦ç»†</strong>: æœ‰è¯¦ç»†çš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒ</p>
</li>
<li>
<p>âŒ <strong>è¯­æ³•å¤æ‚</strong>: ç›¸æ¯”ç°ä»£æ¨¡å—ç³»ç»Ÿè¯­æ³•è¾ƒä¸ºå¤æ‚</p>
</li>
<li>
<p>âŒ <strong>ä½“ç§¯è¾ƒå¤§</strong>: è¿è¡Œæ—¶åº“å¢åŠ äº†é¡µé¢è´Ÿæ‹…</p>
</li>
<li>
<p>âŒ <strong>ç”Ÿæ€è¡°è½</strong>: ç°ä»£å¼€å‘æ›´å€¾å‘äºESæ¨¡å—å’Œæ„å»ºå·¥å…·</p>
</li>
</ul>
<p>è™½ç„¶RequireJSåœ¨ç°ä»£å¼€å‘ä¸­é€æ¸è¢«æ–°æŠ€æœ¯å–ä»£ï¼Œä½†å®ƒä¸ºJavaScriptæ¨¡å—åŒ–å‘å±•åšå‡ºäº†é‡è¦è´¡çŒ®ï¼Œç†è§£å…¶åŸç†å’Œä½¿ç”¨æ–¹æ³•å¯¹äºæŒæ¡å‰ç«¯å‘å±•å†ç¨‹å¾ˆæœ‰ä»·å€¼ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#umdé€šç”¨æ¨¡å—å®šä¹‰">UMDé€šç”¨æ¨¡å—</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="umdé€šç”¨æ¨¡å—å®šä¹‰"><a class="header" href="#umdé€šç”¨æ¨¡å—å®šä¹‰">UMDé€šç”¨æ¨¡å—å®šä¹‰</a></h1>
<p>UMDï¼ˆUniversal Module Definitionï¼Œé€šç”¨æ¨¡å—å®šä¹‰ï¼‰æ˜¯ä¸€ç§JavaScriptæ¨¡å—æ¨¡å¼ï¼Œæ—¨åœ¨åˆ›å»ºå¯ä»¥åœ¨å¤šç§ç¯å¢ƒä¸­å·¥ä½œçš„æ¨¡å—ã€‚å®ƒç»“åˆäº†CommonJSã€AMDå’Œå…¨å±€å˜é‡æ¨¡å¼çš„ç‰¹ç‚¹ï¼Œä½¿æ¨¡å—èƒ½å¤Ÿåœ¨Node.jsã€æµè§ˆå™¨å’ŒAMDåŠ è½½å™¨ä¸­éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯umd"><a class="header" href="#ä»€ä¹ˆæ˜¯umd">ä»€ä¹ˆæ˜¯UMD</a></h2>
<p>UMDæ˜¯ä¸€ç§æ¨¡å—åŒ…è£…å™¨æ¨¡å¼ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>è·¨å¹³å°å…¼å®¹</strong>: åŒä¸€ä¸ªæ¨¡å—å¯ä»¥åœ¨ä¸åŒç¯å¢ƒä¸­ä½¿ç”¨</li>
<li><strong>è‡ªåŠ¨æ£€æµ‹</strong>: è‡ªåŠ¨æ£€æµ‹å½“å‰ç¯å¢ƒå¹¶é€‰æ‹©åˆé€‚çš„æ¨¡å—ç³»ç»Ÿ</li>
<li><strong>å‘åå…¼å®¹</strong>: æ”¯æŒæ—§ç‰ˆæœ¬æµè§ˆå™¨å’Œæ—§çš„æ¨¡å—ç³»ç»Ÿ</li>
<li><strong>æ— ä¾èµ–</strong>: ä¸éœ€è¦é¢å¤–çš„åŠ è½½å™¨æˆ–æ„å»ºå·¥å…·</li>
<li><strong>çµæ´»æ€§</strong>: å¯ä»¥æ ¹æ®éœ€è¦å®šåˆ¶æ£€æµ‹é€»è¾‘</li>
</ul>
<h2 id="umdåŸºæœ¬æ¨¡å¼"><a class="header" href="#umdåŸºæœ¬æ¨¡å¼">UMDåŸºæœ¬æ¨¡å¼</a></h2>
<h3 id="1-æ ‡å‡†umdæ¨¡å¼"><a class="header" href="#1-æ ‡å‡†umdæ¨¡å¼">1. æ ‡å‡†UMDæ¨¡å¼</a></h3>
<pre><code class="language-javascript">(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        // AMDç¯å¢ƒ
        define(['dependency1', 'dependency2'], factory);
    } else if (typeof module === 'object' &amp;&amp; module.exports) {
        // Node.js/CommonJSç¯å¢ƒ
        module.exports = factory(require('dependency1'), require('dependency2'));
    } else {
        // æµè§ˆå™¨å…¨å±€å˜é‡ç¯å¢ƒ
        root.MyModule = factory(root.Dependency1, root.Dependency2);
    }
}(typeof self !== 'undefined' ? self : this, function (dependency1, dependency2) {
    'use strict';
    
    // æ¨¡å—å®ç°
    function MyModule() {
        // æ„é€ å‡½æ•°
    }
    
    MyModule.prototype.method1 = function() {
        return 'method1 result';
    };
    
    MyModule.prototype.method2 = function() {
        return dependency1.someFunction() + dependency2.someOtherFunction();
    };
    
    // è¿”å›æ¨¡å—
    return MyModule;
}));
</code></pre>
<h3 id="2-ç®€åŒ–ç‰ˆumd"><a class="header" href="#2-ç®€åŒ–ç‰ˆumd">2. ç®€åŒ–ç‰ˆUMD</a></h3>
<pre><code class="language-javascript">(function (global, factory) {
    typeof exports === 'object' &amp;&amp; typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' &amp;&amp; define.amd ? define(factory) :
    (global = global || self, global.MyModule = factory());
}(this, function () {
    'use strict';
    
    // æ¨¡å—å®ç°
    var MyModule = {
        version: '1.0.0',
        
        init: function() {
            console.log('MyModule initialized');
        },
        
        destroy: function() {
            console.log('MyModule destroyed');
        }
    };
    
    return MyModule;
}));
</code></pre>
<h3 id="3-æ— ä¾èµ–umdæ¨¡å¼"><a class="header" href="#3-æ— ä¾èµ–umdæ¨¡å¼">3. æ— ä¾èµ–UMDæ¨¡å¼</a></h3>
<pre><code class="language-javascript">(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        // AMD
        define([], factory);
    } else if (typeof exports === 'object') {
        // Node.js
        module.exports = factory();
    } else {
        // æµè§ˆå™¨å…¨å±€å˜é‡
        root.Utils = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {
    
    var Utils = {
        // ç±»å‹æ£€æŸ¥å·¥å…·
        isArray: Array.isArray || function(obj) {
            return Object.prototype.toString.call(obj) === '[object Array]';
        },
        
        isObject: function(obj) {
            return obj !== null &amp;&amp; typeof obj === 'object' &amp;&amp; !this.isArray(obj);
        },
        
        isFunction: function(obj) {
            return typeof obj === 'function';
        },
        
        // å¯¹è±¡å·¥å…·
        extend: function(target) {
            var sources = Array.prototype.slice.call(arguments, 1);
            sources.forEach(function(source) {
                for (var key in source) {
                    if (source.hasOwnProperty(key)) {
                        target[key] = source[key];
                    }
                }
            });
            return target;
        },
        
        clone: function(obj) {
            if (!this.isObject(obj)) return obj;
            var cloned = {};
            for (var key in obj) {
                if (obj.hasOwnProperty(key)) {
                    cloned[key] = this.isObject(obj[key]) ? this.clone(obj[key]) : obj[key];
                }
            }
            return cloned;
        },
        
        // æ•°ç»„å·¥å…·
        unique: function(array) {
            var result = [];
            for (var i = 0; i &lt; array.length; i++) {
                if (result.indexOf(array[i]) === -1) {
                    result.push(array[i]);
                }
            }
            return result;
        },
        
        // å­—ç¬¦ä¸²å·¥å…·
        camelCase: function(str) {
            return str.replace(/-([a-z])/g, function(match, letter) {
                return letter.toUpperCase();
            });
        },
        
        kebabCase: function(str) {
            return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
        }
    };
    
    return Utils;
}));
</code></pre>
<h2 id="å®é™…åº”ç”¨ç¤ºä¾‹-2"><a class="header" href="#å®é™…åº”ç”¨ç¤ºä¾‹-2">å®é™…åº”ç”¨ç¤ºä¾‹</a></h2>
<h3 id="1-æ•°å­¦å·¥å…·åº“"><a class="header" href="#1-æ•°å­¦å·¥å…·åº“">1. æ•°å­¦å·¥å…·åº“</a></h3>
<pre><code class="language-javascript">(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        define([], factory);
    } else if (typeof module === 'object' &amp;&amp; module.exports) {
        module.exports = factory();
    } else {
        root.MathUtils = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {
    'use strict';
    
    var MathUtils = {
        // å¸¸é‡
        PI: Math.PI,
        E: Math.E,
        
        // åŸºç¡€è¿ç®—
        add: function(a, b) {
            return a + b;
        },
        
        subtract: function(a, b) {
            return a - b;
        },
        
        multiply: function(a, b) {
            return a * b;
        },
        
        divide: function(a, b) {
            if (b === 0) throw new Error('Division by zero');
            return a / b;
        },
        
        // é«˜çº§è¿ç®—
        power: function(base, exponent) {
            return Math.pow(base, exponent);
        },
        
        sqrt: function(n) {
            if (n &lt; 0) throw new Error('Cannot calculate square root of negative number');
            return Math.sqrt(n);
        },
        
        factorial: function(n) {
            if (n &lt; 0) throw new Error('Cannot calculate factorial of negative number');
            if (n === 0 || n === 1) return 1;
            var result = 1;
            for (var i = 2; i &lt;= n; i++) {
                result *= i;
            }
            return result;
        },
        
        // å‡ ä½•è®¡ç®—
        circleArea: function(radius) {
            return this.PI * radius * radius;
        },
        
        circleCircumference: function(radius) {
            return 2 * this.PI * radius;
        },
        
        rectangleArea: function(width, height) {
            return width * height;
        },
        
        triangleArea: function(base, height) {
            return 0.5 * base * height;
        },
        
        // ç»Ÿè®¡å‡½æ•°
        average: function(numbers) {
            if (!Array.isArray(numbers) || numbers.length === 0) {
                throw new Error('Input must be a non-empty array');
            }
            var sum = numbers.reduce(function(acc, num) {
                return acc + num;
            }, 0);
            return sum / numbers.length;
        },
        
        median: function(numbers) {
            if (!Array.isArray(numbers) || numbers.length === 0) {
                throw new Error('Input must be a non-empty array');
            }
            var sorted = numbers.slice().sort(function(a, b) { return a - b; });
            var middle = Math.floor(sorted.length / 2);
            
            if (sorted.length % 2 === 0) {
                return (sorted[middle - 1] + sorted[middle]) / 2;
            } else {
                return sorted[middle];
            }
        },
        
        max: function(numbers) {
            if (!Array.isArray(numbers) || numbers.length === 0) {
                throw new Error('Input must be a non-empty array');
            }
            return Math.max.apply(Math, numbers);
        },
        
        min: function(numbers) {
            if (!Array.isArray(numbers) || numbers.length === 0) {
                throw new Error('Input must be a non-empty array');
            }
            return Math.min.apply(Math, numbers);
        }
    };
    
    return MathUtils;
}));
</code></pre>
<h3 id="2-äº‹ä»¶å‘å°„å™¨"><a class="header" href="#2-äº‹ä»¶å‘å°„å™¨">2. äº‹ä»¶å‘å°„å™¨</a></h3>
<pre><code class="language-javascript">(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        define([], factory);
    } else if (typeof module === 'object' &amp;&amp; module.exports) {
        module.exports = factory();
    } else {
        root.EventEmitter = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {
    'use strict';
    
    function EventEmitter() {
        this._events = {};
        this._maxListeners = 10;
    }
    
    EventEmitter.prototype = {
        constructor: EventEmitter,
        
        // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        on: function(event, listener) {
            if (typeof listener !== 'function') {
                throw new TypeError('Listener must be a function');
            }
            
            if (!this._events[event]) {
                this._events[event] = [];
            }
            
            this._events[event].push(listener);
            
            // æ£€æŸ¥ç›‘å¬å™¨æ•°é‡
            if (this._events[event].length &gt; this._maxListeners) {
                console.warn('MaxListenersExceededWarning: Possible memory leak detected. ' +
                    this._events[event].length + ' ' + event + ' listeners added.');
            }
            
            return this;
        },
        
        // æ·»åŠ ä¸€æ¬¡æ€§äº‹ä»¶ç›‘å¬å™¨
        once: function(event, listener) {
            if (typeof listener !== 'function') {
                throw new TypeError('Listener must be a function');
            }
            
            var self = this;
            function onceWrapper() {
                listener.apply(this, arguments);
                self.removeListener(event, onceWrapper);
            }
            
            onceWrapper.listener = listener;
            return this.on(event, onceWrapper);
        },
        
        // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
        removeListener: function(event, listener) {
            if (typeof listener !== 'function') {
                throw new TypeError('Listener must be a function');
            }
            
            if (!this._events[event]) {
                return this;
            }
            
            var listeners = this._events[event];
            for (var i = listeners.length - 1; i &gt;= 0; i--) {
                if (listeners[i] === listener || listeners[i].listener === listener) {
                    listeners.splice(i, 1);
                    break;
                }
            }
            
            if (listeners.length === 0) {
                delete this._events[event];
            }
            
            return this;
        },
        
        // ç§»é™¤æ‰€æœ‰ç›‘å¬å™¨
        removeAllListeners: function(event) {
            if (event) {
                delete this._events[event];
            } else {
                this._events = {};
            }
            return this;
        },
        
        // è§¦å‘äº‹ä»¶
        emit: function(event) {
            if (!this._events[event]) {
                return false;
            }
            
            var listeners = this._events[event].slice();
            var args = Array.prototype.slice.call(arguments, 1);
            
            for (var i = 0; i &lt; listeners.length; i++) {
                try {
                    listeners[i].apply(this, args);
                } catch (error) {
                    console.error('Error in event listener:', error);
                }
            }
            
            return true;
        },
        
        // è·å–ç›‘å¬å™¨åˆ—è¡¨
        listeners: function(event) {
            return this._events[event] ? this._events[event].slice() : [];
        },
        
        // è·å–ç›‘å¬å™¨æ•°é‡
        listenerCount: function(event) {
            return this._events[event] ? this._events[event].length : 0;
        },
        
        // è®¾ç½®æœ€å¤§ç›‘å¬å™¨æ•°é‡
        setMaxListeners: function(n) {
            if (typeof n !== 'number' || n &lt; 0) {
                throw new TypeError('n must be a non-negative number');
            }
            this._maxListeners = n;
            return this;
        },
        
        // è·å–æœ€å¤§ç›‘å¬å™¨æ•°é‡
        getMaxListeners: function() {
            return this._maxListeners;
        }
    };
    
    // é™æ€æ–¹æ³•
    EventEmitter.listenerCount = function(emitter, event) {
        return emitter.listenerCount(event);
    };
    
    return EventEmitter;
}));
</code></pre>
<h3 id="3-httpå®¢æˆ·ç«¯"><a class="header" href="#3-httpå®¢æˆ·ç«¯">3. HTTPå®¢æˆ·ç«¯</a></h3>
<pre><code class="language-javascript">(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        define([], factory);
    } else if (typeof module === 'object' &amp;&amp; module.exports) {
        module.exports = factory();
    } else {
        root.HttpClient = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {
    'use strict';
    
    // æ£€æµ‹ç¯å¢ƒ
    var isNode = typeof module === 'object' &amp;&amp; module.exports;
    var XMLHttpRequest = isNode ? null : (
        typeof XMLHttpRequest !== 'undefined' ? XMLHttpRequest :
        typeof ActiveXObject !== 'undefined' ? function() {
            return new ActiveXObject('Microsoft.XMLHTTP');
        } : null
    );
    
    function HttpClient(baseURL, defaultOptions) {
        this.baseURL = baseURL || '';
        this.defaultOptions = defaultOptions || {};
        this.interceptors = {
            request: [],
            response: []
        };
    }
    
    HttpClient.prototype = {
        constructor: HttpClient,
        
        // è¯·æ±‚æ–¹æ³•
        request: function(options) {
            var self = this;
            
            // åˆå¹¶é…ç½®
            var config = this._mergeConfig(options);
            
            // åº”ç”¨è¯·æ±‚æ‹¦æˆªå™¨
            config = this._applyRequestInterceptors(config);
            
            if (isNode) {
                return this._nodeRequest(config);
            } else {
                return this._browserRequest(config);
            }
        },
        
        // GETè¯·æ±‚
        get: function(url, options) {
            return this.request(this._extend({ method: 'GET', url: url }, options));
        },
        
        // POSTè¯·æ±‚
        post: function(url, data, options) {
            return this.request(this._extend({ method: 'POST', url: url, data: data }, options));
        },
        
        // PUTè¯·æ±‚
        put: function(url, data, options) {
            return this.request(this._extend({ method: 'PUT', url: url, data: data }, options));
        },
        
        // DELETEè¯·æ±‚
        delete: function(url, options) {
            return this.request(this._extend({ method: 'DELETE', url: url }, options));
        },
        
        // æµè§ˆå™¨ç¯å¢ƒè¯·æ±‚
        _browserRequest: function(config) {
            var self = this;
            
            return new Promise(function(resolve, reject) {
                var xhr = new XMLHttpRequest();
                
                xhr.open(config.method, self._buildURL(config.url), true);
                
                // è®¾ç½®è¯·æ±‚å¤´
                if (config.headers) {
                    for (var header in config.headers) {
                        xhr.setRequestHeader(header, config.headers[header]);
                    }
                }
                
                // è®¾ç½®è¶…æ—¶
                if (config.timeout) {
                    xhr.timeout = config.timeout;
                }
                
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                        var response = {
                            data: self._parseResponse(xhr.responseText, xhr.getResponseHeader('Content-Type')),
                            status: xhr.status,
                            statusText: xhr.statusText,
                            headers: self._parseHeaders(xhr.getAllResponseHeaders()),
                            config: config
                        };
                        
                        response = self._applyResponseInterceptors(response);
                        
                        if (xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300) {
                            resolve(response);
                        } else {
                            reject(new Error('Request failed with status ' + xhr.status));
                        }
                    }
                };
                
                xhr.onerror = function() {
                    reject(new Error('Network Error'));
                };
                
                xhr.ontimeout = function() {
                    reject(new Error('Request Timeout'));
                };
                
                // å‘é€è¯·æ±‚
                var data = config.data ? self._serializeData(config.data) : null;
                xhr.send(data);
            });
        },
        
        // Node.jsç¯å¢ƒè¯·æ±‚
        _nodeRequest: function(config) {
            var self = this;
            
            return new Promise(function(resolve, reject) {
                var http = require('http');
                var https = require('https');
                var url = require('url');
                
                var parsedUrl = url.parse(self._buildURL(config.url));
                var isSecure = parsedUrl.protocol === 'https:';
                var client = isSecure ? https : http;
                
                var requestOptions = {
                    hostname: parsedUrl.hostname,
                    port: parsedUrl.port || (isSecure ? 443 : 80),
                    path: parsedUrl.path,
                    method: config.method,
                    headers: config.headers || {}
                };
                
                var req = client.request(requestOptions, function(res) {
                    var data = '';
                    
                    res.on('data', function(chunk) {
                        data += chunk;
                    });
                    
                    res.on('end', function() {
                        var response = {
                            data: self._parseResponse(data, res.headers['content-type']),
                            status: res.statusCode,
                            statusText: res.statusMessage,
                            headers: res.headers,
                            config: config
                        };
                        
                        response = self._applyResponseInterceptors(response);
                        
                        if (res.statusCode &gt;= 200 &amp;&amp; res.statusCode &lt; 300) {
                            resolve(response);
                        } else {
                            reject(new Error('Request failed with status ' + res.statusCode));
                        }
                    });
                });
                
                req.on('error', function(error) {
                    reject(error);
                });
                
                if (config.timeout) {
                    req.setTimeout(config.timeout, function() {
                        req.abort();
                        reject(new Error('Request Timeout'));
                    });
                }
                
                // å‘é€æ•°æ®
                if (config.data) {
                    req.write(self._serializeData(config.data));
                }
                
                req.end();
            });
        },
        
        // æ·»åŠ æ‹¦æˆªå™¨
        addRequestInterceptor: function(interceptor) {
            this.interceptors.request.push(interceptor);
        },
        
        addResponseInterceptor: function(interceptor) {
            this.interceptors.response.push(interceptor);
        },
        
        // è¾…åŠ©æ–¹æ³•
        _mergeConfig: function(options) {
            return this._extend({}, this.defaultOptions, options);
        },
        
        _buildURL: function(url) {
            if (url.indexOf('http') === 0) {
                return url;
            }
            return this.baseURL + url;
        },
        
        _extend: function(target) {
            var sources = Array.prototype.slice.call(arguments, 1);
            sources.forEach(function(source) {
                for (var key in source) {
                    if (source.hasOwnProperty(key)) {
                        target[key] = source[key];
                    }
                }
            });
            return target;
        },
        
        _serializeData: function(data) {
            if (typeof data === 'string') return data;
            return JSON.stringify(data);
        },
        
        _parseResponse: function(data, contentType) {
            if (contentType &amp;&amp; contentType.indexOf('application/json') !== -1) {
                try {
                    return JSON.parse(data);
                } catch (e) {
                    return data;
                }
            }
            return data;
        },
        
        _parseHeaders: function(headerStr) {
            var headers = {};
            if (!headerStr) return headers;
            
            headerStr.split('\r\n').forEach(function(line) {
                var parts = line.split(': ');
                if (parts.length === 2) {
                    headers[parts[0].toLowerCase()] = parts[1];
                }
            });
            
            return headers;
        },
        
        _applyRequestInterceptors: function(config) {
            var result = config;
            this.interceptors.request.forEach(function(interceptor) {
                result = interceptor(result);
            });
            return result;
        },
        
        _applyResponseInterceptors: function(response) {
            var result = response;
            this.interceptors.response.forEach(function(interceptor) {
                result = interceptor(result);
            });
            return result;
        }
    };
    
    // é™æ€æ–¹æ³•
    HttpClient.create = function(baseURL, defaultOptions) {
        return new HttpClient(baseURL, defaultOptions);
    };
    
    return HttpClient;
}));
</code></pre>
<h2 id="umdå˜ä½“å’Œä¼˜åŒ–"><a class="header" href="#umdå˜ä½“å’Œä¼˜åŒ–">UMDå˜ä½“å’Œä¼˜åŒ–</a></h2>
<h3 id="1-è¿”å›å·¥å‚å‡½æ•°çš„umd"><a class="header" href="#1-è¿”å›å·¥å‚å‡½æ•°çš„umd">1. è¿”å›å·¥å‚å‡½æ•°çš„UMD</a></h3>
<pre><code class="language-javascript">(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        define(['jquery'], factory);
    } else if (typeof module === 'object' &amp;&amp; module.exports) {
        module.exports = factory(require('jquery'));
    } else {
        root.MyPlugin = factory(root.jQuery);
    }
}(typeof self !== 'undefined' ? self : this, function ($) {
    'use strict';
    
    // è¿”å›å·¥å‚å‡½æ•°è€Œä¸æ˜¯æ„é€ å‡½æ•°
    return function(options) {
        var defaults = {
            width: 300,
            height: 200,
            animation: true
        };
        
        var settings = $.extend({}, defaults, options);
        
        return {
            init: function() {
                console.log('Plugin initialized with settings:', settings);
            },
            
            destroy: function() {
                console.log('Plugin destroyed');
            },
            
            getSettings: function() {
                return settings;
            }
        };
    };
}));
</code></pre>
<h3 id="2-æ”¯æŒes6æ¨¡å—çš„umd"><a class="header" href="#2-æ”¯æŒes6æ¨¡å—çš„umd">2. æ”¯æŒES6æ¨¡å—çš„UMD</a></h3>
<pre><code class="language-javascript">(function (global, factory) {
    if (typeof exports === 'object' &amp;&amp; typeof module !== 'undefined') {
        // CommonJS
        module.exports = factory();
    } else if (typeof define === 'function' &amp;&amp; define.amd) {
        // AMD
        define(factory);
    } else {
        // æµè§ˆå™¨å…¨å±€å˜é‡
        (global = global || self).MyModule = factory();
    }
}(this, function () {
    'use strict';
    
    class MyClass {
        constructor(options = {}) {
            this.options = Object.assign({
                debug: false,
                timeout: 5000
            }, options);
        }
        
        async fetchData(url) {
            try {
                const response = await fetch(url);
                return await response.json();
            } catch (error) {
                if (this.options.debug) {
                    console.error('Fetch error:', error);
                }
                throw error;
            }
        }
        
        processData(data) {
            return data.map(item =&gt; ({
                ...item,
                processed: true,
                timestamp: Date.now()
            }));
        }
    }
    
    // åŒæ—¶æ”¯æŒç±»å’Œå·¥å‚å‡½æ•°
    MyClass.create = function(options) {
        return new MyClass(options);
    };
    
    return MyClass;
}));
</code></pre>
<h3 id="3-æ‡’åŠ è½½umd"><a class="header" href="#3-æ‡’åŠ è½½umd">3. æ‡’åŠ è½½UMD</a></h3>
<pre><code class="language-javascript">(function (root, factory) {
    if (typeof define === 'function' &amp;&amp; define.amd) {
        define(['exports'], factory);
    } else if (typeof exports === 'object' &amp;&amp; typeof module !== 'undefined') {
        factory(exports);
    } else {
        factory((root.LazyModule = {}));
    }
}(typeof self !== 'undefined' ? self : this, function (exports) {
    'use strict';
    
    var modules = {};
    var loading = {};
    
    function loadModule(name, factory) {
        if (!modules[name]) {
            modules[name] = {
                loaded: false,
                factory: factory,
                exports: null
            };
        }
    }
    
    function getModule(name) {
        var module = modules[name];
        if (!module) {
            throw new Error('Module not found: ' + name);
        }
        
        if (!module.loaded) {
            module.exports = module.factory();
            module.loaded = true;
        }
        
        return module.exports;
    }
    
    async function getModuleAsync(name) {
        if (loading[name]) {
            return loading[name];
        }
        
        if (modules[name] &amp;&amp; modules[name].loaded) {
            return modules[name].exports;
        }
        
        loading[name] = new Promise(function(resolve) {
            setTimeout(function() {
                resolve(getModule(name));
                delete loading[name];
            }, 0);
        });
        
        return loading[name];
    }
    
    // é¢„å®šä¹‰ä¸€äº›æ¨¡å—
    loadModule('utils', function() {
        return {
            formatDate: function(date) {
                return date.toISOString().split('T')[0];
            },
            generateId: function() {
                return Math.random().toString(36).substr(2, 9);
            }
        };
    });
    
    loadModule('validator', function() {
        return {
            isEmail: function(email) {
                return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
            },
            isUrl: function(url) {
                try {
                    new URL(url);
                    return true;
                } catch {
                    return false;
                }
            }
        };
    });
    
    // å¯¼å‡ºAPI
    exports.load = loadModule;
    exports.get = getModule;
    exports.getAsync = getModuleAsync;
    exports.list = function() {
        return Object.keys(modules);
    };
}));
</code></pre>
<h2 id="æ„å»ºå·¥å…·æ”¯æŒ"><a class="header" href="#æ„å»ºå·¥å…·æ”¯æŒ">æ„å»ºå·¥å…·æ”¯æŒ</a></h2>
<h3 id="1-webpack-umdè¾“å‡º"><a class="header" href="#1-webpack-umdè¾“å‡º">1. Webpack UMDè¾“å‡º</a></h3>
<pre><code class="language-javascript">// webpack.config.js
module.exports = {
    entry: './src/index.js',
    output: {
        path: __dirname + '/dist',
        filename: 'my-library.js',
        library: 'MyLibrary',
        libraryTarget: 'umd',
        globalObject: 'typeof self !== "undefined" ? self : this'
    },
    module: {
        rules: [
            {
                test: /\.js$/,
                exclude: /node_modules/,
                use: {
                    loader: 'babel-loader',
                    options: {
                        presets: ['@babel/preset-env']
                    }
                }
            }
        ]
    }
};
</code></pre>
<h3 id="2-rollup-umdè¾“å‡º"><a class="header" href="#2-rollup-umdè¾“å‡º">2. Rollup UMDè¾“å‡º</a></h3>
<pre><code class="language-javascript">// rollup.config.js
import babel from '@rollup/plugin-babel';
import { terser } from 'rollup-plugin-terser';

export default {
    input: 'src/index.js',
    output: {
        file: 'dist/my-library.umd.js',
        format: 'umd',
        name: 'MyLibrary',
        globals: {
            'lodash': '_',
            'jquery': '$'
        }
    },
    external: ['lodash', 'jquery'],
    plugins: [
        babel({
            exclude: 'node_modules/**',
            babelHelpers: 'bundled'
        }),
        terser()
    ]
};
</code></pre>
<h2 id="æµ‹è¯•umdæ¨¡å—"><a class="header" href="#æµ‹è¯•umdæ¨¡å—">æµ‹è¯•UMDæ¨¡å—</a></h2>
<h3 id="1-å¤šç¯å¢ƒæµ‹è¯•"><a class="header" href="#1-å¤šç¯å¢ƒæµ‹è¯•">1. å¤šç¯å¢ƒæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// test/umd-test.js
(function() {
    'use strict';
    
    // æµ‹è¯•ä¸åŒç¯å¢ƒ
    function testEnvironments() {
        var results = {
            amd: false,
            commonjs: false,
            global: false
        };
        
        // æ¨¡æ‹ŸAMDç¯å¢ƒ
        if (typeof define === 'undefined') {
            global.define = function(deps, factory) {
                results.amd = typeof factory() === 'object';
            };
            global.define.amd = true;
            
            // é‡æ–°åŠ è½½æ¨¡å—
            // è¿™é‡Œéœ€è¦é‡æ–°æ‰§è¡ŒUMDæ¨¡å—ä»£ç 
            
            delete global.define;
        }
        
        // æ¨¡æ‹ŸCommonJSç¯å¢ƒ
        if (typeof module === 'undefined') {
            global.module = { exports: {} };
            global.exports = global.module.exports;
            
            // é‡æ–°åŠ è½½æ¨¡å—
            // è¿™é‡Œéœ€è¦é‡æ–°æ‰§è¡ŒUMDæ¨¡å—ä»£ç 
            
            results.commonjs = typeof global.module.exports === 'object';
            
            delete global.module;
            delete global.exports;
        }
        
        // æµ‹è¯•å…¨å±€å˜é‡ç¯å¢ƒ
        // é‡æ–°åŠ è½½æ¨¡å—
        // è¿™é‡Œéœ€è¦é‡æ–°æ‰§è¡ŒUMDæ¨¡å—ä»£ç 
        results.global = typeof global.MyModule === 'object';
        
        return results;
    }
    
    // åŠŸèƒ½æµ‹è¯•
    function testFunctionality(module) {
        var tests = {
            instantiation: false,
            methods: false,
            properties: false
        };
        
        try {
            var instance = new module();
            tests.instantiation = true;
            
            if (typeof instance.method1 === 'function') {
                tests.methods = true;
            }
            
            if (instance.hasOwnProperty('someProperty')) {
                tests.properties = true;
            }
        } catch (error) {
            console.error('Test error:', error);
        }
        
        return tests;
    }
    
    console.log('UMD Environment Tests:', testEnvironments());
    // console.log('UMD Functionality Tests:', testFunctionality(MyModule));
})();
</code></pre>
<h2 id="ä¼˜ç¼ºç‚¹åˆ†æ-1"><a class="header" href="#ä¼˜ç¼ºç‚¹åˆ†æ-1">ä¼˜ç¼ºç‚¹åˆ†æ</a></h2>
<h3 id="ä¼˜ç‚¹-1"><a class="header" href="#ä¼˜ç‚¹-1">ä¼˜ç‚¹</a></h3>
<ul>
<li>âœ… <strong>è·¨å¹³å°å…¼å®¹</strong>: åŒä¸€ä»£ç å¯åœ¨å¤šç§ç¯å¢ƒä¸­ä½¿ç”¨</li>
<li>âœ… <strong>æ— æ„å»ºä¾èµ–</strong>: ä¸éœ€è¦é¢å¤–çš„æ„å»ºæ­¥éª¤</li>
<li>âœ… <strong>å‘åå…¼å®¹</strong>: æ”¯æŒæ—§ç‰ˆæœ¬æµè§ˆå™¨å’Œæ¨¡å—ç³»ç»Ÿ</li>
<li>âœ… <strong>çµæ´»éƒ¨ç½²</strong>: å¯ä»¥é€‰æ‹©æœ€é€‚åˆçš„åˆ†å‘æ–¹å¼</li>
<li>âœ… <strong>ç®€å•æ˜“ç”¨</strong>: ä½¿ç”¨æ ‡å‡†JavaScriptè¯­æ³•</li>
</ul>
<h3 id="ç¼ºç‚¹-1"><a class="header" href="#ç¼ºç‚¹-1">ç¼ºç‚¹</a></h3>
<ul>
<li>âŒ <strong>ä»£ç å†—ä½™</strong>: åŒ…è£…ä»£ç å¢åŠ äº†æ–‡ä»¶å¤§å°</li>
<li>âŒ <strong>å¤æ‚æ€§</strong>: æ¨¡å—åŒ…è£…é€»è¾‘è¾ƒä¸ºå¤æ‚</li>
<li>âŒ <strong>æ€§èƒ½å¼€é”€</strong>: è¿è¡Œæ—¶ç¯å¢ƒæ£€æµ‹æœ‰å¾®å°å¼€é”€</li>
<li>âŒ <strong>è°ƒè¯•å›°éš¾</strong>: åŒ…è£…å™¨å¯èƒ½å½±å“è°ƒè¯•ä½“éªŒ</li>
<li>âŒ <strong>ç»´æŠ¤è´Ÿæ‹…</strong>: éœ€è¦è€ƒè™‘å¤šç§ç¯å¢ƒçš„å…¼å®¹æ€§</li>
</ul>
<h2 id="ç°ä»£æ›¿ä»£æ–¹æ¡ˆ"><a class="header" href="#ç°ä»£æ›¿ä»£æ–¹æ¡ˆ">ç°ä»£æ›¿ä»£æ–¹æ¡ˆ</a></h2>
<h3 id="1-æ„å»ºæ—¶è½¬æ¢"><a class="header" href="#1-æ„å»ºæ—¶è½¬æ¢">1. æ„å»ºæ—¶è½¬æ¢</a></h3>
<pre><code class="language-javascript">// æºç ä½¿ç”¨ESæ¨¡å—
export class MyClass {
    constructor() {
        // ...
    }
}

export default MyClass;

// æ„å»ºå·¥å…·è‡ªåŠ¨ç”ŸæˆUMDç‰ˆæœ¬
</code></pre>
<h3 id="2-æ¡ä»¶å¯¼å‡º-2"><a class="header" href="#2-æ¡ä»¶å¯¼å‡º-2">2. æ¡ä»¶å¯¼å‡º</a></h3>
<pre><code class="language-json">{
  "name": "my-package",
  "main": "./dist/index.cjs",
  "module": "./dist/index.mjs",
  "browser": "./dist/index.umd.js",
  "exports": {
    ".": {
      "import": "./dist/index.mjs",
      "require": "./dist/index.cjs",
      "browser": "./dist/index.umd.js"
    }
  }
}
</code></pre>
<h2 id="æ€»ç»“-14"><a class="header" href="#æ€»ç»“-14">æ€»ç»“</a></h2>
<p>UMDä½œä¸ºè¿‡æ¸¡æœŸçš„è§£å†³æ–¹æ¡ˆï¼Œè§£å†³äº†æ¨¡å—ç³»ç»Ÿç¢ç‰‡åŒ–çš„é—®é¢˜ï¼š</p>
<ul>
<li>ğŸ¯ <strong>å†å²ä»·å€¼</strong>: åœ¨æ¨¡å—æ ‡å‡†åŒ–è¿‡ç¨‹ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨</li>
<li>ğŸ¯ <strong>å®ç”¨æ€§</strong>: å¯¹äºéœ€è¦å¹¿æ³›å…¼å®¹çš„åº“ä»ç„¶æœ‰ç”¨</li>
<li>ğŸ¯ <strong>ç°çŠ¶</strong>: é€æ¸è¢«ESæ¨¡å—å’Œç°ä»£æ„å»ºå·¥å…·å–ä»£</li>
</ul>
<p>è™½ç„¶UMDåœ¨ç°ä»£å¼€å‘ä¸­ä½¿ç”¨é¢‘ç‡é™ä½ï¼Œä½†ç†è§£å…¶è®¾è®¡åŸç†å¯¹äºæ„å»ºè·¨å¹³å°JavaScriptåº“å’Œç†è§£æ¨¡å—åŒ–å‘å±•å†ç¨‹ä»ç„¶å¾ˆæœ‰ä»·å€¼ã€‚éšç€ESæ¨¡å—çš„æ™®åŠå’Œæ„å»ºå·¥å…·çš„å®Œå–„ï¼ŒUMDæ­£åœ¨ä»â€œå¿…éœ€å“â€œè½¬å‘â€œå…¼å®¹æ€§é€‰é¡¹â€œã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="tooling/webpack.html">æ¨¡å—åŒ–å·¥å…·ä¸å®è·µ</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ‰“åŒ…å·¥å…·-1"><a class="header" href="#æ‰“åŒ…å·¥å…·-1">æ‰“åŒ…å·¥å…·</a></h1>
<p>æ‰“åŒ…å·¥å…·æ˜¯ç°ä»£å‰ç«¯å¼€å‘çš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼Œå®ƒä»¬å°†å¼€å‘æ—¶åˆ†æ•£çš„æ¨¡å—æ–‡ä»¶æ•´åˆæˆæµè§ˆå™¨å¯ä»¥é«˜æ•ˆæ‰§è¡Œçš„ä»£ç åŒ…ã€‚éšç€JavaScriptåº”ç”¨å¤æ‚åº¦çš„å¢é•¿ï¼Œæ‰“åŒ…å·¥å…·ä¸ä»…è¦è§£å†³åŸºæœ¬çš„æ–‡ä»¶åˆå¹¶é—®é¢˜ï¼Œè¿˜è¦æä¾›ä»£ç ä¼˜åŒ–ã€èµ„æºç®¡ç†ã€å¼€å‘ä½“éªŒç­‰å…¨æ–¹ä½æ”¯æŒã€‚</p>
<h2 id="æ‰“åŒ…å·¥å…·çš„æ ¸å¿ƒä½œç”¨"><a class="header" href="#æ‰“åŒ…å·¥å…·çš„æ ¸å¿ƒä½œç”¨">æ‰“åŒ…å·¥å…·çš„æ ¸å¿ƒä½œç”¨</a></h2>
<h3 id="è§£å†³çš„åŸºæœ¬é—®é¢˜"><a class="header" href="#è§£å†³çš„åŸºæœ¬é—®é¢˜">è§£å†³çš„åŸºæœ¬é—®é¢˜</a></h3>
<p><strong>æ¨¡å—åŒ–å¼€å‘ä¸æµè§ˆå™¨å…¼å®¹æ€§çš„çŸ›ç›¾</strong></p>
<ul>
<li>å¼€å‘ç¯å¢ƒï¼šéœ€è¦æ¨¡å—åŒ–ç»„ç»‡ä»£ç ï¼Œä¾¿äºç»´æŠ¤å’Œåä½œ</li>
<li>ç”Ÿäº§ç¯å¢ƒï¼šéœ€è¦ä¼˜åŒ–çš„ä»£ç åŒ…ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚å’ŒåŠ è½½æ—¶é—´</li>
<li>å…¼å®¹æ€§ï¼šæ”¯æŒä¸åŒçš„æ¨¡å—æ ¼å¼å’Œè¿è¡Œç¯å¢ƒ</li>
</ul>
<p><strong>ç½‘ç»œæ€§èƒ½ä¼˜åŒ–</strong></p>
<ul>
<li>å‡å°‘HTTPè¯·æ±‚æ•°é‡ï¼Œåˆå¹¶å¤šä¸ªå°æ–‡ä»¶</li>
<li>å‹ç¼©ä»£ç ä½“ç§¯ï¼Œç§»é™¤ä¸å¿…è¦çš„ä»£ç </li>
<li>å®ç°èµ„æºç¼“å­˜ç­–ç•¥ï¼Œæé«˜é‡å¤è®¿é—®æ€§èƒ½</li>
</ul>
<h3 id="ä¸»æµå·¥å…·ç‰¹ç‚¹"><a class="header" href="#ä¸»æµå·¥å…·ç‰¹ç‚¹">ä¸»æµå·¥å…·ç‰¹ç‚¹</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å·¥å…·</th><th>ä¸»è¦ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr>
</thead>
<tbody>
<tr><td><strong>Webpack</strong></td><td>é…ç½®çµæ´»ã€ç”Ÿæ€ä¸°å¯Œã€åŠŸèƒ½å…¨é¢</td><td>å¤§å‹å¤æ‚åº”ç”¨</td></tr>
<tr><td><strong>Rollup</strong></td><td>ä¸“æ³¨ESæ¨¡å—ã€æ ‘æ‘‡ä¼˜ç§€ã€è¾“å‡ºå¹²å‡€</td><td>åº“å¼€å‘</td></tr>
<tr><td><strong>Vite</strong></td><td>å¼€å‘å¿«é€Ÿã€åŸç”ŸESMã€é›¶é…ç½®</td><td>ç°ä»£Webåº”ç”¨</td></tr>
<tr><td><strong>Parcel</strong></td><td>é›¶é…ç½®ã€å¼€ç®±å³ç”¨ã€è‡ªåŠ¨åŒ–</td><td>å¿«é€ŸåŸå‹</td></tr>
<tr><td><strong>esbuild</strong></td><td>æé€Ÿæ„å»ºã€Goç¼–å†™ã€æ€§èƒ½ä¼˜å…ˆ</td><td>å¤§å‹é¡¹ç›®æ„å»º</td></tr>
</tbody>
</table>
</div>
<h2 id="æ‰“åŒ…å·¥ä½œæµç¨‹"><a class="header" href="#æ‰“åŒ…å·¥ä½œæµç¨‹">æ‰“åŒ…å·¥ä½œæµç¨‹</a></h2>
<h3 id="æ ‡å‡†æ„å»ºæµç¨‹"><a class="header" href="#æ ‡å‡†æ„å»ºæµç¨‹">æ ‡å‡†æ„å»ºæµç¨‹</a></h3>
<p>æ‰“åŒ…å·¥å…·çš„å·¥ä½œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªå…³é”®é˜¶æ®µï¼š</p>
<h4 id="1-å…¥å£åˆ†æ-entry-resolution"><a class="header" href="#1-å…¥å£åˆ†æ-entry-resolution">1. <strong>å…¥å£åˆ†æ</strong> (Entry Resolution)</a></h4>
<ul>
<li>ç¡®å®šæ„å»ºçš„èµ·å§‹ç‚¹ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªå…¥å£æ–‡ä»¶</li>
<li>è§£æå…¥å£æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’ŒåŸºæœ¬ä¿¡æ¯</li>
<li>å»ºç«‹å…¥å£æ–‡ä»¶ä¸åç»­å¤„ç†æµç¨‹çš„å…³è”</li>
</ul>
<h4 id="2-ä¾èµ–è§£æ-dependency-resolution"><a class="header" href="#2-ä¾èµ–è§£æ-dependency-resolution">2. <strong>ä¾èµ–è§£æ</strong> (Dependency Resolution)</a></h4>
<ul>
<li>åˆ†ææ¯ä¸ªæ¨¡å—çš„å¯¼å…¥è¯­å¥(<code>import</code>ã€<code>require</code>ç­‰)</li>
<li>é€’å½’è§£ææ‰€æœ‰ä¾èµ–æ¨¡å—ï¼Œæ„å»ºå®Œæ•´çš„ä¾èµ–å…³ç³»å›¾</li>
<li>å¤„ç†æ¨¡å—è·¯å¾„è§£æï¼ŒåŒ…æ‹¬ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„ã€npmåŒ…ç­‰</li>
</ul>
<h4 id="3-èµ„æºåŠ è½½-asset-loading"><a class="header" href="#3-èµ„æºåŠ è½½-asset-loading">3. <strong>èµ„æºåŠ è½½</strong> (Asset Loading)</a></h4>
<ul>
<li>è¯»å–å„ç§ç±»å‹çš„æ–‡ä»¶å†…å®¹(JSã€CSSã€å›¾ç‰‡ç­‰)</li>
<li>é€šè¿‡Loaderç³»ç»Ÿå¤„ç†éJavaScriptèµ„æº</li>
<li>å°†æ‰€æœ‰èµ„æºè½¬æ¢ä¸ºæ¨¡å—ç³»ç»Ÿå¯ä»¥ç†è§£çš„æ ¼å¼</li>
</ul>
<h4 id="4-ä»£ç è½¬æ¢-code-transformation"><a class="header" href="#4-ä»£ç è½¬æ¢-code-transformation">4. <strong>ä»£ç è½¬æ¢</strong> (Code Transformation)</a></h4>
<ul>
<li>ä½¿ç”¨Babelç­‰è½¬è¯‘å™¨å¤„ç†æ–°è¯­æ³•ç‰¹æ€§</li>
<li>åº”ç”¨å„ç§ä»£ç è½¬æ¢æ’ä»¶</li>
<li>å¤„ç†æ¨¡å—æ ¼å¼è½¬æ¢(ES Module â†’ CommonJSç­‰)</li>
</ul>
<h4 id="5-ä¼˜åŒ–å¤„ç†-optimization"><a class="header" href="#5-ä¼˜åŒ–å¤„ç†-optimization">5. <strong>ä¼˜åŒ–å¤„ç†</strong> (Optimization)</a></h4>
<ul>
<li>Tree Shakingï¼šç§»é™¤æœªä½¿ç”¨çš„ä»£ç </li>
<li>ä»£ç å‹ç¼©å’Œæ··æ·†</li>
<li>èµ„æºå‹ç¼©å’Œä¼˜åŒ–</li>
</ul>
<h4 id="6-ä»£ç ç”Ÿæˆ-code-generation"><a class="header" href="#6-ä»£ç ç”Ÿæˆ-code-generation">6. <strong>ä»£ç ç”Ÿæˆ</strong> (Code Generation)</a></h4>
<ul>
<li>å°†æ¨¡å—ç»„ç»‡æˆæœ€ç»ˆçš„ä»£ç åŒ…</li>
<li>ç”Ÿæˆæ¨¡å—è¿è¡Œæ—¶ä»£ç </li>
<li>å¤„ç†ä»£ç åˆ†å‰²å’ŒåŠ¨æ€å¯¼å…¥</li>
</ul>
<h4 id="7-èµ„æºè¾“å‡º-asset-emission"><a class="header" href="#7-èµ„æºè¾“å‡º-asset-emission">7. <strong>èµ„æºè¾“å‡º</strong> (Asset Emission)</a></h4>
<ul>
<li>å°†ç”Ÿæˆçš„ä»£ç åŒ…å†™å…¥æ–‡ä»¶ç³»ç»Ÿ</li>
<li>ç”ŸæˆSource Mapæ–‡ä»¶</li>
<li>è¾“å‡ºæ„å»ºæŠ¥å‘Šå’Œç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<h2 id="æ‰“åŒ…å·¥å…·æ ¸å¿ƒç‰¹æ€§"><a class="header" href="#æ‰“åŒ…å·¥å…·æ ¸å¿ƒç‰¹æ€§">æ‰“åŒ…å·¥å…·æ ¸å¿ƒç‰¹æ€§</a></h2>
<h3 id="1-ä»£ç åˆå¹¶-code-bundling"><a class="header" href="#1-ä»£ç åˆå¹¶-code-bundling">1. ä»£ç åˆå¹¶ (Code Bundling)</a></h3>
<p><strong>æ¦‚å¿µ</strong>ï¼šå°†å¤šä¸ªåˆ†æ•£çš„æ¨¡å—æ–‡ä»¶åˆå¹¶æˆå°‘é‡çš„ä»£ç åŒ…ï¼Œå‡å°‘æµè§ˆå™¨ç½‘ç»œè¯·æ±‚ã€‚</p>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼š</p>
<ul>
<li>å‡å°‘HTTPè¯·æ±‚æ•°é‡ï¼Œæå‡åŠ è½½æ€§èƒ½</li>
<li>è§£å†³æ¨¡å—é—´çš„ä¾èµ–å…³ç³»</li>
<li>ä¼˜åŒ–èµ„æºåŠ è½½é¡ºåº</li>
</ul>
<p><strong>å®ç°æ–¹å¼</strong>ï¼š</p>
<ul>
<li><strong>å•æ–‡ä»¶æ‰“åŒ…</strong>ï¼šå°†æ‰€æœ‰ä»£ç åˆå¹¶ä¸ºä¸€ä¸ªbundle.js</li>
<li><strong>å¤šå…¥å£æ‰“åŒ…</strong>ï¼šé’ˆå¯¹ä¸åŒé¡µé¢ç”Ÿæˆå¯¹åº”çš„ä»£ç åŒ…</li>
<li><strong>åˆ†å±‚æ‰“åŒ…</strong>ï¼šå°†åº”ç”¨ä»£ç å’Œç¬¬ä¸‰æ–¹åº“åˆ†åˆ«æ‰“åŒ…</li>
</ul>
<h3 id="2-tree-shaking"><a class="header" href="#2-tree-shaking">2. Tree Shaking</a></h3>
<p><strong>æ¦‚å¿µ</strong>ï¼šåˆ†æä»£ç çš„å¯¼å…¥å¯¼å‡ºå…³ç³»ï¼Œç§»é™¤æœªè¢«ä½¿ç”¨çš„ä»£ç ï¼ˆâ€œæ­»ä»£ç æ¶ˆé™¤â€ï¼‰ã€‚</p>
<p><strong>å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>é™æ€åˆ†æESæ¨¡å—çš„import/exportè¯­å¥</li>
<li>æ ‡è®°è¢«ä½¿ç”¨çš„å‡½æ•°å’Œå˜é‡</li>
<li>ç§»é™¤æœªè¢«æ ‡è®°çš„ä»£ç </li>
</ul>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>æ˜¾è‘—å‡å°bundleä½“ç§¯</li>
<li>ç‰¹åˆ«é€‚ç”¨äºå·¥å…·åº“çš„æŒ‰éœ€å¼•å…¥</li>
<li>å¯¹ESæ¨¡å—æ”¯æŒæœ€ä½³</li>
</ul>
<p><strong>é™åˆ¶</strong>ï¼š</p>
<ul>
<li>ä¸»è¦æ”¯æŒESæ¨¡å—æ ¼å¼</li>
<li>éœ€è¦ä»£ç æ— å‰¯ä½œç”¨æ‰èƒ½å®‰å…¨ç§»é™¤</li>
<li>åŠ¨æ€å¯¼å…¥éš¾ä»¥è¿›è¡Œé™æ€åˆ†æ</li>
</ul>
<h3 id="3-ä»£ç åˆ†å‰²-code-splitting"><a class="header" href="#3-ä»£ç åˆ†å‰²-code-splitting">3. ä»£ç åˆ†å‰² (Code Splitting)</a></h3>
<p><strong>æ¦‚å¿µ</strong>ï¼šå°†ä»£ç åŒ…æ‹†åˆ†æˆå¤šä¸ªè¾ƒå°çš„chunkï¼Œå®ç°æŒ‰éœ€åŠ è½½å’Œå¹¶è¡Œä¸‹è½½ã€‚</p>
<p><strong>åˆ†å‰²ç­–ç•¥</strong>ï¼š</p>
<ul>
<li><strong>å…¥å£åˆ†å‰²</strong>ï¼šæ¯ä¸ªå…¥å£ç‚¹ç”Ÿæˆç‹¬ç«‹çš„bundle</li>
<li><strong>åŠ¨æ€åˆ†å‰²</strong>ï¼šåŸºäºåŠ¨æ€import()è¯­å¥åˆ›å»ºåˆ†å‰²ç‚¹</li>
<li><strong>å…¬å…±ä»£ç åˆ†å‰²</strong>ï¼šæå–å¤šä¸ªchunké—´çš„å…±åŒä¾èµ–</li>
</ul>
<p><strong>æ”¶ç›Š</strong>ï¼š</p>
<ul>
<li>å‡å°‘åˆå§‹åŠ è½½æ—¶é—´</li>
<li>æé«˜ç¼“å­˜å‘½ä¸­ç‡</li>
<li>æ”¯æŒæ‡’åŠ è½½ä¼˜åŒ–</li>
</ul>
<h3 id="4-å¤–éƒ¨æ¨¡å—å¤„ç†-external-dependencies"><a class="header" href="#4-å¤–éƒ¨æ¨¡å—å¤„ç†-external-dependencies">4. å¤–éƒ¨æ¨¡å—å¤„ç† (External Dependencies)</a></h3>
<p><strong>æ¦‚å¿µ</strong>ï¼šå°†æŸäº›ä¾èµ–æ ‡è®°ä¸ºå¤–éƒ¨æ¨¡å—ï¼Œä¸æ‰“åŒ…åˆ°bundleä¸­ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶ä»å¤–éƒ¨è·å–ã€‚</p>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>CDNåŠ è½½çš„åº“ï¼ˆå¦‚Reactã€Vueï¼‰</li>
<li>å¾®å‰ç«¯æ¶æ„ä¸­çš„å…±äº«ä¾èµ–</li>
<li>å¤§å‹åº“çš„æŒ‰éœ€åŠ è½½</li>
</ul>
<p><strong>é…ç½®æ–¹å¼</strong>ï¼š</p>
<pre><code class="language-javascript">// webpackç¤ºä¾‹
externals: {
  'react': 'React',
  'react-dom': 'ReactDOM'
}
</code></pre>
<h3 id="5-æ¨¡å—æ ¼å¼å…¼å®¹æ€§"><a class="header" href="#5-æ¨¡å—æ ¼å¼å…¼å®¹æ€§">5. æ¨¡å—æ ¼å¼å…¼å®¹æ€§</a></h3>
<p><strong>å¤„ç†çš„æ ¼å¼</strong>ï¼š</p>
<ul>
<li><strong>ES Modules</strong> (ESM)ï¼š<code>import</code>/<code>export</code>è¯­æ³•</li>
<li><strong>CommonJS</strong> (CJS)ï¼š<code>require</code>/<code>module.exports</code></li>
<li><strong>AMD</strong>ï¼šå¼‚æ­¥æ¨¡å—å®šä¹‰</li>
<li><strong>UMD</strong>ï¼šé€šç”¨æ¨¡å—å®šä¹‰</li>
<li><strong>SystemJS</strong>ï¼šåŠ¨æ€æ¨¡å—åŠ è½½å™¨</li>
</ul>
<p><strong>è½¬æ¢ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>ESæ¨¡å— â†’ CommonJSï¼šæœ€å¸¸è§çš„è½¬æ¢</li>
<li>CommonJS â†’ ESæ¨¡å—ï¼šéœ€è¦ç‰¹æ®Šå¤„ç†</li>
<li>æ··åˆæ ¼å¼ï¼šæ™ºèƒ½æ£€æµ‹å’Œé€‚é…</li>
</ul>
<h2 id="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥">æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</a></h2>
<h3 id="1-æ„å»ºæ—¶ä¼˜åŒ–"><a class="header" href="#1-æ„å»ºæ—¶ä¼˜åŒ–">1. æ„å»ºæ—¶ä¼˜åŒ–</a></h3>
<p><strong>ç¼“å­˜æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>æ–‡ä»¶çº§ç¼“å­˜ï¼šç¼“å­˜æœªå˜æ›´çš„æ¨¡å—</li>
<li>å¢é‡æ„å»ºï¼šåªé‡å»ºå‘ç”Ÿå˜åŒ–çš„éƒ¨åˆ†</li>
<li>æŒä¹…åŒ–ç¼“å­˜ï¼šè·¨æ„å»ºä¿å­˜ç¼“å­˜æ•°æ®</li>
</ul>
<p><strong>å¹¶è¡Œå¤„ç†</strong>ï¼š</p>
<ul>
<li>æ¨¡å—è§£æå¹¶è¡ŒåŒ–</li>
<li>ä»£ç è½¬æ¢å¹¶è¡Œæ‰§è¡Œ</li>
<li>å¤šæ ¸å¿ƒæ„å»ºä¼˜åŒ–</li>
</ul>
<p><strong>é¢„ç¼–è¯‘ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>ä¾èµ–é¢„æ„å»ºï¼ˆå¦‚Viteçš„é¢„æ„å»ºï¼‰</li>
<li>ç¬¬ä¸‰æ–¹åº“é¢„ç¼–è¯‘</li>
<li>å…¬å…±ä»£ç æå‰å¤„ç†</li>
</ul>
<h3 id="2-è¿è¡Œæ—¶ä¼˜åŒ–-1"><a class="header" href="#2-è¿è¡Œæ—¶ä¼˜åŒ–-1">2. è¿è¡Œæ—¶ä¼˜åŒ–</a></h3>
<p><strong>æ‡’åŠ è½½</strong>ï¼š</p>
<ul>
<li>è·¯ç”±çº§ä»£ç åˆ†å‰²</li>
<li>ç»„ä»¶çº§æ‡’åŠ è½½</li>
<li>åŠŸèƒ½æ¨¡å—æŒ‰éœ€åŠ è½½</li>
</ul>
<p><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>é•¿æ•ˆç¼“å­˜ï¼šä¸ºç¨³å®šæ–‡ä»¶è®¾ç½®é•¿æœŸç¼“å­˜</li>
<li>å†…å®¹å“ˆå¸Œï¼šåŸºäºå†…å®¹ç”Ÿæˆæ–‡ä»¶å</li>
<li>ç¼“å­˜å¤±æ•ˆæ§åˆ¶ï¼šç²¾ç¡®æ§åˆ¶ç¼“å­˜æ›´æ–°</li>
</ul>
<p><strong>èµ„æºä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>ä»£ç å‹ç¼©å’Œæ··æ·†</li>
<li>å›¾ç‰‡å‹ç¼©å’Œæ ¼å¼ä¼˜åŒ–</li>
<li>å­—ä½“æ–‡ä»¶ä¼˜åŒ–</li>
</ul>
<h3 id="3-å¼€å‘ä½“éªŒä¼˜åŒ–"><a class="header" href="#3-å¼€å‘ä½“éªŒä¼˜åŒ–">3. å¼€å‘ä½“éªŒä¼˜åŒ–</a></h3>
<p><strong>çƒ­æ¨¡å—æ›¿æ¢ (HMR)</strong>ï¼š</p>
<ul>
<li>ä¿æŒåº”ç”¨çŠ¶æ€çš„ä»£ç æ›´æ–°</li>
<li>å¿«é€Ÿçš„å¼€å‘åé¦ˆå¾ªç¯</li>
<li>CSSæ ·å¼å®æ—¶æ›´æ–°</li>
</ul>
<p><strong>å¼€å‘æœåŠ¡å™¨</strong>ï¼š</p>
<ul>
<li>å¿«é€Ÿçš„å†·å¯åŠ¨</li>
<li>å†…å­˜æ–‡ä»¶ç³»ç»Ÿ</li>
<li>è‡ªåŠ¨é‡æ–°åŠ è½½</li>
</ul>
<h2 id="æ‰“åŒ…å·¥å…·ç‰¹æ€§å¯¹æ¯”"><a class="header" href="#æ‰“åŒ…å·¥å…·ç‰¹æ€§å¯¹æ¯”">æ‰“åŒ…å·¥å…·ç‰¹æ€§å¯¹æ¯”</a></h2>
<p>æ ¹æ®åœ¨å‰é¢ç« èŠ‚ä¸­ä»‹ç»çš„å„ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬æ¥è¿›è¡Œå…¨é¢çš„ç‰¹æ€§å¯¹æ¯”ï¼š</p>
<h3 id="å®˜æ–¹æ–‡æ¡£é“¾æ¥"><a class="header" href="#å®˜æ–¹æ–‡æ¡£é“¾æ¥">å®˜æ–¹æ–‡æ¡£é“¾æ¥</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å·¥å…·</th><th>å®˜æ–¹ç½‘ç«™</th><th>æ–‡æ¡£åœ°å€</th><th>GitHub</th></tr>
</thead>
<tbody>
<tr><td><strong>Webpack</strong></td><td><a href="https://webpack.js.org/">webpack.js.org</a></td><td><a href="https://webpack.js.org/concepts/">æ–‡æ¡£</a></td><td><a href="https://github.com/webpack/webpack">webpack/webpack</a></td></tr>
<tr><td><strong>Rollup</strong></td><td><a href="https://rollupjs.org/">rollupjs.org</a></td><td><a href="https://rollupjs.org/guide/en/">æŒ‡å—</a></td><td><a href="https://github.com/rollup/rollup">rollup/rollup</a></td></tr>
<tr><td><strong>Vite</strong></td><td><a href="https://vitejs.dev/">vitejs.dev</a></td><td><a href="https://vitejs.dev/guide/">æŒ‡å—</a></td><td><a href="https://github.com/vitejs/vite">vitejs/vite</a></td></tr>
<tr><td><strong>Parcel</strong></td><td><a href="https://parceljs.org/">parceljs.org</a></td><td><a href="https://parceljs.org/docs/">æ–‡æ¡£</a></td><td><a href="https://github.com/parcel-bundler/parcel">parcel-bundler/parcel</a></td></tr>
<tr><td><strong>esbuild</strong></td><td><a href="https://esbuild.github.io/">esbuild.github.io</a></td><td><a href="https://esbuild.github.io/api/">APIæ–‡æ¡£</a></td><td><a href="https://github.com/evanw/esbuild">evanw/esbuild</a></td></tr>
<tr><td><strong>SWC</strong></td><td><a href="https://swc.rs/">swc.rs</a></td><td><a href="https://swc.rs/docs/getting-started">æ–‡æ¡£</a></td><td><a href="https://github.com/swc-project/swc">swc-project/swc</a></td></tr>
<tr><td><strong>Bun</strong></td><td><a href="https://bun.sh/">bun.sh</a></td><td><a href="https://bun.sh/docs/bundler">æ–‡æ¡£</a></td><td><a href="https://github.com/oven-sh/bun">oven-sh/bun</a></td></tr>
</tbody>
</table>
</div>
<h3 id="æ–°ä¸€ä»£å·¥å…·"><a class="header" href="#æ–°ä¸€ä»£å·¥å…·">æ–°ä¸€ä»£å·¥å…·</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å·¥å…·</th><th>å®˜æ–¹ç½‘ç«™</th><th>çŠ¶æ€</th><th>è¯´æ˜</th></tr>
</thead>
<tbody>
<tr><td><strong>Rolldown</strong></td><td><a href="https://rolldown.rs/">rolldown.rs</a></td><td>å¼€å‘ä¸­</td><td>Rustç‰ˆRollupï¼ŒViteå›¢é˜Ÿå¼€å‘</td></tr>
<tr><td><strong>Turbopack</strong></td><td><a href="https://turbo.build/pack">turbo.build</a></td><td>å¼€å‘ä¸­</td><td>Webpackç»§ä»»è€…ï¼ŒVercelå¼€å‘</td></tr>
<tr><td><strong>Biome</strong></td><td><a href="https://biomejs.dev/">biomejs.dev</a></td><td>æ´»è·ƒå¼€å‘</td><td>ä¸€ä½“åŒ–å·¥å…·é“¾</td></tr>
<tr><td><strong>Farm</strong></td><td><a href="https://farm-fe.github.io/">farm-fe.github.io</a></td><td>æ´»è·ƒå¼€å‘</td><td>Rustæ„å»ºå·¥å…·</td></tr>
</tbody>
</table>
</div>
<h3 id="ç»¼åˆèƒ½åŠ›å¯¹æ¯”"><a class="header" href="#ç»¼åˆèƒ½åŠ›å¯¹æ¯”">ç»¼åˆèƒ½åŠ›å¯¹æ¯”</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>ä¸»è¦è¯­è¨€</strong></td><td>JavaScript</td><td>JavaScript</td><td>JavaScript + Go</td><td>JavaScript</td><td>Go</td><td>Rust</td><td>Zig</td></tr>
<tr><td><strong>é¦–æ¬¡å‘å¸ƒ</strong></td><td>2012</td><td>2015</td><td>2020</td><td>2017</td><td>2020</td><td>2019</td><td>2022</td></tr>
<tr><td><strong>Node.jsè¦æ±‚</strong></td><td>18.12.0+</td><td>18.0.0+</td><td>20.19+/22.12+</td><td>16.0.0+</td><td>æ— è¦æ±‚</td><td>16.0.0+</td><td>1.0.0+</td></tr>
<tr><td><strong>æ„å»ºé€Ÿåº¦</strong></td><td>ä¸­ç­‰</td><td>å¿«</td><td>éå¸¸å¿«</td><td>å¿«</td><td>æå¿«</td><td>æå¿«</td><td>æå¿«</td></tr>
<tr><td><strong>å¼€å‘æœåŠ¡å™¨</strong></td><td>æ”¯æŒ</td><td>æ’ä»¶</td><td>å†…ç½®ä¼˜ç§€</td><td>å†…ç½®ä¼˜ç§€</td><td>å†…ç½®</td><td>æ— </td><td>å†…ç½®</td></tr>
<tr><td><strong>HMRæ”¯æŒ</strong></td><td>è‰¯å¥½</td><td>æ’ä»¶æ”¯æŒ</td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>æ— </td><td>æ— </td><td>è‰¯å¥½</td></tr>
<tr><td><strong>Tree Shaking</strong></td><td>è‰¯å¥½</td><td>ä¼˜ç§€</td><td>è‰¯å¥½(Rollup)</td><td>è‰¯å¥½</td><td>åŸºç¡€</td><td>åŸºç¡€</td><td>è‰¯å¥½</td></tr>
<tr><td><strong>ä»£ç åˆ†å‰²</strong></td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>è‰¯å¥½</td><td>æ”¯æŒ</td><td>åŸºç¡€</td><td>è‰¯å¥½</td></tr>
<tr><td><strong>TypeScript</strong></td><td>é…ç½®</td><td>æ’ä»¶</td><td>å†…ç½®</td><td>å†…ç½®</td><td>å†…ç½®</td><td>å†…ç½®</td><td>å†…ç½®</td></tr>
<tr><td><strong>JSXæ”¯æŒ</strong></td><td>é…ç½®</td><td>æ’ä»¶</td><td>å†…ç½®</td><td>å†…ç½®</td><td>å†…ç½®</td><td>å†…ç½®</td><td>å†…ç½®</td></tr>
<tr><td><strong>CSSå¤„ç†</strong></td><td>é…ç½®</td><td>æ’ä»¶</td><td>å†…ç½®</td><td>å†…ç½®</td><td>æ’ä»¶</td><td>æ— </td><td>åŸºç¡€</td></tr>
<tr><td><strong>ç”Ÿäº§ä¼˜åŒ–</strong></td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>è‰¯å¥½</td><td>è‰¯å¥½</td><td>è‰¯å¥½</td><td>è‰¯å¥½</td></tr>
<tr><td><strong>æ’ä»¶ç”Ÿæ€</strong></td><td>éå¸¸ä¸°å¯Œ</td><td>ä¸°å¯Œ</td><td>å¿«é€Ÿå¢é•¿</td><td>ä¸­ç­‰</td><td>æœ‰é™</td><td>æœ‰é™</td><td>æ–°å…´</td></tr>
<tr><td><strong>é…ç½®å¤æ‚åº¦</strong></td><td>é«˜</td><td>ä¸­ç­‰</td><td>ä½</td><td>é›¶é…ç½®</td><td>ä½</td><td>ä½</td><td>ä½</td></tr>
<tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>é™¡å³­</td><td>é€‚ä¸­</td><td>å¹³ç¼“</td><td>ç®€å•</td><td>ç®€å•</td><td>ç®€å•</td><td>ç®€å•</td></tr>
<tr><td><strong>ç¤¾åŒºæ”¯æŒ</strong></td><td>ä¼˜ç§€</td><td>è‰¯å¥½</td><td>å¿«é€Ÿå¢é•¿</td><td>ä¸­ç­‰</td><td>æ´»è·ƒ</td><td>æ´»è·ƒ</td><td>å¿«é€Ÿå¢é•¿</td></tr>
</tbody>
</table>
</div>
<h3 id="è¯¦ç»†åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”"><a class="header" href="#è¯¦ç»†åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”">è¯¦ç»†åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”</a></h3>
<h4 id="æ ¸å¿ƒæ‰“åŒ…åŠŸèƒ½"><a class="header" href="#æ ¸å¿ƒæ‰“åŒ…åŠŸèƒ½">æ ¸å¿ƒæ‰“åŒ…åŠŸèƒ½</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åŠŸèƒ½ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>Module Federation</strong></td><td>âœ… å†…ç½®</td><td>âŒ</td><td>ğŸ”Œ æ’ä»¶</td><td>âŒ</td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr>
<tr><td><strong>Bundle Splitting</strong></td><td>âœ… ä¼˜ç§€</td><td>âœ… ä¼˜ç§€</td><td>âœ… ä¼˜ç§€</td><td>âœ… è‰¯å¥½</td><td>âœ… åŸºç¡€</td><td>âŒ</td><td>âœ… è‰¯å¥½</td></tr>
<tr><td><strong>Dynamic Imports</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Tree Shaking</strong></td><td>âœ… è‰¯å¥½</td><td>âœ… ä¼˜ç§€</td><td>âœ… ä¼˜ç§€</td><td>âœ… è‰¯å¥½</td><td>âœ… åŸºç¡€</td><td>âœ… åŸºç¡€</td><td>âœ… è‰¯å¥½</td></tr>
<tr><td><strong>Dead Code Elimination</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr>
<tr><td><strong>Scope Hoisting</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Asset Processing</strong></td><td>âœ… å¼ºå¤§</td><td>ğŸ”Œ æ’ä»¶</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>ğŸ”Œ æ’ä»¶</td><td>âŒ</td><td>âœ… åŸºç¡€</td></tr>
</tbody>
</table>
</div>
<h4 id="å¼€å‘å·¥å…·ç‰¹æ€§"><a class="header" href="#å¼€å‘å·¥å…·ç‰¹æ€§">å¼€å‘å·¥å…·ç‰¹æ€§</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åŠŸèƒ½ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>Source Maps</strong></td><td>âœ… å…¨æ”¯æŒ</td><td>âœ… å…¨æ”¯æŒ</td><td>âœ… å…¨æ”¯æŒ</td><td>âœ… å…¨æ”¯æŒ</td><td>âœ… å…¨æ”¯æŒ</td><td>âœ… å…¨æ”¯æŒ</td><td>âœ… å…¨æ”¯æŒ</td></tr>
<tr><td><strong>Watch Mode</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Dev Server</strong></td><td>âœ… å†…ç½®</td><td>ğŸ”Œ æ’ä»¶</td><td>âœ… ä¼˜ç§€</td><td>âœ… ä¼˜ç§€</td><td>âœ… å†…ç½®</td><td>âŒ</td><td>âœ… å†…ç½®</td></tr>
<tr><td><strong>Hot Reload</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ… ä¼˜ç§€</td><td>âœ… ä¼˜ç§€</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Error Overlay</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Progress Reporting</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
</tbody>
</table>
</div>
<h4 id="è¯­è¨€ä¸æ¡†æ¶æ”¯æŒ"><a class="header" href="#è¯­è¨€ä¸æ¡†æ¶æ”¯æŒ">è¯­è¨€ä¸æ¡†æ¶æ”¯æŒ</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åŠŸèƒ½ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>TypeScript</strong></td><td>ğŸ”Œ ts-loader</td><td>ğŸ”Œ @rollup/plugin-typescript</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td></tr>
<tr><td><strong>JSX/TSX</strong></td><td>ğŸ”Œ babel</td><td>ğŸ”Œ æ’ä»¶</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td></tr>
<tr><td><strong>Vue SFC</strong></td><td>ğŸ”Œ vue-loader</td><td>ğŸ”Œ æ’ä»¶</td><td>âœ… å®˜æ–¹æ’ä»¶</td><td>âœ… å†…ç½®</td><td>ğŸ”Œ</td><td>âŒ</td><td>ğŸ”Œ</td></tr>
<tr><td><strong>Svelte</strong></td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>ğŸ”Œ å®˜æ–¹</td><td>âœ…</td><td>ğŸ”Œ</td><td>âŒ</td><td>ğŸ”Œ</td></tr>
<tr><td><strong>React Fast Refresh</strong></td><td>ğŸ”Œ</td><td>âŒ</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr>
</tbody>
</table>
</div>
<h4 id="css-ä¸æ ·å¼å¤„ç†"><a class="header" href="#css-ä¸æ ·å¼å¤„ç†">CSS ä¸æ ·å¼å¤„ç†</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åŠŸèƒ½ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>CSS Modules</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>ğŸ”Œ</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>PostCSS</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>ğŸ”Œ</td><td>âŒ</td><td>åŸºç¡€</td></tr>
<tr><td><strong>Sass/SCSS</strong></td><td>ğŸ”Œ sass-loader</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>ğŸ”Œ</td><td>âŒ</td><td>åŸºç¡€</td></tr>
<tr><td><strong>Less</strong></td><td>ğŸ”Œ less-loader</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>ğŸ”Œ</td><td>âŒ</td><td>åŸºç¡€</td></tr>
<tr><td><strong>Stylus</strong></td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr>
<tr><td><strong>CSS-in-JS</strong></td><td>ğŸ”Œ å¤šç§</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>âŒ</td><td>ğŸ”Œ</td></tr>
<tr><td><strong>Tailwind CSS</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>ğŸ”Œ</td><td>âŒ</td><td>âœ…</td></tr>
</tbody>
</table>
</div>
<h4 id="é«˜çº§ç‰¹æ€§"><a class="header" href="#é«˜çº§ç‰¹æ€§">é«˜çº§ç‰¹æ€§</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åŠŸèƒ½ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>Macros</strong></td><td>ğŸ”Œ babel-macros</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>âŒ</td><td>âŒ</td><td>âŒ</td><td>âœ… å†…ç½®</td></tr>
<tr><td><strong>Custom Loaders</strong></td><td>âœ… å¼ºå¤§</td><td>âœ… æ’ä»¶</td><td>âœ… æ’ä»¶</td><td>âœ… å˜æ¢å™¨</td><td>âœ… æ’ä»¶</td><td>âŒ</td><td>âœ… æ’ä»¶</td></tr>
<tr><td><strong>Virtual Modules</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>External Dependencies</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Banner/Footer</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Alias Resolution</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>Conditional Exports</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
</tbody>
</table>
</div>
<h4 id="æ€§èƒ½ä¸ä¼˜åŒ–"><a class="header" href="#æ€§èƒ½ä¸ä¼˜åŒ–">æ€§èƒ½ä¸ä¼˜åŒ–</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åŠŸèƒ½ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>Minification</strong></td><td>âœ… å¤šç§é€‰æ‹©</td><td>âœ… terser</td><td>âœ… esbuild</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td></tr>
<tr><td><strong>Gzip/Brotli</strong></td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>âŒ</td><td>âŒ</td></tr>
<tr><td><strong>Image Optimization</strong></td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>ğŸ”Œ</td><td>âœ… å†…ç½®</td><td>ğŸ”Œ</td><td>âŒ</td><td>åŸºç¡€</td></tr>
<tr><td><strong>Bundle Analysis</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>ğŸ”Œ</td><td>âŒ</td><td>åŸºç¡€</td></tr>
<tr><td><strong>Caching</strong></td><td>âœ… æŒä¹…åŒ–</td><td>åŸºç¡€</td><td>âœ… ä¾èµ–é¢„æ„å»º</td><td>âœ… å¼ºå¤§</td><td>âœ… åŸºç¡€</td><td>âŒ</td><td>âœ… åŸºç¡€</td></tr>
<tr><td><strong>Parallel Processing</strong></td><td>ğŸ”Œ</td><td>âŒ</td><td>âœ… esbuild</td><td>âœ… worker</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td></tr>
</tbody>
</table>
</div>
<h4 id="éƒ¨ç½²ä¸è¾“å‡º"><a class="header" href="#éƒ¨ç½²ä¸è¾“å‡º">éƒ¨ç½²ä¸è¾“å‡º</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åŠŸèƒ½ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>Multiple Targets</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr>
<tr><td><strong>Library Mode</strong></td><td>âœ…</td><td>âœ… ä¼˜ç§€</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>UMD Output</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ… IIFE</td><td>âŒ</td><td>âŒ</td></tr>
<tr><td><strong>ES Module Output</strong></td><td>âœ…</td><td>âœ… ä¼˜ç§€</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr>
<tr><td><strong>CommonJS Output</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr>
<tr><td><strong>File Hashing</strong></td><td>âœ…</td><td>ğŸ”Œ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr>
</tbody>
</table>
</div>
<h4 id="ç‹¬ç‰¹åŠŸèƒ½ç‰¹æ€§"><a class="header" href="#ç‹¬ç‰¹åŠŸèƒ½ç‰¹æ€§">ç‹¬ç‰¹åŠŸèƒ½ç‰¹æ€§</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å·¥å…·ç‰¹æœ‰åŠŸèƒ½</th><th>æè¿°</th><th>ä½¿ç”¨åœºæ™¯</th><th>ç¤ºä¾‹</th></tr>
</thead>
<tbody>
<tr><td><strong>Webpack Asset Modules</strong></td><td>åŸç”Ÿèµ„æºå¤„ç†ï¼ˆWebpack 5ï¼‰</td><td>æ›¿ä»£å„ç§loader</td><td><code>type: 'asset/resource'</code> å¤„ç†å›¾ç‰‡ã€å­—ä½“ç­‰èµ„æº</td></tr>
<tr><td><strong>Webpack Module Federation</strong></td><td>å¾®å‰ç«¯è¿è¡Œæ—¶æ¨¡å—å…±äº«</td><td>å¤§å‹åˆ†å¸ƒå¼åº”ç”¨</td><td>åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½å…¶ä»–åº”ç”¨çš„æ¨¡å—</td></tr>
<tr><td><strong>Webpack DLL Plugin</strong></td><td>é¢„ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“</td><td>åŠ é€Ÿå¼€å‘æ„å»º</td><td>å°†Reactã€Vueç­‰åº“é¢„æ‰“åŒ…</td></tr>
<tr><td><strong>Rollup Pure Annotations</strong></td><td>çº¯å‡½æ•°æ ‡è®°ä¼˜åŒ–</td><td>åº“å¼€å‘Tree Shaking</td><td><code>/*#__PURE__*/</code> æ³¨é‡Šä¼˜åŒ–</td></tr>
<tr><td><strong>Vite ä¾èµ–é¢„æ„å»º</strong></td><td>CommonJSâ†’ESMè½¬æ¢é¢„æ„å»º</td><td>å¼€å‘æ—¶æ€§èƒ½</td><td>è‡ªåŠ¨é¢„æ„å»ºnode_modulesä¾èµ–</td></tr>
<tr><td><strong>Vite åŸç”ŸESM</strong></td><td>å¼€å‘æ—¶æ— éœ€æ‰“åŒ…</td><td>æé€Ÿå¼€å‘ä½“éªŒ</td><td>ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡ŒESæ¨¡å—</td></tr>
<tr><td><strong>Parcel è‡ªåŠ¨ä¾èµ–å®‰è£…</strong></td><td>æ£€æµ‹å¹¶è‡ªåŠ¨å®‰è£…ç¼ºå¤±ä¾èµ–</td><td>å¿«é€ŸåŸå‹å¼€å‘</td><td>å¼•ç”¨æ–°åŒ…æ—¶è‡ªåŠ¨<code>npm install</code></td></tr>
<tr><td><strong>Parcel Differential Bundling</strong></td><td>ç°ä»£/ä¼ ç»Ÿæµè§ˆå™¨å·®å¼‚åŒ–æ‰“åŒ…</td><td>æ€§èƒ½ä¼˜åŒ–</td><td>ä¸ºæ–°æµè§ˆå™¨æä¾›æ›´å°çš„bundle</td></tr>
<tr><td><strong>esbuild Goå¹¶å‘</strong></td><td>Goåç¨‹å¹¶è¡Œå¤„ç†</td><td>æé€Ÿæ„å»º</td><td>åŒæ—¶å¤„ç†æ•°åƒä¸ªæ–‡ä»¶</td></tr>
<tr><td><strong>SWC Rustæ€§èƒ½</strong></td><td>Rustç¼–å†™çš„ç¼–è¯‘å™¨</td><td>ç¼–è¯‘é€Ÿåº¦</td><td>æ¯”Babelå¿«20å€çš„è½¬è¯‘</td></tr>
<tr><td><strong>Bun Macros</strong></td><td>æ„å»ºæ—¶å®å±•å¼€</td><td>ä»£ç ç”Ÿæˆå’Œä¼˜åŒ–</td><td><code>import {sql} from "./query.ts" with {type: "macro"}</code></td></tr>
<tr><td><strong>Bun å†…ç½®è¿è¡Œæ—¶</strong></td><td>æ‰“åŒ…å™¨+è¿è¡Œæ—¶ä¸€ä½“</td><td>å…¨æ ˆå¼€å‘</td><td>åŒæ—¶å¤„ç†å‰ç«¯æ‰“åŒ…å’Œåç«¯è¿è¡Œ</td></tr>
</tbody>
</table>
</div>
<h4 id="é«˜çº§é…ç½®ç‰¹æ€§"><a class="header" href="#é«˜çº§é…ç½®ç‰¹æ€§">é«˜çº§é…ç½®ç‰¹æ€§</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç‰¹æ€§</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>æ¡ä»¶ç¼–è¯‘</strong></td><td>âœ… DefinePlugin</td><td>âœ… @rollup/plugin-replace</td><td>âœ… define</td><td>âœ… ç¯å¢ƒå˜é‡</td><td>âœ… define</td><td>âŒ</td><td>âœ… define</td></tr>
<tr><td><strong>ä»£ç æ³¨å…¥</strong></td><td>âœ… BannerPlugin</td><td>âœ… banner/footer</td><td>âœ… build.rollupOptions</td><td>âŒ</td><td>âœ… banner</td><td>âŒ</td><td>âœ…</td></tr>
<tr><td><strong>è‡ªå®šä¹‰è§£æ</strong></td><td>âœ… resolveé…ç½®</td><td>âœ… æ’ä»¶</td><td>âœ… resolveé…ç½®</td><td>âœ… è‡ªåŠ¨è§£æ</td><td>âœ… è§£æå™¨</td><td>âŒ</td><td>âœ… è§£æå™¨</td></tr>
<tr><td><strong>ç¯å¢ƒå˜é‡æ³¨å…¥</strong></td><td>âœ… å¤šç§æ–¹å¼</td><td>ğŸ”Œ æ’ä»¶</td><td>âœ… å†…ç½®</td><td>âœ… å†…ç½®</td><td>âœ… define</td><td>âŒ</td><td>âœ… å†…ç½®</td></tr>
<tr><td><strong>å¤šå…¥å£é…ç½®</strong></td><td>âœ… å¤æ‚é…ç½®</td><td>âœ… å¯¹è±¡/æ•°ç»„</td><td>âœ… build.rollupOptions</td><td>âœ… è‡ªåŠ¨æ£€æµ‹</td><td>âœ… æ•°ç»„</td><td>âŒ</td><td>âœ… æ•°ç»„</td></tr>
</tbody>
</table>
</div>
<h4 id="ç¤¾åŒºç”Ÿæ€å¯¹æ¯”"><a class="header" href="#ç¤¾åŒºç”Ÿæ€å¯¹æ¯”">ç¤¾åŒºç”Ÿæ€å¯¹æ¯”</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç”Ÿæ€æŒ‡æ ‡</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>å®˜æ–¹æ’ä»¶</strong></td><td>20+</td><td>30+</td><td>15+</td><td>å†…ç½®ä¸°å¯Œ</td><td>åŸºç¡€</td><td>åŸºç¡€</td><td>æ–°å…´</td></tr>
<tr><td><strong>ç¬¬ä¸‰æ–¹æ’ä»¶</strong></td><td>2000+</td><td>400+</td><td>300+</td><td>150+</td><td>80+</td><td>50+</td><td>30+</td></tr>
<tr><td><strong>æ¡†æ¶å®˜æ–¹æ”¯æŒ</strong></td><td>Vue, React, Angular</td><td>Vue, React</td><td>Vueå®˜æ–¹, React</td><td>å…¨æ”¯æŒ</td><td>å¤šæ•°æ¡†æ¶</td><td>Next.jsç­‰</td><td>å¿«é€Ÿå¢é•¿</td></tr>
<tr><td><strong>ä¼ä¸šæ¡ˆä¾‹</strong></td><td>Netflix, Airbnb</td><td>React, Vue</td><td>Vue, Element+</td><td>Atlassian</td><td>Discord, Figma</td><td>Vercel, Next.js</td><td>Oven, Vercel</td></tr>
<tr><td><strong>å­¦ä¹ èµ„æº</strong></td><td>æä¸°å¯Œ</td><td>ä¸°å¯Œ</td><td>å¿«é€Ÿå¢é•¿</td><td>ä¸­ç­‰</td><td>å……è¶³</td><td>å¢é•¿ä¸­</td><td>æ–°å…´</td></tr>
</tbody>
</table>
</div>
<p><strong>å›¾ä¾‹è¯´æ˜</strong>ï¼š</p>
<ul>
<li>âœ… åŸç”Ÿæ”¯æŒæˆ–æ”¯æŒè‰¯å¥½</li>
<li>ğŸ”Œ éœ€è¦æ’ä»¶æ”¯æŒ</li>
<li>âŒ ä¸æ”¯æŒæˆ–æ”¯æŒæœ‰é™</li>
<li>åŸºç¡€ = åŸºæœ¬åŠŸèƒ½å¯ç”¨ä½†åŠŸèƒ½æœ‰é™</li>
<li>è‰¯å¥½ = åŠŸèƒ½å®Œæ•´ä¸”è¡¨ç°è‰¯å¥½</li>
<li>ä¼˜ç§€ = åŠŸèƒ½å¼ºå¤§ä¸”æ€§èƒ½å‡ºè‰²</li>
</ul>
<h3 id="å„å·¥å…·æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“"><a class="header" href="#å„å·¥å…·æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“">å„å·¥å…·æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“</a></h3>
<h4 id="-webpack---ä¼ä¸šçº§å…¨èƒ½é€‰æ‰‹"><a class="header" href="#-webpack---ä¼ä¸šçº§å…¨èƒ½é€‰æ‰‹">ğŸ”§ <strong>Webpack</strong> - ä¼ä¸šçº§å…¨èƒ½é€‰æ‰‹</a></h4>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>Module Federation</strong>: ä¸šç•Œå”¯ä¸€çš„è¿è¡Œæ—¶æ¨¡å—è”é‚¦è§£å†³æ–¹æ¡ˆ</li>
<li><strong>æåº¦çµæ´»çš„é…ç½®</strong>: å‡ ä¹å¯ä»¥å®šåˆ¶ä¸€åˆ‡æ‰“åŒ…è¡Œä¸º</li>
<li><strong>æœ€æˆç†Ÿçš„ç”Ÿæ€</strong>: 2000+æ’ä»¶ï¼Œè§£å†³å„ç§è¾¹ç¼˜éœ€æ±‚</li>
<li><strong>å¼ºå¤§çš„ä»£ç åˆ†æ</strong>: å†…ç½®Bundle Analyzerï¼Œè¯¦ç»†çš„æ„å»ºç»Ÿè®¡</li>
</ul>
<p><strong>ç‹¬ç‰¹åŠŸèƒ½</strong>ï¼š</p>
<p><strong>1. Asset Modules (Webpack 5)</strong>ï¼š</p>
<pre><code class="language-javascript">// åŸç”Ÿèµ„æºå¤„ç†ï¼Œæ›¿ä»£file-loader/url-loader
module.exports = {
  module: {
    rules: [
      {
        test: /\.(png|svg|jpg|jpeg|gif)$/i,
        type: 'asset/resource',  // è¾“å‡ºå•ç‹¬æ–‡ä»¶
      },
      {
        test: /\.svg$/i,
        type: 'asset/inline',    // å†…è”ä¸ºdata URL
      },
      {
        test: /\.txt$/i,
        type: 'asset/source',    // å¯¼å‡ºä¸ºå­—ç¬¦ä¸²
      },
      {
        test: /\.png$/i,
        type: 'asset',          // è‡ªåŠ¨é€‰æ‹©inline/resource
        parser: {
          dataUrlCondition: {
            maxSize: 8 * 1024   // 8kbé˜ˆå€¼
          }
        }
      }
    ]
  }
}
</code></pre>
<p><strong>2. Module Federationç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="language-javascript">// å¾®å‰ç«¯è¿è¡Œæ—¶æ¨¡å—å…±äº«
const ModuleFederationPlugin = require('@module-federation/webpack');

module.exports = {
  plugins: [
    new ModuleFederationPlugin({
      name: 'shell',
      remotes: {
        'remote-app': 'remoteApp@http://localhost:3001/remoteEntry.js'
      }
    })
  ]
}
</code></pre>
<p><strong>3. å…¶ä»–ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li><strong>Persistent Caching</strong>: æ–‡ä»¶ç³»ç»Ÿçº§æŒä¹…åŒ–ç¼“å­˜</li>
<li><strong>Top Level Await</strong>: é¡¶å±‚awaitæ”¯æŒ</li>
<li><strong>DLLæ’ä»¶</strong>: é¢„ç¼–è¯‘ä¼˜åŒ–</li>
<li><strong>å®Œæ•´çš„å¼€å‘æœåŠ¡å™¨</strong>: å†…ç½®HMRç³»ç»Ÿ</li>
<li><strong>æ”¯æŒæ‰€æœ‰ä¸»æµå‰ç«¯æ¡†æ¶</strong></li>
</ul>
<h4 id="-rollup---åº“å¼€å‘ä¸“å®¶"><a class="header" href="#-rollup---åº“å¼€å‘ä¸“å®¶">ğŸŒ² <strong>Rollup</strong> - åº“å¼€å‘ä¸“å®¶</a></h4>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>æè‡´çš„Tree Shaking</strong>: ESæ¨¡å—é™æ€åˆ†æé¢†åŸŸçš„ä½¼ä½¼è€…</li>
<li><strong>å¹²å‡€çš„è¾“å‡ºä»£ç </strong>: æ¥è¿‘æ‰‹å†™ä»£ç çš„å¯è¯»æ€§</li>
<li><strong>ä¼˜ç§€çš„åº“æ¨¡å¼</strong>: æ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼(UMDã€ESMã€CJS)</li>
<li><strong>çº¯å‡½æ•°æ ‡è®°</strong>: <code>/*#__PURE__*/</code>æ³¨é‡Šä¼˜åŒ–æ”¯æŒ</li>
</ul>
<p><strong>ç‹¬ç‰¹åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>æœ€ä½³çš„ESæ¨¡å—å¤„ç†</li>
<li>æ’ä»¶APIè®¾è®¡ä¼˜é›…</li>
<li>æ”¯æŒå¤æ‚çš„æ¡ä»¶å¯¼å‡º</li>
<li>ä¸“ä¸ºåº“å¼€å‘ä¼˜åŒ–</li>
</ul>
<h4 id="-vite---ç°ä»£å¼€å‘ä½“éªŒä¹‹ç‹"><a class="header" href="#-vite---ç°ä»£å¼€å‘ä½“éªŒä¹‹ç‹">âš¡ <strong>Vite</strong> - ç°ä»£å¼€å‘ä½“éªŒä¹‹ç‹</a></h4>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>åŸç”ŸESMå¼€å‘</strong>: æ— éœ€æ‰“åŒ…ï¼Œç›´æ¥åœ¨æµè§ˆå™¨è¿è¡Œ</li>
<li><strong>ä¾èµ–é¢„æ„å»º</strong>: è‡ªåŠ¨å°†CommonJSè½¬ä¸ºESMå¹¶ç¼“å­˜</li>
<li><strong>æ¯«ç§’çº§HMR</strong>: åŸºäºESæ¨¡å—çš„ç²¾ç¡®æ›´æ–°</li>
<li><strong>é›¶é…ç½®ä½“éªŒ</strong>: å¼€ç®±å³ç”¨çš„ç°ä»£å‰ç«¯å·¥å…·é“¾</li>
</ul>
<p><strong>ç‹¬ç‰¹åŠŸèƒ½</strong>ï¼š</p>
<p><strong>1. ä¾èµ–é¢„æ„å»ºæœºåˆ¶</strong>ï¼š</p>
<pre><code class="language-javascript">// Viteè‡ªåŠ¨æ£€æµ‹å¹¶é¢„æ„å»ºä¾èµ–
// å°† node_modules ä¸­çš„ CommonJS/UMD è½¬æ¢ä¸º ESM

// é¢„æ„å»ºåçš„æ–‡ä»¶ç»“æ„
.vite/
â””â”€â”€ deps/
    â”œâ”€â”€ react.js          // é¢„æ„å»ºçš„React
    â”œâ”€â”€ react-dom.js      // é¢„æ„å»ºçš„ReactDOM
    â”œâ”€â”€ lodash.js         // é¢„æ„å»ºçš„å·¥å…·åº“
    â””â”€â”€ _metadata.json    // ä¾èµ–å…ƒæ•°æ®

// æ‰‹åŠ¨é…ç½®é¢„æ„å»º
export default {
  optimizeDeps: {
    include: ['linked-dep'],        // å¼ºåˆ¶é¢„æ„å»º
    exclude: ['your-lib'],          // æ’é™¤é¢„æ„å»º
    force: true,                    // å¼ºåˆ¶é‡æ–°é¢„æ„å»º
    esbuildOptions: {
      target: 'es2020'              // é¢„æ„å»ºç›®æ ‡
    }
  }
}
</code></pre>
<p><strong>2. å¼€å‘ä¸ç”Ÿäº§æ¶æ„å·®å¼‚</strong>ï¼š</p>
<ul>
<li><strong>å¼€å‘æ—¶</strong>: åŸç”ŸESM + esbuildè½¬è¯‘ + ä¾èµ–é¢„æ„å»º</li>
<li><strong>ç”Ÿäº§æ—¶</strong>: Rollupæ‰“åŒ… + Tree Shaking + ä»£ç åˆ†å‰²</li>
<li><strong>HMRå®ç°</strong>: åŸºäºESæ¨¡å—è¾¹ç•Œçš„ç²¾ç¡®æ›´æ–°</li>
</ul>
<p><strong>3. æµè§ˆå™¨å…¼å®¹æ€§</strong>ï¼š</p>
<ul>
<li><strong>å¼€å‘</strong>: ç°ä»£æµè§ˆå™¨ (esnext target)</li>
<li><strong>ç”Ÿäº§</strong>: Baseline Widely Available (2.5å¹´å‰æµè§ˆå™¨)</li>
<li><strong>Legacyæ”¯æŒ</strong>: @vitejs/plugin-legacyæ’ä»¶</li>
</ul>
<p><strong>4. å…¶ä»–ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨CSSä»£ç åˆ†å‰²</li>
<li>å†…ç½®TypeScriptã€JSXæ”¯æŒ</li>
<li>å®˜æ–¹Vueæ”¯æŒï¼ŒReactç”Ÿæ€å®Œå–„</li>
<li>Multi-pageåº”ç”¨æ”¯æŒ</li>
</ul>
<h4 id="-parcel---é›¶é…ç½®è‡ªåŠ¨åŒ–ä¸“å®¶"><a class="header" href="#-parcel---é›¶é…ç½®è‡ªåŠ¨åŒ–ä¸“å®¶">ğŸ“¦ <strong>Parcel</strong> - é›¶é…ç½®è‡ªåŠ¨åŒ–ä¸“å®¶</a></h4>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>é›¶é…ç½®å“²å­¦</strong>: æ£€æµ‹é¡¹ç›®éœ€æ±‚è‡ªåŠ¨é…ç½®</li>
<li><strong>è‡ªåŠ¨ä¾èµ–å®‰è£…</strong>: æ£€æµ‹åˆ°æ–°ä¾èµ–è‡ªåŠ¨å®‰è£…</li>
<li><strong>å·®å¼‚åŒ–æ‰“åŒ…</strong>: ä¸ºä¸åŒæµè§ˆå™¨ç”Ÿæˆä¸åŒçš„bundle</li>
<li><strong>å†…ç½®ä¼˜åŒ–</strong>: è‡ªåŠ¨å›¾ç‰‡å‹ç¼©ã€ä»£ç åˆ†å‰²ç­‰</li>
</ul>
<p><strong>ç‹¬ç‰¹åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>å¤šæ ¸å¹¶è¡Œå¤„ç†</li>
<li>è‡ªåŠ¨æ£€æµ‹å’Œè½¬æ¢å„ç§èµ„æºç±»å‹</li>
<li>å†…ç½®å¼€å‘æœåŠ¡å™¨å’ŒHMR</li>
<li>æ”¯æŒå¤šç§å‰ç«¯æ¡†æ¶æ— éœ€é…ç½®</li>
</ul>
<h4 id="-esbuild---æé€Ÿæ„å»ºå¼•æ“"><a class="header" href="#-esbuild---æé€Ÿæ„å»ºå¼•æ“">ğŸš€ <strong>esbuild</strong> - æé€Ÿæ„å»ºå¼•æ“</a></h4>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>Goå¹¶å‘å¤„ç†</strong>: åˆ©ç”¨Goåç¨‹å®ç°çœŸæ­£çš„å¹¶è¡Œå¤„ç†</li>
<li><strong>æé€Ÿæ„å»º</strong>: æ¯”ä¼ ç»Ÿå·¥å…·å¿«10-100å€</li>
<li><strong>å†…ç½®è½¬è¯‘</strong>: å†…ç½®TypeScriptã€JSXå¤„ç†</li>
<li><strong>ç®€æ´API</strong>: ç®€å•æ˜“ç”¨çš„é…ç½®æ¥å£</li>
</ul>
<p><strong>ç‹¬ç‰¹åŠŸèƒ½</strong>ï¼š</p>
<p><strong>1. å¼€å‘æœåŠ¡å™¨æ”¯æŒ</strong>ï¼š</p>
<pre><code class="language-javascript">// å¼€å‘æœåŠ¡å™¨æ¨¡å¼
const ctx = await esbuild.context({
  entryPoints: ['src/app.js'],
  bundle: true,
  outdir: 'dist',
})

// å¯åŠ¨å¼€å‘æœåŠ¡å™¨
const { host, port } = await ctx.serve({
  servedir: 'dist',
  port: 8000,
})
console.log(`Server: http://${host}:${port}/`)

// Watchæ¨¡å¼
await ctx.watch()

// æ‰‹åŠ¨é‡æ–°æ„å»º
await ctx.rebuild()
</code></pre>
<p><strong>2. Glob-styleåŠ¨æ€å¯¼å…¥</strong>ï¼š</p>
<pre><code class="language-javascript">// æ”¯æŒæ¨¡å¼åŒ¹é…çš„åŠ¨æ€å¯¼å…¥
const json1 = require('./data/' + kind + '.json')
const json2 = require(`./data/${kind}.json`)

// esbuildä¼šï¼š
// 1. æ‰«æåŒ¹é…çš„æ–‡ä»¶
// 2. ç”Ÿæˆæ–‡ä»¶æ˜ å°„è¡¨
// 3. æ›¿æ¢ä¸ºæŸ¥è¡¨é€»è¾‘
</code></pre>
<p><strong>3. æµè§ˆå™¨WebAssemblyæ”¯æŒ</strong>ï¼š</p>
<pre><code class="language-javascript">// æµè§ˆå™¨ä¸­ä½¿ç”¨esbuild
import * as esbuild from 'esbuild-wasm'

await esbuild.initialize({
  wasmURL: './node_modules/esbuild-wasm/esbuild.wasm',
})

const result = await esbuild.transform(code, { loader: 'tsx' })
</code></pre>
<p><strong>4. å…¶ä»–ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>é›¶ä¾èµ–å®‰è£…</li>
<li>æ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼(ESM/CJS/IIFE)</li>
<li>å†…ç½®ä»£ç å‹ç¼©å’Œæ··æ·†</li>
<li>æ’ä»¶ç³»ç»Ÿç®€å•é«˜æ•ˆ</li>
<li>å¢é‡æ„å»ºAPI</li>
</ul>
<h4 id="-swc---rustç¼–è¯‘å™¨"><a class="header" href="#-swc---rustç¼–è¯‘å™¨">ğŸ¦€ <strong>SWC</strong> - Rustç¼–è¯‘å™¨</a></h4>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>Rustæ€§èƒ½</strong>: æ¯”Babelå¿«20å€çš„è½¬è¯‘é€Ÿåº¦</li>
<li><strong>ç°ä»£è¯­æ³•æ”¯æŒ</strong>: å®Œæ•´çš„ES2022+è¯­æ³•æ”¯æŒ</li>
<li><strong>æ¡†æ¶é›†æˆ</strong>: Next.jså®˜æ–¹ç¼–è¯‘å™¨</li>
<li><strong>æ’ä»¶ç”Ÿæ€</strong>: æ”¯æŒè‡ªå®šä¹‰æ’ä»¶å¼€å‘</li>
</ul>
<p><strong>ç‹¬ç‰¹åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>å®éªŒæ€§ç‰¹æ€§æ”¯æŒ</li>
<li>é«˜åº¦å¯é…ç½®çš„è½¬è¯‘è§„åˆ™</li>
<li>æ”¯æŒWebAssemblyè¾“å‡º</li>
<li>ä¸å„ç§æ„å»ºå·¥å…·é›†æˆ</li>
</ul>
<h4 id="-bun---å…¨æ ˆä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆ"><a class="header" href="#-bun---å…¨æ ˆä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆ">ğŸ¥Ÿ <strong>Bun</strong> - å…¨æ ˆä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆ</a></h4>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>Macrosç³»ç»Ÿ</strong>: æ„å»ºæ—¶ä»£ç ç”Ÿæˆå’Œä¼˜åŒ–</li>
<li><strong>ä¸€ä½“åŒ–å·¥å…·é“¾</strong>: åŒ…ç®¡ç†å™¨+æ‰“åŒ…å™¨+è¿è¡Œæ—¶</li>
<li><strong>æé€Ÿå®‰è£…</strong>: æ¯”npm/yarnå¿«æ•°å€çš„åŒ…å®‰è£…</li>
<li><strong>å†…ç½®æµ‹è¯•</strong>: æ— éœ€Jestç­‰é¢å¤–æµ‹è¯•æ¡†æ¶</li>
</ul>
<p><strong>ç‹¬ç‰¹åŠŸèƒ½</strong>ï¼š</p>
<p><strong>1. Macrosç³»ä¾‹</strong>ï¼š</p>
<pre><code class="language-typescript">// Bun Macrosç¤ºä¾‹
import {sql} from "./database.ts" with {type: "macro"};

// æ„å»ºæ—¶å±•å¼€ä¸ºä¼˜åŒ–çš„SQLæŸ¥è¯¢ä»£ç 
const users = await sql`SELECT * FROM users WHERE id = ${userId}`;
</code></pre>
<p><strong>2. ç¯å¢ƒå˜é‡å¤„ç†</strong>ï¼š</p>
<pre><code class="language-typescript">// å†…è”æ‰€æœ‰ç¯å¢ƒå˜é‡
await Bun.build({
  env: "inline"  // process.env.FOO â†’ "actual_value"
});

// é€‰æ‹©æ€§å†…è”ï¼ˆæ¨èç”¨äºå®¢æˆ·ç«¯ï¼‰
await Bun.build({
  env: "PUBLIC_*"  // åªå†…è”PUBLIC_å¼€å¤´çš„å˜é‡
});

// ç¦ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥
await Bun.build({
  env: "disable"
});
</code></pre>
<p><strong>3. ç›®æ ‡ç¯å¢ƒé…ç½®</strong>ï¼š</p>
<pre><code class="language-typescript">await Bun.build({
  target: "browser",  // æµè§ˆå™¨ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰
  target: "bun",      // Bunè¿è¡Œæ—¶ï¼Œæ·»åŠ // @bun pragma
  target: "node",     // Node.jså…¼å®¹è¾“å‡º
  format: "esm",      // ESæ¨¡å—ï¼ˆé»˜è®¤ï¼‰
  format: "cjs",      // CommonJS
  format: "iife",     // è‡ªæ‰§è¡Œå‡½æ•°
});
</code></pre>
<p><strong>4. å…¨æ ˆåº”ç”¨ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>è¿è¡Œæ—¶+æ„å»ºæ—¶ä¸€ä½“åŒ–</li>
<li>åŒæ—¶å¤„ç†å‰ç«¯å’Œåç«¯ä»£ç æ‰“åŒ…</li>
<li>å†…ç½®SQLiteæ”¯æŒ</li>
<li>åŸç”ŸWebSocketå’ŒHTTPæœåŠ¡å™¨</li>
<li>å…¼å®¹Node.jsç”Ÿæ€ç³»ç»Ÿ</li>
</ul>
<h3 id="æ€§èƒ½åŸºå‡†å¯¹æ¯”"><a class="header" href="#æ€§èƒ½åŸºå‡†å¯¹æ¯”">æ€§èƒ½åŸºå‡†å¯¹æ¯”</a></h3>
<p>åŸºäºå„å·¥å…·å®˜æ–¹æä¾›çš„åŸºå‡†æµ‹è¯•æ•°æ®å’Œç¤¾åŒºæµ‹è¯•ç»“æœï¼š</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>æµ‹è¯•é¡¹ç›®</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>å†·å¯åŠ¨æ—¶é—´</strong></td><td>10-30s</td><td>5-15s</td><td>1-3s</td><td>3-8s</td><td>0.5-2s</td><td>N/A</td><td>0.5-2s</td></tr>
<tr><td><strong>çƒ­æ›´æ–°é€Ÿåº¦</strong></td><td>1-5s</td><td>N/A</td><td>&lt;100ms</td><td>&lt;500ms</td><td>N/A</td><td>N/A</td><td>&lt;500ms</td></tr>
<tr><td><strong>å¤§å‹é¡¹ç›®æ„å»º</strong></td><td>2-10min</td><td>1-5min</td><td>30s-2min</td><td>1-3min</td><td>10s-1min</td><td>10s-1min</td><td>15s-1min</td></tr>
<tr><td><strong>å¢é‡æ„å»º</strong></td><td>5-30s</td><td>2-15s</td><td>1-5s</td><td>2-10s</td><td>1-5s</td><td>1-5s</td><td>1-8s</td></tr>
<tr><td><strong>Bundleå¤§å°ä¼˜åŒ–</strong></td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>è‰¯å¥½</td><td>è‰¯å¥½</td><td>è‰¯å¥½</td><td>è‰¯å¥½</td></tr>
<tr><td><strong>å†…å­˜ä½¿ç”¨</strong></td><td>é«˜</td><td>ä¸­ç­‰</td><td>ä¸­ç­‰</td><td>ä¸­ç­‰</td><td>ä½</td><td>ä½</td><td>ä¸­ç­‰</td></tr>
</tbody>
</table>
</div>
<h3 id="ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿåº¦"><a class="header" href="#ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿåº¦">ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿåº¦</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>æ–¹é¢</th><th>Webpack</th><th>Rollup</th><th>Vite</th><th>Parcel</th><th>esbuild</th><th>SWC</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>å®˜æ–¹æ’ä»¶æ•°é‡</strong></td><td>100+</td><td>50+</td><td>30+</td><td>20+</td><td>10+</td><td>5+</td><td>10+</td></tr>
<tr><td><strong>ç¤¾åŒºæ’ä»¶</strong></td><td>1000+</td><td>300+</td><td>200+</td><td>100+</td><td>50+</td><td>30+</td><td>50+</td></tr>
<tr><td><strong>æ¡†æ¶é›†æˆ</strong></td><td>å…¨æ”¯æŒ</td><td>React/Vue</td><td>Vue/React</td><td>å…¨æ”¯æŒ</td><td>å¤šæ•°æ”¯æŒ</td><td>å¤šæ•°æ”¯æŒ</td><td>å¿«é€Ÿå¢é•¿</td></tr>
<tr><td><strong>ä¼ä¸šé‡‡ç”¨ç‡</strong></td><td>æé«˜</td><td>é«˜</td><td>å¿«é€Ÿå¢é•¿</td><td>ä¸­ç­‰</td><td>å¢é•¿ä¸­</td><td>å¢é•¿ä¸­</td><td>æ–°å…´</td></tr>
<tr><td><strong>Stack Overflowé—®é¢˜</strong></td><td>50K+</td><td>10K+</td><td>5K+</td><td>3K+</td><td>1K+</td><td>500+</td><td>200+</td></tr>
<tr><td><strong>GitHub Stars</strong></td><td>65K+</td><td>25K+</td><td>65K+</td><td>43K+</td><td>38K+</td><td>31K+</td><td>74K+</td></tr>
</tbody>
</table>
</div>
<p><strong>æ³¨æ„</strong>ï¼šæ€§èƒ½æ•°æ®ä¼šå› é¡¹ç›®è§„æ¨¡ã€é…ç½®å’Œç¡¬ä»¶ç¯å¢ƒè€Œæœ‰æ‰€å·®å¼‚ã€‚å»ºè®®åœ¨å®é™…é¡¹ç›®ä¸­è¿›è¡Œæµ‹è¯•ä»¥è·å¾—å‡†ç¡®æ•°æ®ã€‚</p>
<h3 id="è¯¦ç»†ç‰¹æ€§åˆ†æ"><a class="header" href="#è¯¦ç»†ç‰¹æ€§åˆ†æ">è¯¦ç»†ç‰¹æ€§åˆ†æ</a></h3>
<h4 id="1-æ„å»ºæ€§èƒ½-"><a class="header" href="#1-æ„å»ºæ€§èƒ½-">1. <strong>æ„å»ºæ€§èƒ½</strong> ğŸš€</a></h4>
<p><strong>é€Ÿåº¦æ’å</strong>ï¼š</p>
<ol>
<li><strong>esbuild/SWC/Bun</strong> - ä½¿ç”¨ç³»ç»Ÿçº§è¯­è¨€ï¼Œæ„å»ºé€Ÿåº¦æå¿«</li>
<li><strong>Vite</strong> - å¼€å‘æ—¶ä½¿ç”¨åŸç”ŸESMï¼Œç”Ÿäº§æ—¶ä½¿ç”¨Rollup</li>
<li><strong>Rollup</strong> - ä¸“æ³¨æ‰“åŒ…ï¼Œç›¸å¯¹ç®€å•å¿«é€Ÿ</li>
<li><strong>Parcel</strong> - å¤šæ ¸å¹¶è¡Œå¤„ç†ï¼Œé€Ÿåº¦è¾ƒå¿«</li>
<li><strong>Webpack</strong> - åŠŸèƒ½å…¨é¢ä½†ç›¸å¯¹è¾ƒé‡</li>
</ol>
<h4 id="2-å¼€å‘ä½“éªŒ-"><a class="header" href="#2-å¼€å‘ä½“éªŒ-">2. <strong>å¼€å‘ä½“éªŒ</strong> ğŸ‘¨â€ğŸ’»</a></h4>
<p><strong>æœ€ä½³å¼€å‘ä½“éªŒ</strong>ï¼š</p>
<ul>
<li><strong>Vite</strong>ï¼šæ¯«ç§’çº§HMR + åŸç”ŸESM</li>
<li><strong>Parcel</strong>ï¼šé›¶é…ç½® + è‡ªåŠ¨åŒ–ä¸€åˆ‡</li>
<li><strong>Bun</strong>ï¼šå…¨æ ˆå·¥å…·é“¾é›†æˆ</li>
</ul>
<p><strong>é…ç½®å‹å¥½æ€§</strong>ï¼š</p>
<ul>
<li><strong>é›¶é…ç½®</strong>ï¼šParcel</li>
<li><strong>çº¦å®šä¼˜äºé…ç½®</strong>ï¼šVite</li>
<li><strong>é«˜åº¦çµæ´»</strong>ï¼šWebpack</li>
</ul>
<h4 id="3-é€‚ç”¨åœºæ™¯-"><a class="header" href="#3-é€‚ç”¨åœºæ™¯-">3. <strong>é€‚ç”¨åœºæ™¯</strong> ğŸ¯</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>åœºæ™¯</th><th>æ¨èå·¥å…·</th><th>ç†ç”±</th></tr>
</thead>
<tbody>
<tr><td><strong>å¤§å‹ä¼ä¸šåº”ç”¨</strong></td><td>Webpack</td><td>é…ç½®çµæ´»ã€ç”Ÿæ€æˆç†Ÿã€åŠŸèƒ½å…¨é¢</td></tr>
<tr><td><strong>åº“/æ¡†æ¶å¼€å‘</strong></td><td>Rollup</td><td>Tree shakingä¼˜ç§€ã€è¾“å‡ºå¹²å‡€</td></tr>
<tr><td><strong>ç°ä»£Webåº”ç”¨</strong></td><td>Vite</td><td>å¼€å‘å¿«é€Ÿã€æ„å»ºä¼˜åŒ–ã€ä½“éªŒä¼˜ç§€</td></tr>
<tr><td><strong>å¿«é€ŸåŸå‹</strong></td><td>Parcel</td><td>é›¶é…ç½®ã€å¼€ç®±å³ç”¨</td></tr>
<tr><td><strong>æ€§èƒ½æ•æ„Ÿé¡¹ç›®</strong></td><td>esbuild/SWC</td><td>æ„å»ºé€Ÿåº¦æå¿«</td></tr>
<tr><td><strong>å…¨æ ˆåº”ç”¨</strong></td><td>Bun</td><td>è¿è¡Œæ—¶+æ‰“åŒ…å™¨ä¸€ä½“åŒ–</td></tr>
</tbody>
</table>
</div>
<h4 id="4-ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿåº¦-"><a class="header" href="#4-ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿåº¦-">4. <strong>ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿåº¦</strong> ğŸŒ</a></h4>
<p><strong>ç”Ÿæ€ç³»ç»Ÿæ’å</strong>ï¼š</p>
<ol>
<li><strong>Webpack</strong> - æ’ä»¶ä¸°å¯Œã€ç¤¾åŒºåºå¤§ã€æ–‡æ¡£å®Œå–„</li>
<li><strong>Rollup</strong> - æ’ä»¶è´¨é‡é«˜ã€ä¸“ä¸šåŒ–å·¥å…·</li>
<li><strong>Vite</strong> - å¿«é€Ÿå¢é•¿ã€Vueç”Ÿæ€æ”¯æŒå¼º</li>
<li><strong>Parcel</strong> - æ’ä»¶è¾ƒå°‘ä½†æ ¸å¿ƒåŠŸèƒ½å¼º</li>
<li><strong>æ–°ä¸€ä»£å·¥å…·</strong> - ç”Ÿæ€æ­£åœ¨å»ºè®¾ä¸­</li>
</ol>
<h3 id="æŠ€æœ¯æ¶æ„å·®å¼‚"><a class="header" href="#æŠ€æœ¯æ¶æ„å·®å¼‚">æŠ€æœ¯æ¶æ„å·®å¼‚</a></h3>
<h4 id="ä¼ ç»Ÿæ¶æ„-vs-ç°ä»£æ¶æ„"><a class="header" href="#ä¼ ç»Ÿæ¶æ„-vs-ç°ä»£æ¶æ„">ä¼ ç»Ÿæ¶æ„ vs ç°ä»£æ¶æ„</a></h4>
<p><strong>ä¼ ç»Ÿå·¥å…· (Webpack/Rollup)</strong>ï¼š</p>
<ul>
<li>JavaScriptç¼–å†™ï¼Œå•çº¿ç¨‹ä¸ºä¸»</li>
<li>é…ç½®é©±åŠ¨ï¼Œæ’ä»¶ç³»ç»Ÿå¤æ‚</li>
<li>æˆç†Ÿç¨³å®šï¼ŒåŠŸèƒ½å…¨é¢</li>
</ul>
<p><strong>ç°ä»£å·¥å…· (esbuild/SWC/Bun)</strong>ï¼š</p>
<ul>
<li>ç³»ç»Ÿçº§è¯­è¨€ç¼–å†™ï¼ˆGo/Rustï¼‰</li>
<li>å¹¶è¡Œå¤„ç†ï¼Œæ€§èƒ½ä¼˜å…ˆ</li>
<li>ç®€åŒ–é…ç½®ï¼Œå¼€ç®±å³ç”¨</li>
</ul>
<p><strong>æ··åˆæ¶æ„ (Vite)</strong>ï¼š</p>
<ul>
<li>å¼€å‘æ—¶ä½¿ç”¨åŸç”ŸESM + esbuild</li>
<li>ç”Ÿäº§æ—¶ä½¿ç”¨Rollupä¼˜åŒ–</li>
<li>å…¼é¡¾é€Ÿåº¦å’ŒåŠŸèƒ½</li>
</ul>
<h2 id="æ€»ç»“-15"><a class="header" href="#æ€»ç»“-15">æ€»ç»“</a></h2>
<p>ç°ä»£æ‰“åŒ…å·¥å…·å·²ç»ä»ç®€å•çš„æ–‡ä»¶åˆå¹¶å‘å±•ä¸ºå¤æ‚çš„æ„å»ºç³»ç»Ÿï¼Œå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<h3 id="-æ ¸å¿ƒåŠŸèƒ½"><a class="header" href="#-æ ¸å¿ƒåŠŸèƒ½">ğŸ”§ æ ¸å¿ƒåŠŸèƒ½</a></h3>
<ul>
<li><strong>æ¨¡å—è§£æ</strong>: æ”¯æŒå¤šç§æ¨¡å—æ ¼å¼</li>
<li><strong>ä¾èµ–åˆ†æ</strong>: æ„å»ºå®Œæ•´ä¾èµ–å›¾</li>
<li><strong>ä»£ç è½¬æ¢</strong>: Loader/Pluginç”Ÿæ€</li>
<li><strong>ä»£ç ä¼˜åŒ–</strong>: Tree Shakingã€å‹ç¼©ç­‰</li>
<li><strong>ä»£ç åˆ†å‰²</strong>: æ™ºèƒ½chunkåˆ†å‰²ç­–ç•¥</li>
</ul>
<h3 id="-æ€§èƒ½ä¼˜åŒ–"><a class="header" href="#-æ€§èƒ½ä¼˜åŒ–">âš¡ æ€§èƒ½ä¼˜åŒ–</a></h3>
<ul>
<li><strong>å¢é‡æ„å»º</strong>: åªé‡å»ºå˜æ›´éƒ¨åˆ†</li>
<li><strong>å¹¶è¡Œå¤„ç†</strong>: å¤šæ ¸å¿ƒå¹¶è¡Œç¼–è¯‘</li>
<li><strong>ç¼“å­˜æœºåˆ¶</strong>: æŒä¹…åŒ–ç¼“å­˜åŠ é€Ÿ</li>
<li><strong>æµå¼å¤„ç†</strong>: è¾¹å¤„ç†è¾¹è¾“å‡º</li>
</ul>
<h3 id="-å‘å±•è¶‹åŠ¿"><a class="header" href="#-å‘å±•è¶‹åŠ¿">ğŸ¯ å‘å±•è¶‹åŠ¿</a></h3>
<ul>
<li><strong>åŸç”Ÿè¯­è¨€é‡å†™</strong>: Rust/Goæå‡æ€§èƒ½</li>
<li><strong>é›¶é…ç½®</strong>: å¼€ç®±å³ç”¨çš„å¼€å‘ä½“éªŒ</li>
<li><strong>åŸç”ŸESM</strong>: æ‹¥æŠ±ç°ä»£Webæ ‡å‡†</li>
<li><strong>å¼€å‘ä½“éªŒ</strong>: æ›´å¿«çš„HMRå’Œæ›´å¥½çš„é”™è¯¯æç¤º</li>
</ul>
<p>é€‰æ‹©åˆé€‚çš„æ‰“åŒ…å·¥å…·éœ€è¦è€ƒè™‘é¡¹ç›®è§„æ¨¡ã€å›¢é˜ŸæŠ€èƒ½æ ˆã€æ€§èƒ½è¦æ±‚å’Œç”Ÿæ€ç³»ç»Ÿç­‰å› ç´ ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="tooling/webpack.html">Webpackæ¨¡å—å¤„ç†</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="è½¬è¯‘å·¥å…·-1"><a class="header" href="#è½¬è¯‘å·¥å…·-1">è½¬è¯‘å·¥å…·</a></h1>
<p>è½¬è¯‘å·¥å…·æ˜¯ç°ä»£JavaScriptå¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„ç»„æˆéƒ¨åˆ†ï¼Œå®ƒä»¬å°†ä½¿ç”¨æ–°è¯­æ³•ã€æ–°ç‰¹æ€§æˆ–å…¶ä»–è¯­è¨€ç¼–å†™çš„ä»£ç è½¬æ¢ä¸ºæµè§ˆå™¨å’Œè¿è¡Œç¯å¢ƒèƒ½å¤Ÿç†è§£çš„JavaScriptä»£ç ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨ä¸»è¦çš„è½¬è¯‘å·¥å…·åŠå…¶åœ¨æ¨¡å—åŒ–å¼€å‘ä¸­çš„ä½œç”¨ã€‚</p>
<h2 id="è½¬è¯‘çš„æ ¸å¿ƒæ¦‚å¿µ"><a class="header" href="#è½¬è¯‘çš„æ ¸å¿ƒæ¦‚å¿µ">è½¬è¯‘çš„æ ¸å¿ƒæ¦‚å¿µ</a></h2>
<h3 id="ä»€ä¹ˆæ˜¯è½¬è¯‘"><a class="header" href="#ä»€ä¹ˆæ˜¯è½¬è¯‘">ä»€ä¹ˆæ˜¯è½¬è¯‘</a></h3>
<p>è½¬è¯‘(Transpilation)æ˜¯æºåˆ°æºçš„ç¼–è¯‘è¿‡ç¨‹ï¼Œå°†ä¸€ç§è¯­è¨€çš„ä»£ç è½¬æ¢ä¸ºå¦ä¸€ç§è¯­è¨€çš„ç­‰ä»·ä»£ç ï¼š</p>
<pre><code class="language-javascript">// è¾“å…¥ï¼šES2020+ç‰¹æ€§
const data = await fetch('/api/data').then(res =&gt; res.json());
const filtered = data?.items?.filter(item =&gt; item.active) ?? [];

// è¾“å‡ºï¼šES5å…¼å®¹ä»£ç 
var data = fetch('/api/data').then(function(res) { return res.json(); });
var _data$items;
var filtered = (_data$items = data === null || data === void 0 ? void 0 : data.items) === null || _data$items === void 0 ? void 0 : _data$items.filter(function(item) {
  return item.active;
});
if (filtered === null || filtered === void 0) {
  filtered = [];
}
</code></pre>
<h3 id="è½¬è¯‘å™¨çš„ä½œç”¨åŸŸ"><a class="header" href="#è½¬è¯‘å™¨çš„ä½œç”¨åŸŸ">è½¬è¯‘å™¨çš„ä½œç”¨åŸŸ</a></h3>
<p>ç°ä»£è½¬è¯‘å™¨å¤„ç†å¤šç§è½¬æ¢ä»»åŠ¡ï¼š</p>
<pre><code class="language-javascript">// è¯­æ³•è½¬æ¢ç¤ºä¾‹
const transpilerTasks = {
  // 1. è¯­æ³•é™çº§
  syntaxDowngrade: {
    input: 'const { a, ...rest } = obj;',
    output: 'var a = obj.a; var rest = _objectWithoutProperties(obj, ["a"]);'
  },
  
  // 2. æ¨¡å—æ ¼å¼è½¬æ¢
  moduleFormat: {
    input: 'import { utils } from "./utils";',
    output: 'var utils = require("./utils").utils;'
  },
  
  // 3. JSXè½¬æ¢
  jsxTransform: {
    input: '&lt;div className="container"&gt;{content}&lt;/div&gt;',
    output: 'React.createElement("div", { className: "container" }, content)'
  },
  
  // 4. TypeScriptç±»å‹æ“¦é™¤
  typeErasure: {
    input: 'function add(a: number, b: number): number { return a + b; }',
    output: 'function add(a, b) { return a + b; }'
  }
};
</code></pre>
<h2 id="æŠ½è±¡è¯­æ³•æ ‘astå¤„ç†"><a class="header" href="#æŠ½è±¡è¯­æ³•æ ‘astå¤„ç†">æŠ½è±¡è¯­æ³•æ ‘(AST)å¤„ç†</a></h2>
<h3 id="aståŸºç¡€æ¦‚å¿µ"><a class="header" href="#aståŸºç¡€æ¦‚å¿µ">ASTåŸºç¡€æ¦‚å¿µ</a></h3>
<p>è½¬è¯‘å™¨é€šè¿‡ASTè¿›è¡Œä»£ç åˆ†æå’Œè½¬æ¢ï¼š</p>
<pre><code class="language-javascript">// ç®€åŒ–çš„ASTç»“æ„ç¤ºä¾‹
const astExample = {
  type: 'Program',
  body: [
    {
      type: 'ImportDeclaration',
      specifiers: [
        {
          type: 'ImportDefaultSpecifier',
          local: { type: 'Identifier', name: 'React' }
        }
      ],
      source: { type: 'Literal', value: 'react' }
    },
    {
      type: 'FunctionDeclaration',
      id: { type: 'Identifier', name: 'Component' },
      params: [],
      body: {
        type: 'BlockStatement',
        body: [
          {
            type: 'ReturnStatement',
            argument: {
              type: 'JSXElement',
              openingElement: {
                type: 'JSXOpeningElement',
                name: { type: 'JSXIdentifier', name: 'div' }
              }
            }
          }
        ]
      }
    }
  ]
};
</code></pre>
<h3 id="astéå†å’Œè½¬æ¢"><a class="header" href="#astéå†å’Œè½¬æ¢">ASTéå†å’Œè½¬æ¢</a></h3>
<pre><code class="language-javascript">// ASTè®¿é—®è€…æ¨¡å¼å®ç°
class ASTVisitor {
  constructor() {
    this.visitors = {};
  }
  
  // æ³¨å†Œè®¿é—®è€…
  register(nodeType, visitor) {
    this.visitors[nodeType] = visitor;
  }
  
  // éå†AST
  traverse(node, parent = null) {
    // è¿›å…¥èŠ‚ç‚¹
    if (this.visitors[node.type]?.enter) {
      this.visitors[node.type].enter(node, parent);
    }
    
    // é€’å½’è®¿é—®å­èŠ‚ç‚¹
    for (const key in node) {
      const child = node[key];
      if (Array.isArray(child)) {
        child.forEach(item =&gt; {
          if (this.isNode(item)) {
            this.traverse(item, node);
          }
        });
      } else if (this.isNode(child)) {
        this.traverse(child, node);
      }
    }
    
    // é€€å‡ºèŠ‚ç‚¹
    if (this.visitors[node.type]?.exit) {
      this.visitors[node.type].exit(node, parent);
    }
  }
  
  isNode(obj) {
    return obj &amp;&amp; typeof obj === 'object' &amp;&amp; obj.type;
  }
}

// ä½¿ç”¨ç¤ºä¾‹ï¼šå°†ç®­å¤´å‡½æ•°è½¬æ¢ä¸ºæ™®é€šå‡½æ•°
const arrowFunctionTransformer = new ASTVisitor();

arrowFunctionTransformer.register('ArrowFunctionExpression', {
  enter(node, parent) {
    // è½¬æ¢ç®­å¤´å‡½æ•°ä¸ºæ™®é€šå‡½æ•°
    node.type = 'FunctionExpression';
    
    // å¤„ç†éšå¼è¿”å›
    if (node.body.type !== 'BlockStatement') {
      node.body = {
        type: 'BlockStatement',
        body: [
          {
            type: 'ReturnStatement',
            argument: node.body
          }
        ]
      };
    }
  }
});
</code></pre>
<h2 id="æ’ä»¶å’Œé¢„è®¾ç³»ç»Ÿ"><a class="header" href="#æ’ä»¶å’Œé¢„è®¾ç³»ç»Ÿ">æ’ä»¶å’Œé¢„è®¾ç³»ç»Ÿ</a></h2>
<h3 id="æ’ä»¶æ¶æ„"><a class="header" href="#æ’ä»¶æ¶æ„">æ’ä»¶æ¶æ„</a></h3>
<p>ç°ä»£è½¬è¯‘å™¨é‡‡ç”¨æ’ä»¶åŒ–æ¶æ„ï¼Œä¾¿äºæ‰©å±•å’Œå®šåˆ¶ï¼š</p>
<pre><code class="language-javascript">// ç®€åŒ–çš„æ’ä»¶ç³»ç»Ÿå®ç°
class TranspilerCore {
  constructor() {
    this.plugins = [];
    this.presets = [];
  }
  
  use(plugin, options = {}) {
    if (typeof plugin === 'function') {
      this.plugins.push(plugin(options));
    } else {
      this.plugins.push(plugin);
    }
    return this;
  }
  
  preset(preset) {
    this.presets.push(preset);
    return this;
  }
  
  transform(code, filename) {
    // 1. è§£æä»£ç ä¸ºAST
    let ast = this.parse(code, filename);
    
    // 2. åº”ç”¨é¢„è®¾
    this.presets.forEach(preset =&gt; {
      preset.plugins.forEach(plugin =&gt; {
        ast = plugin.transform(ast);
      });
    });
    
    // 3. åº”ç”¨æ’ä»¶
    this.plugins.forEach(plugin =&gt; {
      ast = plugin.transform(ast);
    });
    
    // 4. ç”Ÿæˆä»£ç 
    return this.generate(ast);
  }
}

// æ’ä»¶ç¤ºä¾‹ï¼šæ¨¡å—å¯¼å…¥è½¬æ¢
function importTransformPlugin(options = {}) {
  return {
    name: 'import-transform',
    transform(ast) {
      const visitor = new ASTVisitor();
      
      visitor.register('ImportDeclaration', {
        enter(node) {
          if (options.format === 'cjs') {
            // è½¬æ¢ä¸ºCommonJS require
            this.convertToRequire(node);
          }
        }
      });
      
      visitor.traverse(ast);
      return ast;
    }
  };
}
</code></pre>
<h3 id="é¢„è®¾é…ç½®"><a class="header" href="#é¢„è®¾é…ç½®">é¢„è®¾é…ç½®</a></h3>
<p>é¢„è®¾æ˜¯æ’ä»¶çš„é›†åˆï¼Œæä¾›äº†å¼€ç®±å³ç”¨çš„é…ç½®ï¼š</p>
<pre><code class="language-javascript">// ç¯å¢ƒé¢„è®¾ç¤ºä¾‹
const envPreset = {
  name: '@transpiler/preset-env',
  plugins: [
    ['@transpiler/plugin-arrow-functions'],
    ['@transpiler/plugin-destructuring'],
    ['@transpiler/plugin-async-to-generator'],
    ['@transpiler/plugin-optional-chaining']
  ],
  
  // æ ¹æ®ç›®æ ‡ç¯å¢ƒåŠ¨æ€è°ƒæ•´
  getPlugins(targets) {
    const plugins = [];
    
    if (!this.supportsArrowFunctions(targets)) {
      plugins.push('@transpiler/plugin-arrow-functions');
    }
    
    if (!this.supportsOptionalChaining(targets)) {
      plugins.push('@transpiler/plugin-optional-chaining');
    }
    
    return plugins;
  }
};

// Reacté¢„è®¾ç¤ºä¾‹
const reactPreset = {
  name: '@transpiler/preset-react',
  plugins: [
    '@transpiler/plugin-jsx',
    '@transpiler/plugin-react-display-name',
    '@transpiler/plugin-react-pure-annotations'
  ],
  
  options: {
    runtime: 'automatic', // æˆ– 'classic'
    development: process.env.NODE_ENV === 'development'
  }
};
</code></pre>
<h2 id="æ¨¡å—æ ¼å¼è½¬æ¢"><a class="header" href="#æ¨¡å—æ ¼å¼è½¬æ¢">æ¨¡å—æ ¼å¼è½¬æ¢</a></h2>
<h3 id="esæ¨¡å—åˆ°commonjs"><a class="header" href="#esæ¨¡å—åˆ°commonjs">ESæ¨¡å—åˆ°CommonJS</a></h3>
<pre><code class="language-javascript">// ESæ¨¡å—è½¬æ¢æ’ä»¶å®ç°
function esModuleToCjsPlugin() {
  return {
    name: 'esm-to-cjs',
    
    ImportDeclaration(path) {
      const { node } = path;
      const source = node.source.value;
      
      if (node.specifiers.length === 0) {
        // import './side-effect'
        path.replaceWith(
          t.expressionStatement(
            t.callExpression(t.identifier('require'), [t.stringLiteral(source)])
          )
        );
      } else {
        // import { a, b } from 'module'
        const declarations = [];
        
        node.specifiers.forEach(spec =&gt; {
          if (t.isImportDefaultSpecifier(spec)) {
            // import defaultExport from 'module'
            declarations.push(
              t.variableDeclarator(
                spec.local,
                t.memberExpression(
                  t.callExpression(t.identifier('require'), [t.stringLiteral(source)]),
                  t.identifier('default')
                )
              )
            );
          } else if (t.isImportSpecifier(spec)) {
            // import { namedExport } from 'module'
            declarations.push(
              t.variableDeclarator(
                spec.local,
                t.memberExpression(
                  t.callExpression(t.identifier('require'), [t.stringLiteral(source)]),
                  spec.imported
                )
              )
            );
          }
        });
        
        path.replaceWith(t.variableDeclaration('const', declarations));
      }
    },
    
    ExportDeclaration(path) {
      const { node } = path;
      
      if (t.isExportDefaultDeclaration(node)) {
        // export default value
        path.replaceWith(
          t.expressionStatement(
            t.assignmentExpression(
              '=',
              t.memberExpression(t.identifier('module'), t.identifier('exports')),
              node.declaration
            )
          )
        );
      } else if (t.isExportNamedDeclaration(node)) {
        // export { a, b }
        const assignments = [];
        
        node.specifiers.forEach(spec =&gt; {
          assignments.push(
            t.expressionStatement(
              t.assignmentExpression(
                '=',
                t.memberExpression(
                  t.memberExpression(t.identifier('module'), t.identifier('exports')),
                  spec.exported
                ),
                spec.local
              )
            )
          );
        });
        
        path.replaceWithMultiple(assignments);
      }
    }
  };
}
</code></pre>
<h3 id="åŠ¨æ€å¯¼å…¥è½¬æ¢"><a class="header" href="#åŠ¨æ€å¯¼å…¥è½¬æ¢">åŠ¨æ€å¯¼å…¥è½¬æ¢</a></h3>
<pre><code class="language-javascript">// åŠ¨æ€å¯¼å…¥è½¬æ¢
function dynamicImportPlugin() {
  return {
    name: 'dynamic-import',
    
    CallExpression(path) {
      if (path.node.callee.type === 'Import') {
        // import() -&gt; Promise.resolve(require())
        const requireCall = t.callExpression(
          t.identifier('require'),
          path.node.arguments
        );
        
        path.replaceWith(
          t.callExpression(
            t.memberExpression(t.identifier('Promise'), t.identifier('resolve')),
            [requireCall]
          )
        );
      }
    }
  };
}
</code></pre>
<h2 id="ä»£ç ç”Ÿæˆå’Œæºæ˜ å°„"><a class="header" href="#ä»£ç ç”Ÿæˆå’Œæºæ˜ å°„">ä»£ç ç”Ÿæˆå’Œæºæ˜ å°„</a></h2>
<h3 id="æºæ˜ å°„ç”Ÿæˆ"><a class="header" href="#æºæ˜ å°„ç”Ÿæˆ">æºæ˜ å°„ç”Ÿæˆ</a></h3>
<pre><code class="language-javascript">// æºæ˜ å°„ç”Ÿæˆå™¨
class SourceMapGenerator {
  constructor(filename) {
    this.filename = filename;
    this.mappings = [];
    this.sources = [filename];
  }
  
  addMapping(generated, original, source = 0) {
    this.mappings.push({
      generated: { line: generated.line, column: generated.column },
      original: { line: original.line, column: original.column },
      source
    });
  }
  
  generate() {
    return {
      version: 3,
      file: this.filename,
      sources: this.sources,
      mappings: this.encodeMappings(),
      sourcesContent: this.getSourcesContent()
    };
  }
  
  encodeMappings() {
    // VLQç¼–ç å®ç°
    return vlqEncode(this.mappings);
  }
}

// ä»£ç ç”Ÿæˆå™¨
class CodeGenerator {
  constructor(ast, options = {}) {
    this.ast = ast;
    this.options = options;
    this.sourceMap = options.sourceMaps ? new SourceMapGenerator(options.filename) : null;
  }
  
  generate() {
    const result = {
      code: '',
      map: null
    };
    
    // éå†ASTç”Ÿæˆä»£ç 
    this.traverse(this.ast, (code, node) =&gt; {
      result.code += code;
      
      // è®°å½•æºæ˜ å°„
      if (this.sourceMap &amp;&amp; node.loc) {
        this.sourceMap.addMapping(
          this.getCurrentPosition(),
          node.loc.start
        );
      }
    });
    
    if (this.sourceMap) {
      result.map = this.sourceMap.generate();
    }
    
    return result;
  }
}
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-1"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-1">æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</a></h2>
<h3 id="ç¼“å­˜æœºåˆ¶"><a class="header" href="#ç¼“å­˜æœºåˆ¶">ç¼“å­˜æœºåˆ¶</a></h3>
<pre><code class="language-javascript">// è½¬è¯‘ç¼“å­˜å®ç°
class TranspilerCache {
  constructor() {
    this.cache = new Map();
    this.dependencyGraph = new Map();
  }
  
  getCacheKey(filename, code, options) {
    const optionsHash = this.hashObject(options);
    const codeHash = this.hashString(code);
    return `${filename}:${codeHash}:${optionsHash}`;
  }
  
  get(filename, code, options) {
    const key = this.getCacheKey(filename, code, options);
    const cached = this.cache.get(key);
    
    if (cached &amp;&amp; this.isCacheValid(filename, cached.timestamp)) {
      return cached.result;
    }
    
    return null;
  }
  
  set(filename, code, options, result) {
    const key = this.getCacheKey(filename, code, options);
    this.cache.set(key, {
      result,
      timestamp: Date.now(),
      dependencies: this.extractDependencies(result.ast)
    });
  }
  
  isCacheValid(filename, timestamp) {
    // æ£€æŸ¥æ–‡ä»¶å’Œä¾èµ–æ˜¯å¦æœ‰å˜æ›´
    const stats = fs.statSync(filename);
    if (stats.mtime.getTime() &gt; timestamp) {
      return false;
    }
    
    // æ£€æŸ¥ä¾èµ–æ–‡ä»¶
    const deps = this.dependencyGraph.get(filename) || [];
    return deps.every(dep =&gt; {
      const depStats = fs.statSync(dep);
      return depStats.mtime.getTime() &lt;= timestamp;
    });
  }
}
</code></pre>
<h3 id="å¢é‡ç¼–è¯‘"><a class="header" href="#å¢é‡ç¼–è¯‘">å¢é‡ç¼–è¯‘</a></h3>
<pre><code class="language-javascript">// å¢é‡ç¼–è¯‘ç®¡ç†å™¨
class IncrementalCompiler {
  constructor() {
    this.fileGraph = new Map();
    this.lastBuildTime = 0;
  }
  
  compile(files, options) {
    const changedFiles = this.getChangedFiles(files);
    const affectedFiles = this.getAffectedFiles(changedFiles);
    
    // åªç¼–è¯‘å—å½±å“çš„æ–‡ä»¶
    const results = new Map();
    
    affectedFiles.forEach(file =&gt; {
      const result = this.transpiler.transform(file, options);
      results.set(file, result);
      
      // æ›´æ–°ä¾èµ–å›¾
      this.updateDependencyGraph(file, result.dependencies);
    });
    
    this.lastBuildTime = Date.now();
    return results;
  }
  
  getChangedFiles(files) {
    return files.filter(file =&gt; {
      const stats = fs.statSync(file);
      return stats.mtime.getTime() &gt; this.lastBuildTime;
    });
  }
  
  getAffectedFiles(changedFiles) {
    const affected = new Set(changedFiles);
    
    // é€’å½’æ‰¾å‡ºæ‰€æœ‰å—å½±å“çš„æ–‡ä»¶
    function addDependents(file) {
      const dependents = this.fileGraph.get(file)?.dependents || [];
      dependents.forEach(dependent =&gt; {
        if (!affected.has(dependent)) {
          affected.add(dependent);
          addDependents(dependent);
        }
      });
    }
    
    changedFiles.forEach(file =&gt; addDependents(file));
    return Array.from(affected);
  }
}
</code></pre>
<h2 id="æœ€ä½³å®è·µ-3"><a class="header" href="#æœ€ä½³å®è·µ-3">æœ€ä½³å®è·µ</a></h2>
<h3 id="é…ç½®ä¼˜åŒ–"><a class="header" href="#é…ç½®ä¼˜åŒ–">é…ç½®ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// ç”Ÿäº§ç¯å¢ƒé…ç½®
const productionConfig = {
  presets: [
    ['@transpiler/preset-env', {
      targets: '&gt; 1%, not dead',
      modules: false,
      useBuiltIns: 'usage',
      corejs: 3
    }]
  ],
  plugins: [
    ['@transpiler/plugin-transform-runtime', {
      regenerator: false,
      useESModules: true
    }]
  ],
  
  // ä¼˜åŒ–é€‰é¡¹
  compact: true,
  minified: true,
  sourceMaps: false
};

// å¼€å‘ç¯å¢ƒé…ç½®
const developmentConfig = {
  presets: [
    ['@transpiler/preset-env', {
      targets: { node: 'current' },
      modules: 'auto'
    }],
    '@transpiler/preset-react'
  ],
  
  // å¼€å‘ä¼˜åŒ–
  sourceMaps: 'inline',
  retainLines: true,
  
  // å¿«é€Ÿè½¬æ¢
  compact: false,
  comments: true
};
</code></pre>
<h3 id="é¡¹ç›®é›†æˆ"><a class="header" href="#é¡¹ç›®é›†æˆ">é¡¹ç›®é›†æˆ</a></h3>
<pre><code class="language-javascript">// æ„å»ºå·¥å…·é›†æˆ
module.exports = {
  module: {
    rules: [
      {
        test: /\.(js|jsx|ts|tsx)$/,
        exclude: /node_modules/,
        use: {
          loader: 'transpiler-loader',
          options: {
            configFile: './transpiler.config.js',
            cacheDirectory: true,
            cacheCompression: false
          }
        }
      }
    ]
  }
};
</code></pre>
<p>è½¬è¯‘å·¥å…·ä½œä¸ºç°ä»£JavaScriptå¼€å‘çš„åŸºç¡€è®¾æ–½ï¼Œä¸ä»…è§£å†³äº†æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œè¿˜ä¸ºå¼€å‘è€…æä¾›äº†ä½¿ç”¨æœ€æ–°è¯­è¨€ç‰¹æ€§çš„èƒ½åŠ›ã€‚ç†è§£è½¬è¯‘å·¥å…·çš„å·¥ä½œåŸç†å’Œæœ€ä½³å®è·µï¼Œå¯¹äºæ„å»ºé«˜æ•ˆçš„å¼€å‘å·¥ä½œæµè‡³å…³é‡è¦ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#babelæ¨¡å—è½¬æ¢">Babelæ¨¡å—è½¬æ¢</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="babelæ¨¡å—è½¬æ¢"><a class="header" href="#babelæ¨¡å—è½¬æ¢">Babelæ¨¡å—è½¬æ¢</a></h1>
<p>Babelæ˜¯JavaScriptç”Ÿæ€ç³»ç»Ÿä¸­æœ€é‡è¦çš„è½¬è¯‘å·¥å…·ä¹‹ä¸€ï¼Œå®ƒä½¿å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨æœ€æ–°çš„JavaScriptç‰¹æ€§ï¼ŒåŒæ—¶ä¿æŒä¸æ—§ç‰ˆæµè§ˆå™¨çš„å…¼å®¹æ€§ã€‚åœ¨æ¨¡å—åŒ–å¼€å‘ä¸­ï¼ŒBabelæ‰®æ¼”ç€å°†ç°ä»£æ¨¡å—è¯­æ³•è½¬æ¢ä¸ºå„ç§ç›®æ ‡æ ¼å¼çš„å…³é”®è§’è‰²ã€‚</p>
<h2 id="babelæ ¸å¿ƒæ¶æ„"><a class="header" href="#babelæ ¸å¿ƒæ¶æ„">Babelæ ¸å¿ƒæ¶æ„</a></h2>
<h3 id="è½¬æ¢æµç¨‹"><a class="header" href="#è½¬æ¢æµç¨‹">è½¬æ¢æµç¨‹</a></h3>
<p>Babelçš„è½¬æ¢è¿‡ç¨‹åŒ…å«ä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š</p>
<pre><code class="language-javascript">// Babelè½¬æ¢æµç¨‹ç¤ºä¾‹
const babel = require('@babel/core');

// 1. è§£æé˜¶æ®µ (Parse)
const ast = babel.parseSync(code, {
  sourceType: 'module',
  plugins: ['jsx', 'typescript']
});

// 2. è½¬æ¢é˜¶æ®µ (Transform)  
const transformedAst = babel.transformFromAstSync(ast, code, {
  plugins: [
    '@babel/plugin-transform-arrow-functions',
    '@babel/plugin-transform-modules-commonjs'
  ]
});

// 3. ç”Ÿæˆé˜¶æ®µ (Generate)
const result = babel.generateSync(transformedAst.ast, {
  sourceMaps: true,
  compact: false
});

console.log(result.code);
</code></pre>
<h3 id="æ’ä»¶ç³»ç»Ÿæ¶æ„"><a class="header" href="#æ’ä»¶ç³»ç»Ÿæ¶æ„">æ’ä»¶ç³»ç»Ÿæ¶æ„</a></h3>
<p>Babelé‡‡ç”¨è®¿é—®è€…æ¨¡å¼å®ç°æ’ä»¶ç³»ç»Ÿï¼š</p>
<pre><code class="language-javascript">// ç®€åŒ–çš„Babelæ’ä»¶ç»“æ„
function babelPlugin() {
  return {
    name: 'my-babel-plugin',
    
    // æ’ä»¶åˆå§‹åŒ–
    pre() {
      this.imports = new Set();
    },
    
    // ASTè®¿é—®è€…
    visitor: {
      // å¤„ç†å¯¼å…¥å£°æ˜
      ImportDeclaration(path, state) {
        const source = path.node.source.value;
        this.imports.add(source);
        
        // è®°å½•æ¨¡å—ä¾èµ–
        state.dependencies = state.dependencies || [];
        state.dependencies.push(source);
      },
      
      // å¤„ç†å¯¼å‡ºå£°æ˜
      ExportDeclaration(path) {
        if (path.isExportDefaultDeclaration()) {
          // å¤„ç†é»˜è®¤å¯¼å‡º
          this.handleDefaultExport(path);
        } else if (path.isExportNamedDeclaration()) {
          // å¤„ç†å‘½åå¯¼å‡º
          this.handleNamedExport(path);
        }
      },
      
      // å¤„ç†å‡½æ•°è°ƒç”¨
      CallExpression(path) {
        if (this.isDynamicImport(path)) {
          // è½¬æ¢åŠ¨æ€å¯¼å…¥
          this.transformDynamicImport(path);
        }
      }
    },
    
    // æ’ä»¶æ¸…ç†
    post() {
      console.log('å¤„ç†çš„æ¨¡å—æ•°é‡:', this.imports.size);
    }
  };
}
</code></pre>
<h2 id="æ¨¡å—è½¬æ¢æ’ä»¶"><a class="header" href="#æ¨¡å—è½¬æ¢æ’ä»¶">æ¨¡å—è½¬æ¢æ’ä»¶</a></h2>
<h3 id="esæ¨¡å—åˆ°commonjs-1"><a class="header" href="#esæ¨¡å—åˆ°commonjs-1">ESæ¨¡å—åˆ°CommonJS</a></h3>
<p><code>@babel/plugin-transform-modules-commonjs</code>æ˜¯æœ€å¸¸ç”¨çš„æ¨¡å—è½¬æ¢æ’ä»¶ï¼š</p>
<pre><code class="language-javascript">// æ’ä»¶é…ç½®
module.exports = {
  plugins: [
    ['@babel/plugin-transform-modules-commonjs', {
      // ä¸¥æ ¼æ¨¡å¼
      strict: true,
      
      // æ‡’åŠ è½½
      lazy: false,
      
      // ä¸å…è®¸é¡¶å±‚this
      noInterop: false,
      
      // ä¿ç•™import.meta
      importInterop: 'babel',
      
      // è‡ªå®šä¹‰æ¨¡å—ID
      getModuleId: (moduleName) =&gt; moduleName
    }]
  ]
};

// è½¬æ¢ç¤ºä¾‹
// è¾“å…¥ï¼šESæ¨¡å—
import defaultExport, { namedExport } from 'module';
import * as namespace from 'module';
export { localVar as exportName };
export default function() {}

// è¾“å‡ºï¼šCommonJS
var _module = require('module');
var _module2 = _interopRequireDefault(_module);
var namespace = _interopRequireWildcard(_module);

function _interopRequireDefault(obj) {
  return obj &amp;&amp; obj.__esModule ? obj : { default: obj };
}

function _interopRequireWildcard(obj) {
  if (obj &amp;&amp; obj.__esModule) return obj;
  var newObj = {};
  if (obj != null) {
    for (var key in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, key)) {
        newObj[key] = obj[key];
      }
    }
  }
  newObj.default = obj;
  return newObj;
}

exports.exportName = localVar;
exports.default = function() {};
</code></pre>
<h3 id="åŠ¨æ€å¯¼å…¥è½¬æ¢-1"><a class="header" href="#åŠ¨æ€å¯¼å…¥è½¬æ¢-1">åŠ¨æ€å¯¼å…¥è½¬æ¢</a></h3>
<p>å¤„ç†<code>import()</code>è¯­æ³•çš„è½¬æ¢ï¼š</p>
<pre><code class="language-javascript">// åŠ¨æ€å¯¼å…¥æ’ä»¶å®ç°
function dynamicImportPlugin() {
  return {
    name: 'dynamic-import-transform',
    visitor: {
      CallExpression(path) {
        if (path.node.callee.type === 'Import') {
          const modulePath = path.node.arguments[0];
          
          // è½¬æ¢ä¸ºPromise.resolve(require())
          path.replaceWith(
            t.callExpression(
              t.memberExpression(
                t.identifier('Promise'),
                t.identifier('resolve')
              ),
              [
                t.callExpression(
                  t.identifier('require'),
                  [modulePath]
                )
              ]
            )
          );
        }
      }
    }
  };
}

// ä½¿ç”¨ç¤ºä¾‹
// è¾“å…¥
const module = await import('./module.js');

// è¾“å‡º
const module = await Promise.resolve(require('./module.js'));
</code></pre>
<h3 id="æ¨¡å—è·¯å¾„è½¬æ¢"><a class="header" href="#æ¨¡å—è·¯å¾„è½¬æ¢">æ¨¡å—è·¯å¾„è½¬æ¢</a></h3>
<p>è‡ªå®šä¹‰æ¨¡å—è·¯å¾„è§£æï¼š</p>
<pre><code class="language-javascript">// è·¯å¾„è½¬æ¢æ’ä»¶
function modulePathTransform(options = {}) {
  const { alias = {}, baseUrl = '' } = options;
  
  return {
    name: 'module-path-transform',
    visitor: {
      ImportDeclaration(path) {
        this.transformPath(path.node.source);
      },
      
      CallExpression(path) {
        if (this.isDynamicImport(path)) {
          this.transformPath(path.node.arguments[0]);
        } else if (this.isRequireCall(path)) {
          this.transformPath(path.node.arguments[0]);
        }
      }
    },
    
    transformPath(sourceNode) {
      const originalPath = sourceNode.value;
      
      // å¤„ç†åˆ«å
      for (const [aliasKey, aliasValue] of Object.entries(alias)) {
        if (originalPath.startsWith(aliasKey)) {
          sourceNode.value = originalPath.replace(aliasKey, aliasValue);
          return;
        }
      }
      
      // å¤„ç†ç›¸å¯¹è·¯å¾„
      if (originalPath.startsWith('.')) {
        sourceNode.value = path.resolve(baseUrl, originalPath);
      }
    }
  };
}

// é…ç½®ç¤ºä¾‹
{
  plugins: [
    ['module-path-transform', {
      alias: {
        '@': './src',
        'utils': './src/utils'
      },
      baseUrl: process.cwd()
    }]
  ]
}
</code></pre>
<h2 id="é¢„è®¾é…ç½®-1"><a class="header" href="#é¢„è®¾é…ç½®-1">é¢„è®¾é…ç½®</a></h2>
<h3 id="babelpreset-env"><a class="header" href="#babelpreset-env">@babel/preset-env</a></h3>
<p>ç¯å¢ƒé¢„è®¾æ˜¯æœ€é‡è¦çš„é¢„è®¾ä¹‹ä¸€ï¼š</p>
<pre><code class="language-javascript">// è¯¦ç»†çš„preset-envé…ç½®
module.exports = {
  presets: [
    ['@babel/preset-env', {
      // ç›®æ ‡ç¯å¢ƒ
      targets: {
        browsers: ['&gt; 1%', 'last 2 versions', 'not dead'],
        node: '14'
      },
      
      // æ¨¡å—æ ¼å¼
      modules: 'auto', // false, 'amd', 'umd', 'systemjs', 'commonjs', 'cjs'
      
      // polyfillç­–ç•¥
      useBuiltIns: 'usage', // false, 'entry', 'usage'
      corejs: { version: 3, proposals: true },
      
      // åŒ…å«/æ’é™¤ç‰¹å®šè½¬æ¢
      include: ['@babel/plugin-proposal-class-properties'],
      exclude: ['@babel/plugin-transform-typeof-symbol'],
      
      // è°ƒè¯•æ¨¡å¼
      debug: false,
      
      // å¼ºåˆ¶æ‰€æœ‰è½¬æ¢
      forceAllTransforms: false,
      
      // é…ç½®æ–‡ä»¶è·¯å¾„
      configPath: process.cwd(),
      
      // å¿½ç•¥æµè§ˆå™¨é…ç½®
      ignoreBrowserslistConfig: false,
      
      // è¿è¡Œæ—¶ä¼˜åŒ–
      shippedProposals: false,
      
      // è§„èŒƒåˆè§„æ€§
      spec: false,
      loose: false,
      
      // æ¨¡å—è½¬æ¢é€‰é¡¹
      bugfixes: true
    }]
  ]
};
</code></pre>
<h3 id="è‡ªå®šä¹‰é¢„è®¾"><a class="header" href="#è‡ªå®šä¹‰é¢„è®¾">è‡ªå®šä¹‰é¢„è®¾</a></h3>
<p>åˆ›å»ºé¡¹ç›®ç‰¹å®šçš„é¢„è®¾ï¼š</p>
<pre><code class="language-javascript">// custom-preset.js
module.exports = function(api, options = {}) {
  const { isDevelopment = false, isTest = false } = options;
  
  // æ ¹æ®ç¯å¢ƒè°ƒæ•´é…ç½®
  const plugins = [
    '@babel/plugin-proposal-class-properties',
    '@babel/plugin-proposal-object-rest-spread'
  ];
  
  // å¼€å‘ç¯å¢ƒç‰¹æœ‰æ’ä»¶
  if (isDevelopment) {
    plugins.push('@babel/plugin-transform-react-jsx-self');
    plugins.push('@babel/plugin-transform-react-jsx-source');
  }
  
  // æµ‹è¯•ç¯å¢ƒé…ç½®
  if (isTest) {
    plugins.push('babel-plugin-dynamic-import-node');
  }
  
  return {
    presets: [
      ['@babel/preset-env', {
        targets: isDevelopment ? { node: 'current' } : '&gt; 0.25%, not dead',
        modules: isTest ? 'commonjs' : false,
        useBuiltIns: 'usage',
        corejs: 3
      }],
      ['@babel/preset-react', {
        development: isDevelopment,
        runtime: 'automatic'
      }],
      ['@babel/preset-typescript', {
        allowNamespaces: true,
        allowDeclareFields: true
      }]
    ],
    plugins
  };
};

// ä½¿ç”¨è‡ªå®šä¹‰é¢„è®¾
module.exports = {
  presets: [
    ['./custom-preset', {
      isDevelopment: process.env.NODE_ENV === 'development',
      isTest: process.env.NODE_ENV === 'test'
    }]
  ]
};
</code></pre>
<h2 id="é«˜çº§è½¬æ¢æŠ€æœ¯"><a class="header" href="#é«˜çº§è½¬æ¢æŠ€æœ¯">é«˜çº§è½¬æ¢æŠ€æœ¯</a></h2>
<h3 id="ä»£ç åˆ†å‰²æ”¯æŒ"><a class="header" href="#ä»£ç åˆ†å‰²æ”¯æŒ">ä»£ç åˆ†å‰²æ”¯æŒ</a></h3>
<p>ä¸ºä»£ç åˆ†å‰²ç”Ÿæˆè¾…åŠ©ä»£ç ï¼š</p>
<pre><code class="language-javascript">// ä»£ç åˆ†å‰²æ’ä»¶
function codeSplittingPlugin() {
  return {
    name: 'code-splitting',
    visitor: {
      CallExpression(path) {
        if (this.isDynamicImport(path)) {
          const modulePath = path.node.arguments[0].value;
          
          // æ·»åŠ webpack magic comments
          if (modulePath.includes('/components/')) {
            path.node.arguments[0] = t.stringLiteral(
              `${modulePath}/* webpackChunkName: "component-[request]" */`
            );
          }
          
          // æ·»åŠ é¢„åŠ è½½æç¤º
          this.addPreloadHint(path, modulePath);
        }
      }
    },
    
    addPreloadHint(path, modulePath) {
      // ç”Ÿæˆé¢„åŠ è½½ä»£ç 
      const preloadCode = t.expressionStatement(
        t.callExpression(
          t.memberExpression(
            t.identifier('document'),
            t.identifier('createElement')
          ),
          [t.stringLiteral('link')]
        )
      );
      
      path.insertBefore(preloadCode);
    }
  };
}
</code></pre>
<h3 id="æ¨¡å—è”é‚¦æ”¯æŒ"><a class="header" href="#æ¨¡å—è”é‚¦æ”¯æŒ">æ¨¡å—è”é‚¦æ”¯æŒ</a></h3>
<p>ä¸ºModule Federationç”Ÿæˆé€‚é…ä»£ç ï¼š</p>
<pre><code class="language-javascript">// Module Federationé€‚é…æ’ä»¶
function moduleFederationPlugin(options = {}) {
  const { remotes = {}, exposes = {} } = options;
  
  return {
    name: 'module-federation-adapter',
    visitor: {
      Program: {
        enter(path) {
          // æ·»åŠ è¿œç¨‹æ¨¡å—åŠ è½½å™¨
          this.addRemoteLoader(path);
        },
        
        exit(path) {
          // æ·»åŠ æ¨¡å—å¯¼å‡ºé€‚é…å™¨
          this.addExportAdapter(path);
        }
      },
      
      ImportDeclaration(path) {
        const source = path.node.source.value;
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºè¿œç¨‹æ¨¡å—
        if (remotes[source]) {
          this.transformRemoteImport(path, remotes[source]);
        }
      }
    },
    
    addRemoteLoader(path) {
      const loaderCode = `
        const __webpack_require__ = {
          loadRemote: async (url, scope, module) =&gt; {
            await __webpack_init_sharing__('default');
            const container = window[scope];
            await container.init(__webpack_share_scopes__.default);
            const factory = await container.get(module);
            return factory();
          }
        };
      `;
      
      path.unshiftContainer('body', babel.parse(loaderCode).program.body);
    },
    
    transformRemoteImport(path, remoteConfig) {
      const { url, scope, module } = remoteConfig;
      
      // è½¬æ¢ä¸ºåŠ¨æ€åŠ è½½
      const dynamicImport = t.awaitExpression(
        t.callExpression(
          t.memberExpression(
            t.identifier('__webpack_require__'),
            t.identifier('loadRemote')
          ),
          [
            t.stringLiteral(url),
            t.stringLiteral(scope),
            t.stringLiteral(module)
          ]
        )
      );
      
      path.replaceWith(
        t.variableDeclaration('const', [
          t.variableDeclarator(
            t.objectPattern(path.node.specifiers.map(spec =&gt; 
              t.objectProperty(spec.imported, spec.local)
            )),
            dynamicImport
          )
        ])
      );
    }
  };
}
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–-3"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-3">æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="ç¼–è¯‘ç¼“å­˜"><a class="header" href="#ç¼–è¯‘ç¼“å­˜">ç¼–è¯‘ç¼“å­˜</a></h3>
<p>Babelçš„ç¼“å­˜æœºåˆ¶é…ç½®ï¼š</p>
<pre><code class="language-javascript">// babel.config.js
module.exports = {
  // å¯ç”¨ç¼“å­˜
  cacheDirectory: '.babel-cache',
  cacheCompression: false,
  
  // ç¼“å­˜æ ‡è¯†ç¬¦
  cacheIdentifier: JSON.stringify({
    babelVersion: require('@babel/core/package.json').version,
    nodeVersion: process.version,
    env: process.env.NODE_ENV
  }),
  
  presets: [
    ['@babel/preset-env', {
      targets: '&gt; 0.25%, not dead'
    }]
  ]
};

// ç¨‹åºåŒ–APIç¼“å­˜
const babel = require('@babel/core');
const fs = require('fs');
const crypto = require('crypto');

class BabelCache {
  constructor(cacheDir = '.babel-cache') {
    this.cacheDir = cacheDir;
    this.ensureCacheDir();
  }
  
  getCacheKey(filename, source, options) {
    const content = JSON.stringify({ filename, source, options });
    return crypto.createHash('md5').update(content).digest('hex');
  }
  
  get(filename, source, options) {
    const key = this.getCacheKey(filename, source, options);
    const cachePath = path.join(this.cacheDir, `${key}.json`);
    
    if (fs.existsSync(cachePath)) {
      const cached = JSON.parse(fs.readFileSync(cachePath, 'utf8'));
      
      // æ£€æŸ¥æºæ–‡ä»¶æ˜¯å¦æœ‰å˜æ›´
      const stats = fs.statSync(filename);
      if (stats.mtime.getTime() &lt;= cached.timestamp) {
        return cached.result;
      }
    }
    
    return null;
  }
  
  set(filename, source, options, result) {
    const key = this.getCacheKey(filename, source, options);
    const cachePath = path.join(this.cacheDir, `${key}.json`);
    
    const cached = {
      result,
      timestamp: Date.now()
    };
    
    fs.writeFileSync(cachePath, JSON.stringify(cached));
  }
}
</code></pre>
<h3 id="å¹¶è¡Œå¤„ç†"><a class="header" href="#å¹¶è¡Œå¤„ç†">å¹¶è¡Œå¤„ç†</a></h3>
<p>ä½¿ç”¨workerçº¿ç¨‹åŠ é€Ÿç¼–è¯‘ï¼š</p>
<pre><code class="language-javascript">// babel-worker.js
const { Worker, isMainThread, parentPort, workerData } = require('worker_threads');
const babel = require('@babel/core');

if (!isMainThread) {
  // Workerçº¿ç¨‹å¤„ç†
  parentPort.on('message', async ({ filename, source, options }) =&gt; {
    try {
      const result = await babel.transformAsync(source, {
        filename,
        ...options
      });
      
      parentPort.postMessage({ success: true, result });
    } catch (error) {
      parentPort.postMessage({ success: false, error: error.message });
    }
  });
} else {
  // ä¸»çº¿ç¨‹è°ƒåº¦å™¨
  class ParallelBabel {
    constructor(workerCount = require('os').cpus().length) {
      this.workers = [];
      this.queue = [];
      this.activeJobs = 0;
      
      // åˆ›å»ºworkeræ± 
      for (let i = 0; i &lt; workerCount; i++) {
        this.createWorker();
      }
    }
    
    createWorker() {
      const worker = new Worker(__filename);
      
      worker.on('message', ({ success, result, error }) =&gt; {
        const job = this.activeJobs.shift();
        
        if (success) {
          job.resolve(result);
        } else {
          job.reject(new Error(error));
        }
        
        this.processQueue();
      });
      
      this.workers.push(worker);
    }
    
    async transform(filename, source, options) {
      return new Promise((resolve, reject) =&gt; {
        const job = { filename, source, options, resolve, reject };
        
        const availableWorker = this.workers.find(w =&gt; !w.busy);
        
        if (availableWorker) {
          this.executeJob(availableWorker, job);
        } else {
          this.queue.push(job);
        }
      });
    }
    
    executeJob(worker, job) {
      worker.busy = true;
      this.activeJobs.push(job);
      
      worker.postMessage({
        filename: job.filename,
        source: job.source,
        options: job.options
      });
    }
    
    processQueue() {
      if (this.queue.length === 0) return;
      
      const availableWorker = this.workers.find(w =&gt; !w.busy);
      if (availableWorker) {
        const job = this.queue.shift();
        this.executeJob(availableWorker, job);
      }
    }
  }
  
  module.exports = ParallelBabel;
}
</code></pre>
<h2 id="æ„å»ºå·¥å…·é›†æˆ"><a class="header" href="#æ„å»ºå·¥å…·é›†æˆ">æ„å»ºå·¥å…·é›†æˆ</a></h2>
<h3 id="webpacké›†æˆ"><a class="header" href="#webpacké›†æˆ">Webpacké›†æˆ</a></h3>
<pre><code class="language-javascript">// webpack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.(js|jsx|ts|tsx)$/,
        exclude: /node_modules/,
        use: {
          loader: 'babel-loader',
          options: {
            presets: [
              ['@babel/preset-env', {
                targets: {
                  browsers: ['&gt; 1%', 'last 2 versions']
                },
                modules: false, // è®©webpackå¤„ç†æ¨¡å—
                useBuiltIns: 'usage',
                corejs: 3
              }],
              '@babel/preset-react'
            ],
            
            // ç¼“å­˜é…ç½®
            cacheDirectory: true,
            cacheCompression: false,
            
            // å¼€å‘ç¯å¢ƒæ’ä»¶
            plugins: process.env.NODE_ENV === 'development' ? [
              'react-refresh/babel'
            ] : []
          }
        }
      }
    ]
  }
};
</code></pre>
<h3 id="rollupé›†æˆ"><a class="header" href="#rollupé›†æˆ">Rollupé›†æˆ</a></h3>
<pre><code class="language-javascript">// rollup.config.js
import babel from '@rollup/plugin-babel';

export default {
  input: 'src/index.js',
  output: {
    file: 'dist/bundle.js',
    format: 'es'
  },
  plugins: [
    babel({
      babelHelpers: 'bundled',
      exclude: 'node_modules/**',
      presets: [
        ['@babel/preset-env', {
          modules: false, // è®©Rollupå¤„ç†æ¨¡å—
          targets: {
            browsers: ['&gt; 1%', 'last 2 versions']
          }
        }]
      ]
    })
  ]
};
</code></pre>
<h3 id="viteé›†æˆ"><a class="header" href="#viteé›†æˆ">Viteé›†æˆ</a></h3>
<pre><code class="language-javascript">// vite.config.js
import { defineConfig } from 'vite';
import { babel } from '@rollup/plugin-babel';

export default defineConfig({
  plugins: [
    // å¼€å‘ç¯å¢ƒä½¿ç”¨SWCï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨Babel
    process.env.NODE_ENV === 'production' ? babel({
      babelHelpers: 'bundled',
      exclude: /node_modules/,
      extensions: ['.js', '.jsx', '.ts', '.tsx']
    }) : null
  ].filter(Boolean),
  
  // esbuildé…ç½®ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
  esbuild: {
    jsxFactory: 'React.createElement',
    jsxFragment: 'React.Fragment'
  }
});
</code></pre>
<h2 id="æœ€ä½³å®è·µ-4"><a class="header" href="#æœ€ä½³å®è·µ-4">æœ€ä½³å®è·µ</a></h2>
<h3 id="é…ç½®æ–‡ä»¶ç­–ç•¥"><a class="header" href="#é…ç½®æ–‡ä»¶ç­–ç•¥">é…ç½®æ–‡ä»¶ç­–ç•¥</a></h3>
<pre><code class="language-javascript">// babel.config.js - é¡¹ç›®çº§é…ç½®
module.exports = function(api) {
  // ç¼“å­˜é…ç½®
  api.cache(true);
  
  const presets = [
    ['@babel/preset-env', {
      targets: {
        node: 'current'
      }
    }]
  ];
  
  const plugins = [];
  
  // ç¯å¢ƒç‰¹å®šé…ç½®
  if (process.env.NODE_ENV === 'test') {
    plugins.push('babel-plugin-dynamic-import-node');
  }
  
  return {
    presets,
    plugins,
    env: {
      development: {
        plugins: ['react-refresh/babel']
      },
      production: {
        plugins: [
          ['transform-remove-console', { exclude: ['error', 'warn'] }]
        ]
      }
    }
  };
};

// .babelrc.js - æ–‡ä»¶çº§é…ç½®
module.exports = {
  presets: ['@babel/preset-react'],
  plugins: ['@babel/plugin-proposal-class-properties']
};
</code></pre>
<h3 id="ç±»å‹æ£€æŸ¥é›†æˆ"><a class="header" href="#ç±»å‹æ£€æŸ¥é›†æˆ">ç±»å‹æ£€æŸ¥é›†æˆ</a></h3>
<pre><code class="language-javascript">// ç»“åˆTypeScriptçš„é…ç½®
module.exports = {
  presets: [
    ['@babel/preset-env', {
      targets: '&gt; 0.25%, not dead'
    }],
    ['@babel/preset-typescript', {
      // åªç§»é™¤ç±»å‹ï¼Œä¸åšç±»å‹æ£€æŸ¥
      onlyRemoveTypeImports: true,
      
      // å…è®¸å‘½åç©ºé—´
      allowNamespaces: true,
      
      // å…è®¸å£°æ˜å­—æ®µ
      allowDeclareFields: true
    }]
  ],
  
  plugins: [
    // è£…é¥°å™¨æ”¯æŒ
    ['@babel/plugin-proposal-decorators', { legacy: true }],
    
    // ç±»å±æ€§æ”¯æŒ
    ['@babel/plugin-proposal-class-properties', { loose: true }]
  ]
};
</code></pre>
<p>Babelä½œä¸ºJavaScriptè½¬è¯‘çš„æ ‡æ†å·¥å…·ï¼Œä¸ä»…è§£å†³äº†è¯­è¨€ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜ï¼Œè¿˜ä¸ºç°ä»£æ¨¡å—åŒ–å¼€å‘æä¾›äº†å¼ºå¤§çš„è½¬æ¢èƒ½åŠ›ã€‚æŒæ¡Babelçš„é…ç½®å’Œä¼˜åŒ–æŠ€å·§ï¼Œå¯¹äºæ„å»ºé«˜æ•ˆçš„ç°ä»£JavaScriptåº”ç”¨è‡³å…³é‡è¦ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#typescriptæ¨¡å—">TypeScriptæ¨¡å—</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="typescriptæ¨¡å—"><a class="header" href="#typescriptæ¨¡å—">TypeScriptæ¨¡å—</a></h1>
<p>TypeScriptä½œä¸ºJavaScriptçš„è¶…é›†ï¼Œä¸ºæ¨¡å—åŒ–å¼€å‘å¸¦æ¥äº†å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿæ”¯æŒã€‚å®ƒä¸ä»…æä¾›äº†ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ï¼Œè¿˜å¢å¼ºäº†æ¨¡å—çš„å¯¼å…¥å¯¼å‡ºæœºåˆ¶ï¼Œä¸ºå¤§å‹é¡¹ç›®çš„æ¨¡å—åŒ–æ¶æ„æä¾›äº†åšå®çš„åŸºç¡€ã€‚</p>
<h2 id="typescriptæ¨¡å—ç³»ç»Ÿ"><a class="header" href="#typescriptæ¨¡å—ç³»ç»Ÿ">TypeScriptæ¨¡å—ç³»ç»Ÿ</a></h2>
<h3 id="æ¨¡å—è¯­æ³•å¢å¼º"><a class="header" href="#æ¨¡å—è¯­æ³•å¢å¼º">æ¨¡å—è¯­æ³•å¢å¼º</a></h3>
<p>TypeScriptåœ¨ESæ¨¡å—åŸºç¡€ä¸Šå¢åŠ äº†ç±»å‹ä¿¡æ¯ï¼š</p>
<pre><code class="language-typescript">// ç±»å‹å¯¼å‡º
export type UserType = {
  id: number;
  name: string;
  email: string;
};

export interface ApiResponse&lt;T&gt; {
  data: T;
  status: number;
  message: string;
}

// å€¼å’Œç±»å‹åŒæ—¶å¯¼å‡º
export class UserService {
  async getUser(id: number): Promise&lt;UserType&gt; {
    // å®ç°...
  }
}

// å‘½åç©ºé—´å¯¼å‡º
export namespace Utils {
  export function formatDate(date: Date): string {
    return date.toISOString();
  }
  
  export type DateFormat = 'ISO' | 'Local' | 'UTC';
}

// æ¡ä»¶ç±»å‹å¯¼å‡º
export type ApiEndpoint&lt;T extends string&gt; = T extends 'users' 
  ? UserType[] 
  : T extends 'posts' 
  ? PostType[] 
  : unknown;
</code></pre>
<h3 id="æ¨¡å—å¯¼å…¥çš„ç±»å‹æ”¯æŒ"><a class="header" href="#æ¨¡å—å¯¼å…¥çš„ç±»å‹æ”¯æŒ">æ¨¡å—å¯¼å…¥çš„ç±»å‹æ”¯æŒ</a></h3>
<pre><code class="language-typescript">// ç±»å‹å¯¼å…¥
import type { UserType, ApiResponse } from './types';
import type * as Types from './types';

// å€¼å¯¼å…¥
import { UserService } from './services';
import { Utils } from './utils';

// æ··åˆå¯¼å…¥
import { CONFIG, type ConfigType } from './config';

// åŠ¨æ€å¯¼å…¥ä¸ç±»å‹
const loadModule = async (): Promise&lt;typeof import('./heavy-module')&gt; =&gt; {
  return await import('./heavy-module');
};

// æ¡ä»¶å¯¼å…¥
type ModuleType = typeof import('./module');
type AsyncModuleType = Awaited&lt;typeof import('./async-module')&gt;;
</code></pre>
<h3 id="æ¨¡å—å£°æ˜å’Œç¯å¢ƒå£°æ˜"><a class="header" href="#æ¨¡å—å£°æ˜å’Œç¯å¢ƒå£°æ˜">æ¨¡å—å£°æ˜å’Œç¯å¢ƒå£°æ˜</a></h3>
<pre><code class="language-typescript">// å…¨å±€æ¨¡å—å£°æ˜
declare global {
  interface Window {
    __APP_CONFIG__: AppConfig;
  }
  
  namespace NodeJS {
    interface ProcessEnv {
      NODE_ENV: 'development' | 'production' | 'test';
      API_URL: string;
    }
  }
}

// æ¨¡å—å£°æ˜
declare module '*.vue' {
  import { DefineComponent } from 'vue';
  const component: DefineComponent&lt;{}, {}, any&gt;;
  export default component;
}

declare module '*.module.css' {
  const classes: { readonly [key: string]: string };
  export default classes;
}

// æ‰©å±•å·²æœ‰æ¨¡å—
declare module 'express' {
  interface Request {
    user?: User;
  }
}

// ç¬¬ä¸‰æ–¹åº“ç±»å‹å£°æ˜
declare module 'some-untyped-library' {
  export function someFunction(arg: string): number;
  export const CONSTANT: string;
}
</code></pre>
<h2 id="ç¼–è¯‘é…ç½®"><a class="header" href="#ç¼–è¯‘é…ç½®">ç¼–è¯‘é…ç½®</a></h2>
<h3 id="tsconfigjsonè¯¦è§£"><a class="header" href="#tsconfigjsonè¯¦è§£">tsconfig.jsonè¯¦è§£</a></h3>
<pre><code class="language-json">{
  "compilerOptions": {
    // æ¨¡å—ç³»ç»Ÿé…ç½®
    "module": "ES2022",
    "moduleResolution": "node",
    "target": "ES2020",
    
    // æ¨¡å—æ£€æµ‹
    "moduleDetection": "auto",
    
    // è¾“å‡ºæ§åˆ¶
    "outDir": "./dist",
    "rootDir": "./src",
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    
    // æ¨¡å—è§£æ
    "baseUrl": "./",
    "paths": {
      "@/*": ["src/*"],
      "@components/*": ["src/components/*"],
      "@utils/*": ["src/utils/*"]
    },
    
    // ç±»å‹æ£€æŸ¥
    "strict": true,
    "noImplicitReturns": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    
    // ESæ¨¡å—äº’æ“ä½œ
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "forceConsistentCasingInFileNames": true,
    
    // å®éªŒæ€§ç‰¹æ€§
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true,
    
    // å¢é‡ç¼–è¯‘
    "incremental": true,
    "tsBuildInfoFile": ".tsbuildinfo",
    
    // ç±»å‹å¯¼å…¥
    "verbatimModuleSyntax": false,
    "allowImportingTsExtensions": false
  },
  
  // é¡¹ç›®å¼•ç”¨
  "references": [
    { "path": "./packages/core" },
    { "path": "./packages/utils" }
  ],
  
  // åŒ…å«å’Œæ’é™¤
  "include": [
    "src/**/*",
    "types/**/*"
  ],
  "exclude": [
    "node_modules",
    "dist",
    "**/*.test.ts"
  ]
}
</code></pre>
<h3 id="å¤šåŒ…é¡¹ç›®é…ç½®"><a class="header" href="#å¤šåŒ…é¡¹ç›®é…ç½®">å¤šåŒ…é¡¹ç›®é…ç½®</a></h3>
<pre><code class="language-typescript">// packages/core/tsconfig.json
{
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "./dist",
    "rootDir": "./src",
    "composite": true
  },
  "include": ["src/**/*"],
  "references": []
}

// packages/utils/tsconfig.json  
{
  "extends": "../../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "./dist",
    "rootDir": "./src",
    "composite": true
  },
  "include": ["src/**/*"],
  "references": [
    { "path": "../core" }
  ]
}

// tsconfig.base.json
{
  "compilerOptions": {
    "module": "ES2022",
    "target": "ES2020",
    "moduleResolution": "node",
    "strict": true,
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    "incremental": true
  }
}
</code></pre>
<h2 id="é«˜çº§æ¨¡å—æ¨¡å¼"><a class="header" href="#é«˜çº§æ¨¡å—æ¨¡å¼">é«˜çº§æ¨¡å—æ¨¡å¼</a></h2>
<h3 id="æ¨¡å—æ‰©å±•æ¨¡å¼"><a class="header" href="#æ¨¡å—æ‰©å±•æ¨¡å¼">æ¨¡å—æ‰©å±•æ¨¡å¼</a></h3>
<pre><code class="language-typescript">// åŸºç¡€æ¨¡å—
// base-module.ts
export interface BaseConfig {
  name: string;
  version: string;
}

export class BaseService {
  constructor(protected config: BaseConfig) {}
  
  getName(): string {
    return this.config.name;
  }
}

// æ‰©å±•æ¨¡å—
// extended-module.ts
import { BaseConfig, BaseService } from './base-module';

export interface ExtendedConfig extends BaseConfig {
  features: string[];
  debug: boolean;
}

export class ExtendedService extends BaseService {
  constructor(protected config: ExtendedConfig) {
    super(config);
  }
  
  getFeatures(): string[] {
    return this.config.features;
  }
  
  isDebugEnabled(): boolean {
    return this.config.debug;
  }
}

// æ¨¡å—èšåˆ
export * from './base-module';
export { ExtendedService, type ExtendedConfig } from './extended-module';
</code></pre>
<h3 id="æ’ä»¶æ¶æ„æ¨¡å¼"><a class="header" href="#æ’ä»¶æ¶æ„æ¨¡å¼">æ’ä»¶æ¶æ„æ¨¡å¼</a></h3>
<pre><code class="language-typescript">// æ’ä»¶ç³»ç»Ÿç±»å‹å®šä¹‰
export interface Plugin&lt;T = any&gt; {
  name: string;
  version: string;
  install(app: App, options?: T): void;
  uninstall?(app: App): void;
}

export interface App {
  use&lt;T&gt;(plugin: Plugin&lt;T&gt;, options?: T): this;
  unuse(pluginName: string): this;
  getPlugin&lt;T extends Plugin&gt;(name: string): T | undefined;
}

// æ’ä»¶å®ç°
export class ValidationPlugin implements Plugin&lt;ValidationOptions&gt; {
  name = 'validation';
  version = '1.0.0';
  
  install(app: App, options: ValidationOptions = {}) {
    // å®‰è£…éªŒè¯æ’ä»¶
    app.addValidator(new Validator(options));
  }
  
  uninstall(app: App) {
    app.removeValidator(this.name);
  }
}

// åº”ç”¨å®ç°
export class Application implements App {
  private plugins = new Map&lt;string, Plugin&gt;();
  private validators = new Map&lt;string, Validator&gt;();
  
  use&lt;T&gt;(plugin: Plugin&lt;T&gt;, options?: T): this {
    if (this.plugins.has(plugin.name)) {
      throw new Error(`Plugin ${plugin.name} already installed`);
    }
    
    plugin.install(this, options);
    this.plugins.set(plugin.name, plugin);
    return this;
  }
  
  unuse(pluginName: string): this {
    const plugin = this.plugins.get(pluginName);
    if (plugin?.uninstall) {
      plugin.uninstall(this);
    }
    this.plugins.delete(pluginName);
    return this;
  }
  
  getPlugin&lt;T extends Plugin&gt;(name: string): T | undefined {
    return this.plugins.get(name) as T;
  }
  
  addValidator(validator: Validator): void {
    this.validators.set(validator.name, validator);
  }
  
  removeValidator(name: string): void {
    this.validators.delete(name);
  }
}
</code></pre>
<h3 id="å·¥å‚æ¨¡å¼æ¨¡å—"><a class="header" href="#å·¥å‚æ¨¡å¼æ¨¡å—">å·¥å‚æ¨¡å¼æ¨¡å—</a></h3>
<pre><code class="language-typescript">// å·¥å‚æ¥å£
export interface Factory&lt;T&gt; {
  create(...args: any[]): T;
  canHandle(type: string): boolean;
}

// å…·ä½“å·¥å‚
export class HttpClientFactory implements Factory&lt;HttpClient&gt; {
  canHandle(type: string): boolean {
    return ['axios', 'fetch', 'xhr'].includes(type);
  }
  
  create(type: 'axios' | 'fetch' | 'xhr', config?: any): HttpClient {
    switch (type) {
      case 'axios':
        return new AxiosClient(config);
      case 'fetch':
        return new FetchClient(config);
      case 'xhr':
        return new XhrClient(config);
      default:
        throw new Error(`Unsupported client type: ${type}`);
    }
  }
}

// å·¥å‚æ³¨å†Œå™¨
export class FactoryRegistry {
  private factories = new Map&lt;string, Factory&lt;any&gt;&gt;();
  
  register&lt;T&gt;(name: string, factory: Factory&lt;T&gt;): void {
    this.factories.set(name, factory);
  }
  
  create&lt;T&gt;(name: string, type: string, ...args: any[]): T {
    const factory = this.factories.get(name);
    if (!factory) {
      throw new Error(`Factory ${name} not found`);
    }
    
    if (!factory.canHandle(type)) {
      throw new Error(`Factory ${name} cannot handle type ${type}`);
    }
    
    return factory.create(type, ...args);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const registry = new FactoryRegistry();
registry.register('http', new HttpClientFactory());

const client = registry.create&lt;HttpClient&gt;('http', 'axios', {
  baseURL: 'https://api.example.com'
});
</code></pre>
<h2 id="ç±»å‹ç”Ÿæˆå’Œå¯¼å‡º"><a class="header" href="#ç±»å‹ç”Ÿæˆå’Œå¯¼å‡º">ç±»å‹ç”Ÿæˆå’Œå¯¼å‡º</a></h2>
<h3 id="è‡ªåŠ¨ç±»å‹ç”Ÿæˆ"><a class="header" href="#è‡ªåŠ¨ç±»å‹ç”Ÿæˆ">è‡ªåŠ¨ç±»å‹ç”Ÿæˆ</a></h3>
<pre><code class="language-typescript">// type-generator.ts
import * as ts from 'typescript';
import * as fs from 'fs';

export class TypeGenerator {
  private program: ts.Program;
  private checker: ts.TypeChecker;
  
  constructor(configPath: string) {
    const config = ts.readConfigFile(configPath, ts.sys.readFile);
    const parseResult = ts.parseJsonConfigFileContent(
      config.config,
      ts.sys,
      '.'
    );
    
    this.program = ts.createProgram(
      parseResult.fileNames,
      parseResult.options
    );
    this.checker = this.program.getTypeChecker();
  }
  
  generateApiTypes(sourceFile: string): string {
    const source = this.program.getSourceFile(sourceFile);
    if (!source) {
      throw new Error(`Source file ${sourceFile} not found`);
    }
    
    const types: string[] = [];
    
    ts.forEachChild(source, node =&gt; {
      if (ts.isInterfaceDeclaration(node) || ts.isTypeAliasDeclaration(node)) {
        const type = this.checker.getTypeAtLocation(node);
        const typeString = this.checker.typeToString(type);
        types.push(`export type ${node.name.text} = ${typeString};`);
      }
    });
    
    return types.join('\n');
  }
  
  generateSchemaTypes(schema: any): string {
    // ä»JSON Schemaç”ŸæˆTypeScriptç±»å‹
    const generateType = (obj: any, name: string): string =&gt; {
      if (obj.type === 'object') {
        const properties = Object.entries(obj.properties || {})
          .map(([key, value]: [string, any]) =&gt; {
            const optional = !obj.required?.includes(key) ? '?' : '';
            const type = this.mapJsonSchemaType(value);
            return `${key}${optional}: ${type}`;
          })
          .join(';\n  ');
        
        return `export interface ${name} {\n  ${properties}\n}`;
      }
      
      return `export type ${name} = ${this.mapJsonSchemaType(obj)};`;
    };
    
    return generateType(schema, 'GeneratedType');
  }
  
  private mapJsonSchemaType(schema: any): string {
    switch (schema.type) {
      case 'string':
        return schema.enum ? schema.enum.map((v: string) =&gt; `'${v}'`).join(' | ') : 'string';
      case 'number':
      case 'integer':
        return 'number';
      case 'boolean':
        return 'boolean';
      case 'array':
        return `${this.mapJsonSchemaType(schema.items)}[]`;
      case 'object':
        return 'object';
      default:
        return 'unknown';
    }
  }
}
</code></pre>
<h3 id="å£°æ˜æ–‡ä»¶ç”Ÿæˆ"><a class="header" href="#å£°æ˜æ–‡ä»¶ç”Ÿæˆ">å£°æ˜æ–‡ä»¶ç”Ÿæˆ</a></h3>
<pre><code class="language-typescript">// declaration-bundler.ts
export class DeclarationBundler {
  constructor(private options: {
    input: string;
    output: string;
    external?: string[];
  }) {}
  
  async bundle(): Promise&lt;void&gt; {
    const program = ts.createProgram([this.options.input], {
      declaration: true,
      emitDeclarationOnly: true,
      moduleResolution: ts.ModuleResolutionKind.NodeJs,
      module: ts.ModuleKind.ES2022,
      target: ts.ScriptTarget.ES2020
    });
    
    const declarations = new Map&lt;string, string&gt;();
    
    // æ”¶é›†æ‰€æœ‰å£°æ˜
    program.emit(undefined, (fileName, text) =&gt; {
      if (fileName.endsWith('.d.ts')) {
        declarations.set(fileName, text);
      }
    });
    
    // åˆå¹¶å£°æ˜
    const bundled = this.mergeDeclarations(declarations);
    
    // å†™å…¥è¾“å‡ºæ–‡ä»¶
    fs.writeFileSync(this.options.output, bundled);
  }
  
  private mergeDeclarations(declarations: Map&lt;string, string&gt;): string {
    const imports = new Set&lt;string&gt;();
    const exports = new Set&lt;string&gt;();
    let content = '';
    
    for (const [fileName, text] of declarations) {
      // è§£æå¯¼å…¥å¯¼å‡º
      const lines = text.split('\n');
      
      for (const line of lines) {
        if (line.startsWith('import ')) {
          imports.add(line);
        } else if (line.startsWith('export ')) {
          exports.add(line);
        } else if (line.trim() &amp;&amp; !line.startsWith('//')) {
          content += line + '\n';
        }
      }
    }
    
    // ç»„è£…æœ€ç»ˆè¾“å‡º
    const result = [
      ...Array.from(imports),
      '',
      content,
      '',
      ...Array.from(exports)
    ].join('\n');
    
    return result;
  }
}
</code></pre>
<h2 id="ç¼–è¯‘ä¼˜åŒ–"><a class="header" href="#ç¼–è¯‘ä¼˜åŒ–">ç¼–è¯‘ä¼˜åŒ–</a></h2>
<h3 id="å¢é‡ç¼–è¯‘-1"><a class="header" href="#å¢é‡ç¼–è¯‘-1">å¢é‡ç¼–è¯‘</a></h3>
<pre><code class="language-typescript">// incremental-compiler.ts
export class IncrementalCompiler {
  private program: ts.SemanticDiagnosticsBuilderProgram;
  private host: ts.CompilerHost;
  
  constructor(private configPath: string) {
    this.setupCompiler();
  }
  
  private setupCompiler(): void {
    const config = ts.readConfigFile(this.configPath, ts.sys.readFile);
    const parseResult = ts.parseJsonConfigFileContent(
      config.config,
      ts.sys,
      '.'
    );
    
    this.host = ts.createIncrementalCompilerHost(parseResult.options);
    
    this.program = ts.createIncrementalProgram({
      rootNames: parseResult.fileNames,
      options: {
        ...parseResult.options,
        incremental: true,
        tsBuildInfoFile: '.tsbuildinfo'
      },
      host: this.host
    });
  }
  
  compile(): ts.Diagnostic[] {
    const emitResult = this.program.emit();
    const diagnostics = [
      ...this.program.getConfigFileParsingDiagnostics(),
      ...this.program.getSyntacticDiagnostics(),
      ...this.program.getSemanticDiagnostics(),
      ...emitResult.diagnostics
    ];
    
    return diagnostics;
  }
  
  getAffectedFiles(): string[] {
    const affectedFiles: string[] = [];
    
    while (true) {
      const result = this.program.getSemanticDiagnosticsOfNextAffectedFile();
      if (!result) break;
      
      if (result.affected.fileName) {
        affectedFiles.push(result.affected.fileName);
      }
    }
    
    return affectedFiles;
  }
  
  watchMode(callback: (diagnostics: ts.Diagnostic[]) =&gt; void): void {
    const watchProgram = ts.createWatchProgram(
      ts.createWatchCompilerHost(
        this.configPath,
        {},
        ts.sys,
        ts.createSemanticDiagnosticsBuilderProgram,
        (diagnostic) =&gt; callback([diagnostic]),
        (diagnostic) =&gt; callback([diagnostic])
      )
    );
  }
}
</code></pre>
<h3 id="å¹¶è¡Œç±»å‹æ£€æŸ¥"><a class="header" href="#å¹¶è¡Œç±»å‹æ£€æŸ¥">å¹¶è¡Œç±»å‹æ£€æŸ¥</a></h3>
<pre><code class="language-typescript">// parallel-type-checker.ts
import { Worker, isMainThread, parentPort, workerData } from 'worker_threads';

if (!isMainThread) {
  // Workerçº¿ç¨‹
  const { files, options } = workerData;
  
  const program = ts.createProgram(files, options);
  const diagnostics = ts.getPreEmitDiagnostics(program);
  
  parentPort?.postMessage({
    diagnostics: diagnostics.map(d =&gt; ({
      file: d.file?.fileName,
      start: d.start,
      length: d.length,
      messageText: d.messageText,
      category: d.category,
      code: d.code
    }))
  });
} else {
  // ä¸»çº¿ç¨‹
  export class ParallelTypeChecker {
    async checkFiles(files: string[], options: ts.CompilerOptions): Promise&lt;ts.Diagnostic[]&gt; {
      const chunkSize = Math.ceil(files.length / 4);
      const chunks = [];
      
      for (let i = 0; i &lt; files.length; i += chunkSize) {
        chunks.push(files.slice(i, i + chunkSize));
      }
      
      const workers = chunks.map(chunk =&gt; 
        new Worker(__filename, {
          workerData: { files: chunk, options }
        })
      );
      
      const results = await Promise.all(
        workers.map(worker =&gt; 
          new Promise&lt;{ diagnostics: any[] }&gt;((resolve, reject) =&gt; {
            worker.on('message', resolve);
            worker.on('error', reject);
          })
        )
      );
      
      // æ¸…ç†workers
      workers.forEach(worker =&gt; worker.terminate());
      
      // åˆå¹¶ç»“æœ
      return results.flatMap(result =&gt; result.diagnostics);
    }
  }
}
</code></pre>
<h2 id="æ„å»ºå·¥å…·é›†æˆ-1"><a class="header" href="#æ„å»ºå·¥å…·é›†æˆ-1">æ„å»ºå·¥å…·é›†æˆ</a></h2>
<h3 id="webpacké›†æˆ-1"><a class="header" href="#webpacké›†æˆ-1">Webpacké›†æˆ</a></h3>
<pre><code class="language-typescript">// webpack.config.ts
import type { Configuration } from 'webpack';
import ForkTsCheckerWebpackPlugin from 'fork-ts-checker-webpack-plugin';

const config: Configuration = {
  entry: './src/index.ts',
  
  module: {
    rules: [
      {
        test: /\.tsx?$/,
        use: [
          {
            loader: 'ts-loader',
            options: {
              // åªè¿›è¡Œè½¬è¯‘ï¼Œç±»å‹æ£€æŸ¥äº¤ç»™ForkTsCheckerWebpackPlugin
              transpileOnly: true,
              
              // ç¼–è¯‘é€‰é¡¹è¦†ç›–
              compilerOptions: {
                module: 'esnext',
                target: 'es2020'
              }
            }
          }
        ],
        exclude: /node_modules/
      }
    ]
  },
  
  plugins: [
    new ForkTsCheckerWebpackPlugin({
      typescript: {
        configFile: 'tsconfig.json',
        diagnosticOptions: {
          semantic: true,
          syntactic: true
        }
      },
      
      // ESLinté›†æˆ
      eslint: {
        files: './src/**/*.{ts,tsx,js,jsx}'
      }
    })
  ],
  
  resolve: {
    extensions: ['.tsx', '.ts', '.js'],
    alias: {
      '@': path.resolve(__dirname, 'src')
    }
  }
};

export default config;
</code></pre>
<h3 id="viteé›†æˆ-1"><a class="header" href="#viteé›†æˆ-1">Viteé›†æˆ</a></h3>
<pre><code class="language-typescript">// vite.config.ts
import { defineConfig } from 'vite';
import typescript from '@rollup/plugin-typescript';

export default defineConfig({
  plugins: [
    typescript({
      tsconfig: './tsconfig.json',
      
      // ç±»å‹æ£€æŸ¥é€‰é¡¹
      check: true,
      
      // å£°æ˜æ–‡ä»¶ç”Ÿæˆ
      declaration: true,
      declarationDir: 'dist/types',
      
      // æ’é™¤æµ‹è¯•æ–‡ä»¶
      exclude: ['**/*.test.ts', '**/*.spec.ts']
    })
  ],
  
  build: {
    lib: {
      entry: 'src/index.ts',
      name: 'MyLib',
      formats: ['es', 'cjs', 'umd']
    },
    
    rollupOptions: {
      external: ['vue', 'react'],
      output: {
        globals: {
          vue: 'Vue',
          react: 'React'
        }
      }
    }
  },
  
  // ç±»å‹æ£€æŸ¥è„šæœ¬
  define: {
    __VERSION__: JSON.stringify(process.env.npm_package_version)
  }
});
</code></pre>
<h3 id="esbuildé›†æˆ"><a class="header" href="#esbuildé›†æˆ">esbuildé›†æˆ</a></h3>
<pre><code class="language-typescript">// esbuild.config.ts
import { build } from 'esbuild';
import { promises as fs } from 'fs';

async function buildWithTypes() {
  // JavaScriptæ„å»º
  await build({
    entryPoints: ['src/index.ts'],
    bundle: true,
    outfile: 'dist/index.js',
    format: 'esm',
    target: 'es2020',
    
    // TypeScriptæ”¯æŒ
    loader: {
      '.ts': 'ts',
      '.tsx': 'tsx'
    },
    
    // å¤–éƒ¨ä¾èµ–
    external: ['react', 'react-dom']
  });
  
  // å•ç‹¬çš„ç±»å‹ç”Ÿæˆ
  const tsc = spawn('tsc', [
    '--declaration',
    '--emitDeclarationOnly',
    '--outDir',
    'dist/types'
  ]);
  
  await new Promise((resolve, reject) =&gt; {
    tsc.on('close', (code) =&gt; {
      if (code === 0) resolve(void 0);
      else reject(new Error(`tsc exited with code ${code}`));
    });
  });
}

buildWithTypes().catch(console.error);
</code></pre>
<h2 id="æœ€ä½³å®è·µ-5"><a class="header" href="#æœ€ä½³å®è·µ-5">æœ€ä½³å®è·µ</a></h2>
<h3 id="æ¨¡å—ç»„ç»‡ç­–ç•¥"><a class="header" href="#æ¨¡å—ç»„ç»‡ç­–ç•¥">æ¨¡å—ç»„ç»‡ç­–ç•¥</a></h3>
<pre><code class="language-typescript">// åŠŸèƒ½æ¨¡å—ç»“æ„
// src/modules/user/
//   â”œâ”€â”€ types.ts          // ç±»å‹å®šä¹‰
//   â”œâ”€â”€ service.ts        // ä¸šåŠ¡é€»è¾‘
//   â”œâ”€â”€ api.ts           // APIè°ƒç”¨
//   â”œâ”€â”€ store.ts         // çŠ¶æ€ç®¡ç†
//   â””â”€â”€ index.ts         // æ¨¡å—å¯¼å‡º

// types.ts
export interface User {
  id: number;
  name: string;
  email: string;
  roles: Role[];
}

export interface CreateUserRequest {
  name: string;
  email: string;
  password: string;
}

export type UserRole = 'admin' | 'user' | 'guest';

// service.ts
import type { User, CreateUserRequest } from './types';
import { userApi } from './api';

export class UserService {
  async getUser(id: number): Promise&lt;User&gt; {
    return userApi.get(id);
  }
  
  async createUser(data: CreateUserRequest): Promise&lt;User&gt; {
    return userApi.create(data);
  }
}

export const userService = new UserService();

// index.ts - ç»Ÿä¸€å¯¼å‡º
export type * from './types';
export { UserService, userService } from './service';
export { userApi } from './api';
</code></pre>
<h3 id="ç±»å‹å®‰å…¨çš„é…ç½®"><a class="header" href="#ç±»å‹å®‰å…¨çš„é…ç½®">ç±»å‹å®‰å…¨çš„é…ç½®</a></h3>
<pre><code class="language-typescript">// config.ts
interface DatabaseConfig {
  host: string;
  port: number;
  username: string;
  password: string;
  database: string;
}

interface ApiConfig {
  baseURL: string;
  timeout: number;
  retries: number;
}

interface AppConfig {
  database: DatabaseConfig;
  api: ApiConfig;
  features: {
    [K in FeatureFlag]: boolean;
  };
}

type FeatureFlag = 'userManagement' | 'analytics' | 'notifications';

// é…ç½®éªŒè¯
export function validateConfig(config: unknown): AppConfig {
  // è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥
  if (!isObject(config)) {
    throw new Error('Config must be an object');
  }
  
  // è¯¦ç»†éªŒè¯é€»è¾‘...
  return config as AppConfig;
}

// ç¯å¢ƒç‰¹å®šé…ç½®
export const config: AppConfig = validateConfig({
  database: {
    host: process.env.DB_HOST || 'localhost',
    port: parseInt(process.env.DB_PORT || '5432'),
    username: process.env.DB_USER || 'postgres',
    password: process.env.DB_PASS || '',
    database: process.env.DB_NAME || 'app'
  },
  api: {
    baseURL: process.env.API_URL || 'http://localhost:3000',
    timeout: 5000,
    retries: 3
  },
  features: {
    userManagement: true,
    analytics: process.env.NODE_ENV === 'production',
    notifications: true
  }
});
</code></pre>
<h3 id="ä¾èµ–æ³¨å…¥æ¨¡å¼"><a class="header" href="#ä¾èµ–æ³¨å…¥æ¨¡å¼">ä¾èµ–æ³¨å…¥æ¨¡å¼</a></h3>
<pre><code class="language-typescript">// di-container.ts
type Constructor&lt;T = {}&gt; = new (...args: any[]) =&gt; T;
type Token&lt;T&gt; = Constructor&lt;T&gt; | string | symbol;

export class DIContainer {
  private services = new Map&lt;Token&lt;any&gt;, any&gt;();
  private singletons = new Map&lt;Token&lt;any&gt;, any&gt;();
  
  register&lt;T&gt;(token: Token&lt;T&gt;, implementation: Constructor&lt;T&gt;): void {
    this.services.set(token, implementation);
  }
  
  registerSingleton&lt;T&gt;(token: Token&lt;T&gt;, implementation: Constructor&lt;T&gt;): void {
    this.services.set(token, implementation);
    this.singletons.set(token, null);
  }
  
  resolve&lt;T&gt;(token: Token&lt;T&gt;): T {
    if (this.singletons.has(token)) {
      let instance = this.singletons.get(token);
      if (!instance) {
        instance = this.createInstance(token);
        this.singletons.set(token, instance);
      }
      return instance;
    }
    
    return this.createInstance(token);
  }
  
  private createInstance&lt;T&gt;(token: Token&lt;T&gt;): T {
    const implementation = this.services.get(token);
    if (!implementation) {
      throw new Error(`Service ${String(token)} not found`);
    }
    
    // è·å–æ„é€ å‡½æ•°å‚æ•°ç±»å‹
    const dependencies = this.getDependencies(implementation);
    const resolvedDependencies = dependencies.map(dep =&gt; this.resolve(dep));
    
    return new implementation(...resolvedDependencies);
  }
  
  private getDependencies(constructor: Constructor): Token&lt;any&gt;[] {
    // ä½¿ç”¨reflect-metadataè·å–ä¾èµ–
    return Reflect.getMetadata('design:paramtypes', constructor) || [];
  }
}

// ä½¿ç”¨è£…é¥°å™¨ç®€åŒ–æ³¨å…¥
export function Injectable&lt;T extends Constructor&gt;(constructor: T) {
  return constructor;
}

export function Inject(token: Token&lt;any&gt;) {
  return function (target: any, propertyKey: string | symbol | undefined, parameterIndex: number) {
    const existingTokens = Reflect.getMetadata('design:paramtypes', target) || [];
    existingTokens[parameterIndex] = token;
    Reflect.defineMetadata('design:paramtypes', existingTokens, target);
  };
}

// ä½¿ç”¨ç¤ºä¾‹
@Injectable
export class UserService {
  constructor(
    @Inject('DATABASE') private db: Database,
    @Inject('LOGGER') private logger: Logger
  ) {}
}
</code></pre>
<p>TypeScriptä¸ºJavaScriptæ¨¡å—åŒ–å¼€å‘å¸¦æ¥äº†å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿæ”¯æŒï¼Œä¸ä»…æé«˜äº†ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡ï¼Œè¿˜ä¸ºå¤§å‹é¡¹ç›®çš„æ¨¡å—åŒ–æ¶æ„æä¾›äº†åšå®çš„åŸºç¡€ã€‚æŒæ¡TypeScriptçš„æ¨¡å—ç³»ç»Ÿå’Œæœ€ä½³å®è·µï¼Œæ˜¯ç°ä»£å‰ç«¯å¼€å‘çš„å¿…å¤‡æŠ€èƒ½ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æµè§ˆå™¨ä¸­çš„æ¨¡å—">è¿è¡Œç¯å¢ƒå·®å¼‚</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ— æ„å»ºå¼€å‘"><a class="header" href="#æ— æ„å»ºå¼€å‘">æ— æ„å»ºå¼€å‘</a></h1>
<p>åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œéšç€æµè§ˆå™¨å¯¹ ES æ¨¡å—å’Œç°ä»£ CSS ç‰¹æ€§çš„æ™®éæ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ç§å…¨æ–°çš„å¼€å‘æ–¹å¼ï¼š<strong>æ— æ„å»ºå¼€å‘</strong>ï¼ˆNo Build Developmentï¼‰ã€‚è¿™ç§æ–¹å¼é¿å…äº†å¤æ‚çš„æ„å»ºå·¥å…·é“¾ï¼Œç›´æ¥åˆ©ç”¨æµè§ˆå™¨çš„åŸç”Ÿèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬ç« èŠ‚çš„æ ¸å¿ƒç†å¿µå—åˆ° DHH æ–‡ç«  <a href="https://world.hey.com/dhh/you-can-t-get-faster-than-no-build-7a44131c">â€œYou canâ€™t get faster than No Buildâ€</a> çš„å¯å‘ã€‚</p>
</blockquote>
<h2 id="æ ¸å¿ƒç†å¿µ"><a class="header" href="#æ ¸å¿ƒç†å¿µ">æ ¸å¿ƒç†å¿µ</a></h2>
<p>â€œæ— æ„å»ºâ€œå¹¶ä¸æ„å‘³ç€å®Œå…¨æ²¡æœ‰ä»»ä½•å¤„ç†æ­¥éª¤ï¼Œè€Œæ˜¯æŒ‡ï¼š</p>
<ul>
<li><strong>é¿å…å¤æ‚çš„ç¼–è¯‘è¿‡ç¨‹</strong>ï¼šä¸éœ€è¦ Webpackã€Rollupã€esbuild ç­‰æ‰“åŒ…å·¥å…·</li>
<li><strong>åˆ©ç”¨åŸç”Ÿç‰¹æ€§</strong>ï¼šå……åˆ†ä½¿ç”¨æµè§ˆå™¨å·²ç»æ”¯æŒçš„ç°ä»£ JavaScript å’Œ CSS ç‰¹æ€§</li>
<li><strong>ç®€åŒ–å¼€å‘æµç¨‹</strong>ï¼šå‡å°‘æ„å»ºæ—¶é—´ï¼Œæå‡å¼€å‘ä½“éªŒ</li>
</ul>
<blockquote>
<p>â€œYou canâ€™t get faster than No Buildâ€ - DHH</p>
</blockquote>
<h2 id="æŠ€æœ¯åŸºç¡€"><a class="header" href="#æŠ€æœ¯åŸºç¡€">æŠ€æœ¯åŸºç¡€</a></h2>
<h3 id="es-æ¨¡å—åŸç”Ÿæ”¯æŒ"><a class="header" href="#es-æ¨¡å—åŸç”Ÿæ”¯æŒ">ES æ¨¡å—åŸç”Ÿæ”¯æŒ</a></h3>
<p>ç°ä»£æµè§ˆå™¨å·²ç»åŸç”Ÿæ”¯æŒ ES æ¨¡å—ï¼Œæ— éœ€ç¼–è¯‘ï¼š</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;script type="module" src="./main.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-javascript">// main.js
import { utils } from './utils.js';
import { API_BASE } from './config.js';

console.log(utils.formatDate(new Date()));
</code></pre>
<h3 id="import-maps"><a class="header" href="#import-maps">Import Maps</a></h3>
<p><a href="https://caniuse.com/import-maps">Import Maps</a> è®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è£¸æ¨¡å—è¯´æ˜ç¬¦ï¼Œæ— éœ€æ‰“åŒ…å·¥å…·ï¼š</p>
<pre><code class="language-html">&lt;script type="importmap"&gt;
{
  "imports": {
    "lodash": "https://cdn.skypack.dev/lodash-es",
    "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js",
    "@/": "./src/"
  }
}
&lt;/script&gt;
</code></pre>
<pre><code class="language-javascript">// ç°åœ¨å¯ä»¥ç›´æ¥å¯¼å…¥
import _ from 'lodash';
import { createApp } from 'vue';
import { helper } from '@/utils/helper.js';
</code></pre>
<h3 id="ç°ä»£-css-ç‰¹æ€§"><a class="header" href="#ç°ä»£-css-ç‰¹æ€§">ç°ä»£ CSS ç‰¹æ€§</a></h3>
<p>CSS åµŒå¥—å’Œè‡ªå®šä¹‰å±æ€§ç­‰ç‰¹æ€§å·²è¢«å¹¿æ³›æ”¯æŒï¼š</p>
<pre><code class="language-css">:root {
  --primary-color: #3498db;
  --border-radius: 4px;
}

.card {
  background: white;
  border-radius: var(--border-radius);
  
  .header {
    color: var(--primary-color);
    
    &amp;:hover {
      opacity: 0.8;
    }
  }
}
</code></pre>
<h2 id="å®è·µæ¡ˆä¾‹"><a class="header" href="#å®è·µæ¡ˆä¾‹">å®è·µæ¡ˆä¾‹</a></h2>
<h3 id="åŸºç¡€é¡¹ç›®ç»“æ„"><a class="header" href="#åŸºç¡€é¡¹ç›®ç»“æ„">åŸºç¡€é¡¹ç›®ç»“æ„</a></h3>
<pre><code>project/
â”œâ”€â”€ index.html
â”œâ”€â”€ main.js
â”œâ”€â”€ styles.css
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ header.js
â”‚   â”‚   â””â”€â”€ footer.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ helpers.js
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ client.js
</code></pre>
<h3 id="å…¥å£æ–‡ä»¶"><a class="header" href="#å…¥å£æ–‡ä»¶">å…¥å£æ–‡ä»¶</a></h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="zh-CN"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;æ— æ„å»ºå¼€å‘ç¤ºä¾‹&lt;/title&gt;
    &lt;link rel="stylesheet" href="./styles.css"&gt;
    
    &lt;script type="importmap"&gt;
    {
      "imports": {
        "@/": "./src/",
        "lit": "https://cdn.skypack.dev/lit"
      }
    }
    &lt;/script&gt;
    
    &lt;script type="module" src="./main.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="app"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="ç»„ä»¶æ¨¡å—"><a class="header" href="#ç»„ä»¶æ¨¡å—">ç»„ä»¶æ¨¡å—</a></h3>
<pre><code class="language-javascript">// src/components/header.js
export class HeaderComponent {
  constructor(title) {
    this.title = title;
  }
  
  render() {
    return `
      &lt;header class="app-header"&gt;
        &lt;h1&gt;${this.title}&lt;/h1&gt;
      &lt;/header&gt;
    `;
  }
}
</code></pre>
<pre><code class="language-javascript">// main.js
import { HeaderComponent } from '@/components/header.js';
import { initializeApp } from '@/utils/helpers.js';

const header = new HeaderComponent('æˆ‘çš„åº”ç”¨');
document.getElementById('app').innerHTML = header.render();

initializeApp();
</code></pre>
<h2 id="ä¼˜åŠ¿ä¸é™åˆ¶"><a class="header" href="#ä¼˜åŠ¿ä¸é™åˆ¶">ä¼˜åŠ¿ä¸é™åˆ¶</a></h2>
<h3 id="ä¼˜åŠ¿"><a class="header" href="#ä¼˜åŠ¿">ä¼˜åŠ¿</a></h3>
<ol>
<li>
<p><strong>æé€Ÿå¼€å‘ä½“éªŒ</strong></p>
<ul>
<li>æ— ç¼–è¯‘ç­‰å¾…æ—¶é—´</li>
<li>æ–‡ä»¶ä¿å­˜å³åˆ·æ–°</li>
<li>è°ƒè¯•æ›´ç›´è§‚</li>
</ul>
</li>
<li>
<p><strong>ç®€åŒ–çš„å·¥å…·é“¾</strong></p>
<ul>
<li>å‡å°‘ä¾èµ–åŒ…</li>
<li>é™ä½é…ç½®å¤æ‚åº¦</li>
<li>æ›´å°‘çš„å‡ºé”™ç‚¹</li>
</ul>
</li>
<li>
<p><strong>åŸç”Ÿæ€§èƒ½</strong></p>
<ul>
<li>æµè§ˆå™¨ä¼˜åŒ–çš„æ¨¡å—åŠ è½½</li>
<li>HTTP/2 å¤šè·¯å¤ç”¨ä¼˜åŠ¿</li>
<li>æŒ‰éœ€åŠ è½½å¤©ç„¶æ”¯æŒ</li>
</ul>
</li>
</ol>
<h3 id="é™åˆ¶ä¸è€ƒè™‘"><a class="header" href="#é™åˆ¶ä¸è€ƒè™‘">é™åˆ¶ä¸è€ƒè™‘</a></h3>
<ol>
<li>
<p><strong>å…¼å®¹æ€§è¦æ±‚</strong></p>
<ul>
<li>éœ€è¦æ”¯æŒ ES æ¨¡å—çš„ç°ä»£æµè§ˆå™¨</li>
<li>Import Maps çš„æ”¯æŒç›¸å¯¹è¾ƒæ–°</li>
</ul>
</li>
<li>
<p><strong>å¼€å‘çº¦æŸ</strong></p>
<ul>
<li>ä¸èƒ½ä½¿ç”¨éœ€è¦ç¼–è¯‘çš„è¯­æ³•ï¼ˆJSXã€TypeScriptï¼‰</li>
<li>ç¬¬ä¸‰æ–¹åº“éœ€è¦æœ‰ ES æ¨¡å—ç‰ˆæœ¬</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿäº§ç¯å¢ƒ</strong></p>
<ul>
<li>å¯èƒ½éœ€è¦ HTTP/2 æ”¯æŒ</li>
<li>æ–‡ä»¶æ•°é‡è¾ƒå¤šæ—¶çš„ç½‘ç»œå¼€é”€</li>
</ul>
</li>
</ol>
<h2 id="é€‚ç”¨åœºæ™¯-1"><a class="header" href="#é€‚ç”¨åœºæ™¯-1">é€‚ç”¨åœºæ™¯</a></h2>
<h3 id="é€‚åˆçš„é¡¹ç›®"><a class="header" href="#é€‚åˆçš„é¡¹ç›®">é€‚åˆçš„é¡¹ç›®</a></h3>
<ul>
<li><strong>åŸå‹å¼€å‘</strong>ï¼šå¿«é€ŸéªŒè¯æƒ³æ³•</li>
<li><strong>å°å‹é¡¹ç›®</strong>ï¼šå¤æ‚åº¦ä¸é«˜çš„åº”ç”¨</li>
<li><strong>æ•™å­¦æ¼”ç¤º</strong>ï¼šå‡å°‘å­¦ä¹ æ›²çº¿</li>
<li><strong>å†…éƒ¨å·¥å…·</strong>ï¼šæ§åˆ¶è¿è¡Œç¯å¢ƒçš„åœºæ™¯</li>
</ul>
<h3 id="ä¸é€‚åˆçš„åœºæ™¯"><a class="header" href="#ä¸é€‚åˆçš„åœºæ™¯">ä¸é€‚åˆçš„åœºæ™¯</a></h3>
<ul>
<li><strong>å¤§å‹å›¢é˜Ÿé¡¹ç›®</strong>ï¼šéœ€è¦ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥å’Œè§„èŒƒ</li>
<li><strong>å¤æ‚æ¡†æ¶åº”ç”¨</strong>ï¼šä¾èµ–å¤§é‡ç¼–è¯‘æ—¶ä¼˜åŒ–</li>
<li><strong>å‘åå…¼å®¹è¦æ±‚</strong>ï¼šéœ€è¦æ”¯æŒæ—§ç‰ˆæµè§ˆå™¨</li>
</ul>
<h2 id="å·¥å…·æ”¯æŒ"><a class="header" href="#å·¥å…·æ”¯æŒ">å·¥å…·æ”¯æŒ</a></h2>
<h3 id="å¼€å‘æœåŠ¡å™¨"><a class="header" href="#å¼€å‘æœåŠ¡å™¨">å¼€å‘æœåŠ¡å™¨</a></h3>
<p>ç®€å•çš„ HTTP æœåŠ¡å™¨å³å¯ï¼Œæ”¯æŒ ES æ¨¡å—ï¼š</p>
<pre><code class="language-bash"># Python
python -m http.server 8080

# Node.js
npx http-server

# æˆ–ä½¿ç”¨æ”¯æŒæ¨¡å—çš„å¼€å‘æœåŠ¡å™¨
npx es-dev-server
</code></pre>
<h3 id="ç¼–è¾‘å™¨é…ç½®"><a class="header" href="#ç¼–è¾‘å™¨é…ç½®">ç¼–è¾‘å™¨é…ç½®</a></h3>
<p>ç°ä»£ç¼–è¾‘å™¨å·²ç»å¾ˆå¥½åœ°æ”¯æŒåŸç”Ÿ ES æ¨¡å—ï¼š</p>
<pre><code class="language-json">// .vscode/settings.json
{
  "typescript.preferences.includePackageJsonAutoImports": "on",
  "typescript.suggest.autoImports": true
}
</code></pre>
<h2 id="ä¸ä¼ ç»Ÿæ„å»ºçš„å¯¹æ¯”"><a class="header" href="#ä¸ä¼ ç»Ÿæ„å»ºçš„å¯¹æ¯”">ä¸ä¼ ç»Ÿæ„å»ºçš„å¯¹æ¯”</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>æ–¹é¢</th><th>æ— æ„å»ºå¼€å‘</th><th>ä¼ ç»Ÿæ„å»º</th></tr>
</thead>
<tbody>
<tr><td>å¯åŠ¨é€Ÿåº¦</td><td>å³æ—¶</td><td>éœ€è¦ç¼–è¯‘æ—¶é—´</td></tr>
<tr><td>çƒ­æ›´æ–°</td><td>åŸç”Ÿæ”¯æŒ</td><td>éœ€è¦å·¥å…·æ”¯æŒ</td></tr>
<tr><td>è°ƒè¯•ä½“éªŒ</td><td>ç›´æ¥è°ƒè¯•æºç </td><td>éœ€è¦ Source Map</td></tr>
<tr><td>éƒ¨ç½²å¤æ‚åº¦</td><td>ç®€å•</td><td>éœ€è¦æ„å»ºæ­¥éª¤</td></tr>
<tr><td>æ–‡ä»¶å¤§å°</td><td>æœªå‹ç¼©</td><td>ä¼˜åŒ–å‹ç¼©</td></tr>
<tr><td>å…¼å®¹æ€§</td><td>ç°ä»£æµè§ˆå™¨</td><td>å¯é…ç½®ç›®æ ‡</td></tr>
</tbody>
</table>
</div>
<h2 id="æ€»ç»“-16"><a class="header" href="#æ€»ç»“-16">æ€»ç»“</a></h2>
<p>æ— æ„å»ºå¼€å‘ä»£è¡¨äº† Web å¼€å‘çš„ä¸€ç§å›å½’ï¼šå›å½’åˆ° Web å¹³å°çš„åŸç”Ÿèƒ½åŠ›ã€‚éšç€æµè§ˆå™¨å¯¹ç°ä»£æ ‡å‡†çš„æ”¯æŒè¶Šæ¥è¶Šå®Œå–„ï¼Œè¿™ç§å¼€å‘æ–¹å¼åœ¨ç‰¹å®šåœºæ™¯ä¸‹æä¾›äº†æä½³çš„å¼€å‘ä½“éªŒã€‚</p>
<p>é€‰æ‹©æ˜¯å¦ä½¿ç”¨æ— æ„å»ºå¼€å‘ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®çš„å…·ä½“éœ€æ±‚ã€å›¢é˜ŸæŠ€èƒ½å’Œç›®æ ‡ç”¨æˆ·æ¥æƒè¡¡ã€‚å®ƒä¸æ˜¯é“¶å¼¹ï¼Œä½†ç¡®å®ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é€‰æ‹©ã€‚</p>
<blockquote>
<p>æœ€å¥½çš„æ„å»ºå·¥å…·å°±æ˜¯ä¸éœ€è¦æ„å»ºå·¥å…·ã€‚</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æµè§ˆå™¨ä¸­çš„æ¨¡å—"><a class="header" href="#æµè§ˆå™¨ä¸­çš„æ¨¡å—">æµè§ˆå™¨ä¸­çš„æ¨¡å—</a></h1>
<p>æµè§ˆå™¨ä½œä¸º JavaScript æ¨¡å—åŒ–çš„é‡è¦è¿è¡Œç¯å¢ƒï¼Œç»å†äº†ä»æ— åŸç”Ÿæ”¯æŒåˆ°å…¨é¢æ”¯æŒ ES æ¨¡å—çš„å‘å±•å†ç¨‹ã€‚ç°ä»£æµè§ˆå™¨å¯¹æ¨¡å—çš„æ”¯æŒä¸ºå‰ç«¯å¼€å‘å¸¦æ¥äº†é©å‘½æ€§çš„å˜åŒ–ã€‚</p>
<h2 id="æµè§ˆå™¨æ¨¡å—æ”¯æŒæ¼”è¿›"><a class="header" href="#æµè§ˆå™¨æ¨¡å—æ”¯æŒæ¼”è¿›">æµè§ˆå™¨æ¨¡å—æ”¯æŒæ¼”è¿›</a></h2>
<h3 id="å†å²å‘å±•é˜¶æ®µ"><a class="header" href="#å†å²å‘å±•é˜¶æ®µ">å†å²å‘å±•é˜¶æ®µ</a></h3>
<h4 id="1-æ—©æœŸé˜¶æ®µ-2009-2014"><a class="header" href="#1-æ—©æœŸé˜¶æ®µ-2009-2014">1. <strong>æ—©æœŸé˜¶æ®µ</strong> (2009-2014)</a></h4>
<ul>
<li><strong>æ— åŸç”Ÿæ¨¡å—æ”¯æŒ</strong>ï¼šæµè§ˆå™¨åªèƒ½æ‰§è¡Œå•ä¸ª JS æ–‡ä»¶</li>
<li><strong>å…¨å±€å˜é‡ä¾èµ–</strong>ï¼šé€šè¿‡å…¨å±€å¯¹è±¡å…±äº«ä»£ç </li>
<li><strong>æ‰‹åŠ¨ä¾èµ–ç®¡ç†</strong>ï¼šå¼€å‘è€…éœ€è¦æ‰‹åŠ¨æ§åˆ¶è„šæœ¬åŠ è½½é¡ºåº</li>
</ul>
<pre><code class="language-html">&lt;!-- æ—©æœŸçš„ä¾èµ–ç®¡ç†æ–¹å¼ --&gt;
&lt;script src="jquery.js"&gt;&lt;/script&gt;
&lt;script src="bootstrap.js"&gt;&lt;/script&gt; &lt;!-- ä¾èµ– jQuery --&gt;
&lt;script src="app.js"&gt;&lt;/script&gt;      &lt;!-- ä¾èµ–å‰ä¸¤è€… --&gt;
</code></pre>
<h4 id="2-amdrequirejs-æ—¶ä»£-2011-2015"><a class="header" href="#2-amdrequirejs-æ—¶ä»£-2011-2015">2. <strong>AMD/RequireJS æ—¶ä»£</strong> (2011-2015)</a></h4>
<ul>
<li><strong>å¼‚æ­¥æ¨¡å—å®šä¹‰</strong>ï¼šRequireJS æä¾›æµè§ˆå™¨ç«¯æ¨¡å—åŒ–</li>
<li><strong>åŠ¨æ€åŠ è½½</strong>ï¼šæ”¯æŒæŒ‰éœ€åŠ è½½æ¨¡å—</li>
<li><strong>ä¾èµ–å£°æ˜</strong>ï¼šæ˜ç¡®çš„ä¾èµ–å…³ç³»ç®¡ç†</li>
</ul>
<pre><code class="language-javascript">// AMD æ¨¡å—å®šä¹‰
define(['jquery', 'underscore'], function($, _) {
  return {
    init: function() {
      // æ¨¡å—é€»è¾‘
    }
  };
});
</code></pre>
<h4 id="3-æ‰“åŒ…å·¥å…·æ—¶ä»£-2012-2020"><a class="header" href="#3-æ‰“åŒ…å·¥å…·æ—¶ä»£-2012-2020">3. <strong>æ‰“åŒ…å·¥å…·æ—¶ä»£</strong> (2012-2020)</a></h4>
<ul>
<li><strong>Webpack/Browserify</strong>ï¼šå°† Node.js æ¨¡å—ç³»ç»Ÿå¸¦åˆ°æµè§ˆå™¨</li>
<li><strong>æ„å»ºæ—¶è§£æ</strong>ï¼šç¼–è¯‘æ—¶è§£å†³æ¨¡å—ä¾èµ–</li>
<li><strong>å•æ–‡ä»¶è¾“å‡º</strong>ï¼šæ‰“åŒ…æˆä¸€ä¸ªæˆ–å‡ ä¸ªæ–‡ä»¶</li>
</ul>
<h4 id="4-åŸç”Ÿ-es-æ¨¡å—æ—¶ä»£-2017-è‡³ä»Š"><a class="header" href="#4-åŸç”Ÿ-es-æ¨¡å—æ—¶ä»£-2017-è‡³ä»Š">4. <strong>åŸç”Ÿ ES æ¨¡å—æ—¶ä»£</strong> (2017-è‡³ä»Š)</a></h4>
<ul>
<li><strong>ES6 æ¨¡å—åŸç”Ÿæ”¯æŒ</strong>ï¼šæ‰€æœ‰ç°ä»£æµè§ˆå™¨æ”¯æŒ</li>
<li><strong>é™æ€å¯¼å…¥</strong>ï¼šç¼–è¯‘æ—¶ç¡®å®šä¾èµ–å…³ç³»</li>
<li><strong>åŠ¨æ€å¯¼å…¥</strong>ï¼šè¿è¡Œæ—¶æŒ‰éœ€åŠ è½½</li>
</ul>
<h2 id="es-æ¨¡å—åœ¨æµè§ˆå™¨ä¸­çš„ä½¿ç”¨"><a class="header" href="#es-æ¨¡å—åœ¨æµè§ˆå™¨ä¸­çš„ä½¿ç”¨">ES æ¨¡å—åœ¨æµè§ˆå™¨ä¸­çš„ä½¿ç”¨</a></h2>
<h3 id="åŸºç¡€è¯­æ³•æ”¯æŒ"><a class="header" href="#åŸºç¡€è¯­æ³•æ”¯æŒ">åŸºç¡€è¯­æ³•æ”¯æŒ</a></h3>
<h4 id="é™æ€å¯¼å…¥å¯¼å‡º"><a class="header" href="#é™æ€å¯¼å…¥å¯¼å‡º"><strong>é™æ€å¯¼å…¥/å¯¼å‡º</strong></a></h4>
<pre><code class="language-html">&lt;!-- å¯ç”¨æ¨¡å—æ¨¡å¼ --&gt;
&lt;script type="module"&gt;
  import { utils } from './utils.js';
  import React from './react.js';
  
  console.log(utils.formatDate(new Date()));
&lt;/script&gt;
</code></pre>
<pre><code class="language-javascript">// utils.js
export function formatDate(date) {
  return date.toISOString().split('T')[0];
}

export const API_URL = 'https://api.example.com';

// é»˜è®¤å¯¼å‡º
export default class Logger {
  log(message) {
    console.log(`[${new Date().toISOString()}] ${message}`);
  }
}
</code></pre>
<h4 id="åŠ¨æ€å¯¼å…¥-1"><a class="header" href="#åŠ¨æ€å¯¼å…¥-1"><strong>åŠ¨æ€å¯¼å…¥</strong></a></h4>
<pre><code class="language-javascript">// æ¡ä»¶åŠ è½½
async function loadFeature() {
  if (window.innerWidth &gt; 768) {
    const { default: DesktopUI } = await import('./desktop-ui.js');
    return new DesktopUI();
  } else {
    const { default: MobileUI } = await import('./mobile-ui.js');
    return new MobileUI();
  }
}

// æ‡’åŠ è½½è·¯ç”±
async function handleRoute(path) {
  switch (path) {
    case '/dashboard':
      const dashboard = await import('./pages/dashboard.js');
      dashboard.render();
      break;
    case '/profile':
      const profile = await import('./pages/profile.js');
      profile.render();
      break;
  }
}
</code></pre>
<h3 id="æ¨¡å—è§£æè§„åˆ™"><a class="header" href="#æ¨¡å—è§£æè§„åˆ™">æ¨¡å—è§£æè§„åˆ™</a></h3>
<h4 id="ç›¸å¯¹è·¯å¾„å¯¼å…¥"><a class="header" href="#ç›¸å¯¹è·¯å¾„å¯¼å…¥"><strong>ç›¸å¯¹è·¯å¾„å¯¼å…¥</strong></a></h4>
<pre><code class="language-javascript">// å½“å‰ç›®å½•
import { config } from './config.js';

// çˆ¶ç›®å½•
import { utils } from '../utils/helpers.js';

// æ·±å±‚è·¯å¾„
import { Component } from '../../shared/components/Button.js';
</code></pre>
<h4 id="ç»å¯¹è·¯å¾„å¯¼å…¥"><a class="header" href="#ç»å¯¹è·¯å¾„å¯¼å…¥"><strong>ç»å¯¹è·¯å¾„å¯¼å…¥</strong></a></h4>
<pre><code class="language-javascript">// å®Œæ•´ URL
import { lodash } from 'https://cdn.skypack.dev/lodash';

// ä»æ ¹è·¯å¾„
import { constants } from '/js/constants.js';
</code></pre>
<h4 id="import-maps-ç°ä»£æ–¹æ¡ˆ"><a class="header" href="#import-maps-ç°ä»£æ–¹æ¡ˆ"><strong>Import Maps</strong> (ç°ä»£æ–¹æ¡ˆ)</a></h4>
<pre><code class="language-html">&lt;script type="importmap"&gt;
{
  "imports": {
    "react": "https://esm.sh/react@18",
    "react-dom": "https://esm.sh/react-dom@18",
    "lodash": "https://cdn.skypack.dev/lodash",
    "@/": "/src/",
    "@utils/": "/src/utils/"
  }
}
&lt;/script&gt;

&lt;script type="module"&gt;
  // ä½¿ç”¨æ˜ å°„çš„æ¨¡å—å
  import React from 'react';
  import { render } from 'react-dom';
  import { debounce } from 'lodash';
  import { API } from '@/api.js';
  import { helpers } from '@utils/helpers.js';
&lt;/script&gt;
</code></pre>
<h2 id="æµè§ˆå™¨ç¯å¢ƒç‰¹æ€§"><a class="header" href="#æµè§ˆå™¨ç¯å¢ƒç‰¹æ€§">æµè§ˆå™¨ç¯å¢ƒç‰¹æ€§</a></h2>
<h3 id="ç½‘ç»œåŠ è½½ç‰¹æ€§"><a class="header" href="#ç½‘ç»œåŠ è½½ç‰¹æ€§"><strong>ç½‘ç»œåŠ è½½ç‰¹æ€§</strong></a></h3>
<h4 id="http2-å¤šè·¯å¤ç”¨"><a class="header" href="#http2-å¤šè·¯å¤ç”¨"><strong>HTTP/2 å¤šè·¯å¤ç”¨</strong></a></h4>
<pre><code class="language-javascript">// ç°ä»£æµè§ˆå™¨å¯ä»¥å¹¶è¡ŒåŠ è½½å¤šä¸ªæ¨¡å—
import('./module1.js');  // å¹¶è¡Œè¯·æ±‚
import('./module2.js');  // å¹¶è¡Œè¯·æ±‚  
import('./module3.js');  // å¹¶è¡Œè¯·æ±‚

// ä¾èµ–å…³ç³»è‡ªåŠ¨è§£æ
import { useEffect } from 'react';     // å…ˆåŠ è½½
import { Component } from './comp.js'; // å†åŠ è½½ä¾èµ– react çš„æ¨¡å—
</code></pre>
<h4 id="é¢„åŠ è½½ä¼˜åŒ–"><a class="header" href="#é¢„åŠ è½½ä¼˜åŒ–"><strong>é¢„åŠ è½½ä¼˜åŒ–</strong></a></h4>
<pre><code class="language-html">&lt;!-- æ¨¡å—é¢„åŠ è½½ --&gt;
&lt;link rel="modulepreload" href="./critical-module.js"&gt;
&lt;link rel="modulepreload" href="./utils.js"&gt;

&lt;!-- é¢„è§£æ DNS --&gt;
&lt;link rel="dns-prefetch" href="//cdn.example.com"&gt;

&lt;!-- é¢„è¿æ¥åˆ°å¤–éƒ¨åŸŸ --&gt;
&lt;link rel="preconnect" href="https://fonts.googleapis.com"&gt;
</code></pre>
<h4 id="ç¼“å­˜ç­–ç•¥"><a class="header" href="#ç¼“å­˜ç­–ç•¥"><strong>ç¼“å­˜ç­–ç•¥</strong></a></h4>
<pre><code class="language-javascript">// æœåŠ¡å™¨ç«¯è®¾ç½®ç¼“å­˜å¤´
// Cache-Control: public, max-age=31536000, immutable

// ç‰ˆæœ¬åŒ–æ–‡ä»¶å
import { utils } from './utils.a1b2c3.js';

// åŠ¨æ€ç‰ˆæœ¬æ§åˆ¶
const version = '1.2.3';
const module = await import(`./api.${version}.js`);
</code></pre>
<h3 id="å®‰å…¨ç‰¹æ€§"><a class="header" href="#å®‰å…¨ç‰¹æ€§"><strong>å®‰å…¨ç‰¹æ€§</strong></a></h3>
<h4 id="cors-ç­–ç•¥"><a class="header" href="#cors-ç­–ç•¥"><strong>CORS ç­–ç•¥</strong></a></h4>
<pre><code class="language-javascript">// è·¨åŸŸæ¨¡å—åŠ è½½éœ€è¦ CORS æ”¯æŒ
try {
  const external = await import('https://external-cdn.com/module.js');
} catch (error) {
  console.error('CORS é”™è¯¯:', error);
  // é™çº§æ–¹æ¡ˆ
  const fallback = await import('./local-fallback.js');
}
</code></pre>
<h4 id="csp-å†…å®¹å®‰å…¨ç­–ç•¥"><a class="header" href="#csp-å†…å®¹å®‰å…¨ç­–ç•¥"><strong>CSP (å†…å®¹å®‰å…¨ç­–ç•¥)</strong></a></h4>
<pre><code class="language-html">&lt;!-- å…è®¸æ¨¡å—è„šæœ¬ --&gt;
&lt;meta http-equiv="Content-Security-Policy" 
      content="script-src 'self' 'unsafe-inline' https://cdn.skypack.dev;"&gt;

&lt;script type="module"&gt;
  // ç¬¦åˆ CSP ç­–ç•¥çš„æ¨¡å—å¯¼å…¥
  import { lib } from 'https://cdn.skypack.dev/lib';
&lt;/script&gt;
</code></pre>
<h4 id="subresource-integrity-sri"><a class="header" href="#subresource-integrity-sri"><strong>Subresource Integrity (SRI)</strong></a></h4>
<pre><code class="language-html">&lt;!-- ç¡®ä¿å¤–éƒ¨æ¨¡å—å®Œæ•´æ€§ --&gt;
&lt;script type="module" 
        src="https://cdn.example.com/module.js"
        integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"
        crossorigin="anonymous"&gt;
&lt;/script&gt;
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-2"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-2">æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</a></h2>
<h3 id="ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½"><a class="header" href="#ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½"><strong>ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½</strong></a></h3>
<h4 id="è·¯ç”±çº§åˆ†å‰²"><a class="header" href="#è·¯ç”±çº§åˆ†å‰²"><strong>è·¯ç”±çº§åˆ†å‰²</strong></a></h4>
<pre><code class="language-javascript">class Router {
  async navigate(path) {
    this.showLoading();
    
    try {
      const route = this.routes[path];
      const module = await import(route.component);
      
      this.hideLoading();
      module.default.render();
    } catch (error) {
      this.showError('é¡µé¢åŠ è½½å¤±è´¥');
    }
  }
}

const router = new Router({
  routes: {
    '/': { component: './pages/home.js' },
    '/about': { component: './pages/about.js' },
    '/products': { component: './pages/products.js' }
  }
});
</code></pre>
<h4 id="ç»„ä»¶çº§æ‡’åŠ è½½"><a class="header" href="#ç»„ä»¶çº§æ‡’åŠ è½½"><strong>ç»„ä»¶çº§æ‡’åŠ è½½</strong></a></h4>
<pre><code class="language-javascript">class LazyComponent {
  constructor(importFn) {
    this.importFn = importFn;
    this.component = null;
  }
  
  async render(container) {
    if (!this.component) {
      const module = await this.importFn();
      this.component = module.default;
    }
    
    return this.component.render(container);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const HeavyChart = new LazyComponent(() =&gt; import('./heavy-chart.js'));

document.querySelector('#load-chart').addEventListener('click', async () =&gt; {
  await HeavyChart.render(document.querySelector('#chart-container'));
});
</code></pre>
<h3 id="èµ„æºä¼˜å…ˆçº§ç®¡ç†"><a class="header" href="#èµ„æºä¼˜å…ˆçº§ç®¡ç†"><strong>èµ„æºä¼˜å…ˆçº§ç®¡ç†</strong></a></h3>
<h4 id="critical-resource-first"><a class="header" href="#critical-resource-first"><strong>Critical Resource First</strong></a></h4>
<pre><code class="language-html">&lt;!-- å…³é”®èµ„æºä¼˜å…ˆåŠ è½½ --&gt;
&lt;link rel="modulepreload" href="./critical-app.js" as="script"&gt;
&lt;link rel="modulepreload" href="./critical-styles.js" as="script"&gt;

&lt;script type="module"&gt;
  // ç«‹å³åŠ è½½å…³é”®æ¨¡å—
  import('./critical-app.js').then(app =&gt; app.init());
  
  // å»¶è¿ŸåŠ è½½éå…³é”®æ¨¡å—
  setTimeout(() =&gt; {
    import('./analytics.js');
    import('./social-widgets.js');
  }, 1000);
&lt;/script&gt;
</code></pre>
<h4 id="intersection-observer-æ‡’åŠ è½½"><a class="header" href="#intersection-observer-æ‡’åŠ è½½"><strong>Intersection Observer æ‡’åŠ è½½</strong></a></h4>
<pre><code class="language-javascript">class ModuleLazyLoader {
  constructor() {
    this.observer = new IntersectionObserver(this.handleIntersection.bind(this));
  }
  
  observe(element, moduleUrl) {
    element.dataset.moduleUrl = moduleUrl;
    this.observer.observe(element);
  }
  
  async handleIntersection(entries) {
    for (const entry of entries) {
      if (entry.isIntersecting) {
        const moduleUrl = entry.target.dataset.moduleUrl;
        const module = await import(moduleUrl);
        
        module.default.render(entry.target);
        this.observer.unobserve(entry.target);
      }
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const loader = new ModuleLazyLoader();
loader.observe(document.querySelector('#feature-section'), './feature.js');
</code></pre>
<h2 id="é”™è¯¯å¤„ç†å’Œè°ƒè¯•"><a class="header" href="#é”™è¯¯å¤„ç†å’Œè°ƒè¯•">é”™è¯¯å¤„ç†å’Œè°ƒè¯•</a></h2>
<h3 id="æ¨¡å—åŠ è½½é”™è¯¯å¤„ç†"><a class="header" href="#æ¨¡å—åŠ è½½é”™è¯¯å¤„ç†"><strong>æ¨¡å—åŠ è½½é”™è¯¯å¤„ç†</strong></a></h3>
<pre><code class="language-javascript">class ModuleLoader {
  async loadModule(url, retries = 3) {
    for (let i = 0; i &lt; retries; i++) {
      try {
        return await import(url);
      } catch (error) {
        console.warn(`æ¨¡å—åŠ è½½å¤±è´¥ (${i + 1}/${retries}):`, error);
        
        if (i === retries - 1) {
          // æœ€ç»ˆå¤±è´¥ï¼Œå°è¯•é™çº§æ–¹æ¡ˆ
          return this.loadFallback(url);
        }
        
        // é‡è¯•å‰ç­‰å¾…
        await new Promise(resolve =&gt; setTimeout(resolve, 1000 * (i + 1)));
      }
    }
  }
  
  async loadFallback(originalUrl) {
    const fallbackMap = {
      './analytics.js': './analytics-lite.js',
      './charts.js': './charts-basic.js'
    };
    
    const fallbackUrl = fallbackMap[originalUrl];
    if (fallbackUrl) {
      console.info('ä½¿ç”¨é™çº§æ¨¡å—:', fallbackUrl);
      return import(fallbackUrl);
    }
    
    throw new Error(`æ— æ³•åŠ è½½æ¨¡å—: ${originalUrl}`);
  }
}
</code></pre>
<h3 id="å¼€å‘ç¯å¢ƒè°ƒè¯•"><a class="header" href="#å¼€å‘ç¯å¢ƒè°ƒè¯•"><strong>å¼€å‘ç¯å¢ƒè°ƒè¯•</strong></a></h3>
<pre><code class="language-javascript">// å¼€å‘ç¯å¢ƒæ¨¡å—çƒ­é‡è½½
if (import.meta.hot) {
  import.meta.hot.accept('./utils.js', (newModule) =&gt; {
    console.log('æ¨¡å—å·²æ›´æ–°:', newModule);
    // é‡æ–°åˆå§‹åŒ–ä½¿ç”¨è¯¥æ¨¡å—çš„ç»„ä»¶
    app.updateUtils(newModule);
  });
}

// æ¨¡å—åŠ è½½æ€§èƒ½ç›‘æ§
const moduleLoadTimes = new Map();

const originalImport = window.import;
window.import = function(url) {
  const startTime = performance.now();
  
  return originalImport(url).then(module =&gt; {
    const loadTime = performance.now() - startTime;
    moduleLoadTimes.set(url, loadTime);
    console.log(`æ¨¡å— ${url} åŠ è½½è€—æ—¶: ${loadTime.toFixed(2)}ms`);
    return module;
  });
};
</code></pre>
<h2 id="å…¼å®¹æ€§å’Œé™çº§ç­–ç•¥"><a class="header" href="#å…¼å®¹æ€§å’Œé™çº§ç­–ç•¥">å…¼å®¹æ€§å’Œé™çº§ç­–ç•¥</a></h2>
<h3 id="æµè§ˆå™¨æ”¯æŒæ£€æµ‹"><a class="header" href="#æµè§ˆå™¨æ”¯æŒæ£€æµ‹"><strong>æµè§ˆå™¨æ”¯æŒæ£€æµ‹</strong></a></h3>
<pre><code class="language-javascript">// æ£€æµ‹ ES æ¨¡å—æ”¯æŒ
function supportsESModules() {
  try {
    return typeof importFn === 'function' || 'noModule' in document.createElement('script');
  } catch {
    return false;
  }
}

// æ¸è¿›å¼åŠ è½½ç­–ç•¥
if (supportsESModules()) {
  // ç°ä»£æµè§ˆå™¨ï¼šä½¿ç”¨ ES æ¨¡å—
  import('./modern-app.js').then(app =&gt; app.init());
} else {
  // æ—§æµè§ˆå™¨ï¼šåŠ è½½æ‰“åŒ…åçš„ç‰ˆæœ¬
  const script = document.createElement('script');
  script.src = './legacy-app.bundle.js';
  document.head.appendChild(script);
}
</code></pre>
<h3 id="polyfill-å’Œ-shim"><a class="header" href="#polyfill-å’Œ-shim"><strong>Polyfill å’Œ Shim</strong></a></h3>
<pre><code class="language-html">&lt;!-- ä½¿ç”¨ nomodule ä¸ºæ—§æµè§ˆå™¨æä¾›é™çº§ --&gt;
&lt;script type="module" src="./modern-app.js"&gt;&lt;/script&gt;
&lt;script nomodule src="./legacy-app.js"&gt;&lt;/script&gt;

&lt;!-- SystemJS ä½œä¸º ES æ¨¡å— polyfill --&gt;
&lt;script src="https://unpkg.com/systemjs/dist/system.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
  if (!window.supportsESModules) {
    System.import('./app.js');
  }
&lt;/script&gt;
</code></pre>
<h2 id="æœ€ä½³å®è·µæ€»ç»“"><a class="header" href="#æœ€ä½³å®è·µæ€»ç»“">æœ€ä½³å®è·µæ€»ç»“</a></h2>
<h3 id="æ€§èƒ½ä¼˜åŒ–-4"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-4"><strong>æ€§èƒ½ä¼˜åŒ–</strong></a></h3>
<ol>
<li><strong>ä½¿ç”¨ Import Maps</strong> ç®¡ç†æ¨¡å—æ˜ å°„</li>
<li><strong>å®æ–½ä»£ç åˆ†å‰²</strong> å‡å°‘åˆå§‹åŠ è½½æ—¶é—´</li>
<li><strong>åˆç†ä½¿ç”¨é¢„åŠ è½½</strong> ä¼˜åŒ–å…³é”®è·¯å¾„</li>
<li><strong>ç›‘æ§æ¨¡å—åŠ è½½æ€§èƒ½</strong> è¯†åˆ«ç“¶é¢ˆ</li>
</ol>
<h3 id="å¯ç»´æŠ¤æ€§"><a class="header" href="#å¯ç»´æŠ¤æ€§"><strong>å¯ç»´æŠ¤æ€§</strong></a></h3>
<ol>
<li><strong>æ˜ç¡®çš„æ¨¡å—è¾¹ç•Œ</strong> é¿å…å¾ªç¯ä¾èµ–</li>
<li><strong>ä¸€è‡´çš„å¯¼å…¥è·¯å¾„</strong> ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–åˆ«å</li>
<li><strong>é€‚å½“çš„é”™è¯¯å¤„ç†</strong> æä¾›é™çº§æ–¹æ¡ˆ</li>
<li><strong>æ–‡æ¡£åŒ–ä¾èµ–å…³ç³»</strong> ä¾¿äºå›¢é˜Ÿåä½œ</li>
</ol>
<h3 id="å®‰å…¨æ€§"><a class="header" href="#å®‰å…¨æ€§"><strong>å®‰å…¨æ€§</strong></a></h3>
<ol>
<li><strong>éªŒè¯å¤–éƒ¨æ¨¡å—</strong> ä½¿ç”¨ SRI ç¡®ä¿å®Œæ•´æ€§</li>
<li><strong>é…ç½® CSP ç­–ç•¥</strong> é™åˆ¶æ¨¡å—æ¥æº</li>
<li><strong>å®¡æŸ¥ç¬¬ä¸‰æ–¹ä¾èµ–</strong> å®šæœŸæ›´æ–°å’Œæ£€æŸ¥</li>
</ol>
<p>æµè§ˆå™¨ä¸­çš„æ¨¡å—åŒ–ä¸ºç°ä»£ Web å¼€å‘æä¾›äº†å¼ºå¤§çš„èƒ½åŠ›ï¼Œåˆç†åˆ©ç”¨è¿™äº›ç‰¹æ€§å¯ä»¥æ„å»ºå‡ºé«˜æ€§èƒ½ã€å¯ç»´æŠ¤çš„ Web åº”ç”¨ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#nodejsä¸­çš„æ¨¡å—">Node.jsä¸­çš„æ¨¡å—</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="nodejsä¸­çš„æ¨¡å—"><a class="header" href="#nodejsä¸­çš„æ¨¡å—">Node.jsä¸­çš„æ¨¡å—</a></h1>
<p>Node.js ä½œä¸ºæœåŠ¡ç«¯ JavaScript è¿è¡Œç¯å¢ƒï¼Œä»ä¸€å¼€å§‹å°±æ”¯æŒæ¨¡å—åŒ–å¼€å‘ã€‚å®ƒç»å†äº†ä» CommonJS åˆ° ES æ¨¡å—çš„æ¼”è¿›ï¼Œä¸ºæœåŠ¡ç«¯åº”ç”¨æä¾›äº†å¼ºå¤§çš„æ¨¡å—ç®¡ç†èƒ½åŠ›ã€‚</p>
<h2 id="nodejs-æ¨¡å—ç³»ç»Ÿæ¼”è¿›"><a class="header" href="#nodejs-æ¨¡å—ç³»ç»Ÿæ¼”è¿›">Node.js æ¨¡å—ç³»ç»Ÿæ¼”è¿›</a></h2>
<h3 id="å‘å±•å†ç¨‹"><a class="header" href="#å‘å±•å†ç¨‹">å‘å±•å†ç¨‹</a></h3>
<h4 id="1-commonjs-æ—¶ä»£-2009-2017"><a class="header" href="#1-commonjs-æ—¶ä»£-2009-2017">1. <strong>CommonJS æ—¶ä»£</strong> (2009-2017)</a></h4>
<ul>
<li><strong>åŸç”Ÿ CommonJS æ”¯æŒ</strong>ï¼šNode.js ä»åˆ›å»ºä¹‹åˆå°±æ”¯æŒ require/exports</li>
<li><strong>åŒæ­¥åŠ è½½</strong>ï¼šé€‚åˆæœåŠ¡ç«¯ç¯å¢ƒçš„åŒæ­¥æ¨¡å—åŠ è½½</li>
<li><strong>npm ç”Ÿæ€</strong>ï¼šå›´ç»• CommonJS å»ºç«‹çš„åºå¤§åŒ…ç®¡ç†ç”Ÿæ€ç³»ç»Ÿ</li>
</ul>
<h4 id="2-es-æ¨¡å—æ”¯æŒ-2017-è‡³ä»Š"><a class="header" href="#2-es-æ¨¡å—æ”¯æŒ-2017-è‡³ä»Š">2. <strong>ES æ¨¡å—æ”¯æŒ</strong> (2017-è‡³ä»Š)</a></h4>
<ul>
<li><strong>å®éªŒæ€§æ”¯æŒ</strong> (Node.js 8.5+)ï¼šé€šè¿‡ flag å¯ç”¨ ES æ¨¡å—</li>
<li><strong>ç¨³å®šæ”¯æŒ</strong> (Node.js 12+)ï¼šæ­£å¼æ”¯æŒ ES æ¨¡å—</li>
<li><strong>åŒæ¨¡å—ç³»ç»Ÿ</strong>ï¼šCommonJS å’Œ ES æ¨¡å—å¹¶å­˜</li>
</ul>
<h3 id="å½“å‰çŠ¶æ€-nodejs-18"><a class="header" href="#å½“å‰çŠ¶æ€-nodejs-18">å½“å‰çŠ¶æ€ (Node.js 18+)</a></h3>
<pre><code class="language-javascript">// Node.js ç°åœ¨åŒæ—¶æ”¯æŒä¸¤ç§æ¨¡å—ç³»ç»Ÿ
// CommonJS (é»˜è®¤)
const fs = require('fs');
const { readFile } = require('fs/promises');

// ES æ¨¡å— (éœ€è¦é…ç½®)
import fs from 'fs';
import { readFile } from 'fs/promises';
</code></pre>
<h2 id="commonjs-æ¨¡å—ç³»ç»Ÿ"><a class="header" href="#commonjs-æ¨¡å—ç³»ç»Ÿ">CommonJS æ¨¡å—ç³»ç»Ÿ</a></h2>
<h3 id="åŸºç¡€è¯­æ³•"><a class="header" href="#åŸºç¡€è¯­æ³•">åŸºç¡€è¯­æ³•</a></h3>
<h4 id="moduleexports-å’Œ-exports"><a class="header" href="#moduleexports-å’Œ-exports"><strong>module.exports å’Œ exports</strong></a></h4>
<pre><code class="language-javascript">// math.js - å¤šç§å¯¼å‡ºæ–¹å¼
// 1. å•ä¸ªå‡½æ•°å¯¼å‡º
module.exports = function add(a, b) {
  return a + b;
};

// 2. å¤šä¸ªå¯¼å‡º
exports.add = (a, b) =&gt; a + b;
exports.subtract = (a, b) =&gt; a - b;
exports.PI = 3.14159;

// 3. å¯¹è±¡å¯¼å‡º
module.exports = {
  add: (a, b) =&gt; a + b,
  subtract: (a, b) =&gt; a - b,
  constants: {
    PI: 3.14159,
    E: 2.71828
  }
};

// 4. ç±»å¯¼å‡º
class Calculator {
  add(a, b) { return a + b; }
  subtract(a, b) { return a - b; }
}

module.exports = Calculator;
</code></pre>
<h4 id="require-å¯¼å…¥"><a class="header" href="#require-å¯¼å…¥"><strong>require å¯¼å…¥</strong></a></h4>
<pre><code class="language-javascript">// å¯¼å…¥æ–¹å¼
// 1. å¯¼å…¥æ•´ä¸ªæ¨¡å—
const math = require('./math');
console.log(math.add(2, 3)); // 5

// 2. è§£æ„å¯¼å…¥
const { add, subtract } = require('./math');
console.log(add(2, 3)); // 5

// 3. å¯¼å…¥ç±»
const Calculator = require('./calculator');
const calc = new Calculator();

// 4. å¯¼å…¥ Node.js å†…ç½®æ¨¡å—
const fs = require('fs');
const path = require('path');
const { createServer } = require('http');
</code></pre>
<h3 id="æ¨¡å—è§£ææœºåˆ¶-1"><a class="header" href="#æ¨¡å—è§£ææœºåˆ¶-1">æ¨¡å—è§£ææœºåˆ¶</a></h3>
<h4 id="æ¨¡å—æŸ¥æ‰¾é¡ºåº"><a class="header" href="#æ¨¡å—æŸ¥æ‰¾é¡ºåº"><strong>æ¨¡å—æŸ¥æ‰¾é¡ºåº</strong></a></h4>
<pre><code class="language-javascript">// require('./user') çš„æŸ¥æ‰¾é¡ºåºï¼š
// 1. ./user
// 2. ./user.js
// 3. ./user.json
// 4. ./user.node
// 5. ./user/package.json (mainå­—æ®µ)
// 6. ./user/index.js
// 7. ./user/index.json
// 8. ./user/index.node

// require('lodash') çš„æŸ¥æ‰¾é¡ºåºï¼š
// 1. å½“å‰ç›®å½• node_modules/lodash
// 2. çˆ¶ç›®å½• ../node_modules/lodash
// 3. ç»§ç»­å‘ä¸ŠæŸ¥æ‰¾ç›´åˆ°æ ¹ç›®å½•
// 4. å…¨å±€ node_modules ç›®å½•
// 5. Node.js å†…ç½®æ¨¡å—
</code></pre>
<h4 id="packagejson-é…ç½®"><a class="header" href="#packagejson-é…ç½®"><strong>package.json é…ç½®</strong></a></h4>
<pre><code class="language-json">{
  "name": "my-package",
  "version": "1.0.0",
  "main": "lib/index.js",          // CommonJS å…¥å£
  "exports": {                     // ç°ä»£æ¨¡å—è§£æ
    ".": {
      "import": "./esm/index.js",  // ES æ¨¡å—å…¥å£
      "require": "./cjs/index.js"  // CommonJS å…¥å£
    },
    "./utils": {
      "import": "./esm/utils.js",
      "require": "./cjs/utils.js"
    }
  },
  "type": "commonjs"               // é»˜è®¤æ¨¡å—ç±»å‹
}
</code></pre>
<h3 id="æ¨¡å—ç¼“å­˜æœºåˆ¶"><a class="header" href="#æ¨¡å—ç¼“å­˜æœºåˆ¶">æ¨¡å—ç¼“å­˜æœºåˆ¶</a></h3>
<pre><code class="language-javascript">// æ¨¡å—ç¼“å­˜ç¤ºä¾‹
// counter.js
let count = 0;
exports.increment = () =&gt; ++count;
exports.getCount = () =&gt; count;

// app.js
const counter1 = require('./counter');
const counter2 = require('./counter'); // ä»ç¼“å­˜åŠ è½½

counter1.increment();
console.log(counter2.getCount()); // 1 - å…±äº«çŠ¶æ€

// æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜
delete require.cache[require.resolve('./counter')];
const counter3 = require('./counter');
console.log(counter3.getCount()); // 0 - é‡æ–°åˆå§‹åŒ–
</code></pre>
<h2 id="es-æ¨¡å—ç³»ç»Ÿ"><a class="header" href="#es-æ¨¡å—ç³»ç»Ÿ">ES æ¨¡å—ç³»ç»Ÿ</a></h2>
<h3 id="é…ç½®å’Œå¯ç”¨"><a class="header" href="#é…ç½®å’Œå¯ç”¨">é…ç½®å’Œå¯ç”¨</a></h3>
<h4 id="packagejson-é…ç½®-1"><a class="header" href="#packagejson-é…ç½®-1"><strong>package.json é…ç½®</strong></a></h4>
<pre><code class="language-json">{
  "type": "module",  // å¯ç”¨ ES æ¨¡å—æ¨¡å¼
  "exports": {
    ".": {
      "import": "./index.js",
      "require": "./index.cjs"
    }
  }
}
</code></pre>
<h4 id="æ–‡ä»¶æ‰©å±•åè§„åˆ™"><a class="header" href="#æ–‡ä»¶æ‰©å±•åè§„åˆ™"><strong>æ–‡ä»¶æ‰©å±•åè§„åˆ™</strong></a></h4>
<pre><code class="language-javascript">// åœ¨ "type": "module" é¡¹ç›®ä¸­ï¼š
// .js   - ES æ¨¡å—
// .mjs  - ES æ¨¡å— (æ˜ç¡®)
// .cjs  - CommonJS æ¨¡å—

// åœ¨ "type": "commonjs" é¡¹ç›®ä¸­ (é»˜è®¤)ï¼š
// .js   - CommonJS æ¨¡å—
// .mjs  - ES æ¨¡å—
// .cjs  - CommonJS æ¨¡å—
</code></pre>
<h3 id="es-æ¨¡å—è¯­æ³•"><a class="header" href="#es-æ¨¡å—è¯­æ³•">ES æ¨¡å—è¯­æ³•</a></h3>
<h4 id="å¯¼å…¥å¯¼å‡º"><a class="header" href="#å¯¼å…¥å¯¼å‡º"><strong>å¯¼å…¥å¯¼å‡º</strong></a></h4>
<pre><code class="language-javascript">// math.mjs
export function add(a, b) {
  return a + b;
}

export const PI = 3.14159;

export default class Calculator {
  multiply(a, b) {
    return a * b;
  }
}

// app.mjs
import Calculator, { add, PI } from './math.mjs';
import * as math from './math.mjs';

const calc = new Calculator();
console.log(add(2, 3));
console.log(calc.multiply(4, 5));
</code></pre>
<h4 id="åŠ¨æ€å¯¼å…¥-2"><a class="header" href="#åŠ¨æ€å¯¼å…¥-2"><strong>åŠ¨æ€å¯¼å…¥</strong></a></h4>
<pre><code class="language-javascript">// æ¡ä»¶å¯¼å…¥
async function loadModule(env) {
  if (env === 'production') {
    const prod = await import('./config/production.js');
    return prod.config;
  } else {
    const dev = await import('./config/development.js');
    return dev.config;
  }
}

// æ‡’åŠ è½½
async function processLargeData(data) {
  // åªåœ¨éœ€è¦æ—¶åŠ è½½é‡å‹æ¨¡å—
  const { heavyProcessor } = await import('./heavy-processor.js');
  return heavyProcessor.process(data);
}
</code></pre>
<h3 id="å†…ç½®æ¨¡å—å¯¼å…¥"><a class="header" href="#å†…ç½®æ¨¡å—å¯¼å…¥">å†…ç½®æ¨¡å—å¯¼å…¥</a></h3>
<pre><code class="language-javascript">// ES æ¨¡å—æ–¹å¼å¯¼å…¥å†…ç½®æ¨¡å—
import { readFile, writeFile } from 'fs/promises';
import { join, dirname } from 'path';
import { createServer } from 'http';
import { fileURLToPath } from 'url';

// è·å–å½“å‰æ–‡ä»¶è·¯å¾„ (ES æ¨¡å—ä¸­æ²¡æœ‰ __dirname)
const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

// ä½¿ç”¨ import() åŠ¨æ€å¯¼å…¥ CommonJS æ¨¡å—
const config = await import('./config.json', {
  assert: { type: 'json' }
});
</code></pre>
<h2 id="åŒæ¨¡å—ç³»ç»Ÿäº’æ“ä½œ"><a class="header" href="#åŒæ¨¡å—ç³»ç»Ÿäº’æ“ä½œ">åŒæ¨¡å—ç³»ç»Ÿäº’æ“ä½œ</a></h2>
<h3 id="commonjs-å¯¼å…¥-es-æ¨¡å—"><a class="header" href="#commonjs-å¯¼å…¥-es-æ¨¡å—">CommonJS å¯¼å…¥ ES æ¨¡å—</a></h3>
<pre><code class="language-javascript">// CommonJS æ–‡ä»¶ (.cjs æˆ–åœ¨ type: "commonjs" é¡¹ç›®ä¸­)
async function loadESModule() {
  // åªèƒ½é€šè¿‡åŠ¨æ€å¯¼å…¥
  const { default: Calculator, add } = await import('./math.mjs');
  
  const calc = new Calculator();
  return calc.multiply(add(2, 3), 4);
}

// ä¸èƒ½ä½¿ç”¨ require() å¯¼å…¥ ES æ¨¡å—
// const math = require('./math.mjs'); // é”™è¯¯!
</code></pre>
<h3 id="es-æ¨¡å—å¯¼å…¥-commonjs"><a class="header" href="#es-æ¨¡å—å¯¼å…¥-commonjs">ES æ¨¡å—å¯¼å…¥ CommonJS</a></h3>
<pre><code class="language-javascript">// ES æ¨¡å—æ–‡ä»¶ (.mjs æˆ–åœ¨ type: "module" é¡¹ç›®ä¸­)
// 1. é»˜è®¤å¯¼å…¥
import fs from 'fs';              // æ•´ä¸ª exports å¯¹è±¡
import express from 'express';    // CommonJS åº“

// 2. å‘½åå¯¼å…¥ (å¦‚æœæ”¯æŒ)
import { readFile } from 'fs/promises';

// 3. åŠ¨æ€å¯¼å…¥
const lodash = await import('lodash');
const _ = lodash.default;

// 4. åˆ›å»º require å‡½æ•° (å…¼å®¹æ–¹æ¡ˆ)
import { createRequire } from 'module';
const require = createRequire(import.meta.url);
const oldModule = require('./old-commonjs-module');
</code></pre>
<h2 id="nodejs-ç‰¹æœ‰ç‰¹æ€§"><a class="header" href="#nodejs-ç‰¹æœ‰ç‰¹æ€§">Node.js ç‰¹æœ‰ç‰¹æ€§</a></h2>
<h3 id="æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"><a class="header" href="#æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"><strong>æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</strong></a></h3>
<pre><code class="language-javascript">// ES æ¨¡å—ä¸­çš„æ–‡ä»¶æ“ä½œ
import { readFile, writeFile } from 'fs/promises';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

async function processFile() {
  const configPath = join(__dirname, 'config.json');
  const data = await readFile(configPath, 'utf8');
  const config = JSON.parse(data);
  
  // å¤„ç†é…ç½®...
  
  await writeFile(configPath, JSON.stringify(config, null, 2));
}
</code></pre>
<h3 id="ç¯å¢ƒå˜é‡å’Œé…ç½®"><a class="header" href="#ç¯å¢ƒå˜é‡å’Œé…ç½®"><strong>ç¯å¢ƒå˜é‡å’Œé…ç½®</strong></a></h3>
<pre><code class="language-javascript">// ç¯å¢ƒé…ç½®æ¨¡å—
// config.js
const config = {
  port: process.env.PORT || 3000,
  database: {
    host: process.env.DB_HOST || 'localhost',
    port: process.env.DB_PORT || 5432,
    name: process.env.DB_NAME || 'myapp'
  },
  jwt: {
    secret: process.env.JWT_SECRET || 'default-secret',
    expiresIn: process.env.JWT_EXPIRES || '1h'
  }
};

export default config;

// app.js
import config from './config.js';
import { createServer } from 'http';

const server = createServer((req, res) =&gt; {
  res.writeHead(200, { 'Content-Type': 'application/json' });
  res.end(JSON.stringify({ message: 'Server running', config }));
});

server.listen(config.port, () =&gt; {
  console.log(`Server running on port ${config.port}`);
});
</code></pre>
<h3 id="è¿›ç¨‹ç®¡ç†å’Œé›†ç¾¤"><a class="header" href="#è¿›ç¨‹ç®¡ç†å’Œé›†ç¾¤"><strong>è¿›ç¨‹ç®¡ç†å’Œé›†ç¾¤</strong></a></h3>
<pre><code class="language-javascript">// cluster.js - å¤šè¿›ç¨‹ç®¡ç†
import cluster from 'cluster';
import { cpus } from 'os';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const numCPUs = cpus().length;

if (cluster.isPrimary) {
  console.log(`Primary ${process.pid} is running`);
  
  // Fork workers
  for (let i = 0; i &lt; numCPUs; i++) {
    cluster.fork();
  }
  
  cluster.on('exit', (worker, code, signal) =&gt; {
    console.log(`Worker ${worker.process.pid} died`);
    cluster.fork(); // é‡å¯æ­»æ‰çš„worker
  });
  
} else {
  // Worker è¿›ç¨‹
  const { startApp } = await import('./app.js');
  startApp();
  
  console.log(`Worker ${process.pid} started`);
}
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-3"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-3">æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</a></h2>
<h3 id="æ¨¡å—é¢„åŠ è½½å’Œç¼“å­˜"><a class="header" href="#æ¨¡å—é¢„åŠ è½½å’Œç¼“å­˜"><strong>æ¨¡å—é¢„åŠ è½½å’Œç¼“å­˜</strong></a></h3>
<pre><code class="language-javascript">// æ¨¡å—é¢„åŠ è½½å™¨
class ModulePreloader {
  constructor() {
    this.cache = new Map();
  }
  
  async preload(moduleUrls) {
    const promises = moduleUrls.map(async url =&gt; {
      try {
        const module = await import(url);
        this.cache.set(url, module);
        return { url, success: true };
      } catch (error) {
        console.warn(`Failed to preload ${url}:`, error);
        return { url, success: false, error };
      }
    });
    
    return Promise.all(promises);
  }
  
  get(url) {
    return this.cache.get(url);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const preloader = new ModulePreloader();
await preloader.preload([
  './heavy-computation.js',
  './database-utils.js',
  './email-service.js'
]);
</code></pre>
<h3 id="ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½-1"><a class="header" href="#ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½-1"><strong>ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½</strong></a></h3>
<pre><code class="language-javascript">// è·¯ç”±æ‡’åŠ è½½
class Router {
  constructor() {
    this.routes = new Map();
  }
  
  register(path, moduleUrl) {
    this.routes.set(path, moduleUrl);
  }
  
  async handle(request) {
    const url = new URL(request.url, 'http://localhost');
    const moduleUrl = this.routes.get(url.pathname);
    
    if (!moduleUrl) {
      return { status: 404, body: 'Not Found' };
    }
    
    try {
      const module = await import(moduleUrl);
      return await module.default(request);
    } catch (error) {
      console.error('Route handler error:', error);
      return { status: 500, body: 'Internal Server Error' };
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const router = new Router();
router.register('/api/users', './handlers/users.js');
router.register('/api/posts', './handlers/posts.js');
router.register('/api/auth', './handlers/auth.js');
</code></pre>
<h3 id="å†…å­˜ç®¡ç†"><a class="header" href="#å†…å­˜ç®¡ç†"><strong>å†…å­˜ç®¡ç†</strong></a></h3>
<pre><code class="language-javascript">// å†…å­˜é«˜æ•ˆçš„æ¨¡å—åŠ è½½
import { Worker, isMainThread, parentPort } from 'worker_threads';

class MemoryEfficientProcessor {
  constructor() {
    this.workers = [];
    this.taskQueue = [];
  }
  
  async processInWorker(data, moduleUrl) {
    return new Promise((resolve, reject) =&gt; {
      const worker = new Worker(`
        import { parentPort } from 'worker_threads';
        import processor from '${moduleUrl}';
        
        parentPort.on('message', async (data) =&gt; {
          try {
            const result = await processor.process(data);
            parentPort.postMessage({ success: true, result });
          } catch (error) {
            parentPort.postMessage({ success: false, error: error.message });
          }
          process.exit(0); // å¤„ç†å®Œåç«‹å³é€€å‡ºï¼Œé‡Šæ”¾å†…å­˜
        });
      `, { eval: true });
      
      worker.postMessage(data);
      
      worker.on('message', ({ success, result, error }) =&gt; {
        if (success) {
          resolve(result);
        } else {
          reject(new Error(error));
        }
      });
      
      worker.on('error', reject);
    });
  }
}
</code></pre>
<h2 id="è°ƒè¯•å’Œå¼€å‘å·¥å…·"><a class="header" href="#è°ƒè¯•å’Œå¼€å‘å·¥å…·">è°ƒè¯•å’Œå¼€å‘å·¥å…·</a></h2>
<h3 id="è°ƒè¯•é…ç½®"><a class="header" href="#è°ƒè¯•é…ç½®"><strong>è°ƒè¯•é…ç½®</strong></a></h3>
<pre><code class="language-javascript">// debug.js - å¼€å‘ç¯å¢ƒè°ƒè¯•å·¥å…·
import { inspect } from 'util';

export class Debug {
  constructor(namespace) {
    this.namespace = namespace;
    this.enabled = process.env.DEBUG?.includes(namespace) || false;
  }
  
  log(...args) {
    if (!this.enabled) return;
    
    const timestamp = new Date().toISOString();
    const prefix = `[${timestamp}] ${this.namespace}:`;
    
    console.log(prefix, ...args.map(arg =&gt; 
      typeof arg === 'object' ? inspect(arg, { colors: true, depth: 3 }) : arg
    ));
  }
  
  error(...args) {
    const timestamp = new Date().toISOString();
    const prefix = `[${timestamp}] ${this.namespace}:ERROR`;
    console.error(prefix, ...args);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const debug = new Debug('app:server');
debug.log('Server starting...', { port: 3000, env: process.env.NODE_ENV });
</code></pre>
<h3 id="æ€§èƒ½ç›‘æ§"><a class="header" href="#æ€§èƒ½ç›‘æ§"><strong>æ€§èƒ½ç›‘æ§</strong></a></h3>
<pre><code class="language-javascript">// performance.js
import { performance, PerformanceObserver } from 'perf_hooks';

export class PerformanceMonitor {
  constructor() {
    this.metrics = new Map();
    this.setupObserver();
  }
  
  setupObserver() {
    const obs = new PerformanceObserver((list) =&gt; {
      for (const entry of list.getEntries()) {
        this.recordMetric(entry.name, entry.duration);
      }
    });
    obs.observe({ entryTypes: ['measure'] });
  }
  
  start(name) {
    performance.mark(`${name}-start`);
  }
  
  end(name) {
    performance.mark(`${name}-end`);
    performance.measure(name, `${name}-start`, `${name}-end`);
  }
  
  recordMetric(name, value) {
    if (!this.metrics.has(name)) {
      this.metrics.set(name, []);
    }
    this.metrics.get(name).push(value);
  }
  
  getAverageTime(name) {
    const times = this.metrics.get(name) || [];
    return times.length &gt; 0 ? times.reduce((a, b) =&gt; a + b) / times.length : 0;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const monitor = new PerformanceMonitor();

async function loadHeavyModule() {
  monitor.start('module-load');
  const module = await import('./heavy-module.js');
  monitor.end('module-load');
  return module;
}
</code></pre>
<h2 id="æ‰“åŒ…å’Œéƒ¨ç½²"><a class="header" href="#æ‰“åŒ…å’Œéƒ¨ç½²">æ‰“åŒ…å’Œéƒ¨ç½²</a></h2>
<h3 id="ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–"><a class="header" href="#ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–"><strong>ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–</strong></a></h3>
<pre><code class="language-javascript">// build.js - æ„å»ºè„šæœ¬
import { build } from 'esbuild';
import { readdir, stat } from 'fs/promises';
import { join } from 'path';

async function findEntryPoints(dir) {
  const entries = [];
  const files = await readdir(dir);
  
  for (const file of files) {
    const filePath = join(dir, file);
    const stats = await stat(filePath);
    
    if (stats.isFile() &amp;&amp; file.endsWith('.js')) {
      entries.push(filePath);
    }
  }
  
  return entries;
}

async function buildForProduction() {
  const entryPoints = await findEntryPoints('./src');
  
  await build({
    entryPoints,
    bundle: true,
    minify: true,
    sourcemap: false,
    target: 'node18',
    platform: 'node',
    format: 'esm',
    outdir: './dist',
    external: ['sharp', 'canvas'] // ä¸æ‰“åŒ…çš„åŸç”Ÿä¾èµ–
  });
  
  console.log('Build completed successfully!');
}

buildForProduction().catch(console.error);
</code></pre>
<h3 id="docker-é…ç½®"><a class="header" href="#docker-é…ç½®"><strong>Docker é…ç½®</strong></a></h3>
<pre><code class="language-dockerfile"># Dockerfile
FROM node:18-alpine

WORKDIR /app

# å¤åˆ¶ package æ–‡ä»¶
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm ci --only=production

# å¤åˆ¶æºç 
COPY dist/ ./dist/

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV NODE_ENV=production

# å¯åŠ¨åº”ç”¨
CMD ["node", "dist/index.js"]
</code></pre>
<h2 id="æœ€ä½³å®è·µæ€»ç»“-1"><a class="header" href="#æœ€ä½³å®è·µæ€»ç»“-1">æœ€ä½³å®è·µæ€»ç»“</a></h2>
<h3 id="æ¨¡å—ç»„ç»‡"><a class="header" href="#æ¨¡å—ç»„ç»‡"><strong>æ¨¡å—ç»„ç»‡</strong></a></h3>
<ol>
<li><strong>æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ</strong> - æ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€</li>
<li><strong>ä¸€è‡´çš„å¯¼å…¥è·¯å¾„</strong> - ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–è·¯å¾„åˆ«å</li>
<li><strong>é¿å…å¾ªç¯ä¾èµ–</strong> - é€šè¿‡ä¾èµ–æ³¨å…¥æˆ–é‡æ„è§£å†³</li>
</ol>
<h3 id="æ€§èƒ½ä¼˜åŒ–-5"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-5"><strong>æ€§èƒ½ä¼˜åŒ–</strong></a></h3>
<ol>
<li><strong>åˆç†ä½¿ç”¨ç¼“å­˜</strong> - åˆ©ç”¨æ¨¡å—ç¼“å­˜æœºåˆ¶</li>
<li><strong>æ‡’åŠ è½½éå…³é”®æ¨¡å—</strong> - æé«˜å¯åŠ¨é€Ÿåº¦</li>
<li><strong>Worker éš”ç¦»</strong> - é˜²æ­¢å†…å­˜æ³„æ¼</li>
</ol>
<h3 id="ç”Ÿäº§ç¯å¢ƒ"><a class="header" href="#ç”Ÿäº§ç¯å¢ƒ"><strong>ç”Ÿäº§ç¯å¢ƒ</strong></a></h3>
<ol>
<li><strong>ç¯å¢ƒé…ç½®åˆ†ç¦»</strong> - ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®</li>
<li><strong>é”™è¯¯å¤„ç†å®Œå–„</strong> - æ¨¡å—åŠ è½½å¤±è´¥çš„é™çº§æ–¹æ¡ˆ</li>
<li><strong>ç›‘æ§å’Œæ—¥å¿—</strong> - è·Ÿè¸ªæ¨¡å—æ€§èƒ½å’Œé”™è¯¯</li>
</ol>
<p>Node.js çš„æ¨¡å—ç³»ç»Ÿä¸ºæœåŠ¡ç«¯ JavaScript å¼€å‘æä¾›äº†å¼ºå¤§çš„èƒ½åŠ›ï¼Œåˆç†ä½¿ç”¨è¿™äº›ç‰¹æ€§å¯ä»¥æ„å»ºå‡ºé«˜æ€§èƒ½ã€å¯ç»´æŠ¤çš„åç«¯åº”ç”¨ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#denoçš„æ¨¡å—ç³»ç»Ÿ">Denoçš„æ¨¡å—ç³»ç»Ÿ</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="denoçš„æ¨¡å—ç³»ç»Ÿ"><a class="header" href="#denoçš„æ¨¡å—ç³»ç»Ÿ">Denoçš„æ¨¡å—ç³»ç»Ÿ</a></h1>
<p>Deno æ˜¯ä¸€ä¸ªç°ä»£çš„ JavaScript/TypeScript è¿è¡Œæ—¶ï¼Œç”± Node.js çš„åˆ›å§‹äºº Ryan Dahl å¼€å‘ã€‚å®ƒä»è®¾è®¡ä¹‹åˆå°±åŸç”Ÿæ”¯æŒ ES æ¨¡å—ï¼Œå¹¶é‡‡ç”¨äº†åŸºäº URL çš„æ¨¡å—å¯¼å…¥ç³»ç»Ÿï¼Œä¸ºæ¨¡å—åŒ–å¼€å‘å¸¦æ¥äº†å…¨æ–°çš„ä½“éªŒã€‚</p>
<h2 id="deno-æ¨¡å—ç³»ç»Ÿç‰¹ç‚¹"><a class="header" href="#deno-æ¨¡å—ç³»ç»Ÿç‰¹ç‚¹">Deno æ¨¡å—ç³»ç»Ÿç‰¹ç‚¹</a></h2>
<h3 id="æ ¸å¿ƒè®¾è®¡ç†å¿µ"><a class="header" href="#æ ¸å¿ƒè®¾è®¡ç†å¿µ">æ ¸å¿ƒè®¾è®¡ç†å¿µ</a></h3>
<h4 id="1-åŸç”Ÿ-es-æ¨¡å—æ”¯æŒ"><a class="header" href="#1-åŸç”Ÿ-es-æ¨¡å—æ”¯æŒ">1. <strong>åŸç”Ÿ ES æ¨¡å—æ”¯æŒ</strong></a></h4>
<ul>
<li><strong>ES æ¨¡å—ä¼˜å…ˆ</strong>ï¼šDeno ä»ä¸€å¼€å§‹å°±å®Œå…¨æ”¯æŒ ES æ¨¡å—</li>
<li><strong>æ— éœ€ package.json</strong>ï¼šä¸ä¾èµ– npm çš„åŒ…ç®¡ç†æ¨¡å¼</li>
<li><strong>æ ‡å‡†åŒ–å¯¼å…¥</strong>ï¼šä½¿ç”¨æ ‡å‡†çš„ import/export è¯­æ³•</li>
</ul>
<h4 id="2-åŸºäº-url-çš„æ¨¡å—å¯¼å…¥"><a class="header" href="#2-åŸºäº-url-çš„æ¨¡å—å¯¼å…¥">2. <strong>åŸºäº URL çš„æ¨¡å—å¯¼å…¥</strong></a></h4>
<ul>
<li><strong>å»ä¸­å¿ƒåŒ–</strong>ï¼šæ¨¡å—å¯ä»¥ä»ä»»ä½• URL å¯¼å…¥</li>
<li><strong>æ˜ç¡®çš„ä¾èµ–</strong>ï¼šä¾èµ–å…³ç³»é€šè¿‡ URL æ˜ç¡®è¡¨è¾¾</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šURL ä¸­åŒ…å«ç‰ˆæœ¬ä¿¡æ¯</li>
</ul>
<h4 id="3-å®‰å…¨ä¼˜å…ˆ"><a class="header" href="#3-å®‰å…¨ä¼˜å…ˆ">3. <strong>å®‰å…¨ä¼˜å…ˆ</strong></a></h4>
<ul>
<li><strong>æƒé™ç³»ç»Ÿ</strong>ï¼šæ¨¡å—éœ€è¦æ˜ç¡®çš„æƒé™æ‰èƒ½è®¿é—®ç³»ç»Ÿèµ„æº</li>
<li><strong>æ²™ç›’æ‰§è¡Œ</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹æ¨¡å—è¿è¡Œåœ¨å—é™ç¯å¢ƒä¸­</li>
</ul>
<h2 id="åŸºç¡€æ¨¡å—è¯­æ³•"><a class="header" href="#åŸºç¡€æ¨¡å—è¯­æ³•">åŸºç¡€æ¨¡å—è¯­æ³•</a></h2>
<h3 id="æ ‡å‡†å¯¼å…¥å¯¼å‡º"><a class="header" href="#æ ‡å‡†å¯¼å…¥å¯¼å‡º"><strong>æ ‡å‡†å¯¼å…¥å¯¼å‡º</strong></a></h3>
<pre><code class="language-typescript">// math.ts
export function add(a: number, b: number): number {
  return a + b;
}

export const PI = 3.14159;

export default class Calculator {
  multiply(a: number, b: number): number {
    return a * b;
  }
}

// app.ts
import Calculator, { add, PI } from './math.ts';
import * as math from './math.ts';

const calc = new Calculator();
console.log(add(2, 3));
console.log(calc.multiply(4, 5));
</code></pre>
<h3 id="url-å¯¼å…¥"><a class="header" href="#url-å¯¼å…¥"><strong>URL å¯¼å…¥</strong></a></h3>
<pre><code class="language-typescript">// ä»è¿œç¨‹ URL å¯¼å…¥
import { serve } from 'https://deno.land/std@0.200.0/http/server.ts';
import { parse } from 'https://deno.land/std@0.200.0/flags/mod.ts';

// ä» CDN å¯¼å…¥ç¬¬ä¸‰æ–¹åº“
import lodash from 'https://cdn.skypack.dev/lodash@4.17.21';
import React from 'https://esm.sh/react@18.2.0';

// ä½¿ç”¨å…·ä½“ç‰ˆæœ¬ç¡®ä¿ç¨³å®šæ€§
import { assertEquals } from 'https://deno.land/std@0.200.0/testing/asserts.ts';
</code></pre>
<h3 id="ç›¸å¯¹è·¯å¾„å¯¼å…¥-1"><a class="header" href="#ç›¸å¯¹è·¯å¾„å¯¼å…¥-1"><strong>ç›¸å¯¹è·¯å¾„å¯¼å…¥</strong></a></h3>
<pre><code class="language-typescript">// é¡¹ç›®ç»“æ„
// src/
//   â”œâ”€â”€ utils/
//   â”‚   â”œâ”€â”€ helpers.ts
//   â”‚   â””â”€â”€ constants.ts
//   â”œâ”€â”€ components/
//   â”‚   â””â”€â”€ Button.ts
//   â””â”€â”€ app.ts

// app.ts
import { formatDate } from './utils/helpers.ts';
import { API_URL } from './utils/constants.ts';
import Button from './components/Button.ts';

// helpers.ts
export function formatDate(date: Date): string {
  return date.toISOString().split('T')[0];
}

// æ³¨æ„ï¼šDeno è¦æ±‚å®Œæ•´çš„æ–‡ä»¶æ‰©å±•å
import { config } from './config.ts'; // âœ… æ­£ç¡®
import { config } from './config';     // âŒ é”™è¯¯
</code></pre>
<h2 id="ä¾èµ–ç®¡ç†"><a class="header" href="#ä¾èµ–ç®¡ç†">ä¾èµ–ç®¡ç†</a></h2>
<h3 id="depsts-æ¨¡å¼"><a class="header" href="#depsts-æ¨¡å¼"><strong>deps.ts æ¨¡å¼</strong></a></h3>
<pre><code class="language-typescript">// deps.ts - é›†ä¸­ç®¡ç†å¤–éƒ¨ä¾èµ–
export { serve } from 'https://deno.land/std@0.200.0/http/server.ts';
export { parse } from 'https://deno.land/std@0.200.0/flags/mod.ts';
export { join, dirname } from 'https://deno.land/std@0.200.0/path/mod.ts';
export { assert, assertEquals } from 'https://deno.land/std@0.200.0/testing/asserts.ts';

// é‡æ–°å¯¼å‡ºå¹¶é‡å‘½å
export { default as lodash } from 'https://cdn.skypack.dev/lodash@4.17.21';
export { default as React } from 'https://esm.sh/react@18.2.0';

// åº”ç”¨ä»£ç ä¸­ä½¿ç”¨
// app.ts
import { serve, parse, React } from './deps.ts';

const handler = (req: Request) =&gt; {
  const url = new URL(req.url);
  const params = parse(url.searchParams.toString());
  
  return new Response(`Hello ${params.name || 'World'}!`);
};

serve(handler, { port: 8000 });
</code></pre>
<h3 id="import-maps-1"><a class="header" href="#import-maps-1"><strong>Import Maps</strong></a></h3>
<pre><code class="language-json">// import_map.json
{
  "imports": {
    "std/": "https://deno.land/std@0.200.0/",
    "fmt/": "https://deno.land/std@0.200.0/fmt/",
    "testing/": "https://deno.land/std@0.200.0/testing/",
    "react": "https://esm.sh/react@18.2.0",
    "react-dom": "https://esm.sh/react-dom@18.2.0",
    "@/": "./src/"
  }
}
</code></pre>
<pre><code class="language-typescript">// ä½¿ç”¨ Import Maps åçš„ä»£ç 
import { serve } from 'std/http/server.ts';
import { red, bold } from 'fmt/colors.ts';
import { assertEquals } from 'testing/asserts.ts';
import React from 'react';
import { config } from '@/config.ts';

// å¯åŠ¨æ—¶æŒ‡å®š import map
// deno run --import-map=import_map.json app.ts
</code></pre>
<h3 id="denojson-é…ç½®"><a class="header" href="#denojson-é…ç½®"><strong>deno.json é…ç½®</strong></a></h3>
<pre><code class="language-json">{
  "compilerOptions": {
    "allowJs": true,
    "lib": ["deno.window"],
    "strict": true
  },
  "importMap": "./import_map.json",
  "tasks": {
    "dev": "deno run --watch --allow-net --allow-read app.ts",
    "test": "deno test --allow-all",
    "fmt": "deno fmt",
    "lint": "deno lint"
  },
  "fmt": {
    "files": {
      "include": ["src/", "tests/"],
      "exclude": ["dist/"]
    }
  },
  "lint": {
    "files": {
      "include": ["src/"],
      "exclude": ["dist/"]
    }
  }
}
</code></pre>
<h2 id="å†…ç½®æ¨¡å—å’Œæ ‡å‡†åº“"><a class="header" href="#å†…ç½®æ¨¡å—å’Œæ ‡å‡†åº“">å†…ç½®æ¨¡å—å’Œæ ‡å‡†åº“</a></h2>
<h3 id="deno-æ ‡å‡†åº“"><a class="header" href="#deno-æ ‡å‡†åº“"><strong>Deno æ ‡å‡†åº“</strong></a></h3>
<pre><code class="language-typescript">// æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
import { copy, ensureDir, exists } from 'std/fs/mod.ts';
import { readLines } from 'std/io/mod.ts';

// ç½‘ç»œè¯·æ±‚
import { serve } from 'std/http/server.ts';
import { Status } from 'std/http/http_status.ts';

// è·¯å¾„å¤„ç†
import { join, dirname, basename, extname } from 'std/path/mod.ts';

// æ—¥æœŸæ—¶é—´
import { format, parse } from 'std/datetime/mod.ts';

// ç¼–ç è§£ç 
import { encode, decode } from 'std/encoding/base64.ts';
import { stringify, parse as parseCSV } from 'std/encoding/csv.ts';

// æµ‹è¯•å·¥å…·
import { assertEquals, assertThrows } from 'std/testing/asserts.ts';
import { FakeTime } from 'std/testing/time.ts';

// ç¤ºä¾‹ï¼šæ–‡ä»¶æœåŠ¡å™¨
async function fileServer() {
  const handler = async (req: Request): Promise&lt;Response&gt; =&gt; {
    const url = new URL(req.url);
    const filePath = join('.', url.pathname);
    
    if (await exists(filePath)) {
      const file = await Deno.readFile(filePath);
      return new Response(file);
    }
    
    return new Response('Not Found', { status: Status.NotFound });
  };
  
  console.log('Server running on http://localhost:8000');
  await serve(handler, { port: 8000 });
}
</code></pre>
<h3 id="web-apis"><a class="header" href="#web-apis"><strong>Web APIs</strong></a></h3>
<pre><code class="language-typescript">// Deno æ”¯æŒç°ä»£ Web APIs
// Fetch API
const response = await fetch('https://api.github.com/users/denoland');
const data = await response.json();

// Web Streams
const readable = new ReadableStream({
  start(controller) {
    controller.enqueue('Hello ');
    controller.enqueue('World!');
    controller.close();
  }
});

// URL æ„é€ å™¨
const url = new URL('/api/users', 'https://example.com');
url.searchParams.set('page', '1');

// åŠ å¯† API
const data = new TextEncoder().encode('hello world');
const hashBuffer = await crypto.subtle.digest('SHA-256', data);
const hashArray = Array.from(new Uint8Array(hashBuffer));
const hashHex = hashArray.map(b =&gt; b.toString(16).padStart(2, '0')).join('');
</code></pre>
<h2 id="åŠ¨æ€å¯¼å…¥å’Œä»£ç åˆ†å‰²"><a class="header" href="#åŠ¨æ€å¯¼å…¥å’Œä»£ç åˆ†å‰²">åŠ¨æ€å¯¼å…¥å’Œä»£ç åˆ†å‰²</a></h2>
<h3 id="åŠ¨æ€å¯¼å…¥-3"><a class="header" href="#åŠ¨æ€å¯¼å…¥-3"><strong>åŠ¨æ€å¯¼å…¥</strong></a></h3>
<pre><code class="language-typescript">// æ¡ä»¶å¯¼å…¥
async function loadEnvironmentConfig(env: string) {
  switch (env) {
    case 'development':
      const devConfig = await import('./config/development.ts');
      return devConfig.default;
    case 'production':
      const prodConfig = await import('./config/production.ts');
      return prodConfig.default;
    default:
      throw new Error(`Unknown environment: ${env}`);
  }
}

// æ‡’åŠ è½½æ¨¡å—
async function processData(data: unknown[]) {
  // åªåœ¨éœ€è¦æ—¶åŠ è½½æ•°æ®å¤„ç†æ¨¡å—
  const { DataProcessor } = await import('./utils/data-processor.ts');
  const processor = new DataProcessor();
  return processor.process(data);
}

// æ’ä»¶ç³»ç»Ÿ
class PluginManager {
  private plugins = new Map&lt;string, unknown&gt;();
  
  async loadPlugin(name: string, url: string) {
    try {
      const plugin = await import(url);
      this.plugins.set(name, plugin.default);
      console.log(`Plugin ${name} loaded successfully`);
    } catch (error) {
      console.error(`Failed to load plugin ${name}:`, error);
    }
  }
  
  getPlugin(name: string) {
    return this.plugins.get(name);
  }
}
</code></pre>
<h3 id="ä»£ç åˆ†å‰²ç­–ç•¥"><a class="header" href="#ä»£ç åˆ†å‰²ç­–ç•¥"><strong>ä»£ç åˆ†å‰²ç­–ç•¥</strong></a></h3>
<pre><code class="language-typescript">// è·¯ç”±çº§ä»£ç åˆ†å‰²
class Router {
  private routes = new Map&lt;string, () =&gt; Promise&lt;{ default: Function }&gt;&gt;();
  
  register(path: string, moduleUrl: string) {
    this.routes.set(path, () =&gt; import(moduleUrl));
  }
  
  async handle(request: Request): Promise&lt;Response&gt; {
    const url = new URL(request.url);
    const routeLoader = this.routes.get(url.pathname);
    
    if (!routeLoader) {
      return new Response('Not Found', { status: 404 });
    }
    
    try {
      const module = await routeLoader();
      return await module.default(request);
    } catch (error) {
      console.error('Route handler error:', error);
      return new Response('Internal Server Error', { status: 500 });
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const router = new Router();
router.register('/api/users', './routes/users.ts');
router.register('/api/posts', './routes/posts.ts');
router.register('/health', './routes/health.ts');
</code></pre>
<h2 id="æƒé™ç³»ç»Ÿ"><a class="header" href="#æƒé™ç³»ç»Ÿ">æƒé™ç³»ç»Ÿ</a></h2>
<h3 id="æƒé™æ¨¡å‹"><a class="header" href="#æƒé™æ¨¡å‹"><strong>æƒé™æ¨¡å‹</strong></a></h3>
<pre><code class="language-typescript">// Deno çš„æƒé™ç³»ç»Ÿç¡®ä¿å®‰å…¨æ€§
// éœ€è¦æ˜ç¡®æŒ‡å®šæƒé™æ‰èƒ½è®¿é—®ç³»ç»Ÿèµ„æº

// æ–‡ä»¶ç³»ç»Ÿæƒé™
// deno run --allow-read --allow-write app.ts

async function readConfig() {
  try {
    const config = await Deno.readTextFile('./config.json');
    return JSON.parse(config);
  } catch (error) {
    if (error instanceof Deno.errors.PermissionDenied) {
      console.error('Permission denied: Cannot read config file');
      console.error('Run with --allow-read flag');
    }
    throw error;
  }
}

// ç½‘ç»œæƒé™
// deno run --allow-net app.ts

async function fetchData(url: string) {
  try {
    const response = await fetch(url);
    return await response.json();
  } catch (error) {
    if (error instanceof Deno.errors.PermissionDenied) {
      console.error('Permission denied: Cannot make network requests');
      console.error('Run with --allow-net flag');
    }
    throw error;
  }
}

// ç¯å¢ƒå˜é‡æƒé™
// deno run --allow-env app.ts

function getPort(): number {
  try {
    return parseInt(Deno.env.get('PORT') || '8000', 10);
  } catch (error) {
    if (error instanceof Deno.errors.PermissionDenied) {
      console.error('Permission denied: Cannot access environment variables');
      console.error('Run with --allow-env flag');
    }
    return 8000;
  }
}
</code></pre>
<h3 id="æƒé™æ£€æŸ¥å’Œå¤„ç†"><a class="header" href="#æƒé™æ£€æŸ¥å’Œå¤„ç†"><strong>æƒé™æ£€æŸ¥å’Œå¤„ç†</strong></a></h3>
<pre><code class="language-typescript">// è¿è¡Œæ—¶æƒé™æ£€æŸ¥
async function safeFileOperation(path: string) {
  // æ£€æŸ¥è¯»å–æƒé™
  const readStatus = await Deno.permissions.query({ name: 'read', path });
  if (readStatus.state !== 'granted') {
    // è¯·æ±‚æƒé™
    const readRequest = await Deno.permissions.request({ name: 'read', path });
    if (readRequest.state !== 'granted') {
      throw new Error('Read permission denied');
    }
  }
  
  // æ£€æŸ¥å†™å…¥æƒé™
  const writeStatus = await Deno.permissions.query({ name: 'write', path });
  if (writeStatus.state !== 'granted') {
    const writeRequest = await Deno.permissions.request({ name: 'write', path });
    if (writeRequest.state !== 'granted') {
      throw new Error('Write permission denied');
    }
  }
  
  // å®‰å…¨åœ°æ‰§è¡Œæ–‡ä»¶æ“ä½œ
  const content = await Deno.readTextFile(path);
  const modified = content.toUpperCase();
  await Deno.writeTextFile(path, modified);
}

// æƒé™åŒ…è£…å™¨
class PermissionWrapper {
  async withPermission&lt;T&gt;(
    permission: Deno.PermissionDescriptor,
    operation: () =&gt; Promise&lt;T&gt;
  ): Promise&lt;T&gt; {
    const status = await Deno.permissions.query(permission);
    
    if (status.state === 'denied') {
      throw new Error(`Permission denied: ${permission.name}`);
    }
    
    if (status.state === 'prompt') {
      const request = await Deno.permissions.request(permission);
      if (request.state !== 'granted') {
        throw new Error(`Permission rejected: ${permission.name}`);
      }
    }
    
    return await operation();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const permissionWrapper = new PermissionWrapper();

await permissionWrapper.withPermission(
  { name: 'net', host: 'api.example.com' },
  async () =&gt; {
    const response = await fetch('https://api.example.com/data');
    return await response.json();
  }
);
</code></pre>
<h2 id="æµ‹è¯•å’Œå¼€å‘å·¥å…·"><a class="header" href="#æµ‹è¯•å’Œå¼€å‘å·¥å…·">æµ‹è¯•å’Œå¼€å‘å·¥å…·</a></h2>
<h3 id="å†…ç½®æµ‹è¯•æ¡†æ¶"><a class="header" href="#å†…ç½®æµ‹è¯•æ¡†æ¶"><strong>å†…ç½®æµ‹è¯•æ¡†æ¶</strong></a></h3>
<pre><code class="language-typescript">// math_test.ts
import { assertEquals, assertThrows } from 'std/testing/asserts.ts';
import { add, divide } from './math.ts';

Deno.test('addition works correctly', () =&gt; {
  assertEquals(add(2, 3), 5);
  assertEquals(add(-1, 1), 0);
  assertEquals(add(0, 0), 0);
});

Deno.test('division works correctly', () =&gt; {
  assertEquals(divide(10, 2), 5);
  assertEquals(divide(7, 2), 3.5);
});

Deno.test('division by zero throws error', () =&gt; {
  assertThrows(
    () =&gt; divide(5, 0),
    Error,
    'Division by zero'
  );
});

// å¼‚æ­¥æµ‹è¯•
Deno.test('async operation', async () =&gt; {
  const result = await fetch('https://httpbin.org/json');
  const data = await result.json();
  assertEquals(typeof data, 'object');
});

// æµ‹è¯•æƒé™
Deno.test({
  name: 'file operation test',
  permissions: { read: true, write: true },
  async fn() {
    await Deno.writeTextFile('./test.txt', 'hello');
    const content = await Deno.readTextFile('./test.txt');
    assertEquals(content, 'hello');
    await Deno.remove('./test.txt');
  }
});
</code></pre>
<h3 id="åŸºå‡†æµ‹è¯•"><a class="header" href="#åŸºå‡†æµ‹è¯•"><strong>åŸºå‡†æµ‹è¯•</strong></a></h3>
<pre><code class="language-typescript">// benchmark.ts
import { bench, runBenchmarks } from 'std/testing/bench.ts';

// ç®€å•åŸºå‡†æµ‹è¯•
bench('string concatenation', () =&gt; {
  let result = '';
  for (let i = 0; i &lt; 1000; i++) {
    result += 'a';
  }
});

bench('array join', () =&gt; {
  const arr = [];
  for (let i = 0; i &lt; 1000; i++) {
    arr.push('a');
  }
  arr.join('');
});

// å¼‚æ­¥åŸºå‡†æµ‹è¯•
bench({
  name: 'async fetch',
  async fn() {
    await fetch('https://httpbin.org/json');
  }
});

// è¿è¡ŒåŸºå‡†æµ‹è¯•
if (import.meta.main) {
  runBenchmarks();
}
</code></pre>
<h3 id="å¼€å‘å·¥å…·é›†æˆ"><a class="header" href="#å¼€å‘å·¥å…·é›†æˆ"><strong>å¼€å‘å·¥å…·é›†æˆ</strong></a></h3>
<pre><code class="language-typescript">// dev.ts - å¼€å‘ç¯å¢ƒå·¥å…·
import { serve } from 'std/http/server.ts';
import { serveDir } from 'std/http/file_server.ts';

class DevServer {
  private watcher?: Deno.FsWatcher;
  
  async start(port = 8000) {
    console.log(`Dev server starting on http://localhost:${port}`);
    
    // æ–‡ä»¶ç›‘å¬å’Œçƒ­é‡è½½
    this.setupFileWatcher();
    
    const handler = async (req: Request): Promise&lt;Response&gt; =&gt; {
      const url = new URL(req.url);
      
      // API è·¯ç”±
      if (url.pathname.startsWith('/api/')) {
        return await this.handleApiRequest(req);
      }
      
      // é™æ€æ–‡ä»¶æœåŠ¡
      return serveDir(req, {
        fsRoot: './public',
        showDirListing: true,
      });
    };
    
    await serve(handler, { port });
  }
  
  private setupFileWatcher() {
    this.watcher = Deno.watchFs(['./src'], { recursive: true });
    
    (async () =&gt; {
      for await (const event of this.watcher!) {
        if (event.kind === 'modify') {
          console.log(`File changed: ${event.paths.join(', ')}`);
          // è§¦å‘é‡æ–°åŠ è½½
          await this.broadcastReload();
        }
      }
    })();
  }
  
  private async handleApiRequest(req: Request): Promise&lt;Response&gt; {
    const url = new URL(req.url);
    
    // åŠ¨æ€åŠ è½½ API è·¯ç”±
    try {
      const routePath = `./api${url.pathname.replace('/api', '')}.ts`;
      const module = await import(routePath);
      return await module.default(req);
    } catch (error) {
      console.error('API route error:', error);
      return new Response('API Error', { status: 500 });
    }
  }
  
  private async broadcastReload() {
    // å®ç°çƒ­é‡è½½é€»è¾‘
    console.log('Broadcasting reload...');
  }
  
  stop() {
    this.watcher?.close();
  }
}

// å¯åŠ¨å¼€å‘æœåŠ¡å™¨
if (import.meta.main) {
  const server = new DevServer();
  await server.start();
}
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–-6"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-6">æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="æ¨¡å—ç¼“å­˜å’Œé¢„ç¼–è¯‘"><a class="header" href="#æ¨¡å—ç¼“å­˜å’Œé¢„ç¼–è¯‘"><strong>æ¨¡å—ç¼“å­˜å’Œé¢„ç¼–è¯‘</strong></a></h3>
<pre><code class="language-typescript">// ç¼“å­˜ç®¡ç†
class ModuleCache {
  private cache = new Map&lt;string, unknown&gt;();
  private loading = new Map&lt;string, Promise&lt;unknown&gt;&gt;();
  
  async load&lt;T&gt;(url: string): Promise&lt;T&gt; {
    // æ£€æŸ¥ç¼“å­˜
    if (this.cache.has(url)) {
      return this.cache.get(url) as T;
    }
    
    // æ£€æŸ¥æ˜¯å¦æ­£åœ¨åŠ è½½
    if (this.loading.has(url)) {
      return await this.loading.get(url) as T;
    }
    
    // å¼€å§‹åŠ è½½
    const loadPromise = this.loadModule&lt;T&gt;(url);
    this.loading.set(url, loadPromise);
    
    try {
      const module = await loadPromise;
      this.cache.set(url, module);
      return module;
    } finally {
      this.loading.delete(url);
    }
  }
  
  private async loadModule&lt;T&gt;(url: string): Promise&lt;T&gt; {
    const module = await import(url);
    return module.default || module;
  }
  
  invalidate(url: string) {
    this.cache.delete(url);
  }
  
  clear() {
    this.cache.clear();
    this.loading.clear();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const moduleCache = new ModuleCache();

async function loadProcessor() {
  return await moduleCache.load('./processors/heavy-processor.ts');
}
</code></pre>
<h3 id="bundle-å’Œéƒ¨ç½²"><a class="header" href="#bundle-å’Œéƒ¨ç½²"><strong>Bundle å’Œéƒ¨ç½²</strong></a></h3>
<pre><code class="language-typescript">// build.ts - ç”Ÿäº§ç¯å¢ƒæ„å»ºè„šæœ¬
import { bundle } from 'https://deno.land/x/emit@0.26.0/mod.ts';

async function buildForProduction() {
  console.log('Building for production...');
  
  const result = await bundle('./src/app.ts', {
    compilerOptions: {
      sourceMap: false,
      target: 'ES2022',
    },
  });
  
  // å†™å…¥æ„å»ºç»“æœ
  await Deno.writeTextFile('./dist/app.js', result.code);
  
  // ç”Ÿæˆå…ƒæ•°æ®
  const metadata = {
    buildTime: new Date().toISOString(),
    version: '1.0.0',
    modules: result.files,
  };
  
  await Deno.writeTextFile(
    './dist/metadata.json',
    JSON.stringify(metadata, null, 2)
  );
  
  console.log('Build completed successfully!');
}

// Docker éƒ¨ç½²é…ç½®
const dockerFile = `
FROM denoland/deno:1.37.0

WORKDIR /app

# ç¼“å­˜ä¾èµ–
COPY deps.ts ./
RUN deno cache deps.ts

# å¤åˆ¶æºç 
COPY . .

# ç¼“å­˜å…¥å£æ–‡ä»¶
RUN deno cache app.ts

# è¿è¡Œåº”ç”¨
CMD ["run", "--allow-net", "--allow-read", "app.ts"]
`;

await Deno.writeTextFile('./Dockerfile', dockerFile);
</code></pre>
<h2 id="æœ€ä½³å®è·µæ€»ç»“-2"><a class="header" href="#æœ€ä½³å®è·µæ€»ç»“-2">æœ€ä½³å®è·µæ€»ç»“</a></h2>
<h3 id="æ¨¡å—ç»„ç»‡-1"><a class="header" href="#æ¨¡å—ç»„ç»‡-1"><strong>æ¨¡å—ç»„ç»‡</strong></a></h3>
<ol>
<li><strong>ä½¿ç”¨ deps.ts é›†ä¸­ç®¡ç†ä¾èµ–</strong> - ä¾¿äºç‰ˆæœ¬æ§åˆ¶å’Œæ›´æ–°</li>
<li><strong>Import Maps ç®€åŒ–å¯¼å…¥è·¯å¾„</strong> - æé«˜ä»£ç å¯è¯»æ€§</li>
<li><strong>æ˜ç¡®çš„æ–‡ä»¶æ‰©å±•å</strong> - Deno è¦æ±‚å®Œæ•´çš„æ–‡ä»¶æ‰©å±•å</li>
</ol>
<h3 id="å®‰å…¨æ€§-1"><a class="header" href="#å®‰å…¨æ€§-1"><strong>å®‰å…¨æ€§</strong></a></h3>
<ol>
<li><strong>æœ€å°æƒé™åŸåˆ™</strong> - åªæˆäºˆå¿…è¦çš„æƒé™</li>
<li><strong>è¿è¡Œæ—¶æƒé™æ£€æŸ¥</strong> - ä¼˜é›…å¤„ç†æƒé™ä¸è¶³çš„æƒ…å†µ</li>
<li><strong>URL éªŒè¯</strong> - éªŒè¯è¿œç¨‹æ¨¡å—çš„æ¥æºå’Œå®Œæ•´æ€§</li>
</ol>
<h3 id="æ€§èƒ½ä¼˜åŒ–-1-1"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-1-1"><strong>æ€§èƒ½ä¼˜åŒ–</strong></a></h3>
<ol>
<li><strong>æ¨¡å—ç¼“å­˜</strong> - é¿å…é‡å¤åŠ è½½ç›¸åŒæ¨¡å—</li>
<li><strong>ä»£ç åˆ†å‰²</strong> - æŒ‰éœ€åŠ è½½éå…³é”®æ¨¡å—</li>
<li><strong>ç‰ˆæœ¬é”å®š</strong> - ä½¿ç”¨å…·ä½“ç‰ˆæœ¬ç¡®ä¿ç¨³å®šæ€§</li>
</ol>
<h3 id="å¼€å‘ä½“éªŒ"><a class="header" href="#å¼€å‘ä½“éªŒ"><strong>å¼€å‘ä½“éªŒ</strong></a></h3>
<ol>
<li><strong>å†…ç½®å·¥å…·é“¾</strong> - å……åˆ†åˆ©ç”¨ Deno çš„å†…ç½®åŠŸèƒ½</li>
<li><strong>TypeScript ä¼˜å…ˆ</strong> - äº«å—ç±»å‹å®‰å…¨çš„å¼€å‘ä½“éªŒ</li>
<li><strong>æ ‡å‡†åŒ–æ ¼å¼</strong> - ä½¿ç”¨ <code>deno fmt</code> å’Œ <code>deno lint</code></li>
</ol>
<p>Deno çš„æ¨¡å—ç³»ç»Ÿä»£è¡¨äº† JavaScript ç”Ÿæ€ç³»ç»Ÿçš„ç°ä»£åŒ–æ–¹å‘ï¼Œé€šè¿‡æ ‡å‡†åŒ–çš„å¯¼å…¥æœºåˆ¶ã€å¼ºå¤§çš„å®‰å…¨æ¨¡å‹å’Œä¼˜ç§€çš„å¼€å‘ä½“éªŒï¼Œä¸ºæ„å»ºå®‰å…¨ã€é«˜æ•ˆçš„åº”ç”¨æä¾›äº†æ–°çš„å¯èƒ½æ€§ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ¨¡å—è®¾è®¡åŸåˆ™">æœ€ä½³å®è·µ</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="bunçš„æ¨¡å—ç³»ç»Ÿ"><a class="header" href="#bunçš„æ¨¡å—ç³»ç»Ÿ">Bunçš„æ¨¡å—ç³»ç»Ÿ</a></h1>
<p>Bun æ˜¯ä¸€ä¸ªç°ä»£çš„ JavaScript/TypeScript è¿è¡Œæ—¶å’ŒåŒ…ç®¡ç†å™¨ï¼Œç”± Jarred Sumner å¼€å‘ã€‚å®ƒä»¥æé€Ÿæ€§èƒ½ä¸ºç›®æ ‡ï¼ŒåŸç”Ÿæ”¯æŒ TypeScriptã€JSXï¼Œå¹¶æä¾›äº†ä¸€å¥—å®Œæ•´çš„å·¥å…·é“¾ï¼ŒåŒ…æ‹¬æ‰“åŒ…å™¨ã€æµ‹è¯•è¿è¡Œå™¨å’ŒåŒ…ç®¡ç†å™¨ã€‚</p>
<h2 id="bun-æ¨¡å—ç³»ç»Ÿç‰¹ç‚¹"><a class="header" href="#bun-æ¨¡å—ç³»ç»Ÿç‰¹ç‚¹">Bun æ¨¡å—ç³»ç»Ÿç‰¹ç‚¹</a></h2>
<h3 id="æ ¸å¿ƒè®¾è®¡ç†å¿µ-1"><a class="header" href="#æ ¸å¿ƒè®¾è®¡ç†å¿µ-1">æ ¸å¿ƒè®¾è®¡ç†å¿µ</a></h3>
<h4 id="1-é€Ÿåº¦ä¼˜å…ˆ"><a class="header" href="#1-é€Ÿåº¦ä¼˜å…ˆ">1. <strong>é€Ÿåº¦ä¼˜å…ˆ</strong></a></h4>
<ul>
<li><strong>Zig ç¼–å†™</strong>ï¼šä½¿ç”¨ Zig è¯­è¨€ç¼–å†™ï¼Œæ€§èƒ½æä½³</li>
<li><strong>JavaScriptCore å¼•æ“</strong>ï¼šä½¿ç”¨ Safari çš„ JavaScript å¼•æ“</li>
<li><strong>åŸç”Ÿä¼˜åŒ–</strong>ï¼šé’ˆå¯¹æ¨¡å—åŠ è½½å’Œæ‰§è¡Œè¿›è¡Œäº†å¤§é‡ä¼˜åŒ–</li>
</ul>
<h4 id="2-ç°ä»£æ ‡å‡†æ”¯æŒ"><a class="header" href="#2-ç°ä»£æ ‡å‡†æ”¯æŒ">2. <strong>ç°ä»£æ ‡å‡†æ”¯æŒ</strong></a></h4>
<ul>
<li><strong>åŸç”Ÿ ES æ¨¡å—</strong>ï¼šå®Œå…¨æ”¯æŒ ES æ¨¡å—è¯­æ³•</li>
<li><strong>TypeScript å†…ç½®</strong>ï¼šæ— éœ€é¢å¤–é…ç½®å³å¯è¿è¡Œ TypeScript</li>
<li><strong>JSX åŸç”Ÿæ”¯æŒ</strong>ï¼šç›´æ¥è¿è¡Œ JSX ä»£ç </li>
</ul>
<h4 id="3-nodejs-å…¼å®¹æ€§"><a class="header" href="#3-nodejs-å…¼å®¹æ€§">3. <strong>Node.js å…¼å®¹æ€§</strong></a></h4>
<ul>
<li><strong>API å…¼å®¹</strong>ï¼šå…¼å®¹å¤§éƒ¨åˆ† Node.js API</li>
<li><strong>npm ç”Ÿæ€</strong>ï¼šæ”¯æŒç°æœ‰çš„ npm åŒ…</li>
<li><strong>æ— ç¼è¿ç§»</strong>ï¼šç°æœ‰ Node.js é¡¹ç›®å¯ä»¥è½»æ¾è¿ç§»</li>
</ul>
<h2 id="åŸºç¡€æ¨¡å—è¯­æ³•-1"><a class="header" href="#åŸºç¡€æ¨¡å—è¯­æ³•-1">åŸºç¡€æ¨¡å—è¯­æ³•</a></h2>
<h3 id="es-æ¨¡å—æ”¯æŒ"><a class="header" href="#es-æ¨¡å—æ”¯æŒ"><strong>ES æ¨¡å—æ”¯æŒ</strong></a></h3>
<pre><code class="language-typescript">// math.ts
export function add(a: number, b: number): number {
  return a + b;
}

export const PI = 3.14159;

export default class Calculator {
  multiply(a: number, b: number): number {
    return a * b;
  }
}

// app.ts
import Calculator, { add, PI } from './math.ts';
import * as math from './math.ts';

const calc = new Calculator();
console.log(add(2, 3));
console.log(calc.multiply(4, 5));
</code></pre>
<h3 id="typescript-é›¶é…ç½®æ”¯æŒ"><a class="header" href="#typescript-é›¶é…ç½®æ”¯æŒ"><strong>TypeScript é›¶é…ç½®æ”¯æŒ</strong></a></h3>
<pre><code class="language-typescript">// æ— éœ€ tsconfig.json å³å¯è¿è¡Œ
// types.ts
interface User {
  id: number;
  name: string;
  email: string;
}

export type UserResponse = {
  user: User;
  token: string;
};

// api.ts
import type { UserResponse } from './types.ts';

export async function fetchUser(id: number): Promise&lt;UserResponse&gt; {
  const response = await fetch(`/api/users/${id}`);
  return response.json();
}

// ç›´æ¥è¿è¡Œï¼šbun run api.ts
</code></pre>
<h3 id="jsx-åŸç”Ÿæ”¯æŒ"><a class="header" href="#jsx-åŸç”Ÿæ”¯æŒ"><strong>JSX åŸç”Ÿæ”¯æŒ</strong></a></h3>
<pre><code class="language-tsx">// component.tsx
interface Props {
  name: string;
  count: number;
}

export function Counter({ name, count }: Props) {
  return (
    &lt;div&gt;
      &lt;h1&gt;Hello {name}!&lt;/h1&gt;
      &lt;p&gt;Count: {count}&lt;/p&gt;
    &lt;/div&gt;
  );
}

// app.tsx
import { Counter } from './component.tsx';

function App() {
  return (
    &lt;div&gt;
      &lt;Counter name="World" count={42} /&gt;
    &lt;/div&gt;
  );
}

// ç›´æ¥è¿è¡Œï¼šbun run app.tsx
</code></pre>
<h2 id="å†…ç½®æ¨¡å—å’Œ-api"><a class="header" href="#å†…ç½®æ¨¡å—å’Œ-api">å†…ç½®æ¨¡å—å’Œ API</a></h2>
<h3 id="bun-ä¸“æœ‰-api"><a class="header" href="#bun-ä¸“æœ‰-api"><strong>Bun ä¸“æœ‰ API</strong></a></h3>
<pre><code class="language-typescript">// æ–‡ä»¶æ“ä½œ - Bun.file API
const file = Bun.file('./data.json');
const contents = await file.text();
const data = await file.json();

// å†™å…¥æ–‡ä»¶
await Bun.write('./output.txt', 'Hello Bun!');
await Bun.write('./data.json', { message: 'Hello' });

// å¯†ç å“ˆå¸Œ
const password = 'secret123';
const hash = await Bun.password.hash(password);
const isValid = await Bun.password.verify(password, hash);

// ç¯å¢ƒå˜é‡
const port = Bun.env.PORT || '3000';
const isDev = Bun.env.NODE_ENV === 'development';
</code></pre>
<h3 id="é«˜æ€§èƒ½-http-æœåŠ¡å™¨"><a class="header" href="#é«˜æ€§èƒ½-http-æœåŠ¡å™¨"><strong>é«˜æ€§èƒ½ HTTP æœåŠ¡å™¨</strong></a></h3>
<pre><code class="language-typescript">// server.ts
const server = Bun.serve({
  port: 3000,
  async fetch(req) {
    const url = new URL(req.url);
    
    if (url.pathname === '/api/hello') {
      return new Response(JSON.stringify({ message: 'Hello Bun!' }), {
        headers: { 'Content-Type': 'application/json' }
      });
    }
    
    if (url.pathname === '/') {
      return new Response('Hello World!');
    }
    
    return new Response('Not Found', { status: 404 });
  },
});

console.log(`Server running on http://localhost:${server.port}`);
</code></pre>
<h3 id="websocket-æ”¯æŒ"><a class="header" href="#websocket-æ”¯æŒ"><strong>WebSocket æ”¯æŒ</strong></a></h3>
<pre><code class="language-typescript">// websocket-server.ts
const server = Bun.serve({
  port: 3001,
  async fetch(req, server) {
    const success = server.upgrade(req);
    if (success) {
      return undefined;
    }
    return new Response('Upgrade failed', { status: 500 });
  },
  websocket: {
    message(ws, message) {
      console.log('Received:', message);
      ws.send(`Echo: ${message}`);
    },
    open(ws) {
      console.log('WebSocket opened');
      ws.subscribe('chat');
    },
    close(ws, code, message) {
      console.log('WebSocket closed');
    }
  }
});

// å®¢æˆ·ç«¯ä»£ç 
const ws = new WebSocket('ws://localhost:3001');
ws.onmessage = (event) =&gt; {
  console.log('Received:', event.data);
};
ws.send('Hello WebSocket!');
</code></pre>
<h2 id="åŒ…ç®¡ç†å’Œä¾èµ–"><a class="header" href="#åŒ…ç®¡ç†å’Œä¾èµ–">åŒ…ç®¡ç†å’Œä¾èµ–</a></h2>
<h3 id="bun-install---æé€ŸåŒ…ç®¡ç†"><a class="header" href="#bun-install---æé€ŸåŒ…ç®¡ç†"><strong>bun install - æé€ŸåŒ…ç®¡ç†</strong></a></h3>
<pre><code class="language-bash"># å®‰è£…ä¾èµ–ï¼ˆæ¯” npm å¿« 20-100 å€ï¼‰
bun install

# å®‰è£…ç‰¹å®šåŒ…
bun add react react-dom
bun add -d typescript @types/react

# ç§»é™¤åŒ…
bun remove lodash

# å…¨å±€å®‰è£…
bun add -g typescript
</code></pre>
<h3 id="å…¼å®¹-packagejson"><a class="header" href="#å…¼å®¹-packagejson"><strong>å…¼å®¹ package.json</strong></a></h3>
<pre><code class="language-json">{
  "name": "my-bun-app",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "bun run --watch src/index.ts",
    "build": "bun build src/index.ts --outdir dist",
    "test": "bun test",
    "start": "bun run src/index.ts"
  },
  "dependencies": {
    "react": "^18.2.0",
    "express": "^4.18.2"
  },
  "devDependencies": {
    "@types/react": "^18.2.0",
    "@types/express": "^4.17.17"
  },
  "trustedDependencies": ["esbuild"]
}
</code></pre>
<h3 id="workspaces-æ”¯æŒ"><a class="header" href="#workspaces-æ”¯æŒ"><strong>workspaces æ”¯æŒ</strong></a></h3>
<pre><code class="language-json">// æ ¹ç›®å½• package.json
{
  "name": "monorepo",
  "workspaces": ["packages/*"],
  "devDependencies": {
    "typescript": "^5.0.0"
  }
}

// packages/app/package.json
{
  "name": "@monorepo/app",
  "dependencies": {
    "@monorepo/shared": "workspace:*"
  }
}

// packages/shared/package.json
{
  "name": "@monorepo/shared",
  "exports": {
    ".": "./index.ts"
  }
}
</code></pre>
<h2 id="æ¨¡å—è§£æå’Œå¯¼å…¥"><a class="header" href="#æ¨¡å—è§£æå’Œå¯¼å…¥">æ¨¡å—è§£æå’Œå¯¼å…¥</a></h2>
<h3 id="nodejs-å…¼å®¹å¯¼å…¥"><a class="header" href="#nodejs-å…¼å®¹å¯¼å…¥"><strong>Node.js å…¼å®¹å¯¼å…¥</strong></a></h3>
<pre><code class="language-typescript">// å…¼å®¹ Node.js æ¨¡å—
import fs from 'fs';
import path from 'path';
import { readFile } from 'fs/promises';

// å…¼å®¹ CommonJS
const express = require('express');
const lodash = require('lodash');

// Bun ç‰¹æœ‰çš„å¿«é€Ÿå¯¼å…¥
import { Database } from 'bun:sqlite';
import { spawn } from 'bun:subprocess';
</code></pre>
<h3 id="è·¯å¾„è§£æå¢å¼º"><a class="header" href="#è·¯å¾„è§£æå¢å¼º"><strong>è·¯å¾„è§£æå¢å¼º</strong></a></h3>
<pre><code class="language-typescript">// bun.config.js æˆ– bunfig.toml
export default {
  preload: ['./setup.ts'],
  external: ['sharp', 'canvas'],
  define: {
    __VERSION__: JSON.stringify('1.0.0'),
    __DEV__: 'true'
  }
};

// ä½¿ç”¨è·¯å¾„åˆ«å
// tsconfig.json ä¸­çš„ paths ä¼šè¢«è‡ªåŠ¨è¯†åˆ«
import { utils } from '@/utils';
import { components } from '~/components';
</code></pre>
<h3 id="åŠ¨æ€å¯¼å…¥å’Œæ‡’åŠ è½½"><a class="header" href="#åŠ¨æ€å¯¼å…¥å’Œæ‡’åŠ è½½"><strong>åŠ¨æ€å¯¼å…¥å’Œæ‡’åŠ è½½</strong></a></h3>
<pre><code class="language-typescript">// æ¡ä»¶å¯¼å…¥
async function loadRenderer(type: 'server' | 'client') {
  if (type === 'server') {
    const { ServerRenderer } = await import('./server-renderer.ts');
    return new ServerRenderer();
  } else {
    const { ClientRenderer } = await import('./client-renderer.ts');
    return new ClientRenderer();
  }
}

// æ’ä»¶ç³»ç»Ÿ
class PluginLoader {
  private plugins = new Map&lt;string, any&gt;();
  
  async loadPlugin(name: string, path: string) {
    try {
      const plugin = await import(path);
      this.plugins.set(name, plugin.default || plugin);
      console.log(`Plugin ${name} loaded`);
    } catch (error) {
      console.error(`Failed to load plugin ${name}:`, error);
    }
  }
  
  getPlugin(name: string) {
    return this.plugins.get(name);
  }
}
</code></pre>
<h2 id="å†…ç½®å·¥å…·é“¾"><a class="header" href="#å†…ç½®å·¥å…·é“¾">å†…ç½®å·¥å…·é“¾</a></h2>
<h3 id="bunbuild---å†…ç½®æ‰“åŒ…å™¨"><a class="header" href="#bunbuild---å†…ç½®æ‰“åŒ…å™¨"><strong>Bun.build - å†…ç½®æ‰“åŒ…å™¨</strong></a></h3>
<pre><code class="language-typescript">// build.ts
await Bun.build({
  entrypoints: ['./src/index.ts'],
  outdir: './dist',
  target: 'browser', // 'browser' | 'bun' | 'node'
  format: 'esm',     // 'esm' | 'cjs' | 'iife'
  minify: true,
  sourcemap: 'external',
  splitting: true,   // ä»£ç åˆ†å‰²
  
  // ç¯å¢ƒå˜é‡å¤„ç†
  env: 'inline',     // 'inline' | 'PUBLIC_*' | 'disable'
  
  // æ’ä»¶ç³»ç»Ÿ
  plugins: [
    {
      name: 'custom-plugin',
      setup(build) {
        build.onLoad({ filter: /\.custom$/ }, async (args) =&gt; {
          const contents = await Bun.file(args.path).text();
          return {
            contents: `export default ${JSON.stringify(contents)}`,
            loader: 'js'
          };
        });
      }
    }
  ],
  
  // å¤–éƒ¨ä¾èµ–
  external: ['react', 'react-dom']
});
</code></pre>
<h3 id="macros---æ„å»ºæ—¶ä»£ç ç”Ÿæˆ"><a class="header" href="#macros---æ„å»ºæ—¶ä»£ç ç”Ÿæˆ"><strong>Macros - æ„å»ºæ—¶ä»£ç ç”Ÿæˆ</strong></a></h3>
<pre><code class="language-typescript">// database.ts (macro æ–‡ä»¶)
export function sql(strings: TemplateStringsArray, ...values: any[]) {
  // æ„å»ºæ—¶æ‰§è¡Œï¼Œç”Ÿæˆä¼˜åŒ–çš„ SQL æŸ¥è¯¢ä»£ç 
  const query = strings.reduce((acc, str, i) =&gt; {
    return acc + str + (values[i] ? `$${i + 1}` : '');
  }, '');
  
  return {
    query,
    params: values,
    execute: (db: any) =&gt; db.prepare(query).all(...values)
  };
}

// app.ts
import { sql } from './database.ts' with { type: 'macro' };

// è¿™ä¼šåœ¨æ„å»ºæ—¶å±•å¼€ä¸ºä¼˜åŒ–çš„ä»£ç 
const users = await sql`SELECT * FROM users WHERE id = ${userId}`;

// æ„å»ºåç”Ÿæˆçš„ä»£ç ç±»ä¼¼ï¼š
// const users = await db.prepare("SELECT * FROM users WHERE id = $1").all(userId);
</code></pre>
<h3 id="å†…ç½®æµ‹è¯•è¿è¡Œå™¨"><a class="header" href="#å†…ç½®æµ‹è¯•è¿è¡Œå™¨"><strong>å†…ç½®æµ‹è¯•è¿è¡Œå™¨</strong></a></h3>
<pre><code class="language-typescript">// math.test.ts
import { expect, test, describe, beforeAll, afterAll } from 'bun:test';
import { add, subtract } from './math.ts';

describe('Math functions', () =&gt; {
  test('addition', () =&gt; {
    expect(add(2, 3)).toBe(5);
    expect(add(-1, 1)).toBe(0);
  });
  
  test('subtraction', () =&gt; {
    expect(subtract(5, 3)).toBe(2);
    expect(subtract(1, 1)).toBe(0);
  });
  
  test('async operation', async () =&gt; {
    const result = await fetch('https://httpbin.org/json');
    const data = await result.json();
    expect(data).toHaveProperty('slideshow');
  });
});

// è¿è¡Œæµ‹è¯•ï¼šbun test
// å¹¶è¡Œè¿è¡Œï¼Œé€Ÿåº¦æå¿«
</code></pre>
<h3 id="æ€§èƒ½åŸºå‡†æµ‹è¯•"><a class="header" href="#æ€§èƒ½åŸºå‡†æµ‹è¯•"><strong>æ€§èƒ½åŸºå‡†æµ‹è¯•</strong></a></h3>
<pre><code class="language-typescript">// benchmark.ts
import { bench, run } from 'bun:test';

bench('string concatenation', () =&gt; {
  let result = '';
  for (let i = 0; i &lt; 1000; i++) {
    result += 'a';
  }
});

bench('array join', () =&gt; {
  const arr = [];
  for (let i = 0; i &lt; 1000; i++) {
    arr.push('a');
  }
  arr.join('');
});

bench('template literal', () =&gt; {
  let result = '';
  for (let i = 0; i &lt; 1000; i++) {
    result = `${result}a`;
  }
});

await run();
</code></pre>
<h2 id="æ•°æ®åº“é›†æˆ"><a class="header" href="#æ•°æ®åº“é›†æˆ">æ•°æ®åº“é›†æˆ</a></h2>
<h3 id="å†…ç½®-sqlite"><a class="header" href="#å†…ç½®-sqlite"><strong>å†…ç½® SQLite</strong></a></h3>
<pre><code class="language-typescript">// database.ts
import { Database } from 'bun:sqlite';

const db = new Database('mydb.sqlite');

// åˆ›å»ºè¡¨
db.exec(`
  CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL
  )
`);

// é¢„ç¼–è¯‘è¯­å¥ï¼ˆæ€§èƒ½æœ€ä½³ï¼‰
const insertUser = db.prepare('INSERT INTO users (name, email) VALUES (?, ?)');
const getUserById = db.prepare('SELECT * FROM users WHERE id = ?');
const getAllUsers = db.prepare('SELECT * FROM users');

// æ’å…¥æ•°æ®
insertUser.run('John Doe', 'john@example.com');

// æŸ¥è¯¢æ•°æ®
const user = getUserById.get(1);
const users = getAllUsers.all();

// äº‹åŠ¡æ”¯æŒ
const insertManyUsers = db.transaction((users) =&gt; {
  for (const user of users) {
    insertUser.run(user.name, user.email);
  }
});

insertManyUsers([
  { name: 'Alice', email: 'alice@example.com' },
  { name: 'Bob', email: 'bob@example.com' }
]);

db.close();
</code></pre>
<h3 id="orm-é›†æˆç¤ºä¾‹"><a class="header" href="#orm-é›†æˆç¤ºä¾‹"><strong>ORM é›†æˆç¤ºä¾‹</strong></a></h3>
<pre><code class="language-typescript">// user.model.ts
interface User {
  id?: number;
  name: string;
  email: string;
  createdAt?: Date;
}

class UserModel {
  private db: Database;
  
  constructor(db: Database) {
    this.db = db;
    this.init();
  }
  
  private init() {
    this.db.exec(`
      CREATE TABLE IF NOT EXISTS users (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        email TEXT UNIQUE NOT NULL,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP
      )
    `);
  }
  
  create(user: Omit&lt;User, 'id' | 'createdAt'&gt;): User {
    const stmt = this.db.prepare('INSERT INTO users (name, email) VALUES (?, ?) RETURNING *');
    return stmt.get(user.name, user.email) as User;
  }
  
  findById(id: number): User | null {
    const stmt = this.db.prepare('SELECT * FROM users WHERE id = ?');
    return stmt.get(id) as User | null;
  }
  
  findAll(): User[] {
    const stmt = this.db.prepare('SELECT * FROM users ORDER BY created_at DESC');
    return stmt.all() as User[];
  }
  
  update(id: number, updates: Partial&lt;User&gt;): User | null {
    const fields = Object.keys(updates).map(key =&gt; `${key} = ?`).join(', ');
    const values = Object.values(updates);
    const stmt = this.db.prepare(`UPDATE users SET ${fields} WHERE id = ? RETURNING *`);
    return stmt.get(...values, id) as User | null;
  }
  
  delete(id: number): boolean {
    const stmt = this.db.prepare('DELETE FROM users WHERE id = ?');
    const result = stmt.run(id);
    return result.changes &gt; 0;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
import { Database } from 'bun:sqlite';

const db = new Database('app.db');
const userModel = new UserModel(db);

const newUser = userModel.create({
  name: 'Alice Smith',
  email: 'alice@example.com'
});

console.log('Created user:', newUser);
</code></pre>
<h2 id="å¼€å‘å·¥å…·å’Œè°ƒè¯•"><a class="header" href="#å¼€å‘å·¥å…·å’Œè°ƒè¯•">å¼€å‘å·¥å…·å’Œè°ƒè¯•</a></h2>
<h3 id="çƒ­é‡è½½å¼€å‘"><a class="header" href="#çƒ­é‡è½½å¼€å‘"><strong>çƒ­é‡è½½å¼€å‘</strong></a></h3>
<pre><code class="language-typescript">// dev-server.ts
const server = Bun.serve({
  port: 3000,
  development: true, // å¯ç”¨å¼€å‘æ¨¡å¼
  
  async fetch(req) {
    const url = new URL(req.url);
    
    // API è·¯ç”±
    if (url.pathname.startsWith('/api/')) {
      // åŠ¨æ€å¯¼å…¥ï¼Œæ”¯æŒçƒ­é‡è½½
      const handler = await import(`./api${url.pathname.replace('/api', '')}.ts`);
      return handler.default(req);
    }
    
    // é™æ€æ–‡ä»¶æœåŠ¡
    return new Response(Bun.file('./public/index.html'));
  }
});

// æ–‡ä»¶ç›‘å¬å™¨
const watcher = Bun.watch({
  recursive: true,
  paths: ['./src'],
  onchange(event, path) {
    console.log(`File changed: ${path}`);
    // å¯ä»¥å‘é€ WebSocket æ¶ˆæ¯é€šçŸ¥å®¢æˆ·ç«¯åˆ·æ–°
  }
});

console.log(`Dev server running on http://localhost:${server.port}`);
</code></pre>
<h3 id="è°ƒè¯•å’Œæ—¥å¿—"><a class="header" href="#è°ƒè¯•å’Œæ—¥å¿—"><strong>è°ƒè¯•å’Œæ—¥å¿—</strong></a></h3>
<pre><code class="language-typescript">// logger.ts
class Logger {
  private isDev = Bun.env.NODE_ENV === 'development';
  
  info(message: string, ...args: any[]) {
    if (this.isDev) {
      console.log(`[INFO] ${new Date().toISOString()} - ${message}`, ...args);
    }
  }
  
  error(message: string, error?: Error) {
    console.error(`[ERROR] ${new Date().toISOString()} - ${message}`);
    if (error &amp;&amp; this.isDev) {
      console.error(error.stack);
    }
  }
  
  perf&lt;T&gt;(name: string, fn: () =&gt; T): T {
    if (!this.isDev) return fn();
    
    const start = performance.now();
    const result = fn();
    const end = performance.now();
    
    console.log(`[PERF] ${name}: ${(end - start).toFixed(2)}ms`);
    return result;
  }
}

export const logger = new Logger();

// ä½¿ç”¨ç¤ºä¾‹
import { logger } from './logger.ts';

logger.perf('database-query', () =&gt; {
  return db.prepare('SELECT * FROM users').all();
});
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–-7"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-7">æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="é¢„ç¼–è¯‘å’Œç¼“å­˜"><a class="header" href="#é¢„ç¼–è¯‘å’Œç¼“å­˜"><strong>é¢„ç¼–è¯‘å’Œç¼“å­˜</strong></a></h3>
<pre><code class="language-typescript">// åˆ©ç”¨ Bun çš„ç¼–è¯‘ç¼“å­˜
// bun.config.js
export default {
  // é¢„åŠ è½½æ¨¡å—ï¼Œæé«˜å¯åŠ¨é€Ÿåº¦
  preload: [
    './src/setup.ts',
    './src/config.ts'
  ],
  
  // ç¼–è¯‘ç›®æ ‡
  target: 'bun',
  
  // å¤–éƒ¨ä¾èµ–ï¼ˆä¸ç¼–è¯‘ï¼‰
  external: ['sharp', 'canvas'],
  
  // å‹ç¼©
  minify: {
    whitespace: true,
    identifiers: true,
    syntax: true
  }
};
</code></pre>
<h3 id="å†…å­˜å’Œæ€§èƒ½ç›‘æ§"><a class="header" href="#å†…å­˜å’Œæ€§èƒ½ç›‘æ§"><strong>å†…å­˜å’Œæ€§èƒ½ç›‘æ§</strong></a></h3>
<pre><code class="language-typescript">// monitor.ts
class PerformanceMonitor {
  private metrics = new Map&lt;string, number[]&gt;();
  
  measure&lt;T&gt;(name: string, fn: () =&gt; T): T {
    const start = performance.now();
    
    try {
      const result = fn();
      const duration = performance.now() - start;
      this.recordMetric(name, duration);
      return result;
    } catch (error) {
      const duration = performance.now() - start;
      this.recordMetric(`${name}-error`, duration);
      throw error;
    }
  }
  
  async measureAsync&lt;T&gt;(name: string, fn: () =&gt; Promise&lt;T&gt;): Promise&lt;T&gt; {
    const start = performance.now();
    
    try {
      const result = await fn();
      const duration = performance.now() - start;
      this.recordMetric(name, duration);
      return result;
    } catch (error) {
      const duration = performance.now() - start;
      this.recordMetric(`${name}-error`, duration);
      throw error;
    }
  }
  
  private recordMetric(name: string, value: number) {
    if (!this.metrics.has(name)) {
      this.metrics.set(name, []);
    }
    this.metrics.get(name)!.push(value);
  }
  
  getStats(name: string) {
    const values = this.metrics.get(name) || [];
    if (values.length === 0) return null;
    
    const sum = values.reduce((a, b) =&gt; a + b, 0);
    const avg = sum / values.length;
    const min = Math.min(...values);
    const max = Math.max(...values);
    
    return { avg, min, max, count: values.length };
  }
  
  getMemoryUsage() {
    return {
      rss: process.memoryUsage.rss(),
      heapUsed: process.memoryUsage().heapUsed,
      heapTotal: process.memoryUsage().heapTotal,
      external: process.memoryUsage().external
    };
  }
}

export const monitor = new PerformanceMonitor();
</code></pre>
<h2 id="ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²"><a class="header" href="#ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²">ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</a></h2>
<h3 id="docker-é…ç½®-1"><a class="header" href="#docker-é…ç½®-1"><strong>Docker é…ç½®</strong></a></h3>
<pre><code class="language-dockerfile"># Dockerfile
FROM oven/bun:1.0-alpine

WORKDIR /app

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package.json bun.lockb ./

# å®‰è£…ä¾èµ–
RUN bun install --frozen-lockfile --production

# å¤åˆ¶æºç 
COPY src/ ./src/

# æ„å»ºåº”ç”¨
RUN bun build src/index.ts --outdir dist --target bun

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV NODE_ENV=production

# æš´éœ²ç«¯å£
EXPOSE 3000

# å¯åŠ¨åº”ç”¨
CMD ["bun", "run", "dist/index.js"]
</code></pre>
<h3 id="éƒ¨ç½²è„šæœ¬"><a class="header" href="#éƒ¨ç½²è„šæœ¬"><strong>éƒ¨ç½²è„šæœ¬</strong></a></h3>
<pre><code class="language-typescript">// deploy.ts
import { $ } from 'bun';

async function deploy() {
  console.log('Starting deployment...');
  
  // è¿è¡Œæµ‹è¯•
  await $`bun test`;
  console.log('âœ… Tests passed');
  
  // æ„å»ºç”Ÿäº§ç‰ˆæœ¬
  await $`bun run build:prod`;
  console.log('âœ… Build completed');
  
  // æ„å»º Docker é•œåƒ
  await $`docker build -t myapp:latest .`;
  console.log('âœ… Docker image built');
  
  // æ¨é€åˆ°ä»“åº“ï¼ˆå¦‚æœéœ€è¦ï¼‰
  if (Bun.env.PUSH_TO_REGISTRY === 'true') {
    await $`docker push myapp:latest`;
    console.log('âœ… Image pushed to registry');
  }
  
  console.log('ğŸš€ Deployment completed!');
}

deploy().catch(console.error);
</code></pre>
<h2 id="æœ€ä½³å®è·µæ€»ç»“-3"><a class="header" href="#æœ€ä½³å®è·µæ€»ç»“-3">æœ€ä½³å®è·µæ€»ç»“</a></h2>
<h3 id="æ€§èƒ½ä¼˜åŒ–-1-2"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-1-2"><strong>æ€§èƒ½ä¼˜åŒ–</strong></a></h3>
<ol>
<li><strong>åˆ©ç”¨ Bun çš„é€Ÿåº¦ä¼˜åŠ¿</strong> - å……åˆ†ä½¿ç”¨å†…ç½® API</li>
<li><strong>åˆç†ä½¿ç”¨ Macros</strong> - åœ¨æ„å»ºæ—¶ç”Ÿæˆä¼˜åŒ–ä»£ç </li>
<li><strong>æ•°æ®åº“è¿æ¥å¤ç”¨</strong> - ä½¿ç”¨è¿æ¥æ± å’Œé¢„ç¼–è¯‘è¯­å¥</li>
<li><strong>é¿å…ä¸å¿…è¦çš„ä¾èµ–</strong> - åˆ©ç”¨ Bun çš„å†…ç½®åŠŸèƒ½</li>
</ol>
<h3 id="å¼€å‘ä½“éªŒ-1"><a class="header" href="#å¼€å‘ä½“éªŒ-1"><strong>å¼€å‘ä½“éªŒ</strong></a></h3>
<ol>
<li><strong>é›¶é…ç½® TypeScript</strong> - ç›´æ¥è¿è¡Œ .ts æ–‡ä»¶</li>
<li><strong>çƒ­é‡è½½å¼€å‘</strong> - ä½¿ç”¨ <code>--watch</code> æ ‡å¿—</li>
<li><strong>å†…ç½®æµ‹è¯•å·¥å…·</strong> - ä½¿ç”¨ <code>bun test</code> è¿›è¡Œå¿«é€Ÿæµ‹è¯•</li>
<li><strong>ä¸€ä½“åŒ–å·¥å…·é“¾</strong> - å‡å°‘å·¥å…·é…ç½®å¤æ‚åº¦</li>
</ol>
<h3 id="ç”Ÿäº§ç¯å¢ƒ-1"><a class="header" href="#ç”Ÿäº§ç¯å¢ƒ-1"><strong>ç”Ÿäº§ç¯å¢ƒ</strong></a></h3>
<ol>
<li><strong>å®¹å™¨åŒ–éƒ¨ç½²</strong> - ä½¿ç”¨å®˜æ–¹ Docker é•œåƒ</li>
<li><strong>ç¯å¢ƒå˜é‡ç®¡ç†</strong> - åˆç†é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡</li>
<li><strong>ç›‘æ§å’Œæ—¥å¿—</strong> - å®æ–½å®Œå–„çš„ç›‘æ§ä½“ç³»</li>
<li><strong>æ¸è¿›å¼è¿ç§»</strong> - ä» Node.js é€æ­¥è¿ç§»åˆ° Bun</li>
</ol>
<h3 id="ç”Ÿæ€å…¼å®¹æ€§"><a class="header" href="#ç”Ÿæ€å…¼å®¹æ€§"><strong>ç”Ÿæ€å…¼å®¹æ€§</strong></a></h3>
<ol>
<li><strong>Node.js API å…¼å®¹</strong> - å¤§éƒ¨åˆ†ç°æœ‰ä»£ç å¯ç›´æ¥è¿è¡Œ</li>
<li><strong>npm åŒ…æ”¯æŒ</strong> - å…¼å®¹ç°æœ‰çš„ npm ç”Ÿæ€</li>
<li><strong>æ¡†æ¶æ”¯æŒ</strong> - æ”¯æŒ Reactã€Vueã€Express ç­‰ä¸»æµæ¡†æ¶</li>
<li><strong>å·¥å…·é›†æˆ</strong> - ä¸ç°æœ‰å¼€å‘å·¥å…·é“¾è‰¯å¥½é›†æˆ</li>
</ol>
<p>Bun ä»£è¡¨äº† JavaScript è¿è¡Œæ—¶çš„ä¸‹ä¸€ä»£å‘å±•æ–¹å‘ï¼Œé€šè¿‡æè‡´çš„æ€§èƒ½ä¼˜åŒ–ã€ç°ä»£åŒ–çš„å·¥å…·é“¾å’Œä¼˜ç§€çš„å¼€å‘ä½“éªŒï¼Œä¸º JavaScript å¼€å‘è€…æä¾›äº†ä¸€ä¸ªå…¨æ–°çš„é€‰æ‹©ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ¨¡å—è®¾è®¡åŸåˆ™">æœ€ä½³å®è·µ</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ¨¡å—è®¾è®¡åŸåˆ™"><a class="header" href="#æ¨¡å—è®¾è®¡åŸåˆ™">æ¨¡å—è®¾è®¡åŸåˆ™</a></h1>
<p>è‰¯å¥½çš„æ¨¡å—è®¾è®¡æ˜¯æ„å»ºå¯ç»´æŠ¤ã€å¯æ‰©å±•åº”ç”¨çš„åŸºç¡€ã€‚æœ¬ç« å°†ä»‹ç»æ¨¡å—åŒ–å¼€å‘ä¸­çš„è®¾è®¡åŸåˆ™å’Œæœ€ä½³å®è·µã€‚</p>
<h2 id="solid-åŸåˆ™åœ¨æ¨¡å—åŒ–ä¸­çš„åº”ç”¨"><a class="header" href="#solid-åŸåˆ™åœ¨æ¨¡å—åŒ–ä¸­çš„åº”ç”¨">SOLID åŸåˆ™åœ¨æ¨¡å—åŒ–ä¸­çš„åº”ç”¨</a></h2>
<h3 id="1-å•ä¸€èŒè´£åŸåˆ™-single-responsibility-principle"><a class="header" href="#1-å•ä¸€èŒè´£åŸåˆ™-single-responsibility-principle">1. å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility Principle)</a></h3>
<p>æ¯ä¸ªæ¨¡å—åº”è¯¥åªæœ‰ä¸€ä¸ªå˜åŒ–çš„ç†ç”±ï¼Œå³åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸã€‚</p>
<h4 id="-è¿åå•ä¸€èŒè´£çš„ç¤ºä¾‹"><a class="header" href="#-è¿åå•ä¸€èŒè´£çš„ç¤ºä¾‹">âŒ è¿åå•ä¸€èŒè´£çš„ç¤ºä¾‹</a></h4>
<pre><code class="language-javascript">// user-manager.js - èŒè´£è¿‡å¤š
export class UserManager {
  // ç”¨æˆ·æ•°æ®ç®¡ç†
  async saveUser(user) {
    await this.validateUser(user);
    await this.sendEmail(user);
    return await this.database.save(user);
  }
  
  // æ•°æ®éªŒè¯
  validateUser(user) {
    if (!user.email || !user.name) {
      throw new Error('Invalid user data');
    }
  }
  
  // é‚®ä»¶å‘é€
  async sendEmail(user) {
    const emailClient = new EmailClient();
    await emailClient.send(user.email, 'Welcome!');
  }
  
  // æ•°æ®åº“æ“ä½œ
  async findUser(id) {
    return await this.database.find(id);
  }
}
</code></pre>
<h4 id="-éµå¾ªå•ä¸€èŒè´£çš„æ”¹è¿›"><a class="header" href="#-éµå¾ªå•ä¸€èŒè´£çš„æ”¹è¿›">âœ… éµå¾ªå•ä¸€èŒè´£çš„æ”¹è¿›</a></h4>
<pre><code class="language-javascript">// user-validator.js - åªè´Ÿè´£éªŒè¯
export class UserValidator {
  static validate(user) {
    if (!user.email || !user.name) {
      throw new Error('Invalid user data');
    }
    
    if (!this.isValidEmail(user.email)) {
      throw new Error('Invalid email format');
    }
  }
  
  static isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  }
}

// email-service.js - åªè´Ÿè´£é‚®ä»¶å‘é€
export class EmailService {
  constructor(config) {
    this.client = new EmailClient(config);
  }
  
  async sendWelcomeEmail(user) {
    const template = await this.loadTemplate('welcome');
    const content = this.renderTemplate(template, { name: user.name });
    return await this.client.send(user.email, 'Welcome!', content);
  }
  
  async loadTemplate(name) {
    // åŠ è½½é‚®ä»¶æ¨¡æ¿
  }
  
  renderTemplate(template, data) {
    // æ¸²æŸ“æ¨¡æ¿
  }
}

// user-repository.js - åªè´Ÿè´£æ•°æ®æŒä¹…åŒ–
export class UserRepository {
  constructor(database) {
    this.db = database;
  }
  
  async save(user) {
    return await this.db.collection('users').insert(user);
  }
  
  async findById(id) {
    return await this.db.collection('users').findOne({ _id: id });
  }
  
  async findByEmail(email) {
    return await this.db.collection('users').findOne({ email });
  }
}

// user-service.js - åè°ƒå„ä¸ªæœåŠ¡
export class UserService {
  constructor(userRepository, emailService) {
    this.userRepository = userRepository;
    this.emailService = emailService;
  }
  
  async createUser(userData) {
    // éªŒè¯ç”¨æˆ·æ•°æ®
    UserValidator.validate(userData);
    
    // æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²å­˜åœ¨
    const existingUser = await this.userRepository.findByEmail(userData.email);
    if (existingUser) {
      throw new Error('Email already exists');
    }
    
    // ä¿å­˜ç”¨æˆ·
    const user = await this.userRepository.save(userData);
    
    // å‘é€æ¬¢è¿é‚®ä»¶
    await this.emailService.sendWelcomeEmail(user);
    
    return user;
  }
}
</code></pre>
<h3 id="2-å¼€é—­åŸåˆ™-openclosed-principle"><a class="header" href="#2-å¼€é—­åŸåˆ™-openclosed-principle">2. å¼€é—­åŸåˆ™ (Open/Closed Principle)</a></h3>
<p>æ¨¡å—åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p>
<pre><code class="language-javascript">// æŠ½è±¡åŸºç±»
// payment-processor.js
export class PaymentProcessor {
  async process(payment) {
    throw new Error('Must implement process method');
  }
  
  async validate(payment) {
    if (!payment.amount || payment.amount &lt;= 0) {
      throw new Error('Invalid payment amount');
    }
  }
}

// å…·ä½“å®ç° - ä¸ä¿®æ”¹åŸºç±»ï¼Œåªæ‰©å±•
// stripe-processor.js
import { PaymentProcessor } from './payment-processor.js';

export class StripeProcessor extends PaymentProcessor {
  constructor(apiKey) {
    super();
    this.stripe = new Stripe(apiKey);
  }
  
  async process(payment) {
    await this.validate(payment);
    
    return await this.stripe.charges.create({
      amount: payment.amount,
      currency: payment.currency,
      source: payment.token
    });
  }
}

// paypal-processor.js
import { PaymentProcessor } from './payment-processor.js';

export class PayPalProcessor extends PaymentProcessor {
  constructor(config) {
    super();
    this.paypal = new PayPal(config);
  }
  
  async process(payment) {
    await this.validate(payment);
    
    return await this.paypal.payment.create({
      intent: 'sale',
      transactions: [{
        amount: {
          total: payment.amount,
          currency: payment.currency
        }
      }]
    });
  }
}

// payment-service.js - ä½¿ç”¨ç­–ç•¥æ¨¡å¼
export class PaymentService {
  constructor() {
    this.processors = new Map();
  }
  
  registerProcessor(type, processor) {
    this.processors.set(type, processor);
  }
  
  async processPayment(type, payment) {
    const processor = this.processors.get(type);
    if (!processor) {
      throw new Error(`Unsupported payment type: ${type}`);
    }
    
    return await processor.process(payment);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const paymentService = new PaymentService();
paymentService.registerProcessor('stripe', new StripeProcessor(apiKey));
paymentService.registerProcessor('paypal', new PayPalProcessor(config));

// æ·»åŠ æ–°çš„æ”¯ä»˜æ–¹å¼ä¸éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç 
paymentService.registerProcessor('alipay', new AlipayProcessor(config));
</code></pre>
<h3 id="3-é‡Œæ°æ›¿æ¢åŸåˆ™-liskov-substitution-principle"><a class="header" href="#3-é‡Œæ°æ›¿æ¢åŸåˆ™-liskov-substitution-principle">3. é‡Œæ°æ›¿æ¢åŸåˆ™ (Liskov Substitution Principle)</a></h3>
<p>å­ç±»å¿…é¡»èƒ½å¤Ÿæ›¿æ¢å…¶çˆ¶ç±»è€Œä¸å½±å“ç¨‹åºçš„æ­£ç¡®æ€§ã€‚</p>
<pre><code class="language-javascript">// cache-interface.js
export class CacheInterface {
  async get(key) {
    throw new Error('Must implement get method');
  }
  
  async set(key, value, ttl = 3600) {
    throw new Error('Must implement set method');
  }
  
  async delete(key) {
    throw new Error('Must implement delete method');
  }
}

// memory-cache.js
import { CacheInterface } from './cache-interface.js';

export class MemoryCache extends CacheInterface {
  constructor() {
    super();
    this.cache = new Map();
    this.timers = new Map();
  }
  
  async get(key) {
    return this.cache.get(key) || null;
  }
  
  async set(key, value, ttl = 3600) {
    this.cache.set(key, value);
    
    // æ¸…é™¤æ—§çš„å®šæ—¶å™¨
    if (this.timers.has(key)) {
      clearTimeout(this.timers.get(key));
    }
    
    // è®¾ç½®æ–°çš„è¿‡æœŸå®šæ—¶å™¨
    const timer = setTimeout(() =&gt; {
      this.cache.delete(key);
      this.timers.delete(key);
    }, ttl * 1000);
    
    this.timers.set(key, timer);
  }
  
  async delete(key) {
    this.cache.delete(key);
    if (this.timers.has(key)) {
      clearTimeout(this.timers.get(key));
      this.timers.delete(key);
    }
  }
}

// redis-cache.js
import { CacheInterface } from './cache-interface.js';

export class RedisCache extends CacheInterface {
  constructor(client) {
    super();
    this.redis = client;
  }
  
  async get(key) {
    return await this.redis.get(key);
  }
  
  async set(key, value, ttl = 3600) {
    return await this.redis.setex(key, ttl, JSON.stringify(value));
  }
  
  async delete(key) {
    return await this.redis.del(key);
  }
}

// user-service.js - å¯ä»¥æ— ç¼æ›¿æ¢ç¼“å­˜å®ç°
export class UserService {
  constructor(userRepository, cache) {
    this.userRepository = userRepository;
    this.cache = cache; // å¯ä»¥æ˜¯ MemoryCache æˆ– RedisCache
  }
  
  async getUser(id) {
    const cacheKey = `user:${id}`;
    
    // å…ˆä»ç¼“å­˜è·å–
    let user = await this.cache.get(cacheKey);
    if (user) {
      return JSON.parse(user);
    }
    
    // ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æ•°æ®åº“è·å–
    user = await this.userRepository.findById(id);
    if (user) {
      await this.cache.set(cacheKey, JSON.stringify(user), 1800);
    }
    
    return user;
  }
}
</code></pre>
<h3 id="4-æ¥å£éš”ç¦»åŸåˆ™-interface-segregation-principle"><a class="header" href="#4-æ¥å£éš”ç¦»åŸåˆ™-interface-segregation-principle">4. æ¥å£éš”ç¦»åŸåˆ™ (Interface Segregation Principle)</a></h3>
<p>ä¸åº”è¯¥å¼ºè¿«å®¢æˆ·ç«¯ä¾èµ–äºå®ƒä»¬ä¸ä½¿ç”¨çš„æ¥å£ã€‚</p>
<h4 id="-è¿åæ¥å£éš”ç¦»çš„ç¤ºä¾‹"><a class="header" href="#-è¿åæ¥å£éš”ç¦»çš„ç¤ºä¾‹">âŒ è¿åæ¥å£éš”ç¦»çš„ç¤ºä¾‹</a></h4>
<pre><code class="language-javascript">// è‡ƒè‚¿çš„æ¥å£
export class DatabaseService {
  // ç”¨æˆ·ç›¸å…³
  async createUser(user) { /* ... */ }
  async updateUser(id, user) { /* ... */ }
  async deleteUser(id) { /* ... */ }
  
  // è®¢å•ç›¸å…³
  async createOrder(order) { /* ... */ }
  async updateOrder(id, order) { /* ... */ }
  async deleteOrder(id) { /* ... */ }
  
  // äº§å“ç›¸å…³
  async createProduct(product) { /* ... */ }
  async updateProduct(id, product) { /* ... */ }
  async deleteProduct(id) { /* ... */ }
  
  // æŠ¥è¡¨ç›¸å…³
  async generateUserReport() { /* ... */ }
  async generateOrderReport() { /* ... */ }
  async generateProductReport() { /* ... */ }
}
</code></pre>
<h4 id="-éµå¾ªæ¥å£éš”ç¦»çš„æ”¹è¿›"><a class="header" href="#-éµå¾ªæ¥å£éš”ç¦»çš„æ”¹è¿›">âœ… éµå¾ªæ¥å£éš”ç¦»çš„æ”¹è¿›</a></h4>
<pre><code class="language-javascript">// ç»†åˆ†çš„æ¥å£
// user-operations.js
export class UserOperations {
  constructor(database) {
    this.db = database;
  }
  
  async create(user) {
    return await this.db.collection('users').insert(user);
  }
  
  async update(id, user) {
    return await this.db.collection('users').update({ _id: id }, user);
  }
  
  async delete(id) {
    return await this.db.collection('users').delete({ _id: id });
  }
  
  async findById(id) {
    return await this.db.collection('users').findOne({ _id: id });
  }
}

// order-operations.js
export class OrderOperations {
  constructor(database) {
    this.db = database;
  }
  
  async create(order) {
    return await this.db.collection('orders').insert(order);
  }
  
  async findByUserId(userId) {
    return await this.db.collection('orders').find({ userId });
  }
  
  async updateStatus(id, status) {
    return await this.db.collection('orders').update(
      { _id: id }, 
      { $set: { status, updatedAt: new Date() } }
    );
  }
}

// report-generator.js
export class ReportGenerator {
  constructor(database) {
    this.db = database;
  }
  
  async generateUserReport(startDate, endDate) {
    return await this.db.collection('users').aggregate([
      { $match: { createdAt: { $gte: startDate, $lte: endDate } } },
      { $group: { _id: null, count: { $sum: 1 } } }
    ]);
  }
  
  async generateOrderReport(startDate, endDate) {
    return await this.db.collection('orders').aggregate([
      { $match: { createdAt: { $gte: startDate, $lte: endDate } } },
      { $group: { _id: '$status', count: { $sum: 1 }, total: { $sum: '$amount' } } }
    ]);
  }
}

// å®¢æˆ·ç«¯åªä¾èµ–éœ€è¦çš„æ¥å£
// user-service.js
import { UserOperations } from './user-operations.js';

export class UserService {
  constructor(database) {
    this.userOps = new UserOperations(database);
  }
  
  async createUser(userData) {
    // åªéœ€è¦ç”¨æˆ·æ“ä½œæ¥å£
    return await this.userOps.create(userData);
  }
}
</code></pre>
<h3 id="5-ä¾èµ–å€’ç½®åŸåˆ™-dependency-inversion-principle"><a class="header" href="#5-ä¾èµ–å€’ç½®åŸåˆ™-dependency-inversion-principle">5. ä¾èµ–å€’ç½®åŸåˆ™ (Dependency Inversion Principle)</a></h3>
<p>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p>
<pre><code class="language-javascript">// æŠ½è±¡å±‚
// logger-interface.js
export class LoggerInterface {
  info(message, meta = {}) {
    throw new Error('Must implement info method');
  }
  
  error(message, error = null, meta = {}) {
    throw new Error('Must implement error method');
  }
  
  warn(message, meta = {}) {
    throw new Error('Must implement warn method');
  }
}

// notification-interface.js
export class NotificationInterface {
  async send(recipient, message, options = {}) {
    throw new Error('Must implement send method');
  }
}

// å…·ä½“å®ç°
// console-logger.js
import { LoggerInterface } from './logger-interface.js';

export class ConsoleLogger extends LoggerInterface {
  info(message, meta = {}) {
    console.log(`[INFO] ${new Date().toISOString()} - ${message}`, meta);
  }
  
  error(message, error = null, meta = {}) {
    console.error(`[ERROR] ${new Date().toISOString()} - ${message}`, {
      error: error?.stack || error,
      ...meta
    });
  }
  
  warn(message, meta = {}) {
    console.warn(`[WARN] ${new Date().toISOString()} - ${message}`, meta);
  }
}

// file-logger.js
import { LoggerInterface } from './logger-interface.js';
import fs from 'fs/promises';

export class FileLogger extends LoggerInterface {
  constructor(logFile) {
    super();
    this.logFile = logFile;
  }
  
  async info(message, meta = {}) {
    await this.writeLog('INFO', message, meta);
  }
  
  async error(message, error = null, meta = {}) {
    await this.writeLog('ERROR', message, { error: error?.stack || error, ...meta });
  }
  
  async warn(message, meta = {}) {
    await this.writeLog('WARN', message, meta);
  }
  
  async writeLog(level, message, meta) {
    const timestamp = new Date().toISOString();
    const logEntry = JSON.stringify({ timestamp, level, message, meta }) + '\n';
    await fs.appendFile(this.logFile, logEntry);
  }
}

// email-notification.js
import { NotificationInterface } from './notification-interface.js';

export class EmailNotification extends NotificationInterface {
  constructor(emailService) {
    super();
    this.emailService = emailService;
  }
  
  async send(recipient, message, options = {}) {
    return await this.emailService.send({
      to: recipient,
      subject: options.subject || 'Notification',
      body: message,
      html: options.html || false
    });
  }
}

// é«˜å±‚æ¨¡å—ä¾èµ–æŠ½è±¡
// order-service.js
export class OrderService {
  constructor(orderRepository, logger, notificationService) {
    this.orderRepository = orderRepository;
    this.logger = logger; // ä¾èµ–æŠ½è±¡ï¼Œä¸æ˜¯å…·ä½“å®ç°
    this.notificationService = notificationService; // ä¾èµ–æŠ½è±¡
  }
  
  async createOrder(orderData) {
    try {
      this.logger.info('Creating new order', { orderData });
      
      const order = await this.orderRepository.create(orderData);
      
      await this.notificationService.send(
        orderData.customerEmail,
        `Your order ${order.id} has been created successfully`,
        { subject: 'Order Confirmation' }
      );
      
      this.logger.info('Order created successfully', { orderId: order.id });
      return order;
      
    } catch (error) {
      this.logger.error('Failed to create order', error, { orderData });
      throw error;
    }
  }
}

// ä¾èµ–æ³¨å…¥é…ç½®
// app.js
import { OrderService } from './order-service.js';
import { ConsoleLogger } from './console-logger.js';
import { EmailNotification } from './email-notification.js';

// å¯ä»¥è½»æ¾åˆ‡æ¢ä¸åŒçš„å®ç°
const logger = new ConsoleLogger(); // æˆ– new FileLogger('./app.log')
const notificationService = new EmailNotification(emailService);

const orderService = new OrderService(orderRepository, logger, notificationService);
</code></pre>
<h2 id="æ¨¡å—è€¦åˆå’Œå†…èš"><a class="header" href="#æ¨¡å—è€¦åˆå’Œå†…èš">æ¨¡å—è€¦åˆå’Œå†…èš</a></h2>
<h3 id="é«˜å†…èšçš„æ¨¡å—è®¾è®¡"><a class="header" href="#é«˜å†…èšçš„æ¨¡å—è®¾è®¡">é«˜å†…èšçš„æ¨¡å—è®¾è®¡</a></h3>
<p>æ¨¡å—å†…éƒ¨çš„å…ƒç´ åº”è¯¥ç´§å¯†ç›¸å…³ï¼Œå…±åŒå®Œæˆä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½ã€‚</p>
<pre><code class="language-javascript">// é«˜å†…èšçš„ç”¨æˆ·è®¤è¯æ¨¡å—
// auth-module.js
export class AuthModule {
  constructor(userRepository, tokenService, passwordService) {
    this.userRepository = userRepository;
    this.tokenService = tokenService;
    this.passwordService = passwordService;
  }
  
  // æ‰€æœ‰æ–¹æ³•éƒ½ä¸è®¤è¯ç›¸å…³
  async login(email, password) {
    const user = await this.userRepository.findByEmail(email);
    if (!user) {
      throw new Error('User not found');
    }
    
    const isValidPassword = await this.passwordService.verify(password, user.hashedPassword);
    if (!isValidPassword) {
      throw new Error('Invalid password');
    }
    
    return this.tokenService.generate(user.id);
  }
  
  async register(userData) {
    const hashedPassword = await this.passwordService.hash(userData.password);
    const user = await this.userRepository.create({
      ...userData,
      hashedPassword
    });
    
    return this.tokenService.generate(user.id);
  }
  
  async verifyToken(token) {
    return this.tokenService.verify(token);
  }
  
  async refreshToken(refreshToken) {
    const userId = await this.tokenService.verifyRefresh(refreshToken);
    return this.tokenService.generate(userId);
  }
  
  async logout(token) {
    return this.tokenService.revoke(token);
  }
}
</code></pre>
<h3 id="ä½è€¦åˆçš„æ¨¡å—é—´é€šä¿¡"><a class="header" href="#ä½è€¦åˆçš„æ¨¡å—é—´é€šä¿¡">ä½è€¦åˆçš„æ¨¡å—é—´é€šä¿¡</a></h3>
<p>æ¨¡å—ä¹‹é—´çš„ä¾èµ–åº”è¯¥æœ€å°åŒ–ï¼Œé€šè¿‡æ˜ç¡®çš„æ¥å£è¿›è¡Œé€šä¿¡ã€‚</p>
<pre><code class="language-javascript">// äº‹ä»¶é©±åŠ¨çš„ä½è€¦åˆæ¶æ„
// event-bus.js
export class EventBus {
  constructor() {
    this.listeners = new Map();
  }
  
  on(event, callback) {
    if (!this.listeners.has(event)) {
      this.listeners.set(event, []);
    }
    this.listeners.get(event).push(callback);
  }
  
  off(event, callback) {
    const callbacks = this.listeners.get(event);
    if (callbacks) {
      const index = callbacks.indexOf(callback);
      if (index &gt; -1) {
        callbacks.splice(index, 1);
      }
    }
  }
  
  emit(event, data) {
    const callbacks = this.listeners.get(event) || [];
    callbacks.forEach(callback =&gt; {
      try {
        callback(data);
      } catch (error) {
        console.error(`Error in event listener for ${event}:`, error);
      }
    });
  }
}

// order-service.js - å‘å¸ƒäº‹ä»¶ï¼Œä¸ç›´æ¥ä¾èµ–å…¶ä»–æœåŠ¡
export class OrderService {
  constructor(orderRepository, eventBus) {
    this.orderRepository = orderRepository;
    this.eventBus = eventBus;
  }
  
  async createOrder(orderData) {
    const order = await this.orderRepository.create(orderData);
    
    // å‘å¸ƒäº‹ä»¶è€Œä¸æ˜¯ç›´æ¥è°ƒç”¨å…¶ä»–æœåŠ¡
    this.eventBus.emit('order.created', {
      orderId: order.id,
      customerId: order.customerId,
      amount: order.amount,
      createdAt: order.createdAt
    });
    
    return order;
  }
}

// notification-service.js - ç›‘å¬äº‹ä»¶
export class NotificationService {
  constructor(emailService, eventBus) {
    this.emailService = emailService;
    this.eventBus = eventBus;
    
    // è®¢é˜…ç›¸å…³äº‹ä»¶
    this.eventBus.on('order.created', this.handleOrderCreated.bind(this));
    this.eventBus.on('user.registered', this.handleUserRegistered.bind(this));
  }
  
  async handleOrderCreated(orderData) {
    await this.emailService.send(
      orderData.customerEmail,
      'Order Confirmation',
      `Your order ${orderData.orderId} has been confirmed.`
    );
  }
  
  async handleUserRegistered(userData) {
    await this.emailService.send(
      userData.email,
      'Welcome!',
      `Welcome to our platform, ${userData.name}!`
    );
  }
}

// analytics-service.js - ç‹¬ç«‹çš„åˆ†ææœåŠ¡
export class AnalyticsService {
  constructor(analyticsRepository, eventBus) {
    this.analyticsRepository = analyticsRepository;
    this.eventBus = eventBus;
    
    // è®¢é˜…æ‰€æœ‰æ„Ÿå…´è¶£çš„äº‹ä»¶
    this.eventBus.on('order.created', this.trackOrderCreated.bind(this));
    this.eventBus.on('user.registered', this.trackUserRegistered.bind(this));
    this.eventBus.on('user.login', this.trackUserLogin.bind(this));
  }
  
  async trackOrderCreated(orderData) {
    await this.analyticsRepository.recordEvent('order_created', {
      orderId: orderData.orderId,
      amount: orderData.amount,
      timestamp: orderData.createdAt
    });
  }
  
  async trackUserRegistered(userData) {
    await this.analyticsRepository.recordEvent('user_registered', {
      userId: userData.id,
      timestamp: userData.createdAt
    });
  }
  
  async trackUserLogin(loginData) {
    await this.analyticsRepository.recordEvent('user_login', {
      userId: loginData.userId,
      timestamp: loginData.timestamp
    });
  }
}
</code></pre>
<h2 id="æ¨¡å—å‘½åå’Œç»„ç»‡"><a class="header" href="#æ¨¡å—å‘½åå’Œç»„ç»‡">æ¨¡å—å‘½åå’Œç»„ç»‡</a></h2>
<h3 id="æ¸…æ™°çš„å‘½åçº¦å®š"><a class="header" href="#æ¸…æ™°çš„å‘½åçº¦å®š">æ¸…æ™°çš„å‘½åçº¦å®š</a></h3>
<pre><code class="language-javascript">// å¥½çš„å‘½åçº¦å®š
// services/user-authentication.service.js
export class UserAuthenticationService { }

// repositories/user.repository.js
export class UserRepository { }

// models/user.model.js
export class User { }

// utils/date.utils.js
export const DateUtils = { };

// config/database.config.js
export const databaseConfig = { };

// types/user.types.js
export interface User { }

// constants/http-status.constants.js
export const HTTP_STATUS = { };
</code></pre>
<h3 id="ç›®å½•ç»“æ„ç»„ç»‡"><a class="header" href="#ç›®å½•ç»“æ„ç»„ç»‡">ç›®å½•ç»“æ„ç»„ç»‡</a></h3>
<pre><code>src/
â”œâ”€â”€ components/           # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ ui/              # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ button/
â”‚   â”‚   â”œâ”€â”€ input/
â”‚   â”‚   â””â”€â”€ modal/
â”‚   â””â”€â”€ business/        # ä¸šåŠ¡ç»„ä»¶
â”‚       â”œâ”€â”€ user-profile/
â”‚       â””â”€â”€ order-summary/
â”œâ”€â”€ services/            # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ user.service.js
â”‚   â”œâ”€â”€ order.service.js
â”‚   â””â”€â”€ payment.service.js
â”œâ”€â”€ repositories/        # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ user.repository.js
â”‚   â””â”€â”€ order.repository.js
â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ user.model.js
â”‚   â””â”€â”€ order.model.js
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ date.utils.js
â”‚   â”œâ”€â”€ validation.utils.js
â”‚   â””â”€â”€ format.utils.js
â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ app.config.js
â”‚   â”œâ”€â”€ database.config.js
â”‚   â””â”€â”€ api.config.js
â”œâ”€â”€ types/              # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ user.types.ts
â”‚   â””â”€â”€ api.types.ts
â”œâ”€â”€ constants/          # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ http-status.constants.js
â”‚   â””â”€â”€ error-codes.constants.js
â””â”€â”€ tests/              # æµ‹è¯•æ–‡ä»¶
    â”œâ”€â”€ unit/
    â”œâ”€â”€ integration/
    â””â”€â”€ e2e/
</code></pre>
<h2 id="æ¨¡å—ç‰ˆæœ¬ç®¡ç†"><a class="header" href="#æ¨¡å—ç‰ˆæœ¬ç®¡ç†">æ¨¡å—ç‰ˆæœ¬ç®¡ç†</a></h2>
<h3 id="è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶"><a class="header" href="#è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶">è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶</a></h3>
<pre><code class="language-json">// package.json
{
  "name": "@mycompany/user-service",
  "version": "1.2.3",
  "description": "User management service",
  "main": "dist/index.js",
  "exports": {
    ".": {
      "import": "./dist/esm/index.js",
      "require": "./dist/cjs/index.js",
      "types": "./dist/types/index.d.ts"
    },
    "./types": {
      "import": "./dist/esm/types.js",
      "require": "./dist/cjs/types.js",
      "types": "./dist/types/types.d.ts"
    }
  },
  "files": [
    "dist/"
  ],
  "engines": {
    "node": "&gt;=16.0.0"
  }
}
</code></pre>
<h3 id="å‘åå…¼å®¹çš„-api-è®¾è®¡"><a class="header" href="#å‘åå…¼å®¹çš„-api-è®¾è®¡">å‘åå…¼å®¹çš„ API è®¾è®¡</a></h3>
<pre><code class="language-javascript">// v1.0.0 - åˆå§‹ç‰ˆæœ¬
export class UserService {
  async getUser(id) {
    return await this.userRepository.findById(id);
  }
}

// v1.1.0 - æ·»åŠ æ–°åŠŸèƒ½ï¼Œä¿æŒå‘åå…¼å®¹
export class UserService {
  async getUser(id) {
    return await this.userRepository.findById(id);
  }
  
  // æ–°å¢æ–¹æ³•
  async getUserWithProfile(id) {
    const user = await this.userRepository.findById(id);
    const profile = await this.profileRepository.findByUserId(id);
    return { ...user, profile };
  }
}

// v2.0.0 - ç ´åæ€§å˜æ›´ï¼Œæ–°çš„ä¸»ç‰ˆæœ¬
export class UserService {
  // ä¿®æ”¹æ–¹æ³•ç­¾åï¼Œè¿”å›ç»“æ„å˜åŒ–
  async getUser(id, options = {}) {
    const user = await this.userRepository.findById(id);
    
    if (options.includeProfile) {
      const profile = await this.profileRepository.findByUserId(id);
      return { user, profile };
    }
    
    return { user };
  }
  
  // åºŸå¼ƒçš„æ–¹æ³•æ ‡è®°
  /**
   * @deprecated Use getUser with options.includeProfile instead
   */
  async getUserWithProfile(id) {
    console.warn('getUserWithProfile is deprecated. Use getUser with options.includeProfile instead.');
    return this.getUser(id, { includeProfile: true });
  }
}
</code></pre>
<h2 id="æ€»ç»“-17"><a class="header" href="#æ€»ç»“-17">æ€»ç»“</a></h2>
<p>è‰¯å¥½çš„æ¨¡å—è®¾è®¡åŸåˆ™åŒ…æ‹¬ï¼š</p>
<h3 id="-æ ¸å¿ƒåŸåˆ™"><a class="header" href="#-æ ¸å¿ƒåŸåˆ™">ğŸ¯ <strong>æ ¸å¿ƒåŸåˆ™</strong></a></h3>
<ul>
<li><strong>SOLIDåŸåˆ™</strong>: å•ä¸€èŒè´£ã€å¼€é—­ã€é‡Œæ°æ›¿æ¢ã€æ¥å£éš”ç¦»ã€ä¾èµ–å€’ç½®</li>
<li><strong>é«˜å†…èšä½è€¦åˆ</strong>: æ¨¡å—å†…éƒ¨ç´§å¯†ç›¸å…³ï¼Œæ¨¡å—é—´ä¾èµ–æœ€å°</li>
<li><strong>æ˜ç¡®çš„æ¥å£</strong>: æ¸…æ™°çš„è¾“å…¥è¾“å‡ºå’ŒèŒè´£è¾¹ç•Œ</li>
</ul>
<h3 id="-å‘½åå’Œç»„ç»‡"><a class="header" href="#-å‘½åå’Œç»„ç»‡">ğŸ“ <strong>å‘½åå’Œç»„ç»‡</strong></a></h3>
<ul>
<li><strong>ä¸€è‡´çš„å‘½åçº¦å®š</strong>: æ¸…æ™°è¡¨è¾¾æ¨¡å—ç”¨é€”</li>
<li><strong>åˆç†çš„ç›®å½•ç»“æ„</strong>: æŒ‰åŠŸèƒ½å’Œå±‚æ¬¡ç»„ç»‡</li>
<li><strong>è¯­ä¹‰åŒ–ç‰ˆæœ¬</strong>: æ˜ç¡®çš„ç‰ˆæœ¬å˜æ›´ç­–ç•¥</li>
</ul>
<h3 id="-æŒç»­æ”¹è¿›"><a class="header" href="#-æŒç»­æ”¹è¿›">ğŸ”„ <strong>æŒç»­æ”¹è¿›</strong></a></h3>
<ul>
<li><strong>å®šæœŸé‡æ„</strong>: ä¿æŒä»£ç è´¨é‡</li>
<li><strong>ä»£ç å®¡æŸ¥</strong>: ç¡®ä¿è®¾è®¡åŸåˆ™çš„æ‰§è¡Œ</li>
<li><strong>æ–‡æ¡£ç»´æŠ¤</strong>: ä¿æŒæ–‡æ¡£ä¸ä»£ç åŒæ­¥</li>
</ul>
<p>éµå¾ªè¿™äº›è®¾è®¡åŸåˆ™å¯ä»¥æ„å»ºå‡ºæ˜“äºç»´æŠ¤ã€æµ‹è¯•å’Œæ‰©å±•çš„æ¨¡å—åŒ–åº”ç”¨ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ€§èƒ½ä¼˜åŒ–-8">æ€§èƒ½ä¼˜åŒ–</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ€§èƒ½ä¼˜åŒ–-8"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-8">æ€§èƒ½ä¼˜åŒ–</a></h1>
<p>åœ¨ç°ä»£Webåº”ç”¨å¼€å‘ä¸­ï¼Œæ¨¡å—çš„æ€§èƒ½ä¼˜åŒ–å¯¹ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨JavaScriptæ¨¡å—ç³»ç»Ÿçš„å„ç§æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ã€‚</p>
<h2 id="ä»£ç åˆ†å‰²-code-splitting"><a class="header" href="#ä»£ç åˆ†å‰²-code-splitting">ä»£ç åˆ†å‰² (Code Splitting)</a></h2>
<p>ä»£ç åˆ†å‰²æ˜¯æœ€é‡è¦çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ä¹‹ä¸€ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªè¾ƒå°çš„åŒ…ï¼ŒæŒ‰éœ€åŠ è½½ã€‚</p>
<h3 id="åŠ¨æ€å¯¼å…¥å®ç°ä»£ç åˆ†å‰²"><a class="header" href="#åŠ¨æ€å¯¼å…¥å®ç°ä»£ç åˆ†å‰²">åŠ¨æ€å¯¼å…¥å®ç°ä»£ç åˆ†å‰²</a></h3>
<pre><code class="language-javascript">// è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
const routes = [
  {
    path: '/dashboard',
    component: () =&gt; import('./views/Dashboard.vue')
  },
  {
    path: '/profile',
    component: () =&gt; import('./views/Profile.vue')
  }
];

// åŠŸèƒ½çº§åˆ«çš„ä»£ç åˆ†å‰²
async function loadImageEditor() {
  const { ImageEditor } = await import('./components/ImageEditor.js');
  return new ImageEditor();
}

// æ¡ä»¶åŠ è½½
if (window.innerWidth &gt; 768) {
  const { DesktopLayout } = await import('./layouts/DesktopLayout.js');
  app.use(DesktopLayout);
} else {
  const { MobileLayout } = await import('./layouts/MobileLayout.js');
  app.use(MobileLayout);
}
</code></pre>
<h3 id="bundle-splittingç­–ç•¥"><a class="header" href="#bundle-splittingç­–ç•¥">Bundle Splittingç­–ç•¥</a></h3>
<pre><code class="language-javascript">// webpack.config.js
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        // ç¬¬ä¸‰æ–¹åº“å•ç‹¬æ‰“åŒ…
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
        // å…¬å…±ä»£ç æå–
        common: {
          name: 'common',
          minChunks: 2,
          chunks: 'all',
          enforce: true
        }
      }
    }
  }
};

// Viteé…ç½®
export default {
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          utils: ['lodash', 'moment'],
          ui: ['antd', '@mui/material']
        }
      }
    }
  }
};
</code></pre>
<h2 id="æ‡’åŠ è½½ä¸é¢„åŠ è½½"><a class="header" href="#æ‡’åŠ è½½ä¸é¢„åŠ è½½">æ‡’åŠ è½½ä¸é¢„åŠ è½½</a></h2>
<h3 id="æ¨¡å—æ‡’åŠ è½½æ¨¡å¼"><a class="header" href="#æ¨¡å—æ‡’åŠ è½½æ¨¡å¼">æ¨¡å—æ‡’åŠ è½½æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// æ‡’åŠ è½½ç®¡ç†å™¨
class LazyModuleLoader {
  constructor() {
    this.loadedModules = new Map();
    this.loadingPromises = new Map();
  }

  async load(moduleName, importFn) {
    // å¦‚æœå·²åŠ è½½ï¼Œç›´æ¥è¿”å›
    if (this.loadedModules.has(moduleName)) {
      return this.loadedModules.get(moduleName);
    }

    // å¦‚æœæ­£åœ¨åŠ è½½ï¼Œè¿”å›åŠ è½½Promise
    if (this.loadingPromises.has(moduleName)) {
      return this.loadingPromises.get(moduleName);
    }

    // å¼€å§‹åŠ è½½
    const loadPromise = importFn().then(module =&gt; {
      this.loadedModules.set(moduleName, module);
      this.loadingPromises.delete(moduleName);
      return module;
    });

    this.loadingPromises.set(moduleName, loadPromise);
    return loadPromise;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const loader = new LazyModuleLoader();

async function initChart() {
  const module = await loader.load('chart', () =&gt; import('./chart/Chart.js'));
  return new module.Chart();
}
</code></pre>
<h3 id="æ™ºèƒ½é¢„åŠ è½½"><a class="header" href="#æ™ºèƒ½é¢„åŠ è½½">æ™ºèƒ½é¢„åŠ è½½</a></h3>
<pre><code class="language-javascript">// é¢„åŠ è½½ç­–ç•¥
class PreloadManager {
  constructor() {
    this.preloadedModules = new Set();
    this.observer = new IntersectionObserver(this.handleIntersection.bind(this));
  }

  // é¢„åŠ è½½å…³é”®æ¨¡å—
  preloadCritical() {
    this.preload(() =&gt; import('./core/UserManager.js'));
    this.preload(() =&gt; import('./core/Router.js'));
  }

  // æ ¹æ®ç”¨æˆ·è¡Œä¸ºé¢„åŠ è½½
  preloadOnHover(element, importFn) {
    element.addEventListener('mouseenter', () =&gt; {
      this.preload(importFn);
    }, { once: true });
  }

  // è§†å£é¢„åŠ è½½
  preloadOnVisible(element, importFn) {
    element.dataset.preload = importFn.toString();
    this.observer.observe(element);
  }

  async preload(importFn) {
    const moduleKey = importFn.toString();
    if (this.preloadedModules.has(moduleKey)) return;

    this.preloadedModules.add(moduleKey);
    
    // ä½¿ç”¨linké¢„åŠ è½½
    const link = document.createElement('link');
    link.rel = 'modulepreload';
    link.href = this.getModuleURL(importFn);
    document.head.appendChild(link);
  }

  handleIntersection(entries) {
    entries.forEach(entry =&gt; {
      if (entry.isIntersecting) {
        const importFn = new Function('return ' + entry.target.dataset.preload)();
        this.preload(importFn);
        this.observer.unobserve(entry.target);
      }
    });
  }
}
</code></pre>
<h2 id="tree-shakingä¼˜åŒ–"><a class="header" href="#tree-shakingä¼˜åŒ–">Tree Shakingä¼˜åŒ–</a></h2>
<h3 id="esæ¨¡å—tree-shakingæœ€ä½³å®è·µ"><a class="header" href="#esæ¨¡å—tree-shakingæœ€ä½³å®è·µ">ESæ¨¡å—Tree Shakingæœ€ä½³å®è·µ</a></h3>
<pre><code class="language-javascript">// é”™è¯¯çš„å¯¼å…¥æ–¹å¼ - ä¼šå¯¼å…¥æ•´ä¸ªåº“
import * as _ from 'lodash';
import { Button } from '@mui/material';

// æ­£ç¡®çš„å¯¼å…¥æ–¹å¼ - æ”¯æŒTree Shaking
import { debounce } from 'lodash-es';
import Button from '@mui/material/Button';

// utils.js - ç¡®ä¿å¯è¢«Tree Shaking
export const formatDate = (date) =&gt; {
  return new Intl.DateTimeFormat('zh-CN').format(date);
};

export const formatCurrency = (amount) =&gt; {
  return new Intl.NumberFormat('zh-CN', {
    style: 'currency',
    currency: 'CNY'
  }).format(amount);
};

// é¿å…å‰¯ä½œç”¨
export const API_BASE_URL = 'https://api.example.com';

// è€Œä¸æ˜¯
console.log('API module loaded'); // è¿™ä¼šé˜»æ­¢Tree Shaking
export const API_BASE_URL = 'https://api.example.com';
</code></pre>
<h3 id="åº“çš„tree-shakingå‹å¥½è®¾è®¡"><a class="header" href="#åº“çš„tree-shakingå‹å¥½è®¾è®¡">åº“çš„Tree Shakingå‹å¥½è®¾è®¡</a></h3>
<pre><code class="language-javascript">// package.json
{
  "name": "my-utils",
  "main": "dist/index.js",
  "module": "dist/index.esm.js",
  "sideEffects": false,
  "exports": {
    ".": {
      "import": "./dist/index.esm.js",
      "require": "./dist/index.js"
    },
    "./string": {
      "import": "./dist/string.esm.js",
      "require": "./dist/string.js"
    }
  }
}

// æ¨¡å—åŒ–å¯¼å‡ºç»“æ„
// src/index.js
export { default as formatDate } from './date/formatDate.js';
export { default as formatCurrency } from './currency/formatCurrency.js';
export { default as debounce } from './function/debounce.js';
export { default as throttle } from './function/throttle.js';

// åˆ†ç±»å¯¼å‡º
// src/string/index.js
export { default as capitalize } from './capitalize.js';
export { default as slugify } from './slugify.js';
</code></pre>
<h2 id="ç¼“å­˜ç­–ç•¥-1"><a class="header" href="#ç¼“å­˜ç­–ç•¥-1">ç¼“å­˜ç­–ç•¥</a></h2>
<h3 id="æ¨¡å—ç¼“å­˜ä¼˜åŒ–"><a class="header" href="#æ¨¡å—ç¼“å­˜ä¼˜åŒ–">æ¨¡å—ç¼“å­˜ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// æµè§ˆå™¨ç¼“å­˜ç­–ç•¥
class ModuleCache {
  constructor() {
    this.cache = new Map();
    this.version = '1.0.0';
  }

  async loadWithCache(moduleId, importFn) {
    const cacheKey = `${moduleId}_${this.version}`;
    
    // æ£€æŸ¥å†…å­˜ç¼“å­˜
    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey);
    }

    // æ£€æŸ¥localStorageç¼“å­˜
    const cached = this.getFromLocalStorage(cacheKey);
    if (cached) {
      this.cache.set(cacheKey, cached);
      return cached;
    }

    // åŠ è½½å¹¶ç¼“å­˜
    const module = await importFn();
    this.cache.set(cacheKey, module);
    this.saveToLocalStorage(cacheKey, module);
    
    return module;
  }

  getFromLocalStorage(key) {
    try {
      const item = localStorage.getItem(key);
      return item ? JSON.parse(item) : null;
    } catch {
      return null;
    }
  }

  saveToLocalStorage(key, data) {
    try {
      localStorage.setItem(key, JSON.stringify(data));
    } catch {
      // å­˜å‚¨å¤±è´¥æ—¶çš„é™çº§å¤„ç†
    }
  }
}
</code></pre>
<h3 id="httpç¼“å­˜é…ç½®"><a class="header" href="#httpç¼“å­˜é…ç½®">HTTPç¼“å­˜é…ç½®</a></h3>
<pre><code class="language-javascript">// webpacké…ç½® - æ–‡ä»¶åå“ˆå¸Œ
module.exports = {
  output: {
    filename: '[name].[contenthash].js',
    chunkFilename: '[name].[contenthash].chunk.js'
  }
};

// nginxé…ç½®ç¤ºä¾‹
// å¯¹äºå¸¦å“ˆå¸Œçš„æ–‡ä»¶ï¼Œè®¾ç½®é•¿æœŸç¼“å­˜
location ~* \.(js|css)$ {
  if ($uri ~ ".*\.[a-f0-9]{8,}\.(js|css)$") {
    expires 1y;
    add_header Cache-Control "public, immutable";
  }
  
  # å¯¹äºä¸å¸¦å“ˆå¸Œçš„æ–‡ä»¶ï¼Œè®¾ç½®çŸ­æœŸç¼“å­˜
  expires 1h;
  add_header Cache-Control "public";
}
</code></pre>
<h2 id="æ‰“åŒ…ä½“ç§¯ä¼˜åŒ–"><a class="header" href="#æ‰“åŒ…ä½“ç§¯ä¼˜åŒ–">æ‰“åŒ…ä½“ç§¯ä¼˜åŒ–</a></h2>
<h3 id="ä¾èµ–åˆ†æä¸ä¼˜åŒ–"><a class="header" href="#ä¾èµ–åˆ†æä¸ä¼˜åŒ–">ä¾èµ–åˆ†æä¸ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// webpack-bundle-analyzerä½¿ç”¨
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

module.exports = {
  plugins: [
    new BundleAnalyzerPlugin({
      analyzerMode: 'static',
      openAnalyzer: false,
      reportFilename: 'bundle-report.html'
    })
  ]
};

// æ›¿æ¢å¤§å‹ä¾èµ–
// ä½¿ç”¨date-fnsæ›¿ä»£moment.js
import { format, parseISO } from 'date-fns';

// ä½¿ç”¨åŸç”ŸAPIæ›¿ä»£lodash
const unique = array =&gt; [...new Set(array)];
const groupBy = (array, key) =&gt; 
  array.reduce((groups, item) =&gt; {
    const group = item[key];
    groups[group] = groups[group] || [];
    groups[group].push(item);
    return groups;
  }, {});
</code></pre>
<h3 id="å‹ç¼©ä¸æ··æ·†"><a class="header" href="#å‹ç¼©ä¸æ··æ·†">å‹ç¼©ä¸æ··æ·†</a></h3>
<pre><code class="language-javascript">// Terseré…ç½®
const TerserPlugin = require('terser-webpack-plugin');

module.exports = {
  optimization: {
    minimizer: [
      new TerserPlugin({
        terserOptions: {
          compress: {
            drop_console: true,
            drop_debugger: true,
            pure_funcs: ['console.log', 'console.info']
          },
          mangle: {
            safari10: true
          }
        }
      })
    ]
  }
};

// ç§»é™¤å¼€å‘ä»£ç 
if (process.env.NODE_ENV === 'production') {
  // ç”Ÿäº§ç¯å¢ƒä»£ç 
} else {
  // å¼€å‘ç¯å¢ƒä»£ç ï¼Œä¼šè¢«æ‰“åŒ…å·¥å…·ç§»é™¤
}
</code></pre>
<h2 id="è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–"><a class="header" href="#è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–">è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="æ¨¡å—åˆå§‹åŒ–ä¼˜åŒ–"><a class="header" href="#æ¨¡å—åˆå§‹åŒ–ä¼˜åŒ–">æ¨¡å—åˆå§‹åŒ–ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// å»¶è¿Ÿåˆå§‹åŒ–
class PerformanceModule {
  constructor() {
    this._heavyResource = null;
    this._initialized = false;
  }

  async getHeavyResource() {
    if (!this._initialized) {
      await this.initialize();
    }
    return this._heavyResource;
  }

  async initialize() {
    if (this._initialized) return;
    
    // åªåœ¨éœ€è¦æ—¶åˆå§‹åŒ–é‡èµ„æº
    this._heavyResource = await this.createHeavyResource();
    this._initialized = true;
  }

  async createHeavyResource() {
    // æ¨¡æ‹Ÿé‡é‡çº§èµ„æºåˆ›å»º
    const { HeavyLibrary } = await import('./HeavyLibrary.js');
    return new HeavyLibrary();
  }
}

// å•ä¾‹æ¨¡å¼ç¡®ä¿åªåˆå§‹åŒ–ä¸€æ¬¡
const performanceModule = new PerformanceModule();
export default performanceModule;
</code></pre>
<h3 id="å†…å­˜ç®¡ç†-1"><a class="header" href="#å†…å­˜ç®¡ç†-1">å†…å­˜ç®¡ç†</a></h3>
<pre><code class="language-javascript">// æ¨¡å—çº§åˆ«çš„å†…å­˜ç®¡ç†
class ModuleMemoryManager {
  constructor() {
    this.modules = new WeakMap();
    this.timers = new Set();
    this.listeners = new Map();
  }

  register(module, cleanup) {
    this.modules.set(module, cleanup);
  }

  addTimer(timerId) {
    this.timers.add(timerId);
  }

  addListener(element, event, handler) {
    const key = { element, event };
    this.listeners.set(key, handler);
    element.addEventListener(event, handler);
  }

  cleanup() {
    // æ¸…ç†å®šæ—¶å™¨
    this.timers.forEach(timerId =&gt; clearTimeout(timerId));
    this.timers.clear();

    // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
    this.listeners.forEach((handler, { element, event }) =&gt; {
      element.removeEventListener(event, handler);
    });
    this.listeners.clear();

    // è°ƒç”¨æ¨¡å—æ¸…ç†å‡½æ•°
    this.modules.forEach(cleanup =&gt; cleanup());
  }
}

// æ¨¡å—ä½¿ç”¨ç¤ºä¾‹
const memoryManager = new ModuleMemoryManager();

export function initialize() {
  const timer = setTimeout(() =&gt; {
    // å®šæ—¶å™¨é€»è¾‘
  }, 1000);
  
  memoryManager.addTimer(timer);
  
  const handler = () =&gt; console.log('clicked');
  memoryManager.addListener(document.body, 'click', handler);
}

export function destroy() {
  memoryManager.cleanup();
}
</code></pre>
<h2 id="ç½‘ç»œä¼˜åŒ–"><a class="header" href="#ç½‘ç»œä¼˜åŒ–">ç½‘ç»œä¼˜åŒ–</a></h2>
<h3 id="æ¨¡å—é¢„åŠ è½½ç­–ç•¥"><a class="header" href="#æ¨¡å—é¢„åŠ è½½ç­–ç•¥">æ¨¡å—é¢„åŠ è½½ç­–ç•¥</a></h3>
<pre><code class="language-html">&lt;!-- HTMLä¸­çš„é¢„åŠ è½½ --&gt;
&lt;link rel="modulepreload" href="/modules/critical.js"&gt;
&lt;link rel="preload" href="/modules/important.js" as="script" crossorigin&gt;

&lt;!-- åŠ¨æ€é¢„åŠ è½½ --&gt;
&lt;script&gt;
const preloadModule = (href) =&gt; {
  const link = document.createElement('link');
  link.rel = 'modulepreload';
  link.href = href;
  document.head.appendChild(link);
};

// é¢„åŠ è½½ä¸‹ä¸€ä¸ªå¯èƒ½éœ€è¦çš„æ¨¡å—
preloadModule('/modules/next-page.js');
&lt;/script&gt;
</code></pre>
<h3 id="cdnä¼˜åŒ–"><a class="header" href="#cdnä¼˜åŒ–">CDNä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// é…ç½®CDNåŠ è½½
const CDN_BASE = 'https://cdn.example.com';

export async function loadFromCDN(moduleName, version = 'latest') {
  const url = `${CDN_BASE}/${moduleName}@${version}/index.js`;
  
  try {
    return await import(url);
  } catch (error) {
    // CDNå¤±è´¥æ—¶çš„é™çº§æ–¹æ¡ˆ
    console.warn(`CDN load failed for ${moduleName}, falling back to local`);
    return await import(`./local-modules/${moduleName}.js`);
  }
}

// ç‰ˆæœ¬æ§åˆ¶
const MODULE_VERSIONS = {
  'chart-lib': '2.1.0',
  'ui-components': '1.5.2'
};

export function getModuleURL(moduleName) {
  const version = MODULE_VERSIONS[moduleName];
  return `${CDN_BASE}/${moduleName}@${version}/index.js`;
}
</code></pre>
<h2 id="æ€§èƒ½ç›‘æ§-1"><a class="header" href="#æ€§èƒ½ç›‘æ§-1">æ€§èƒ½ç›‘æ§</a></h2>
<h3 id="æ¨¡å—åŠ è½½æ€§èƒ½ç›‘æ§"><a class="header" href="#æ¨¡å—åŠ è½½æ€§èƒ½ç›‘æ§">æ¨¡å—åŠ è½½æ€§èƒ½ç›‘æ§</a></h3>
<pre><code class="language-javascript">class ModulePerformanceMonitor {
  constructor() {
    this.metrics = new Map();
  }

  startLoad(moduleName) {
    this.metrics.set(moduleName, {
      startTime: performance.now(),
      loadTime: null,
      size: null
    });
  }

  endLoad(moduleName, moduleSize) {
    const metric = this.metrics.get(moduleName);
    if (metric) {
      metric.loadTime = performance.now() - metric.startTime;
      metric.size = moduleSize;
    }
  }

  getMetrics() {
    return Array.from(this.metrics.entries()).map(([name, data]) =&gt; ({
      name,
      loadTime: data.loadTime,
      size: data.size,
      speed: data.size ? data.size / data.loadTime : null
    }));
  }

  reportMetrics() {
    const metrics = this.getMetrics();
    
    // å‘é€åˆ°åˆ†ææœåŠ¡
    if (typeof analytics !== 'undefined') {
      analytics.track('Module Performance', {
        modules: metrics,
        totalModules: metrics.length,
        averageLoadTime: metrics.reduce((sum, m) =&gt; sum + m.loadTime, 0) / metrics.length
      });
    }
    
    console.table(metrics);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const monitor = new ModulePerformanceMonitor();

export async function loadModule(moduleName, importFn) {
  monitor.startLoad(moduleName);
  
  try {
    const module = await importFn();
    
    // ä¼°ç®—æ¨¡å—å¤§å°ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
    const moduleSize = JSON.stringify(module).length;
    monitor.endLoad(moduleName, moduleSize);
    
    return module;
  } catch (error) {
    console.error(`Failed to load module ${moduleName}:`, error);
    throw error;
  }
}

// é¡µé¢å¸è½½æ—¶æŠ¥å‘Šæ€§èƒ½æ•°æ®
window.addEventListener('beforeunload', () =&gt; {
  monitor.reportMetrics();
});
</code></pre>
<p>é€šè¿‡å®æ–½è¿™äº›æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Œå¯ä»¥æ˜¾è‘—æå‡JavaScriptåº”ç”¨çš„åŠ è½½é€Ÿåº¦å’Œè¿è¡Œæ€§èƒ½ï¼Œä¸ºç”¨æˆ·æä¾›æ›´å¥½çš„ä½“éªŒã€‚</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="é”™è¯¯å¤„ç†-1"><a class="header" href="#é”™è¯¯å¤„ç†-1">é”™è¯¯å¤„ç†</a></h1>
<p>åœ¨æ¨¡å—åŒ–å¼€å‘ä¸­ï¼Œè‰¯å¥½çš„é”™è¯¯å¤„ç†ç­–ç•¥å¯¹äºåº”ç”¨çš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§è‡³å…³é‡è¦ã€‚æœ¬ç« å°†æ¢è®¨JavaScriptæ¨¡å—ç³»ç»Ÿä¸­çš„å„ç§é”™è¯¯å¤„ç†æœ€ä½³å®è·µã€‚</p>
<h2 id="æ¨¡å—åŠ è½½é”™è¯¯å¤„ç†-1"><a class="header" href="#æ¨¡å—åŠ è½½é”™è¯¯å¤„ç†-1">æ¨¡å—åŠ è½½é”™è¯¯å¤„ç†</a></h2>
<h3 id="åŠ¨æ€å¯¼å…¥é”™è¯¯å¤„ç†"><a class="header" href="#åŠ¨æ€å¯¼å…¥é”™è¯¯å¤„ç†">åŠ¨æ€å¯¼å…¥é”™è¯¯å¤„ç†</a></h3>
<pre><code class="language-javascript">// åŸºç¡€é”™è¯¯å¤„ç†
async function loadModule(modulePath) {
  try {
    const module = await import(modulePath);
    return module;
  } catch (error) {
    console.error(`Failed to load module ${modulePath}:`, error);
    throw new Error(`Module loading failed: ${error.message}`);
  }
}

// å¸¦é‡è¯•æœºåˆ¶çš„æ¨¡å—åŠ è½½
async function loadModuleWithRetry(modulePath, maxRetries = 3) {
  let lastError;
  
  for (let attempt = 1; attempt &lt;= maxRetries; attempt++) {
    try {
      const module = await import(modulePath);
      return module;
    } catch (error) {
      lastError = error;
      console.warn(`Module load attempt ${attempt} failed:`, error);
      
      if (attempt &lt; maxRetries) {
        // æŒ‡æ•°é€€é¿ç­–ç•¥
        await new Promise(resolve =&gt; 
          setTimeout(resolve, Math.pow(2, attempt) * 1000)
        );
      }
    }
  }
  
  throw new Error(`Module ${modulePath} failed to load after ${maxRetries} attempts: ${lastError.message}`);
}

// ä¼˜é›…é™çº§å¤„ç†
async function loadModuleWithFallback(primaryPath, fallbackPath) {
  try {
    return await import(primaryPath);
  } catch (primaryError) {
    console.warn(`Primary module ${primaryPath} failed, trying fallback:`, primaryError);
    
    try {
      return await import(fallbackPath);
    } catch (fallbackError) {
      console.error(`Both primary and fallback modules failed:`, {
        primary: primaryError,
        fallback: fallbackError
      });
      
      // è¿”å›æœ€å°åŠŸèƒ½å®ç°
      return {
        default: () =&gt; console.log('Using minimal fallback implementation')
      };
    }
  }
}
</code></pre>
<h3 id="é”™è¯¯åˆ†ç±»å¤„ç†"><a class="header" href="#é”™è¯¯åˆ†ç±»å¤„ç†">é”™è¯¯åˆ†ç±»å¤„ç†</a></h3>
<pre><code class="language-javascript">// é”™è¯¯ç±»å‹å®šä¹‰
class ModuleError extends Error {
  constructor(message, code, modulePath) {
    super(message);
    this.name = 'ModuleError';
    this.code = code;
    this.modulePath = modulePath;
  }
}

class NetworkError extends ModuleError {
  constructor(message, modulePath) {
    super(message, 'NETWORK_ERROR', modulePath);
    this.name = 'NetworkError';
  }
}

class ParseError extends ModuleError {
  constructor(message, modulePath) {
    super(message, 'PARSE_ERROR', modulePath);
    this.name = 'ParseError';
  }
}

// é”™è¯¯å¤„ç†ç­–ç•¥
class ModuleLoader {
  constructor() {
    this.errorHandlers = new Map();
    this.setupDefaultHandlers();
  }

  setupDefaultHandlers() {
    this.errorHandlers.set('NETWORK_ERROR', this.handleNetworkError.bind(this));
    this.errorHandlers.set('PARSE_ERROR', this.handleParseError.bind(this));
    this.errorHandlers.set('PERMISSION_ERROR', this.handlePermissionError.bind(this));
  }

  async load(modulePath) {
    try {
      return await import(modulePath);
    } catch (error) {
      const categorizedError = this.categorizeError(error, modulePath);
      return this.handleError(categorizedError);
    }
  }

  categorizeError(error, modulePath) {
    if (error.message.includes('fetch')) {
      return new NetworkError(error.message, modulePath);
    }
    
    if (error.message.includes('Unexpected token')) {
      return new ParseError(error.message, modulePath);
    }
    
    return new ModuleError(error.message, 'UNKNOWN_ERROR', modulePath);
  }

  async handleError(error) {
    const handler = this.errorHandlers.get(error.code);
    if (handler) {
      return await handler(error);
    }
    
    console.error('Unhandled module error:', error);
    throw error;
  }

  async handleNetworkError(error) {
    console.warn('Network error detected, attempting offline fallback');
    // å°è¯•ä»ç¼“å­˜åŠ è½½
    return this.loadFromCache(error.modulePath);
  }

  async handleParseError(error) {
    console.warn('Parse error detected, attempting alternative version');
    // å°è¯•åŠ è½½å…¼å®¹ç‰ˆæœ¬
    const fallbackPath = error.modulePath.replace('.js', '.compat.js');
    return this.load(fallbackPath);
  }

  async handlePermissionError(error) {
    console.warn('Permission error, requesting user authorization');
    // è¯·æ±‚ç”¨æˆ·æˆæƒæˆ–æä¾›æ›¿ä»£æ–¹æ¡ˆ
    return this.requestPermissionAndRetry(error.modulePath);
  }
}
</code></pre>
<h2 id="è¿è¡Œæ—¶é”™è¯¯å¤„ç†"><a class="header" href="#è¿è¡Œæ—¶é”™è¯¯å¤„ç†">è¿è¡Œæ—¶é”™è¯¯å¤„ç†</a></h2>
<h3 id="æ¨¡å—çº§é”™è¯¯è¾¹ç•Œ"><a class="header" href="#æ¨¡å—çº§é”™è¯¯è¾¹ç•Œ">æ¨¡å—çº§é”™è¯¯è¾¹ç•Œ</a></h3>
<pre><code class="language-javascript">// æ¨¡å—é”™è¯¯è¾¹ç•ŒåŒ…è£…å™¨
class ModuleErrorBoundary {
  constructor(moduleName) {
    this.moduleName = moduleName;
    this.errorCount = 0;
    this.maxErrors = 5;
    this.resetInterval = 60000; // 1åˆ†é’Ÿ
    this.setupErrorHandling();
  }

  setupErrorHandling() {
    // æ•è·æœªå¤„ç†çš„Promiseæ‹’ç»
    window.addEventListener('unhandledrejection', (event) =&gt; {
      if (this.isModuleError(event.reason)) {
        this.handleError(event.reason);
        event.preventDefault();
      }
    });

    // æ•è·æœªå¤„ç†çš„é”™è¯¯
    window.addEventListener('error', (event) =&gt; {
      if (this.isModuleError(event.error)) {
        this.handleError(event.error);
      }
    });
  }

  isModuleError(error) {
    return error &amp;&amp; error.stack &amp;&amp; 
           error.stack.includes(this.moduleName);
  }

  handleError(error) {
    this.errorCount++;
    
    console.error(`Error in module ${this.moduleName}:`, error);
    
    // é”™è¯¯é¢‘ç‡é™åˆ¶
    if (this.errorCount &gt;= this.maxErrors) {
      console.warn(`Module ${this.moduleName} has exceeded error limit, disabling`);
      this.disableModule();
      return;
    }

    // å‘é€é”™è¯¯æŠ¥å‘Š
    this.reportError(error);
    
    // é‡ç½®é”™è¯¯è®¡æ•°
    setTimeout(() =&gt; {
      this.errorCount = Math.max(0, this.errorCount - 1);
    }, this.resetInterval);
  }

  disableModule() {
    // ç¦ç”¨æœ‰é—®é¢˜çš„æ¨¡å—
    window[`${this.moduleName}_disabled`] = true;
  }

  reportError(error) {
    // å‘é€åˆ°é”™è¯¯ç›‘æ§æœåŠ¡
    if (typeof errorReporting !== 'undefined') {
      errorReporting.captureException(error, {
        module: this.moduleName,
        errorCount: this.errorCount
      });
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const chartModuleBoundary = new ModuleErrorBoundary('chart-module');
</code></pre>
<h3 id="å‡½æ•°çº§é”™è¯¯å¤„ç†"><a class="header" href="#å‡½æ•°çº§é”™è¯¯å¤„ç†">å‡½æ•°çº§é”™è¯¯å¤„ç†</a></h3>
<pre><code class="language-javascript">// é«˜é˜¶å‡½æ•°ï¼šæ·»åŠ é”™è¯¯å¤„ç†
function withErrorHandling(fn, options = {}) {
  const {
    retries = 0,
    timeout = 5000,
    fallback = null,
    onError = console.error
  } = options;

  return async function(...args) {
    let lastError;
    
    for (let attempt = 0; attempt &lt;= retries; attempt++) {
      try {
        // æ·»åŠ è¶…æ—¶æ§åˆ¶
        const timeoutPromise = new Promise((_, reject) =&gt;
          setTimeout(() =&gt; reject(new Error('Function timeout')), timeout)
        );
        
        const resultPromise = Promise.resolve(fn.apply(this, args));
        
        return await Promise.race([resultPromise, timeoutPromise]);
      } catch (error) {
        lastError = error;
        onError(`Attempt ${attempt + 1} failed:`, error);
        
        if (attempt &lt; retries) {
          await new Promise(resolve =&gt; setTimeout(resolve, 1000 * attempt));
        }
      }
    }
    
    // å¦‚æœæ‰€æœ‰é‡è¯•éƒ½å¤±è´¥ï¼Œä½¿ç”¨fallback
    if (fallback) {
      console.warn('Using fallback function due to repeated failures');
      return fallback.apply(this, args);
    }
    
    throw lastError;
  };
}

// ä½¿ç”¨ç¤ºä¾‹
const safeApiCall = withErrorHandling(
  async (url) =&gt; {
    const response = await fetch(url);
    return response.json();
  },
  {
    retries: 3,
    timeout: 10000,
    fallback: () =&gt; ({ error: 'Service unavailable' }),
    onError: (msg, error) =&gt; console.warn(`API call failed: ${msg}`, error)
  }
);
</code></pre>
<h2 id="å¼‚æ­¥é”™è¯¯å¤„ç†"><a class="header" href="#å¼‚æ­¥é”™è¯¯å¤„ç†">å¼‚æ­¥é”™è¯¯å¤„ç†</a></h2>
<h3 id="promiseé”™è¯¯å¤„ç†æ¨¡å¼"><a class="header" href="#promiseé”™è¯¯å¤„ç†æ¨¡å¼">Promiseé”™è¯¯å¤„ç†æ¨¡å¼</a></h3>
<pre><code class="language-javascript">// Promiseé“¾é”™è¯¯å¤„ç†
class AsyncModuleManager {
  constructor() {
    this.pendingOperations = new Map();
    this.errorQueue = [];
  }

  async executeWithErrorHandling(operationId, asyncFn) {
    // é˜²æ­¢é‡å¤æ‰§è¡Œ
    if (this.pendingOperations.has(operationId)) {
      return this.pendingOperations.get(operationId);
    }

    const operation = this.createOperation(operationId, asyncFn);
    this.pendingOperations.set(operationId, operation);

    try {
      const result = await operation;
      this.pendingOperations.delete(operationId);
      return result;
    } catch (error) {
      this.pendingOperations.delete(operationId);
      this.handleAsyncError(operationId, error);
      throw error;
    }
  }

  createOperation(operationId, asyncFn) {
    return Promise.resolve()
      .then(() =&gt; asyncFn())
      .catch(error =&gt; {
        // å¢å¼ºé”™è¯¯ä¿¡æ¯
        error.operationId = operationId;
        error.timestamp = new Date().toISOString();
        throw error;
      });
  }

  handleAsyncError(operationId, error) {
    this.errorQueue.push({
      operationId,
      error,
      timestamp: Date.now()
    });

    // é™åˆ¶é”™è¯¯é˜Ÿåˆ—å¤§å°
    if (this.errorQueue.length &gt; 100) {
      this.errorQueue.shift();
    }

    this.reportAsyncError(operationId, error);
  }

  reportAsyncError(operationId, error) {
    console.error(`Async operation ${operationId} failed:`, error);
    
    // æ‰¹é‡å‘é€é”™è¯¯æŠ¥å‘Š
    this.batchReportErrors();
  }

  batchReportErrors() {
    if (this.errorQueue.length === 0) return;

    const errors = this.errorQueue.splice(0);
    
    // å‘é€åˆ°ç›‘æ§æœåŠ¡
    if (typeof analytics !== 'undefined') {
      analytics.track('Batch Error Report', {
        errors: errors.map(e =&gt; ({
          operationId: e.operationId,
          message: e.error.message,
          timestamp: e.timestamp
        }))
      });
    }
  }
}
</code></pre>
<h3 id="å¹¶å‘é”™è¯¯å¤„ç†"><a class="header" href="#å¹¶å‘é”™è¯¯å¤„ç†">å¹¶å‘é”™è¯¯å¤„ç†</a></h3>
<pre><code class="language-javascript">// å¹¶å‘æ“ä½œé”™è¯¯å¤„ç†
class ConcurrentModuleLoader {
  constructor(maxConcurrency = 5) {
    this.maxConcurrency = maxConcurrency;
    this.activeLoads = 0;
    this.queue = [];
    this.results = new Map();
    this.errors = new Map();
  }

  async loadModules(modulePaths) {
    const loadPromises = modulePaths.map(path =&gt; this.queueLoad(path));
    
    // ä½¿ç”¨Promise.allSettledå¤„ç†éƒ¨åˆ†å¤±è´¥
    const results = await Promise.allSettled(loadPromises);
    
    return this.processResults(results, modulePaths);
  }

  async queueLoad(modulePath) {
    return new Promise((resolve, reject) =&gt; {
      this.queue.push({ modulePath, resolve, reject });
      this.processQueue();
    });
  }

  async processQueue() {
    if (this.activeLoads &gt;= this.maxConcurrency || this.queue.length === 0) {
      return;
    }

    const { modulePath, resolve, reject } = this.queue.shift();
    this.activeLoads++;

    try {
      const module = await this.loadSingleModule(modulePath);
      this.results.set(modulePath, module);
      resolve(module);
    } catch (error) {
      this.errors.set(modulePath, error);
      reject(error);
    } finally {
      this.activeLoads--;
      this.processQueue(); // å¤„ç†ä¸‹ä¸€ä¸ª
    }
  }

  async loadSingleModule(modulePath) {
    try {
      return await import(modulePath);
    } catch (error) {
      console.error(`Failed to load ${modulePath}:`, error);
      throw new Error(`Module load failed: ${modulePath}`);
    }
  }

  processResults(results, modulePaths) {
    const successful = [];
    const failed = [];

    results.forEach((result, index) =&gt; {
      const modulePath = modulePaths[index];
      
      if (result.status === 'fulfilled') {
        successful.push({ modulePath, module: result.value });
      } else {
        failed.push({ modulePath, error: result.reason });
      }
    });

    // è®°å½•åŠ è½½ç»Ÿè®¡
    console.log(`Module loading completed: ${successful.length} successful, ${failed.length} failed`);
    
    if (failed.length &gt; 0) {
      console.warn('Failed modules:', failed);
    }

    return {
      successful,
      failed,
      hasErrors: failed.length &gt; 0
    };
  }
}
</code></pre>
<h2 id="é”™è¯¯ç›‘æ§ä¸æŠ¥å‘Š"><a class="header" href="#é”™è¯¯ç›‘æ§ä¸æŠ¥å‘Š">é”™è¯¯ç›‘æ§ä¸æŠ¥å‘Š</a></h2>
<h3 id="é”™è¯¯ç›‘æ§ç³»ç»Ÿ"><a class="header" href="#é”™è¯¯ç›‘æ§ç³»ç»Ÿ">é”™è¯¯ç›‘æ§ç³»ç»Ÿ</a></h3>
<pre><code class="language-javascript">class ModuleErrorMonitor {
  constructor() {
    this.errorBuffer = [];
    this.reportInterval = 30000; // 30ç§’
    this.maxBufferSize = 50;
    this.setupPeriodicReporting();
  }

  captureError(error, context = {}) {
    const errorData = {
      message: error.message,
      stack: error.stack,
      timestamp: Date.now(),
      url: window.location.href,
      userAgent: navigator.userAgent,
      context
    };

    this.errorBuffer.push(errorData);

    // ç«‹å³å¤„ç†ä¸¥é‡é”™è¯¯
    if (this.isCriticalError(error)) {
      this.reportImmediately(errorData);
    }

    // ç¼“å†²åŒºæº¢å‡ºæ—¶å‘é€
    if (this.errorBuffer.length &gt;= this.maxBufferSize) {
      this.sendErrorReport();
    }
  }

  isCriticalError(error) {
    const criticalPatterns = [
      /cannot read property/i,
      /is not a function/i,
      /network error/i,
      /security/i
    ];

    return criticalPatterns.some(pattern =&gt; pattern.test(error.message));
  }

  setupPeriodicReporting() {
    setInterval(() =&gt; {
      if (this.errorBuffer.length &gt; 0) {
        this.sendErrorReport();
      }
    }, this.reportInterval);
  }

  async sendErrorReport() {
    if (this.errorBuffer.length === 0) return;

    const errors = this.errorBuffer.splice(0);
    
    try {
      await this.submitErrors(errors);
      console.log(`Sent ${errors.length} error reports`);
    } catch (reportError) {
      console.error('Failed to send error report:', reportError);
      // å°†é”™è¯¯æ”¾å›ç¼“å†²åŒº
      this.errorBuffer.unshift(...errors.slice(-10)); // åªä¿ç•™æœ€æ–°çš„10ä¸ª
    }
  }

  async submitErrors(errors) {
    const reportData = {
      errors,
      session: this.getSessionInfo(),
      performance: this.getPerformanceMetrics()
    };

    const response = await fetch('/api/errors', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(reportData)
    });

    if (!response.ok) {
      throw new Error(`Error reporting failed: ${response.status}`);
    }
  }

  getSessionInfo() {
    return {
      sessionId: this.getSessionId(),
      timestamp: Date.now(),
      modules: this.getLoadedModules()
    };
  }

  getPerformanceMetrics() {
    if (!window.performance) return null;

    return {
      memory: window.performance.memory ? {
        used: window.performance.memory.usedJSHeapSize,
        total: window.performance.memory.totalJSHeapSize
      } : null,
      timing: window.performance.timing
    };
  }

  async reportImmediately(errorData) {
    try {
      await this.submitErrors([errorData]);
    } catch (error) {
      console.error('Failed to send immediate error report:', error);
    }
  }
}

// å…¨å±€é”™è¯¯ç›‘æ§å™¨
const errorMonitor = new ModuleErrorMonitor();

// é›†æˆåˆ°æ¨¡å—åŠ è½½å™¨
const originalImport = window.import || (() =&gt; {});
window.import = function(specifier) {
  return originalImport(specifier).catch(error =&gt; {
    errorMonitor.captureError(error, { 
      type: 'module_load', 
      specifier 
    });
    throw error;
  });
};
</code></pre>
<h2 id="é”™è¯¯æ¢å¤ç­–ç•¥"><a class="header" href="#é”™è¯¯æ¢å¤ç­–ç•¥">é”™è¯¯æ¢å¤ç­–ç•¥</a></h2>
<h3 id="è‡ªåŠ¨æ¢å¤æœºåˆ¶"><a class="header" href="#è‡ªåŠ¨æ¢å¤æœºåˆ¶">è‡ªåŠ¨æ¢å¤æœºåˆ¶</a></h3>
<pre><code class="language-javascript">class ModuleRecoveryManager {
  constructor() {
    this.failedModules = new Map();
    this.recoveryStrategies = new Map();
    this.setupRecoveryStrategies();
  }

  setupRecoveryStrategies() {
    this.recoveryStrategies.set('reload', this.reloadModule.bind(this));
    this.recoveryStrategies.set('fallback', this.useFallbackModule.bind(this));
    this.recoveryStrategies.set('retry', this.retryModuleLoad.bind(this));
    this.recoveryStrategies.set('degrade', this.degradeGracefully.bind(this));
  }

  async handleModuleFailure(modulePath, error, context = {}) {
    const failureInfo = {
      error,
      timestamp: Date.now(),
      attempts: 0,
      context
    };

    this.failedModules.set(modulePath, failureInfo);

    // é€‰æ‹©æ¢å¤ç­–ç•¥
    const strategy = this.selectRecoveryStrategy(error, context);
    
    try {
      return await this.executeRecoveryStrategy(strategy, modulePath, failureInfo);
    } catch (recoveryError) {
      console.error(`Recovery failed for ${modulePath}:`, recoveryError);
      return this.handleRecoveryFailure(modulePath, recoveryError);
    }
  }

  selectRecoveryStrategy(error, context) {
    if (error.message.includes('network')) {
      return 'retry';
    }
    
    if (error.message.includes('parse')) {
      return 'fallback';
    }
    
    if (context.isCritical) {
      return 'reload';
    }
    
    return 'degrade';
  }

  async executeRecoveryStrategy(strategy, modulePath, failureInfo) {
    const handler = this.recoveryStrategies.get(strategy);
    if (!handler) {
      throw new Error(`Unknown recovery strategy: ${strategy}`);
    }

    console.log(`Attempting recovery for ${modulePath} using strategy: ${strategy}`);
    return await handler(modulePath, failureInfo);
  }

  async reloadModule(modulePath, failureInfo) {
    // å¼ºåˆ¶é‡æ–°åŠ è½½æ¨¡å—
    const cacheBustedPath = `${modulePath}?v=${Date.now()}`;
    return await import(cacheBustedPath);
  }

  async useFallbackModule(modulePath, failureInfo) {
    // å°è¯•åŠ è½½å¤‡ç”¨æ¨¡å—
    const fallbackPaths = [
      modulePath.replace('.js', '.fallback.js'),
      modulePath.replace('.js', '.min.js'),
      './fallbacks/default-module.js'
    ];

    for (const fallbackPath of fallbackPaths) {
      try {
        return await import(fallbackPath);
      } catch (fallbackError) {
        console.warn(`Fallback ${fallbackPath} also failed:`, fallbackError);
      }
    }

    throw new Error('All fallback options exhausted');
  }

  async retryModuleLoad(modulePath, failureInfo) {
    failureInfo.attempts++;
    const maxRetries = 3;
    
    if (failureInfo.attempts &gt;= maxRetries) {
      throw new Error(`Max retries (${maxRetries}) exceeded for ${modulePath}`);
    }

    // æŒ‡æ•°é€€é¿
    const delay = Math.pow(2, failureInfo.attempts) * 1000;
    await new Promise(resolve =&gt; setTimeout(resolve, delay));

    return await import(modulePath);
  }

  async degradeGracefully(modulePath, failureInfo) {
    // è¿”å›æœ€å°åŠŸèƒ½å®ç°
    console.warn(`Gracefully degrading functionality for ${modulePath}`);
    
    return {
      default: function() {
        console.warn(`Module ${modulePath} is unavailable, using degraded functionality`);
        return null;
      },
      __degraded: true,
      __originalPath: modulePath
    };
  }

  async handleRecoveryFailure(modulePath, recoveryError) {
    console.error(`All recovery attempts failed for ${modulePath}`);
    
    // ç§»é™¤å¤±è´¥çš„æ¨¡å—è®°å½•
    this.failedModules.delete(modulePath);
    
    // å‘é€å¤±è´¥æŠ¥å‘Š
    errorMonitor.captureError(recoveryError, {
      type: 'recovery_failure',
      modulePath,
      originalError: this.failedModules.get(modulePath)?.error
    });

    // è¿”å›ç©ºå®ç°é¿å…åº”ç”¨å´©æºƒ
    return this.degradeGracefully(modulePath, {});
  }
}

// å…¨å±€æ¢å¤ç®¡ç†å™¨
const recoveryManager = new ModuleRecoveryManager();
</code></pre>
<p>é€šè¿‡å®æ–½è¿™äº›é”™è¯¯å¤„ç†ç­–ç•¥ï¼Œå¯ä»¥å¤§å¤§æé«˜æ¨¡å—åŒ–åº”ç”¨çš„å¥å£®æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œç¡®ä¿å³ä½¿åœ¨å‡ºç°é”™è¯¯æ—¶åº”ç”¨ä¹Ÿèƒ½ç»§ç»­è¿è¡Œã€‚</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æµ‹è¯•æ¨¡å—åŒ–ä»£ç "><a class="header" href="#æµ‹è¯•æ¨¡å—åŒ–ä»£ç ">æµ‹è¯•æ¨¡å—åŒ–ä»£ç </a></h1>
<p>æ¨¡å—åŒ–ä»£ç çš„æµ‹è¯•ç­–ç•¥ä¸ä¼ ç»Ÿä»£ç æœ‰æ‰€ä¸åŒï¼Œéœ€è¦è€ƒè™‘æ¨¡å—é—´çš„ä¾èµ–å…³ç³»ã€å¼‚æ­¥åŠ è½½ã€éš”ç¦»æ€§ç­‰å› ç´ ã€‚æœ¬ç« å°†è¯¦ç»†ä»‹ç»å¦‚ä½•æœ‰æ•ˆæµ‹è¯•JavaScriptæ¨¡å—ã€‚</p>
<h2 id="æ¨¡å—æµ‹è¯•åŸºç¡€"><a class="header" href="#æ¨¡å—æµ‹è¯•åŸºç¡€">æ¨¡å—æµ‹è¯•åŸºç¡€</a></h2>
<h3 id="å•å…ƒæµ‹è¯•ç­–ç•¥"><a class="header" href="#å•å…ƒæµ‹è¯•ç­–ç•¥">å•å…ƒæµ‹è¯•ç­–ç•¥</a></h3>
<pre><code class="language-javascript">// userService.js - è¢«æµ‹è¯•çš„æ¨¡å—
export class UserService {
  constructor(httpClient, cache) {
    this.httpClient = httpClient;
    this.cache = cache;
  }

  async getUser(id) {
    const cacheKey = `user:${id}`;
    
    // å…ˆæ£€æŸ¥ç¼“å­˜
    const cached = await this.cache.get(cacheKey);
    if (cached) {
      return cached;
    }

    // ä»APIè·å–
    const user = await this.httpClient.get(`/users/${id}`);
    
    // ç¼“å­˜ç»“æœ
    await this.cache.set(cacheKey, user, { ttl: 300 });
    
    return user;
  }

  async updateUser(id, data) {
    const user = await this.httpClient.put(`/users/${id}`, data);
    
    // æ¸…é™¤ç›¸å…³ç¼“å­˜
    await this.cache.delete(`user:${id}`);
    
    return user;
  }
}

export const createUserService = (httpClient, cache) =&gt; {
  return new UserService(httpClient, cache);
};
</code></pre>
<pre><code class="language-javascript">// userService.test.js - å•å…ƒæµ‹è¯•
import { describe, it, expect, beforeEach, vi } from 'vitest';
import { UserService } from '../userService.js';

describe('UserService', () =&gt; {
  let userService;
  let mockHttpClient;
  let mockCache;

  beforeEach(() =&gt; {
    // åˆ›å»ºæ¨¡æ‹Ÿä¾èµ–
    mockHttpClient = {
      get: vi.fn(),
      put: vi.fn()
    };
    
    mockCache = {
      get: vi.fn(),
      set: vi.fn(),
      delete: vi.fn()
    };

    userService = new UserService(mockHttpClient, mockCache);
  });

  describe('getUser', () =&gt; {
    it('should return cached user when available', async () =&gt; {
      const userId = '123';
      const cachedUser = { id: userId, name: 'John' };
      
      mockCache.get.mockResolvedValue(cachedUser);

      const result = await userService.getUser(userId);

      expect(result).toBe(cachedUser);
      expect(mockCache.get).toHaveBeenCalledWith('user:123');
      expect(mockHttpClient.get).not.toHaveBeenCalled();
    });

    it('should fetch from API and cache when not in cache', async () =&gt; {
      const userId = '123';
      const apiUser = { id: userId, name: 'John' };
      
      mockCache.get.mockResolvedValue(null);
      mockHttpClient.get.mockResolvedValue(apiUser);

      const result = await userService.getUser(userId);

      expect(result).toBe(apiUser);
      expect(mockHttpClient.get).toHaveBeenCalledWith('/users/123');
      expect(mockCache.set).toHaveBeenCalledWith('user:123', apiUser, { ttl: 300 });
    });
  });

  describe('updateUser', () =&gt; {
    it('should update user and clear cache', async () =&gt; {
      const userId = '123';
      const updateData = { name: 'Jane' };
      const updatedUser = { id: userId, name: 'Jane' };
      
      mockHttpClient.put.mockResolvedValue(updatedUser);

      const result = await userService.updateUser(userId, updateData);

      expect(result).toBe(updatedUser);
      expect(mockHttpClient.put).toHaveBeenCalledWith('/users/123', updateData);
      expect(mockCache.delete).toHaveBeenCalledWith('user:123');
    });
  });
});
</code></pre>
<h3 id="æ¨¡å—éš”ç¦»æµ‹è¯•"><a class="header" href="#æ¨¡å—éš”ç¦»æµ‹è¯•">æ¨¡å—éš”ç¦»æµ‹è¯•</a></h3>
<pre><code class="language-javascript">// testUtils.js - æµ‹è¯•å·¥å…·
export class ModuleTestEnvironment {
  constructor() {
    this.originalModules = new Map();
    this.mockModules = new Map();
  }

  // å¤‡ä»½åŸå§‹æ¨¡å—
  backupModule(modulePath, moduleObject) {
    this.originalModules.set(modulePath, moduleObject);
  }

  // åˆ›å»ºæ¨¡å—æ¨¡æ‹Ÿ
  mockModule(modulePath, mockImplementation) {
    this.mockModules.set(modulePath, mockImplementation);
  }

  // æ¢å¤æ‰€æœ‰æ¨¡å—
  restoreAll() {
    this.originalModules.clear();
    this.mockModules.clear();
  }

  // è·å–æ¨¡æ‹Ÿçš„æ¨¡å—
  getMockedModule(modulePath) {
    return this.mockModules.get(modulePath);
  }
}

// æ¨¡å—æµ‹è¯•è£…é¥°å™¨
export function testModule(testFn) {
  return async () =&gt; {
    const env = new ModuleTestEnvironment();
    
    try {
      await testFn(env);
    } finally {
      env.restoreAll();
    }
  };
}

// ä½¿ç”¨ç¤ºä¾‹
import { testModule } from './testUtils.js';

describe('Module Integration Tests', () =&gt; {
  it('should handle module dependencies correctly', testModule(async (env) =&gt; {
    // æ¨¡æ‹Ÿä¾èµ–æ¨¡å—
    env.mockModule('./httpClient.js', {
      get: vi.fn().mockResolvedValue({ data: 'mocked' }),
      post: vi.fn().mockResolvedValue({ success: true })
    });

    env.mockModule('./logger.js', {
      info: vi.fn(),
      error: vi.fn()
    });

    // å¯¼å…¥å¹¶æµ‹è¯•ç›®æ ‡æ¨¡å—
    const { DataService } = await import('./dataService.js');
    const service = new DataService();
    
    const result = await service.fetchData();
    expect(result.data).toBe('mocked');
  }));
});
</code></pre>
<h2 id="å¼‚æ­¥æ¨¡å—æµ‹è¯•"><a class="header" href="#å¼‚æ­¥æ¨¡å—æµ‹è¯•">å¼‚æ­¥æ¨¡å—æµ‹è¯•</a></h2>
<h3 id="åŠ¨æ€å¯¼å…¥æµ‹è¯•"><a class="header" href="#åŠ¨æ€å¯¼å…¥æµ‹è¯•">åŠ¨æ€å¯¼å…¥æµ‹è¯•</a></h3>
<pre><code class="language-javascript">// moduleLoader.js - åŠ¨æ€æ¨¡å—åŠ è½½å™¨
export class ModuleLoader {
  constructor() {
    this.loadedModules = new Map();
  }

  async loadModule(modulePath) {
    if (this.loadedModules.has(modulePath)) {
      return this.loadedModules.get(modulePath);
    }

    try {
      const module = await import(modulePath);
      this.loadedModules.set(modulePath, module);
      return module;
    } catch (error) {
      throw new Error(`Failed to load module ${modulePath}: ${error.message}`);
    }
  }

  async loadModuleWithTimeout(modulePath, timeout = 5000) {
    const timeoutPromise = new Promise((_, reject) =&gt;
      setTimeout(() =&gt; reject(new Error('Module load timeout')), timeout)
    );

    return Promise.race([
      this.loadModule(modulePath),
      timeoutPromise
    ]);
  }

  getLoadedModuleCount() {
    return this.loadedModules.size;
  }

  clearCache() {
    this.loadedModules.clear();
  }
}
</code></pre>
<pre><code class="language-javascript">// moduleLoader.test.js - å¼‚æ­¥æ¨¡å—æµ‹è¯•
import { describe, it, expect, beforeEach, vi } from 'vitest';
import { ModuleLoader } from '../moduleLoader.js';

describe('ModuleLoader', () =&gt; {
  let loader;

  beforeEach(() =&gt; {
    loader = new ModuleLoader();
  });

  describe('loadModule', () =&gt; {
    it('should load module successfully', async () =&gt; {
      // ä½¿ç”¨å®é™…å­˜åœ¨çš„æ¨¡å—è¿›è¡Œæµ‹è¯•
      const module = await loader.loadModule('./testData/sampleModule.js');
      
      expect(module).toBeDefined();
      expect(module.default).toBeDefined();
      expect(loader.getLoadedModuleCount()).toBe(1);
    });

    it('should cache loaded modules', async () =&gt; {
      const modulePath = './testData/sampleModule.js';
      
      const module1 = await loader.loadModule(modulePath);
      const module2 = await loader.loadModule(modulePath);
      
      expect(module1).toBe(module2); // åº”è¯¥æ˜¯åŒä¸€ä¸ªå¯¹è±¡
      expect(loader.getLoadedModuleCount()).toBe(1);
    });

    it('should handle module load failure', async () =&gt; {
      const invalidPath = './nonexistent/module.js';
      
      await expect(loader.loadModule(invalidPath))
        .rejects
        .toThrow(/Failed to load module/);
    });
  });

  describe('loadModuleWithTimeout', () =&gt; {
    it('should timeout when module takes too long to load', async () =&gt; {
      // æ¨¡æ‹Ÿæ…¢åŠ è½½çš„æ¨¡å—
      const slowModulePath = './testData/slowModule.js';
      
      await expect(loader.loadModuleWithTimeout(slowModulePath, 100))
        .rejects
        .toThrow('Module load timeout');
    });
  });
});
</code></pre>
<h3 id="promiseå¹¶å‘æµ‹è¯•"><a class="header" href="#promiseå¹¶å‘æµ‹è¯•">Promiseå¹¶å‘æµ‹è¯•</a></h3>
<pre><code class="language-javascript">// concurrentLoader.js - å¹¶å‘æ¨¡å—åŠ è½½å™¨
export class ConcurrentModuleLoader {
  constructor(maxConcurrency = 3) {
    this.maxConcurrency = maxConcurrency;
    this.activeLoads = 0;
    this.pendingLoads = [];
    this.results = new Map();
  }

  async loadModules(modulePaths) {
    const loadPromises = modulePaths.map(path =&gt; this.queueLoad(path));
    
    const results = await Promise.allSettled(loadPromises);
    
    return this.processResults(results, modulePaths);
  }

  async queueLoad(modulePath) {
    if (this.results.has(modulePath)) {
      return this.results.get(modulePath);
    }

    return new Promise((resolve, reject) =&gt; {
      this.pendingLoads.push({ modulePath, resolve, reject });
      this.processQueue();
    });
  }

  async processQueue() {
    if (this.activeLoads &gt;= this.maxConcurrency || this.pendingLoads.length === 0) {
      return;
    }

    const { modulePath, resolve, reject } = this.pendingLoads.shift();
    this.activeLoads++;

    try {
      const module = await import(modulePath);
      this.results.set(modulePath, module);
      resolve(module);
    } catch (error) {
      reject(error);
    } finally {
      this.activeLoads--;
      this.processQueue();
    }
  }

  processResults(results, modulePaths) {
    const successful = [];
    const failed = [];

    results.forEach((result, index) =&gt; {
      const modulePath = modulePaths[index];
      
      if (result.status === 'fulfilled') {
        successful.push({ path: modulePath, module: result.value });
      } else {
        failed.push({ path: modulePath, error: result.reason });
      }
    });

    return { successful, failed };
  }
}
</code></pre>
<pre><code class="language-javascript">// concurrentLoader.test.js - å¹¶å‘æµ‹è¯•
import { describe, it, expect, beforeEach } from 'vitest';
import { ConcurrentModuleLoader } from '../concurrentLoader.js';

describe('ConcurrentModuleLoader', () =&gt; {
  let loader;

  beforeEach(() =&gt; {
    loader = new ConcurrentModuleLoader(2); // æœ€å¤§å¹¶å‘æ•°ä¸º2
  });

  it('should load multiple modules concurrently', async () =&gt; {
    const modulePaths = [
      './testData/module1.js',
      './testData/module2.js',
      './testData/module3.js'
    ];

    const startTime = Date.now();
    const result = await loader.loadModules(modulePaths);
    const endTime = Date.now();

    expect(result.successful).toHaveLength(3);
    expect(result.failed).toHaveLength(0);
    
    // éªŒè¯å¹¶å‘åŠ è½½ç¡®å®æ›´å¿«
    expect(endTime - startTime).toBeLessThan(3000); // å‡è®¾å•ä¸ªæ¨¡å—åŠ è½½éœ€è¦1ç§’
  });

  it('should handle mixed success and failure', async () =&gt; {
    const modulePaths = [
      './testData/validModule.js',
      './nonexistent/module.js',
      './testData/anotherValidModule.js'
    ];

    const result = await loader.loadModules(modulePaths);

    expect(result.successful).toHaveLength(2);
    expect(result.failed).toHaveLength(1);
    
    expect(result.failed[0].path).toBe('./nonexistent/module.js');
  });

  it('should respect concurrency limits', async () =&gt; {
    const loader = new ConcurrentModuleLoader(1); // é™åˆ¶ä¸º1
    
    let concurrentCount = 0;
    let maxConcurrent = 0;

    // åˆ›å»ºæ¨¡æ‹Ÿæ¨¡å—è·¯å¾„
    const modulePaths = Array.from({ length: 5 }, (_, i) =&gt; `./test${i}.js`);
    
    // ç›‘æ§å¹¶å‘æ•°
    const originalImport = global.import;
    global.import = async (path) =&gt; {
      concurrentCount++;
      maxConcurrent = Math.max(maxConcurrent, concurrentCount);
      
      await new Promise(resolve =&gt; setTimeout(resolve, 100));
      
      concurrentCount--;
      return { default: `module-${path}` };
    };

    try {
      await loader.loadModules(modulePaths);
      expect(maxConcurrent).toBe(1);
    } finally {
      global.import = originalImport;
    }
  });
});
</code></pre>
<h2 id="é›†æˆæµ‹è¯•"><a class="header" href="#é›†æˆæµ‹è¯•">é›†æˆæµ‹è¯•</a></h2>
<h3 id="æ¨¡å—é—´é›†æˆæµ‹è¯•"><a class="header" href="#æ¨¡å—é—´é›†æˆæµ‹è¯•">æ¨¡å—é—´é›†æˆæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// integration.test.js - é›†æˆæµ‹è¯•
import { describe, it, expect, beforeEach, afterEach } from 'vitest';

describe('Module Integration Tests', () =&gt; {
  let testServer;
  let testDatabase;

  beforeEach(async () =&gt; {
    // å¯åŠ¨æµ‹è¯•ç¯å¢ƒ
    testDatabase = await startTestDatabase();
    testServer = await startTestServer();
  });

  afterEach(async () =&gt; {
    // æ¸…ç†æµ‹è¯•ç¯å¢ƒ
    await testServer.stop();
    await testDatabase.cleanup();
  });

  it('should handle complete user workflow', async () =&gt; {
    // å¯¼å…¥çœŸå®æ¨¡å—
    const { UserService } = await import('../src/services/userService.js');
    const { HttpClient } = await import('../src/http/httpClient.js');
    const { RedisCache } = await import('../src/cache/redisCache.js');

    // åˆ›å»ºçœŸå®çš„ä¾èµ–å®ä¾‹
    const httpClient = new HttpClient({
      baseURL: testServer.url,
      timeout: 5000
    });

    const cache = new RedisCache({
      host: testDatabase.host,
      port: testDatabase.port
    });

    const userService = new UserService(httpClient, cache);

    // æµ‹è¯•å®Œæ•´çš„ç”¨æˆ·å·¥ä½œæµ
    const userData = { name: 'Test User', email: 'test@example.com' };
    
    // 1. åˆ›å»ºç”¨æˆ·
    const createdUser = await userService.createUser(userData);
    expect(createdUser.id).toBeDefined();

    // 2. è·å–ç”¨æˆ·ï¼ˆåº”è¯¥ä»APIè·å–ï¼‰
    const fetchedUser = await userService.getUser(createdUser.id);
    expect(fetchedUser.name).toBe(userData.name);

    // 3. å†æ¬¡è·å–ç”¨æˆ·ï¼ˆåº”è¯¥ä»ç¼“å­˜è·å–ï¼‰
    const cachedUser = await userService.getUser(createdUser.id);
    expect(cachedUser.name).toBe(userData.name);

    // 4. æ›´æ–°ç”¨æˆ·
    const updatedData = { name: 'Updated User' };
    const updatedUser = await userService.updateUser(createdUser.id, updatedData);
    expect(updatedUser.name).toBe(updatedData.name);

    // 5. éªŒè¯ç¼“å­˜å·²è¢«æ¸…é™¤
    const freshUser = await userService.getUser(createdUser.id);
    expect(freshUser.name).toBe(updatedData.name);
  });

  it('should handle module loading failures gracefully', async () =&gt; {
    // æ¨¡æ‹Ÿæ¨¡å—åŠ è½½å¤±è´¥çš„æƒ…å†µ
    const { ModuleManager } = await import('../src/core/moduleManager.js');
    
    const manager = new ModuleManager();
    
    // æ³¨å†Œæ¨¡å—åŠ è½½å¤±è´¥çš„å¤„ç†å™¨
    const errorHandler = vi.fn();
    manager.onModuleLoadError(errorHandler);

    // å°è¯•åŠ è½½ä¸å­˜åœ¨çš„æ¨¡å—
    const result = await manager.loadOptionalModule('./nonexistent.js');
    
    expect(result).toBeNull();
    expect(errorHandler).toHaveBeenCalled();
  });
});
</code></pre>
<h3 id="ç«¯åˆ°ç«¯æµ‹è¯•"><a class="header" href="#ç«¯åˆ°ç«¯æµ‹è¯•">ç«¯åˆ°ç«¯æµ‹è¯•</a></h3>
<pre><code class="language-javascript">// e2e.test.js - ç«¯åˆ°ç«¯æµ‹è¯•
import { describe, it, expect, beforeAll, afterAll } from 'vitest';
import { chromium } from 'playwright';

describe('End-to-End Module Tests', () =&gt; {
  let browser;
  let context;
  let page;

  beforeAll(async () =&gt; {
    browser = await chromium.launch();
    context = await browser.newContext();
    page = await context.newPage();
  });

  afterAll(async () =&gt; {
    await browser.close();
  });

  it('should load modules dynamically in browser', async () =&gt; {
    // è®¿é—®æµ‹è¯•é¡µé¢
    await page.goto('http://localhost:3000/test.html');

    // ç­‰å¾…é¡µé¢åˆå§‹åŒ–
    await page.waitForLoadState('networkidle');

    // è§¦å‘åŠ¨æ€æ¨¡å—åŠ è½½
    await page.click('[data-testid="load-chart-module"]');

    // ç­‰å¾…æ¨¡å—åŠ è½½å®Œæˆ
    await page.waitForSelector('[data-testid="chart-container"]');

    // éªŒè¯æ¨¡å—åŠŸèƒ½
    const chartTitle = await page.textContent('[data-testid="chart-title"]');
    expect(chartTitle).toBe('Sales Chart');

    // éªŒè¯æ¨¡å—é—´é€šä¿¡
    await page.click('[data-testid="update-chart-data"]');
    
    await page.waitForFunction(() =&gt; {
      const chart = document.querySelector('[data-testid="chart-container"]');
      return chart &amp;&amp; chart.dataset.updated === 'true';
    });

    const updatedData = await page.getAttribute('[data-testid="chart-container"]', 'data-points');
    expect(parseInt(updatedData)).toBeGreaterThan(0);
  });

  it('should handle module load errors gracefully', async () =&gt; {
    await page.goto('http://localhost:3000/error-test.html');

    // æ¨¡æ‹Ÿç½‘ç»œæ•…éšœ
    await page.route('**/modules/broken-module.js', route =&gt; {
      route.fulfill({ status: 500, body: 'Server Error' });
    });

    // è§¦å‘æœ‰é—®é¢˜çš„æ¨¡å—åŠ è½½
    await page.click('[data-testid="load-broken-module"]');

    // éªŒè¯é”™è¯¯å¤„ç†
    await page.waitForSelector('[data-testid="error-message"]');
    
    const errorMessage = await page.textContent('[data-testid="error-message"]');
    expect(errorMessage).toContain('Module failed to load');

    // éªŒè¯fallbackæœºåˆ¶
    await page.waitForSelector('[data-testid="fallback-content"]');
    
    const fallbackText = await page.textContent('[data-testid="fallback-content"]');
    expect(fallbackText).toBe('Using fallback implementation');
  });
});
</code></pre>
<h2 id="æ€§èƒ½æµ‹è¯•"><a class="header" href="#æ€§èƒ½æµ‹è¯•">æ€§èƒ½æµ‹è¯•</a></h2>
<h3 id="æ¨¡å—åŠ è½½æ€§èƒ½æµ‹è¯•"><a class="header" href="#æ¨¡å—åŠ è½½æ€§èƒ½æµ‹è¯•">æ¨¡å—åŠ è½½æ€§èƒ½æµ‹è¯•</a></h3>
<pre><code class="language-javascript">// performance.test.js - æ€§èƒ½æµ‹è¯•
import { describe, it, expect } from 'vitest';
import { performance } from 'perf_hooks';

describe('Module Performance Tests', () =&gt; {
  it('should load modules within acceptable time limits', async () =&gt; {
    const moduleLoads = [
      './src/modules/chart.js',
      './src/modules/table.js',
      './src/modules/form.js',
      './src/modules/validation.js'
    ];

    const startTime = performance.now();
    
    const loadPromises = moduleLoads.map(async (modulePath) =&gt; {
      const moduleStartTime = performance.now();
      const module = await import(modulePath);
      const moduleEndTime = performance.now();
      
      return {
        path: modulePath,
        loadTime: moduleEndTime - moduleStartTime,
        module
      };
    });

    const results = await Promise.all(loadPromises);
    const totalTime = performance.now() - startTime;

    // éªŒè¯æ€»åŠ è½½æ—¶é—´
    expect(totalTime).toBeLessThan(2000); // 2ç§’å†…

    // éªŒè¯å•ä¸ªæ¨¡å—åŠ è½½æ—¶é—´
    results.forEach(result =&gt; {
      expect(result.loadTime).toBeLessThan(500); // æ¯ä¸ªæ¨¡å—500mså†…
      expect(result.module).toBeDefined();
    });

    // éªŒè¯å¹¶å‘åŠ è½½ç¡®å®æ¯”ä¸²è¡Œå¿«
    const averageTime = totalTime / results.length;
    expect(averageTime).toBeLessThan(totalTime);
  });

  it('should handle memory usage efficiently', async () =&gt; {
    const initialMemory = process.memoryUsage();
    
    // åŠ è½½å¤§é‡æ¨¡å—
    const modulePromises = Array.from({ length: 50 }, (_, i) =&gt; 
      import(`./testData/module${i % 5}.js`) // é‡å¤ä½¿ç”¨5ä¸ªæ¨¡å—
    );

    await Promise.all(modulePromises);

    const finalMemory = process.memoryUsage();
    const memoryIncrease = finalMemory.heapUsed - initialMemory.heapUsed;

    // éªŒè¯å†…å­˜å¢é•¿åœ¨åˆç†èŒƒå›´å†…ï¼ˆè€ƒè™‘æ¨¡å—ç¼“å­˜ï¼‰
    expect(memoryIncrease).toBeLessThan(50 * 1024 * 1024); // 50MB
  });

  it('should demonstrate efficient module caching', async () =&gt; {
    const modulePath = './src/modules/heavyModule.js';
    
    // ç¬¬ä¸€æ¬¡åŠ è½½
    const firstLoadStart = performance.now();
    const firstModule = await import(modulePath);
    const firstLoadTime = performance.now() - firstLoadStart;

    // ç¬¬äºŒæ¬¡åŠ è½½ï¼ˆåº”è¯¥ä»ç¼“å­˜è·å–ï¼‰
    const secondLoadStart = performance.now();
    const secondModule = await import(modulePath);
    const secondLoadTime = performance.now() - secondLoadStart;

    // éªŒè¯ç¼“å­˜æ•ˆæœ
    expect(secondModule).toBe(firstModule); // åŒä¸€ä¸ªå¯¹è±¡
    expect(secondLoadTime).toBeLessThan(firstLoadTime * 0.1); // ç¼“å­˜åŠ è½½åº”è¯¥å¿«å¾ˆå¤š
  });
});
</code></pre>
<h2 id="æµ‹è¯•å·¥å…·ä¸é…ç½®"><a class="header" href="#æµ‹è¯•å·¥å…·ä¸é…ç½®">æµ‹è¯•å·¥å…·ä¸é…ç½®</a></h2>
<h3 id="æµ‹è¯•ç¯å¢ƒé…ç½®"><a class="header" href="#æµ‹è¯•ç¯å¢ƒé…ç½®">æµ‹è¯•ç¯å¢ƒé…ç½®</a></h3>
<pre><code class="language-javascript">// vitest.config.js - æµ‹è¯•é…ç½®
import { defineConfig } from 'vitest/config';
import path from 'path';

export default defineConfig({
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: ['./tests/setup.js'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'html', 'lcov'],
      exclude: [
        'node_modules/',
        'tests/',
        '**/*.test.js',
        '**/*.config.js'
      ]
    },
    // æ¨¡å—è§£æé…ç½®
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@tests': path.resolve(__dirname, './tests')
    },
    // è¶…æ—¶é…ç½®
    testTimeout: 10000,
    hookTimeout: 10000
  },
  // æ¨¡å—è½¬æ¢é…ç½®
  esbuild: {
    target: 'es2020'
  }
});
</code></pre>
<pre><code class="language-javascript">// tests/setup.js - æµ‹è¯•è®¾ç½®
import { vi } from 'vitest';

// å…¨å±€æ¨¡æ‹Ÿ
global.fetch = vi.fn();

// æ¨¡æ‹Ÿæµè§ˆå™¨API
Object.defineProperty(window, 'performance', {
  value: {
    now: vi.fn(() =&gt; Date.now()),
    mark: vi.fn(),
    measure: vi.fn()
  }
});

// æ¨¡æ‹ŸåŠ¨æ€å¯¼å…¥
const originalImport = global.import;
global.import = vi.fn().mockImplementation((path) =&gt; {
  // å¯¹æµ‹è¯•æ¨¡å—ä½¿ç”¨çœŸå®å¯¼å…¥
  if (path.startsWith('./testData/') || path.startsWith('../')) {
    return originalImport(path);
  }
  
  // å¯¹å…¶ä»–æ¨¡å—è¿”å›æ¨¡æ‹Ÿ
  return Promise.resolve({
    default: `mocked-${path}`,
    __esModule: true
  });
});

// æ¸…ç†å‡½æ•°
afterEach(() =&gt; {
  vi.clearAllMocks();
});
</code></pre>
<h3 id="æµ‹è¯•æ•°æ®ç”Ÿæˆ"><a class="header" href="#æµ‹è¯•æ•°æ®ç”Ÿæˆ">æµ‹è¯•æ•°æ®ç”Ÿæˆ</a></h3>
<pre><code class="language-javascript">// tests/testDataGenerator.js - æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨
export class TestDataGenerator {
  static createMockModule(name, exports = {}) {
    return {
      default: exports.default || (() =&gt; `Mock ${name}`),
      ...exports,
      __moduleName: name,
      __isMock: true
    };
  }

  static createModuleTree(depth = 3, breadth = 3) {
    const tree = {
      modules: new Map(),
      dependencies: new Map()
    };

    for (let i = 0; i &lt; breadth; i++) {
      const moduleName = `level0-module${i}`;
      const module = this.createMockModule(moduleName);
      
      tree.modules.set(moduleName, module);
      
      if (depth &gt; 1) {
        const children = this.createModuleTree(depth - 1, breadth);
        tree.dependencies.set(moduleName, Array.from(children.modules.keys()));
        
        // åˆå¹¶å­æ¨¡å—
        children.modules.forEach((module, name) =&gt; {
          tree.modules.set(name, module);
        });
        
        children.dependencies.forEach((deps, name) =&gt; {
          tree.dependencies.set(name, deps);
        });
      }
    }

    return tree;
  }

  static async createAsyncModules(count = 10) {
    const modules = [];
    
    for (let i = 0; i &lt; count; i++) {
      const delay = Math.random() * 1000; // 0-1ç§’éšæœºå»¶è¿Ÿ
      
      const module = await new Promise(resolve =&gt; {
        setTimeout(() =&gt; {
          resolve(this.createMockModule(`async-module-${i}`, {
            loadTime: delay,
            id: i
          }));
        }, delay);
      });
      
      modules.push(module);
    }

    return modules;
  }
}
</code></pre>
<p>é€šè¿‡è¿™äº›å…¨é¢çš„æµ‹è¯•ç­–ç•¥å’Œå·¥å…·ï¼Œå¯ä»¥ç¡®ä¿æ¨¡å—åŒ–ä»£ç çš„è´¨é‡å’Œå¯é æ€§ï¼Œä»å•å…ƒæµ‹è¯•åˆ°é›†æˆæµ‹è¯•ï¼Œä»åŠŸèƒ½éªŒè¯åˆ°æ€§èƒ½ç›‘æ§ï¼Œå½¢æˆå®Œæ•´çš„æµ‹è¯•ä½“ç³»ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="å¾®å‰ç«¯æ¨¡å—åŒ–"><a class="header" href="#å¾®å‰ç«¯æ¨¡å—åŒ–">å¾®å‰ç«¯æ¨¡å—åŒ–</a></h1>
<p>å¾®å‰ç«¯æ¶æ„å°†å‰ç«¯åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„ã€å¯éƒ¨ç½²çš„å‰ç«¯åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨è´Ÿè´£ç‰¹å®šçš„ä¸šåŠ¡åŸŸã€‚æœ¬ç« å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨JavaScriptæ¨¡å—ç³»ç»Ÿå®ç°å¾®å‰ç«¯æ¶æ„ã€‚</p>
<h2 id="å¾®å‰ç«¯åŸºç¡€æ¦‚å¿µ"><a class="header" href="#å¾®å‰ç«¯åŸºç¡€æ¦‚å¿µ">å¾®å‰ç«¯åŸºç¡€æ¦‚å¿µ</a></h2>
<h3 id="å¾®å‰ç«¯æ¶æ„ç‰¹ç‚¹"><a class="header" href="#å¾®å‰ç«¯æ¶æ„ç‰¹ç‚¹">å¾®å‰ç«¯æ¶æ„ç‰¹ç‚¹</a></h3>
<pre><code class="language-javascript">// å¾®å‰ç«¯æ¶æ„çš„æ ¸å¿ƒç‰¹å¾
const MicrofrontendFeatures = {
  // æŠ€æœ¯æ ˆæ— å…³æ€§
  technologyAgnostic: {
    react: 'Reactåº”ç”¨',
    vue: 'Vueåº”ç”¨',
    angular: 'Angularåº”ç”¨',
    vanilla: 'åŸç”ŸJavaScriptåº”ç”¨'
  },
  
  // ç‹¬ç«‹éƒ¨ç½²
  independentDeployment: {
    cicd: 'æ¯ä¸ªå¾®å‰ç«¯æœ‰è‡ªå·±çš„CI/CDæµæ°´çº¿',
    versioning: 'ç‹¬ç«‹ç‰ˆæœ¬ç®¡ç†',
    rollback: 'ç‹¬ç«‹å›æ»šèƒ½åŠ›'
  },
  
  // å›¢é˜Ÿè‡ªæ²»
  teamAutonomy: {
    ownership: 'å›¢é˜Ÿå®Œå…¨æ‹¥æœ‰å¾®å‰ç«¯çš„å¼€å‘å’Œç»´æŠ¤',
    decisions: 'æŠ€æœ¯å†³ç­–ç‹¬ç«‹',
    timeline: 'å¼€å‘å‘¨æœŸç‹¬ç«‹'
  }
};

// å¾®å‰ç«¯åº”ç”¨æ³¨å†Œè¡¨
class MicrofrontendRegistry {
  constructor() {
    this.applications = new Map();
    this.routes = new Map();
    this.sharedDependencies = new Map();
  }

  // æ³¨å†Œå¾®å‰ç«¯åº”ç”¨
  register(name, config) {
    this.applications.set(name, {
      name,
      url: config.url,
      mount: config.mount,
      unmount: config.unmount,
      activeWhen: config.activeWhen,
      dependencies: config.dependencies || [],
      sharedLibraries: config.sharedLibraries || []
    });
  }

  // è·å–æ¿€æ´»çš„åº”ç”¨
  getActiveApplications(location) {
    return Array.from(this.applications.values())
      .filter(app =&gt; app.activeWhen(location));
  }

  // é¢„åŠ è½½åº”ç”¨
  async preloadApplication(name) {
    const app = this.applications.get(name);
    if (!app || app.loaded) return;

    try {
      const module = await import(app.url);
      app.loaded = true;
      app.module = module;
      return module;
    } catch (error) {
      console.error(`Failed to preload application ${name}:`, error);
      throw error;
    }
  }
}
</code></pre>
<h2 id="æ¨¡å—è”é‚¦-module-federation"><a class="header" href="#æ¨¡å—è”é‚¦-module-federation">æ¨¡å—è”é‚¦ (Module Federation)</a></h2>
<h3 id="webpack-module-federation"><a class="header" href="#webpack-module-federation">Webpack Module Federation</a></h3>
<pre><code class="language-javascript">// webpack.config.js - ä¸»åº”ç”¨ (Shell/Host)
const ModuleFederationPlugin = require('@module-federation/webpack');

module.exports = {
  mode: 'development',
  entry: './src/index.js',
  devServer: {
    port: 3000,
  },
  plugins: [
    new ModuleFederationPlugin({
      name: 'shell',
      remotes: {
        'user-app': 'userApp@http://localhost:3001/remoteEntry.js',
        'product-app': 'productApp@http://localhost:3002/remoteEntry.js',
        'cart-app': 'cartApp@http://localhost:3003/remoteEntry.js'
      },
      shared: {
        react: {
          singleton: true,
          requiredVersion: '^18.0.0'
        },
        'react-dom': {
          singleton: true,
          requiredVersion: '^18.0.0'
        }
      }
    })
  ]
};

// å¾®å‰ç«¯åº”ç”¨é…ç½®
// webpack.config.js - ç”¨æˆ·ç®¡ç†åº”ç”¨
module.exports = {
  mode: 'development',
  entry: './src/index.js',
  devServer: {
    port: 3001,
  },
  plugins: [
    new ModuleFederationPlugin({
      name: 'userApp',
      filename: 'remoteEntry.js',
      exposes: {
        './UserList': './src/components/UserList',
        './UserProfile': './src/components/UserProfile',
        './UserManagement': './src/UserManagement'
      },
      shared: {
        react: {
          singleton: true,
          requiredVersion: '^18.0.0'
        },
        'react-dom': {
          singleton: true,
          requiredVersion: '^18.0.0'
        }
      }
    })
  ]
};
</code></pre>
<h3 id="åŠ¨æ€æ¨¡å—åŠ è½½"><a class="header" href="#åŠ¨æ€æ¨¡å—åŠ è½½">åŠ¨æ€æ¨¡å—åŠ è½½</a></h3>
<pre><code class="language-javascript">// shellåº”ç”¨ - åŠ¨æ€åŠ è½½å¾®å‰ç«¯
class MicrofrontendLoader {
  constructor() {
    this.loadedApps = new Map();
    this.loadingPromises = new Map();
  }

  async loadMicrofrontend(appName, remoteName) {
    if (this.loadedApps.has(appName)) {
      return this.loadedApps.get(appName);
    }

    if (this.loadingPromises.has(appName)) {
      return this.loadingPromises.get(appName);
    }

    const loadingPromise = this._loadRemoteModule(appName, remoteName);
    this.loadingPromises.set(appName, loadingPromise);

    try {
      const app = await loadingPromise;
      this.loadedApps.set(appName, app);
      this.loadingPromises.delete(appName);
      return app;
    } catch (error) {
      this.loadingPromises.delete(appName);
      throw error;
    }
  }

  async _loadRemoteModule(appName, remoteName) {
    try {
      // åŠ¨æ€å¯¼å…¥è¿œç¨‹æ¨¡å—
      const module = await import(remoteName);
      
      return {
        name: appName,
        module,
        mount: module.mount || (() =&gt; {}),
        unmount: module.unmount || (() =&gt; {}),
        update: module.update || (() =&gt; {})
      };
    } catch (error) {
      console.error(`Failed to load microfrontend ${appName}:`, error);
      
      // è¿”å›é”™è¯¯è¾¹ç•Œç»„ä»¶
      return this._createErrorBoundary(appName, error);
    }
  }

  _createErrorBoundary(appName, error) {
    return {
      name: appName,
      module: {
        default: () =&gt; ({
          render: (container) =&gt; {
            container.innerHTML = `
              &lt;div class="microfrontend-error"&gt;
                &lt;h3&gt;åº”ç”¨ ${appName} åŠ è½½å¤±è´¥&lt;/h3&gt;
                &lt;p&gt;é”™è¯¯ä¿¡æ¯: ${error.message}&lt;/p&gt;
                &lt;button onclick="location.reload()"&gt;é‡è¯•&lt;/button&gt;
              &lt;/div&gt;
            `;
          }
        })
      },
      mount: () =&gt; {},
      unmount: () =&gt; {}
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const loader = new MicrofrontendLoader();

// Reactç»„ä»¶ä¸­ä½¿ç”¨
function App() {
  const [userApp, setUserApp] = useState(null);
  const [loading, setLoading] = useState(false);

  const loadUserApp = async () =&gt; {
    setLoading(true);
    try {
      const app = await loader.loadMicrofrontend('user-app', 'user-app/UserManagement');
      setUserApp(app);
    } catch (error) {
      console.error('Failed to load user app:', error);
    } finally {
      setLoading(false);
    }
  };

  return (
    &lt;div&gt;
      &lt;nav&gt;
        &lt;button onClick={loadUserApp}&gt;åŠ è½½ç”¨æˆ·ç®¡ç†&lt;/button&gt;
      &lt;/nav&gt;
      {loading &amp;&amp; &lt;div&gt;åŠ è½½ä¸­...&lt;/div&gt;}
      {userApp &amp;&amp; &lt;RemoteComponent app={userApp} /&gt;}
    &lt;/div&gt;
  );
}
</code></pre>
<h2 id="åº”ç”¨é—´é€šä¿¡"><a class="header" href="#åº”ç”¨é—´é€šä¿¡">åº”ç”¨é—´é€šä¿¡</a></h2>
<h3 id="äº‹ä»¶æ€»çº¿é€šä¿¡"><a class="header" href="#äº‹ä»¶æ€»çº¿é€šä¿¡">äº‹ä»¶æ€»çº¿é€šä¿¡</a></h3>
<pre><code class="language-javascript">// å¾®å‰ç«¯äº‹ä»¶æ€»çº¿
class MicrofrontendEventBus {
  constructor() {
    this.events = new Map();
    this.wildcardEvents = new Map();
    this.middlewares = [];
  }

  // æ·»åŠ ä¸­é—´ä»¶
  use(middleware) {
    this.middlewares.push(middleware);
  }

  // è®¢é˜…äº‹ä»¶
  on(eventName, handler, options = {}) {
    const { once = false, priority = 0, namespace = 'global' } = options;
    
    const subscription = {
      handler,
      once,
      priority,
      namespace,
      id: Math.random().toString(36).substr(2, 9)
    };

    if (eventName.includes('*')) {
      // é€šé…ç¬¦äº‹ä»¶
      if (!this.wildcardEvents.has(eventName)) {
        this.wildcardEvents.set(eventName, []);
      }
      this.wildcardEvents.get(eventName).push(subscription);
    } else {
      // æ™®é€šäº‹ä»¶
      if (!this.events.has(eventName)) {
        this.events.set(eventName, []);
      }
      this.events.get(eventName).push(subscription);
    }

    // æŒ‰ä¼˜å…ˆçº§æ’åº
    const handlers = this.events.get(eventName) || this.wildcardEvents.get(eventName);
    handlers.sort((a, b) =&gt; b.priority - a.priority);

    // è¿”å›å–æ¶ˆè®¢é˜…å‡½æ•°
    return () =&gt; this.off(eventName, subscription.id);
  }

  // å–æ¶ˆè®¢é˜…
  off(eventName, handlerOrId) {
    const removeFromArray = (array, predicate) =&gt; {
      const index = array.findIndex(predicate);
      if (index &gt; -1) {
        array.splice(index, 1);
      }
    };

    const predicate = typeof handlerOrId === 'string' 
      ? (sub) =&gt; sub.id === handlerOrId
      : (sub) =&gt; sub.handler === handlerOrId;

    if (this.events.has(eventName)) {
      removeFromArray(this.events.get(eventName), predicate);
    }

    // æ£€æŸ¥é€šé…ç¬¦äº‹ä»¶
    this.wildcardEvents.forEach((handlers, pattern) =&gt; {
      if (this._matchPattern(pattern, eventName)) {
        removeFromArray(handlers, predicate);
      }
    });
  }

  // å‘å¸ƒäº‹ä»¶
  async emit(eventName, data, options = {}) {
    const { timeout = 5000, retries = 0 } = options;
    
    // åº”ç”¨ä¸­é—´ä»¶
    let processedData = data;
    for (const middleware of this.middlewares) {
      processedData = await middleware(eventName, processedData, options);
    }

    const event = {
      name: eventName,
      data: processedData,
      timestamp: Date.now(),
      source: options.source || 'unknown'
    };

    const promises = [];

    // æ™®é€šäº‹ä»¶å¤„ç†å™¨
    if (this.events.has(eventName)) {
      const handlers = this.events.get(eventName);
      promises.push(...this._executeHandlers(handlers, event, timeout));
    }

    // é€šé…ç¬¦äº‹ä»¶å¤„ç†å™¨
    this.wildcardEvents.forEach((handlers, pattern) =&gt; {
      if (this._matchPattern(pattern, eventName)) {
        promises.push(...this._executeHandlers(handlers, event, timeout));
      }
    });

    // ç­‰å¾…æ‰€æœ‰å¤„ç†å™¨å®Œæˆ
    try {
      await Promise.allSettled(promises);
    } catch (error) {
      console.error(`Event ${eventName} handling failed:`, error);
      
      if (retries &gt; 0) {
        console.log(`Retrying event ${eventName}, ${retries} attempts left`);
        return this.emit(eventName, data, { ...options, retries: retries - 1 });
      }
    }
  }

  _executeHandlers(handlers, event, timeout) {
    return handlers.map(async (subscription) =&gt; {
      try {
        const timeoutPromise = new Promise((_, reject) =&gt;
          setTimeout(() =&gt; reject(new Error('Handler timeout')), timeout)
        );

        const handlerPromise = Promise.resolve(subscription.handler(event));
        
        await Promise.race([handlerPromise, timeoutPromise]);

        // ä¸€æ¬¡æ€§è®¢é˜…å¤„ç†
        if (subscription.once) {
          this.off(event.name, subscription.id);
        }
      } catch (error) {
        console.error(`Handler failed for event ${event.name}:`, error);
      }
    });
  }

  _matchPattern(pattern, eventName) {
    const regex = new RegExp(
      pattern.replace(/\*/g, '.*').replace(/\?/g, '.')
    );
    return regex.test(eventName);
  }
}

// å…¨å±€äº‹ä»¶æ€»çº¿å®ä¾‹
const eventBus = new MicrofrontendEventBus();

// ä½¿ç”¨ç¤ºä¾‹
// ç”¨æˆ·åº”ç”¨ - å‘å¸ƒç”¨æˆ·ç™»å½•äº‹ä»¶
eventBus.emit('user.login', {
  userId: '123',
  username: 'john_doe',
  timestamp: Date.now()
}, { source: 'user-app' });

// è´­ç‰©è½¦åº”ç”¨ - ç›‘å¬ç”¨æˆ·ç™»å½•
eventBus.on('user.login', (event) =&gt; {
  console.log('User logged in, updating cart:', event.data);
  // æ›´æ–°è´­ç‰©è½¦çŠ¶æ€
});

// å¯¼èˆªåº”ç”¨ - ç›‘å¬æ‰€æœ‰ç”¨æˆ·äº‹ä»¶
eventBus.on('user.*', (event) =&gt; {
  console.log('User event received:', event.name, event.data);
  // æ›´æ–°å¯¼èˆªçŠ¶æ€
});
</code></pre>
<h3 id="çŠ¶æ€å…±äº«"><a class="header" href="#çŠ¶æ€å…±äº«">çŠ¶æ€å…±äº«</a></h3>
<pre><code class="language-javascript">// å¾®å‰ç«¯çŠ¶æ€ç®¡ç†
class MicrofrontendStore {
  constructor() {
    this.state = new Map();
    this.subscribers = new Map();
    this.middlewares = [];
    this.history = [];
    this.maxHistory = 50;
  }

  // æ·»åŠ ä¸­é—´ä»¶
  use(middleware) {
    this.middlewares.push(middleware);
  }

  // è®¾ç½®çŠ¶æ€
  async setState(namespace, updates, options = {}) {
    const { merge = true, notify = true } = options;
    
    const currentState = this.state.get(namespace) || {};
    const newState = merge ? { ...currentState, ...updates } : updates;
    
    // åº”ç”¨ä¸­é—´ä»¶
    let processedState = newState;
    for (const middleware of this.middlewares) {
      processedState = await middleware({
        action: 'setState',
        namespace,
        oldState: currentState,
        newState: processedState,
        updates
      });
    }

    // è®°å½•å†å²
    this.history.push({
      timestamp: Date.now(),
      namespace,
      oldState: currentState,
      newState: processedState,
      action: 'setState'
    });

    if (this.history.length &gt; this.maxHistory) {
      this.history.shift();
    }

    this.state.set(namespace, processedState);

    // é€šçŸ¥è®¢é˜…è€…
    if (notify) {
      this._notifySubscribers(namespace, processedState, currentState);
    }

    return processedState;
  }

  // è·å–çŠ¶æ€
  getState(namespace, path) {
    const state = this.state.get(namespace);
    
    if (!state) return undefined;
    if (!path) return state;

    // æ”¯æŒè·¯å¾„è®¿é—® 'user.profile.name'
    return path.split('.').reduce((obj, key) =&gt; obj?.[key], state);
  }

  // è®¢é˜…çŠ¶æ€å˜åŒ–
  subscribe(namespace, callback, options = {}) {
    const { path, immediate = false } = options;
    
    if (!this.subscribers.has(namespace)) {
      this.subscribers.set(namespace, []);
    }

    const subscription = {
      callback,
      path,
      id: Math.random().toString(36).substr(2, 9)
    };

    this.subscribers.get(namespace).push(subscription);

    // ç«‹å³è°ƒç”¨å›è°ƒ
    if (immediate) {
      const state = this.getState(namespace, path);
      callback(state, undefined, namespace);
    }

    // è¿”å›å–æ¶ˆè®¢é˜…å‡½æ•°
    return () =&gt; {
      const subs = this.subscribers.get(namespace);
      const index = subs.findIndex(sub =&gt; sub.id === subscription.id);
      if (index &gt; -1) {
        subs.splice(index, 1);
      }
    };
  }

  // æ¸…ç†å‘½åç©ºé—´
  clearNamespace(namespace) {
    this.state.delete(namespace);
    this.subscribers.delete(namespace);
  }

  // è·å–æ‰€æœ‰å‘½åç©ºé—´
  getNamespaces() {
    return Array.from(this.state.keys());
  }

  _notifySubscribers(namespace, newState, oldState) {
    const subscribers = this.subscribers.get(namespace) || [];
    
    subscribers.forEach(({ callback, path }) =&gt; {
      try {
        const newValue = path ? this._getValueByPath(newState, path) : newState;
        const oldValue = path ? this._getValueByPath(oldState, path) : oldState;
        
        // åªåœ¨å€¼å®é™…æ”¹å˜æ—¶é€šçŸ¥
        if (JSON.stringify(newValue) !== JSON.stringify(oldValue)) {
          callback(newValue, oldValue, namespace);
        }
      } catch (error) {
        console.error(`Subscriber callback failed for ${namespace}:`, error);
      }
    });
  }

  _getValueByPath(obj, path) {
    return path.split('.').reduce((current, key) =&gt; current?.[key], obj);
  }
}

// å…¨å±€çŠ¶æ€å­˜å‚¨
const microfrontendStore = new MicrofrontendStore();

// æ·»åŠ æ—¥å¿—ä¸­é—´ä»¶
microfrontendStore.use(async (context) =&gt; {
  console.log('State change:', context);
  return context.newState;
});

// ä½¿ç”¨ç¤ºä¾‹
// ç”¨æˆ·åº”ç”¨
microfrontendStore.setState('user', {
  isLoggedIn: true,
  profile: {
    id: '123',
    name: 'John Doe',
    email: 'john@example.com'
  }
});

// è´­ç‰©è½¦åº”ç”¨ç›‘å¬ç”¨æˆ·çŠ¶æ€
const unsubscribe = microfrontendStore.subscribe('user', (userState) =&gt; {
  if (userState.isLoggedIn) {
    console.log('User logged in, loading cart for:', userState.profile.name);
    // åŠ è½½ç”¨æˆ·è´­ç‰©è½¦
  }
}, { immediate: true });

// äº§å“åº”ç”¨åªç›‘å¬ç”¨æˆ·ID
microfrontendStore.subscribe('user', (userId) =&gt; {
  console.log('User ID changed:', userId);
  // æ›´æ–°æ¨èäº§å“
}, { path: 'profile.id' });
</code></pre>
<h2 id="è·¯ç”±ç®¡ç†"><a class="header" href="#è·¯ç”±ç®¡ç†">è·¯ç”±ç®¡ç†</a></h2>
<h3 id="å¾®å‰ç«¯è·¯ç”±ç³»ç»Ÿ"><a class="header" href="#å¾®å‰ç«¯è·¯ç”±ç³»ç»Ÿ">å¾®å‰ç«¯è·¯ç”±ç³»ç»Ÿ</a></h3>
<pre><code class="language-javascript">// å¾®å‰ç«¯è·¯ç”±ç®¡ç†å™¨
class MicrofrontendRouter {
  constructor() {
    this.routes = new Map();
    this.activeApplications = new Set();
    this.currentLocation = this._getCurrentLocation();
    this.beforeRouteChangeHooks = [];
    this.afterRouteChangeHooks = [];
    
    this._setupEventListeners();
  }

  // æ³¨å†Œè·¯ç”±
  registerRoute(pattern, config) {
    this.routes.set(pattern, {
      ...config,
      pattern,
      regex: this._patternToRegex(pattern),
      active: false
    });
  }

  // å¯¼èˆªåˆ°æŒ‡å®šè·¯å¾„
  async navigate(path, options = {}) {
    const { replace = false, state = null } = options;
    
    // æ‰§è¡Œå‰ç½®é’©å­
    for (const hook of this.beforeRouteChangeHooks) {
      const result = await hook(path, this.currentLocation);
      if (result === false) {
        console.log('Navigation cancelled by beforeRouteChange hook');
        return false;
      }
    }

    // æ›´æ–°æµè§ˆå™¨å†å²
    if (replace) {
      history.replaceState(state, '', path);
    } else {
      history.pushState(state, '', path);
    }

    // æ›´æ–°å½“å‰ä½ç½®å¹¶é‡æ–°è·¯ç”±
    await this._handleLocationChange(path);
    
    return true;
  }

  // æ·»åŠ è·¯ç”±å˜åŒ–é’©å­
  beforeRouteChange(hook) {
    this.beforeRouteChangeHooks.push(hook);
  }

  afterRouteChange(hook) {
    this.afterRouteChangeHooks.push(hook);
  }

  // è·å–å½“å‰æ¿€æ´»çš„åº”ç”¨
  getActiveApplications() {
    return Array.from(this.activeApplications);
  }

  async _handleLocationChange(newLocation = this._getCurrentLocation()) {
    const oldLocation = this.currentLocation;
    this.currentLocation = newLocation;

    // è®¡ç®—éœ€è¦æ¿€æ´»å’Œåœç”¨çš„åº”ç”¨
    const { toActivate, toDeactivate } = this._calculateApplicationChanges();

    // åœç”¨åº”ç”¨
    for (const appName of toDeactivate) {
      await this._deactivateApplication(appName);
    }

    // æ¿€æ´»åº”ç”¨
    for (const appName of toActivate) {
      await this._activateApplication(appName);
    }

    // æ‰§è¡Œåç½®é’©å­
    for (const hook of this.afterRouteChangeHooks) {
      await hook(newLocation, oldLocation);
    }
  }

  _calculateApplicationChanges() {
    const newActiveApps = new Set();
    
    // æ£€æŸ¥æ¯ä¸ªè·¯ç”±æ˜¯å¦åŒ¹é…å½“å‰ä½ç½®
    for (const [pattern, route] of this.routes) {
      if (route.regex.test(this.currentLocation)) {
        newActiveApps.add(route.application);
      }
    }

    const toActivate = new Set([...newActiveApps].filter(app =&gt; !this.activeApplications.has(app)));
    const toDeactivate = new Set([...this.activeApplications].filter(app =&gt; !newActiveApps.has(app)));

    return { toActivate, toDeactivate };
  }

  async _activateApplication(appName) {
    try {
      const route = this._findRouteByApplication(appName);
      if (!route) return;

      console.log(`Activating application: ${appName}`);
      
      // åŠ è½½åº”ç”¨æ¨¡å—
      let appModule;
      if (typeof route.loadApp === 'function') {
        appModule = await route.loadApp();
      } else if (typeof route.loadApp === 'string') {
        appModule = await import(route.loadApp);
      }

      // æŒ‚è½½åº”ç”¨
      if (appModule &amp;&amp; appModule.mount) {
        const mountProps = {
          domElement: route.domElementGetter ? route.domElementGetter() : document.getElementById(route.containerId),
          currentLocation: this.currentLocation,
          routeParams: this._extractRouteParams(route.pattern, this.currentLocation)
        };

        await appModule.mount(mountProps);
        route.mountedModule = appModule;
      }

      this.activeApplications.add(appName);
    } catch (error) {
      console.error(`Failed to activate application ${appName}:`, error);
    }
  }

  async _deactivateApplication(appName) {
    try {
      const route = this._findRouteByApplication(appName);
      if (!route || !route.mountedModule) return;

      console.log(`Deactivating application: ${appName}`);

      // å¸è½½åº”ç”¨
      if (route.mountedModule.unmount) {
        await route.mountedModule.unmount();
      }

      route.mountedModule = null;
      this.activeApplications.delete(appName);
    } catch (error) {
      console.error(`Failed to deactivate application ${appName}:`, error);
    }
  }

  _findRouteByApplication(appName) {
    for (const route of this.routes.values()) {
      if (route.application === appName) {
        return route;
      }
    }
    return null;
  }

  _extractRouteParams(pattern, path) {
    const paramNames = pattern.match(/:(\w+)/g)?.map(param =&gt; param.slice(1)) || [];
    const matches = path.match(this._patternToRegex(pattern));
    
    if (!matches) return {};

    const params = {};
    paramNames.forEach((name, index) =&gt; {
      params[name] = matches[index + 1];
    });

    return params;
  }

  _patternToRegex(pattern) {
    const escaped = pattern.replace(/[.*+?^${}()|[\]\\]/g, '\\$&amp;');
    const withParams = escaped.replace(/\\:(\w+)/g, '([^/]+)');
    return new RegExp(`^${withParams}$`);
  }

  _getCurrentLocation() {
    return window.location.pathname + window.location.search + window.location.hash;
  }

  _setupEventListeners() {
    // ç›‘å¬æµè§ˆå™¨å†å²å˜åŒ–
    window.addEventListener('popstate', () =&gt; {
      this._handleLocationChange();
    });

    // æ‹¦æˆªé“¾æ¥ç‚¹å‡»
    document.addEventListener('click', (event) =&gt; {
      if (event.target.tagName === 'A' &amp;&amp; event.target.origin === window.location.origin) {
        event.preventDefault();
        this.navigate(event.target.pathname + event.target.search + event.target.hash);
      }
    });
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const router = new MicrofrontendRouter();

// æ³¨å†Œå¾®å‰ç«¯è·¯ç”±
router.registerRoute('/users/*', {
  application: 'user-app',
  loadApp: () =&gt; import('user-app/UserApp'),
  containerId: 'user-app-container'
});

router.registerRoute('/products/:category', {
  application: 'product-app',
  loadApp: 'product-app/ProductApp',
  domElementGetter: () =&gt; document.querySelector('#product-container')
});

router.registerRoute('/cart', {
  application: 'cart-app',
  loadApp: () =&gt; import('cart-app/CartApp'),
  containerId: 'cart-app-container'
});

// æ·»åŠ è·¯ç”±å®ˆå«
router.beforeRouteChange(async (to, from) =&gt; {
  if (to.startsWith('/admin') &amp;&amp; !isUserAdmin()) {
    console.log('Access denied to admin area');
    return false;
  }
  return true;
});

// å¯åŠ¨è·¯ç”±
router._handleLocationChange();
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–-9"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–-9">æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="èµ„æºå…±äº«ä¸ä¼˜åŒ–"><a class="header" href="#èµ„æºå…±äº«ä¸ä¼˜åŒ–">èµ„æºå…±äº«ä¸ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// å…±äº«èµ„æºç®¡ç†å™¨
class SharedResourceManager {
  constructor() {
    this.sharedLibraries = new Map();
    this.loadingPromises = new Map();
    this.dependencyGraph = new Map();
  }

  // æ³¨å†Œå…±äº«åº“
  registerSharedLibrary(name, config) {
    this.sharedLibraries.set(name, {
      name,
      version: config.version,
      url: config.url,
      eager: config.eager || false,
      singleton: config.singleton || false,
      requiredVersion: config.requiredVersion,
      shareScope: config.shareScope || 'default',
      loaded: false,
      module: null
    });

    if (config.eager) {
      this.preloadLibrary(name);
    }
  }

  // é¢„åŠ è½½åº“
  async preloadLibrary(name) {
    if (this.loadingPromises.has(name)) {
      return this.loadingPromises.get(name);
    }

    const library = this.sharedLibraries.get(name);
    if (!library || library.loaded) {
      return library?.module;
    }

    const loadingPromise = this._loadLibrary(library);
    this.loadingPromises.set(name, loadingPromise);

    try {
      const module = await loadingPromise;
      library.loaded = true;
      library.module = module;
      this.loadingPromises.delete(name);
      return module;
    } catch (error) {
      this.loadingPromises.delete(name);
      throw error;
    }
  }

  // è·å–å…±äº«åº“
  async getSharedLibrary(name, requiredVersion) {
    const library = this.sharedLibraries.get(name);
    
    if (!library) {
      throw new Error(`Shared library ${name} not found`);
    }

    // ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥
    if (requiredVersion &amp;&amp; !this._isVersionCompatible(library.version, requiredVersion)) {
      console.warn(`Version mismatch for ${name}: required ${requiredVersion}, available ${library.version}`);
    }

    // å•ä¾‹æ£€æŸ¥
    if (library.singleton &amp;&amp; library.loaded) {
      return library.module;
    }

    return this.preloadLibrary(name);
  }

  // åˆ†æä¾èµ–å…³ç³»
  analyzeDependencies(appName, dependencies) {
    this.dependencyGraph.set(appName, dependencies);
    
    // æ£€æµ‹å¾ªç¯ä¾èµ–
    const visited = new Set();
    const recursionStack = new Set();
    
    const hasCycle = (node) =&gt; {
      if (recursionStack.has(node)) return true;
      if (visited.has(node)) return false;

      visited.add(node);
      recursionStack.add(node);

      const deps = this.dependencyGraph.get(node) || [];
      for (const dep of deps) {
        if (hasCycle(dep)) return true;
      }

      recursionStack.delete(node);
      return false;
    };

    if (hasCycle(appName)) {
      console.warn(`Circular dependency detected for application: ${appName}`);
    }
  }

  // é¢„åŠ è½½åº”ç”¨ä¾èµ–
  async preloadDependencies(appName) {
    const dependencies = this.dependencyGraph.get(appName) || [];
    const loadPromises = dependencies.map(dep =&gt; this.preloadLibrary(dep));
    
    try {
      await Promise.allSettled(loadPromises);
    } catch (error) {
      console.error(`Failed to preload dependencies for ${appName}:`, error);
    }
  }

  _loadLibrary(library) {
    if (library.url.startsWith('http')) {
      // è¿œç¨‹æ¨¡å—
      return import(library.url);
    } else {
      // æœ¬åœ°æ¨¡å—
      return import(library.url);
    }
  }

  _isVersionCompatible(available, required) {
    // ç®€åŒ–çš„è¯­ä¹‰ç‰ˆæœ¬æ£€æŸ¥
    const parseVersion = (version) =&gt; version.replace(/[^\d.]/g, '').split('.').map(Number);
    const availableVersion = parseVersion(available);
    const requiredVersion = parseVersion(required);

    // ä¸»ç‰ˆæœ¬å¿…é¡»åŒ¹é…
    return availableVersion[0] === requiredVersion[0] &amp;&amp; 
           availableVersion[1] &gt;= requiredVersion[1];
  }
}

// ç¼“å­˜ä¼˜åŒ–
class MicrofrontendCache {
  constructor() {
    this.moduleCache = new Map();
    this.resourceCache = new Map();
    this.cacheStats = {
      hits: 0,
      misses: 0,
      evictions: 0
    };
    this.maxCacheSize = 50;
  }

  // ç¼“å­˜æ¨¡å—
  cacheModule(url, module, metadata = {}) {
    if (this.moduleCache.size &gt;= this.maxCacheSize) {
      this._evictOldestModule();
    }

    this.moduleCache.set(url, {
      module,
      timestamp: Date.now(),
      accessCount: 0,
      size: this._estimateSize(module),
      ...metadata
    });
  }

  // è·å–ç¼“å­˜çš„æ¨¡å—
  getCachedModule(url) {
    const cached = this.moduleCache.get(url);
    
    if (cached) {
      cached.accessCount++;
      cached.lastAccessed = Date.now();
      this.cacheStats.hits++;
      return cached.module;
    }

    this.cacheStats.misses++;
    return null;
  }

  // é¢„å–èµ„æº
  async prefetchResource(url, priority = 'low') {
    if (this.resourceCache.has(url)) {
      return this.resourceCache.get(url);
    }

    const link = document.createElement('link');
    link.rel = 'prefetch';
    link.href = url;
    link.fetchPriority = priority;
    
    document.head.appendChild(link);

    // åˆ›å»ºé¢„å–Promise
    const prefetchPromise = new Promise((resolve, reject) =&gt; {
      link.onload = () =&gt; resolve(url);
      link.onerror = () =&gt; reject(new Error(`Failed to prefetch ${url}`));
    });

    this.resourceCache.set(url, prefetchPromise);
    return prefetchPromise;
  }

  _evictOldestModule() {
    let oldestUrl = null;
    let oldestTime = Date.now();

    for (const [url, cached] of this.moduleCache) {
      if (cached.lastAccessed &lt; oldestTime) {
        oldestTime = cached.lastAccessed;
        oldestUrl = url;
      }
    }

    if (oldestUrl) {
      this.moduleCache.delete(oldestUrl);
      this.cacheStats.evictions++;
    }
  }

  _estimateSize(obj) {
    return JSON.stringify(obj).length;
  }

  getStats() {
    return {
      ...this.cacheStats,
      cacheSize: this.moduleCache.size,
      hitRate: this.cacheStats.hits / (this.cacheStats.hits + this.cacheStats.misses)
    };
  }
}

// å…¨å±€å®ä¾‹
const sharedResourceManager = new SharedResourceManager();
const microfrontendCache = new MicrofrontendCache();

// ä½¿ç”¨ç¤ºä¾‹
// æ³¨å†Œå…±äº«åº“
sharedResourceManager.registerSharedLibrary('react', {
  version: '18.2.0',
  url: 'https://unpkg.com/react@18/umd/react.production.min.js',
  singleton: true,
  eager: true
});

sharedResourceManager.registerSharedLibrary('lodash', {
  version: '4.17.21',
  url: 'https://unpkg.com/lodash@4.17.21/lodash.min.js',
  singleton: false
});

// é¢„åŠ è½½åº”ç”¨ä¾èµ–
sharedResourceManager.analyzeDependencies('user-app', ['react', 'lodash']);
await sharedResourceManager.preloadDependencies('user-app');
</code></pre>
<p>é€šè¿‡è¿™äº›å¾®å‰ç«¯æ¨¡å—åŒ–æŠ€æœ¯ï¼Œå¯ä»¥æ„å»ºé«˜åº¦å¯æ‰©å±•ã€å¯ç»´æŠ¤çš„å¤§å‹å‰ç«¯åº”ç”¨ï¼Œå®ç°å›¢é˜Ÿè‡ªæ²»å’ŒæŠ€æœ¯æ ˆå¤šæ ·åŒ–çš„åŒæ—¶ï¼Œä¿æŒè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿæ€§èƒ½ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="web-workersä¸­çš„æ¨¡å—"><a class="header" href="#web-workersä¸­çš„æ¨¡å—">Web Workersä¸­çš„æ¨¡å—</a></h1>
<p>Web Workersä¸ºJavaScriptæä¾›äº†å¤šçº¿ç¨‹èƒ½åŠ›ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œè®¡ç®—å¯†é›†å‹ä»»åŠ¡ã€‚æœ¬ç« å°†æ¢è®¨å¦‚ä½•åœ¨Web Workersä¸­ä½¿ç”¨ESæ¨¡å—ç³»ç»Ÿã€‚</p>
<h2 id="web-workersåŸºç¡€"><a class="header" href="#web-workersåŸºç¡€">Web WorkersåŸºç¡€</a></h2>
<h3 id="workerç±»å‹ä¸æ¨¡å—æ”¯æŒ"><a class="header" href="#workerç±»å‹ä¸æ¨¡å—æ”¯æŒ">Workerç±»å‹ä¸æ¨¡å—æ”¯æŒ</a></h3>
<pre><code class="language-javascript">// ä¸»çº¿ç¨‹ - main.js
// 1. ç»å…¸Worker (ä¸æ”¯æŒESæ¨¡å—)
const classicWorker = new Worker('./classic-worker.js');

// 2. æ¨¡å—Worker (æ”¯æŒESæ¨¡å—)
const moduleWorker = new Worker('./module-worker.js', { 
  type: 'module' 
});

// 3. å†…è”Worker
const inlineWorkerScript = `
  import { heavyComputation } from './utils.js';
  
  self.onmessage = function(e) {
    const result = heavyComputation(e.data);
    self.postMessage(result);
  };
`;

const blob = new Blob([inlineWorkerScript], { type: 'application/javascript' });
const inlineWorker = new Worker(URL.createObjectURL(blob), { 
  type: 'module' 
});

// Workerèƒ½åŠ›æ£€æµ‹
function supportsModuleWorkers() {
  try {
    new Worker('data:text/javascript,', { type: 'module' }).terminate();
    return true;
  } catch (e) {
    return false;
  }
}

if (supportsModuleWorkers()) {
  console.log('Browser supports module workers');
} else {
  console.log('Falling back to classic workers');
}
</code></pre>
<h3 id="æ¨¡å—workerç¤ºä¾‹"><a class="header" href="#æ¨¡å—workerç¤ºä¾‹">æ¨¡å—Workerç¤ºä¾‹</a></h3>
<pre><code class="language-javascript">// module-worker.js - æ”¯æŒESæ¨¡å—çš„Worker
import { calculatePrimes } from './math-utils.js';
import { formatResult } from './formatters.js';
import { Logger } from './logger.js';

const logger = new Logger('MathWorker');

// Workerå…¨å±€ä½œç”¨åŸŸä¸­çš„self
self.onmessage = async function(event) {
  const { type, data, id } = event.data;
  
  try {
    let result;
    
    switch (type) {
      case 'CALCULATE_PRIMES':
        logger.info(`Calculating primes up to ${data.limit}`);
        result = await calculatePrimes(data.limit);
        break;
        
      case 'PROCESS_ARRAY':
        logger.info(`Processing array of ${data.array.length} items`);
        result = await processLargeArray(data.array, data.operation);
        break;
        
      default:
        throw new Error(`Unknown task type: ${type}`);
    }
    
    // å‘é€æ ¼å¼åŒ–çš„ç»“æœ
    self.postMessage({
      id,
      type: 'SUCCESS',
      data: formatResult(result),
      timestamp: Date.now()
    });
    
  } catch (error) {
    logger.error('Worker task failed:', error);
    
    self.postMessage({
      id,
      type: 'ERROR',
      error: {
        message: error.message,
        stack: error.stack
      },
      timestamp: Date.now()
    });
  }
};

// åŠ¨æ€å¯¼å…¥æ¨¡å—
async function processLargeArray(array, operation) {
  // æ ¹æ®æ“ä½œç±»å‹åŠ¨æ€åŠ è½½å¤„ç†æ¨¡å—
  const { default: processor } = await import(`./processors/${operation}.js`);
  return processor(array);
}

// é”™è¯¯å¤„ç†
self.onerror = function(error) {
  logger.error('Uncaught error in worker:', error);
};

self.onunhandledrejection = function(event) {
  logger.error('Unhandled promise rejection in worker:', event.reason);
};

logger.info('Math worker initialized');
</code></pre>
<h2 id="workeræ¨¡å—ç®¡ç†å™¨"><a class="header" href="#workeræ¨¡å—ç®¡ç†å™¨">Workeræ¨¡å—ç®¡ç†å™¨</a></h2>
<h3 id="æ¨¡å—åŒ–workerç®¡ç†ç³»ç»Ÿ"><a class="header" href="#æ¨¡å—åŒ–workerç®¡ç†ç³»ç»Ÿ">æ¨¡å—åŒ–Workerç®¡ç†ç³»ç»Ÿ</a></h3>
<pre><code class="language-javascript">// worker-manager.js - Workeræ¨¡å—ç®¡ç†å™¨
class WorkerManager {
  constructor() {
    this.workers = new Map();
    this.taskQueue = new Map();
    this.taskId = 0;
    this.workerPool = new Map();
    this.maxWorkers = navigator.hardwareConcurrency || 4;
  }

  // æ³¨å†ŒWorkerç±»å‹
  registerWorker(name, config) {
    this.workers.set(name, {
      name,
      script: config.script,
      type: config.type || 'module',
      maxInstances: config.maxInstances || 1,
      pool: [],
      activeCount: 0,
      options: config.options || {}
    });
  }

  // æ‰§è¡Œä»»åŠ¡
  async executeTask(workerName, taskType, data, options = {}) {
    const taskId = ++this.taskId;
    const { timeout = 30000, priority = 'normal' } = options;
    
    return new Promise((resolve, reject) =&gt; {
      const task = {
        id: taskId,
        workerName,
        taskType,
        data,
        resolve,
        reject,
        priority,
        timestamp: Date.now(),
        timeout: setTimeout(() =&gt; {
          this._handleTaskTimeout(taskId);
        }, timeout)
      };

      this.taskQueue.set(taskId, task);
      this._processTaskQueue();
    });
  }

  // è·å–æˆ–åˆ›å»ºWorkerå®ä¾‹
  async _getWorkerInstance(workerName) {
    const workerConfig = this.workers.get(workerName);
    if (!workerConfig) {
      throw new Error(`Worker ${workerName} not registered`);
    }

    // å°è¯•ä»æ± ä¸­è·å–ç©ºé—²çš„Worker
    const availableWorker = workerConfig.pool.find(w =&gt; !w.busy);
    if (availableWorker) {
      return availableWorker;
    }

    // å¦‚æœæ± æœªæ»¡ï¼Œåˆ›å»ºæ–°çš„Worker
    if (workerConfig.pool.length &lt; workerConfig.maxInstances) {
      const worker = await this._createWorkerInstance(workerConfig);
      workerConfig.pool.push(worker);
      return worker;
    }

    // ç­‰å¾…Workerå˜ä¸ºå¯ç”¨
    return this._waitForAvailableWorker(workerName);
  }

  async _createWorkerInstance(config) {
    const worker = new Worker(config.script, {
      type: config.type,
      ...config.options
    });

    const workerInstance = {
      worker,
      busy: false,
      tasks: new Set(),
      created: Date.now(),
      taskCount: 0
    };

    // è®¾ç½®æ¶ˆæ¯å¤„ç†
    worker.onmessage = (event) =&gt; {
      this._handleWorkerMessage(workerInstance, event);
    };

    worker.onerror = (error) =&gt; {
      this._handleWorkerError(workerInstance, error);
    };

    // ç­‰å¾…Workeråˆå§‹åŒ–å®Œæˆ
    await this._waitForWorkerReady(worker);

    return workerInstance;
  }

  _handleWorkerMessage(workerInstance, event) {
    const { id, type, data, error } = event.data;
    const task = this.taskQueue.get(id);
    
    if (!task) {
      console.warn(`Received message for unknown task ${id}`);
      return;
    }

    clearTimeout(task.timeout);
    this.taskQueue.delete(id);
    workerInstance.tasks.delete(id);

    if (type === 'SUCCESS') {
      task.resolve(data);
    } else if (type === 'ERROR') {
      task.reject(new Error(error.message));
    }

    // æ ‡è®°Workerä¸ºç©ºé—²
    if (workerInstance.tasks.size === 0) {
      workerInstance.busy = false;
      this._processTaskQueue();
    }
  }

  _handleWorkerError(workerInstance, error) {
    console.error('Worker error:', error);
    
    // æ‹’ç»æ‰€æœ‰å¾…å¤„ç†çš„ä»»åŠ¡
    for (const taskId of workerInstance.tasks) {
      const task = this.taskQueue.get(taskId);
      if (task) {
        clearTimeout(task.timeout);
        task.reject(new Error(`Worker error: ${error.message}`));
        this.taskQueue.delete(taskId);
      }
    }

    // ä»æ± ä¸­ç§»é™¤æŸåçš„Worker
    this._removeWorkerFromPool(workerInstance);
  }

  _processTaskQueue() {
    const pendingTasks = Array.from(this.taskQueue.values())
      .filter(task =&gt; !task.assigned)
      .sort((a, b) =&gt; {
        // æŒ‰ä¼˜å…ˆçº§å’Œæ—¶é—´æˆ³æ’åº
        const priorityOrder = { high: 3, normal: 2, low: 1 };
        const aPriority = priorityOrder[a.priority] || 2;
        const bPriority = priorityOrder[b.priority] || 2;
        
        if (aPriority !== bPriority) {
          return bPriority - aPriority;
        }
        
        return a.timestamp - b.timestamp;
      });

    for (const task of pendingTasks) {
      this._assignTaskToWorker(task);
    }
  }

  async _assignTaskToWorker(task) {
    try {
      const workerInstance = await this._getWorkerInstance(task.workerName);
      
      workerInstance.busy = true;
      workerInstance.tasks.add(task.id);
      workerInstance.taskCount++;
      task.assigned = true;

      // å‘é€ä»»åŠ¡åˆ°Worker
      workerInstance.worker.postMessage({
        id: task.id,
        type: task.taskType,
        data: task.data
      });

    } catch (error) {
      clearTimeout(task.timeout);
      task.reject(error);
      this.taskQueue.delete(task.id);
    }
  }

  _handleTaskTimeout(taskId) {
    const task = this.taskQueue.get(taskId);
    if (task) {
      task.reject(new Error('Task timeout'));
      this.taskQueue.delete(taskId);
    }
  }

  async _waitForWorkerReady(worker) {
    return new Promise((resolve) =&gt; {
      const checkReady = () =&gt; {
        worker.postMessage({ type: 'PING' });
        
        const handlePong = (event) =&gt; {
          if (event.data.type === 'PONG') {
            worker.removeEventListener('message', handlePong);
            resolve();
          }
        };
        
        worker.addEventListener('message', handlePong);
      };
      
      checkReady();
    });
  }

  // ç»ˆæ­¢æ‰€æœ‰Worker
  terminateAllWorkers() {
    for (const workerConfig of this.workers.values()) {
      for (const workerInstance of workerConfig.pool) {
        workerInstance.worker.terminate();
      }
      workerConfig.pool.length = 0;
    }
  }

  // è·å–ç»Ÿè®¡ä¿¡æ¯
  getStats() {
    const stats = {
      totalWorkers: 0,
      busyWorkers: 0,
      pendingTasks: 0,
      workerTypes: {}
    };

    for (const [name, config] of this.workers) {
      const busyCount = config.pool.filter(w =&gt; w.busy).length;
      stats.totalWorkers += config.pool.length;
      stats.busyWorkers += busyCount;
      
      stats.workerTypes[name] = {
        total: config.pool.length,
        busy: busyCount,
        maxInstances: config.maxInstances
      };
    }

    stats.pendingTasks = this.taskQueue.size;
    return stats;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const workerManager = new WorkerManager();

// æ³¨å†Œä¸åŒç±»å‹çš„Worker
workerManager.registerWorker('math', {
  script: './workers/math-worker.js',
  type: 'module',
  maxInstances: 2
});

workerManager.registerWorker('image', {
  script: './workers/image-worker.js',
  type: 'module',
  maxInstances: 1
});

// æ‰§è¡Œä»»åŠ¡
async function calculatePrimes(limit) {
  try {
    const result = await workerManager.executeTask('math', 'CALCULATE_PRIMES', 
      { limit }, 
      { timeout: 10000, priority: 'high' }
    );
    console.log('Primes calculated:', result);
  } catch (error) {
    console.error('Failed to calculate primes:', error);
  }
}
</code></pre>
<h2 id="æ¨¡å—å…±äº«ä¸é€šä¿¡"><a class="header" href="#æ¨¡å—å…±äº«ä¸é€šä¿¡">æ¨¡å—å…±äº«ä¸é€šä¿¡</a></h2>
<h3 id="workeré—´æ¨¡å—å…±äº«"><a class="header" href="#workeré—´æ¨¡å—å…±äº«">Workeré—´æ¨¡å—å…±äº«</a></h3>
<pre><code class="language-javascript">// shared-module-manager.js - è·¨Workeræ¨¡å—å…±äº«
class SharedModuleManager {
  constructor() {
    this.sharedModules = new Map();
    this.moduleCache = new Map();
    this.workers = new Set();
  }

  // æ³¨å†Œå¯å…±äº«çš„æ¨¡å—
  registerSharedModule(name, moduleUrl, exports = []) {
    this.sharedModules.set(name, {
      name,
      url: moduleUrl,
      exports,
      cached: false,
      module: null
    });
  }

  // æ³¨å†ŒWorkerå®ä¾‹
  registerWorker(worker, id) {
    this.workers.add({ worker, id });
  }

  // é¢„åŠ è½½å…±äº«æ¨¡å—
  async preloadSharedModules() {
    const loadPromises = Array.from(this.sharedModules.keys())
      .map(name =&gt; this.loadSharedModule(name));
    
    await Promise.allSettled(loadPromises);
  }

  // åŠ è½½å…±äº«æ¨¡å—
  async loadSharedModule(name) {
    const moduleConfig = this.sharedModules.get(name);
    if (!moduleConfig) {
      throw new Error(`Shared module ${name} not found`);
    }

    if (moduleConfig.cached) {
      return moduleConfig.module;
    }

    try {
      // åœ¨ä¸»çº¿ç¨‹ä¸­åŠ è½½æ¨¡å—
      const module = await import(moduleConfig.url);
      
      // ç¼“å­˜æ¨¡å—
      moduleConfig.module = module;
      moduleConfig.cached = true;
      
      // é€šçŸ¥æ‰€æœ‰Workeræ¨¡å—å·²å¯ç”¨
      this._broadcastModuleAvailable(name, moduleConfig);
      
      return module;
    } catch (error) {
      console.error(`Failed to load shared module ${name}:`, error);
      throw error;
    }
  }

  // å¹¿æ’­æ¨¡å—å¯ç”¨æ€§
  _broadcastModuleAvailable(name, moduleConfig) {
    const message = {
      type: 'SHARED_MODULE_AVAILABLE',
      moduleName: name,
      moduleUrl: moduleConfig.url,
      exports: moduleConfig.exports
    };

    for (const workerInfo of this.workers) {
      try {
        workerInfo.worker.postMessage(message);
      } catch (error) {
        console.warn(`Failed to notify worker ${workerInfo.id}:`, error);
      }
    }
  }

  // æ¨¡å—é—´é€šä¿¡ä»£ç†
  createCommunicationBridge() {
    return {
      // Workeråˆ°Workeré€šä¿¡
      sendToWorker: (targetWorkerId, message) =&gt; {
        const targetWorker = Array.from(this.workers)
          .find(w =&gt; w.id === targetWorkerId);
        
        if (targetWorker) {
          targetWorker.worker.postMessage({
            type: 'WORKER_MESSAGE',
            from: 'main',
            data: message
          });
        } else {
          console.warn(`Worker ${targetWorkerId} not found`);
        }
      },

      // å¹¿æ’­æ¶ˆæ¯åˆ°æ‰€æœ‰Worker
      broadcast: (message) =&gt; {
        for (const workerInfo of this.workers) {
          workerInfo.worker.postMessage({
            type: 'BROADCAST',
            from: 'main',
            data: message
          });
        }
      }
    };
  }
}

// Workerç«¯çš„å…±äº«æ¨¡å—å¤„ç†
// shared-worker-utils.js
class WorkerSharedModuleHandler {
  constructor() {
    this.availableModules = new Map();
    this.loadedModules = new Map();
  }

  // å¤„ç†ä¸»çº¿ç¨‹æ¶ˆæ¯
  handleMainThreadMessage(event) {
    const { type, moduleName, moduleUrl, exports } = event.data;
    
    switch (type) {
      case 'SHARED_MODULE_AVAILABLE':
        this.availableModules.set(moduleName, { moduleUrl, exports });
        break;
        
      case 'WORKER_MESSAGE':
        this._handleWorkerMessage(event.data);
        break;
        
      case 'BROADCAST':
        this._handleBroadcast(event.data);
        break;
    }
  }

  // åŠ¨æ€åŠ è½½å…±äº«æ¨¡å—
  async loadSharedModule(name) {
    if (this.loadedModules.has(name)) {
      return this.loadedModules.get(name);
    }

    const moduleInfo = this.availableModules.get(name);
    if (!moduleInfo) {
      throw new Error(`Shared module ${name} not available`);
    }

    try {
      const module = await import(moduleInfo.moduleUrl);
      this.loadedModules.set(name, module);
      return module;
    } catch (error) {
      console.error(`Failed to load shared module ${name} in worker:`, error);
      throw error;
    }
  }

  _handleWorkerMessage(messageData) {
    // å¤„ç†æ¥è‡ªå…¶ä»–Workerçš„æ¶ˆæ¯
    console.log('Received message from other worker:', messageData);
  }

  _handleBroadcast(messageData) {
    // å¤„ç†å¹¿æ’­æ¶ˆæ¯
    console.log('Received broadcast:', messageData);
  }
}

// åœ¨Workerä¸­ä½¿ç”¨
// worker-with-shared-modules.js
import { WorkerSharedModuleHandler } from './shared-worker-utils.js';

const sharedHandler = new WorkerSharedModuleHandler();

self.onmessage = async function(event) {
  const { type, data } = event.data;
  
  // å¤„ç†å…±äº«æ¨¡å—ç›¸å…³æ¶ˆæ¯
  if (['SHARED_MODULE_AVAILABLE', 'WORKER_MESSAGE', 'BROADCAST'].includes(type)) {
    sharedHandler.handleMainThreadMessage(event);
    return;
  }

  // å¤„ç†ä¸šåŠ¡é€»è¾‘
  try {
    let result;
    
    switch (type) {
      case 'PROCESS_WITH_SHARED_UTILS':
        // åŠ¨æ€åŠ è½½å…±äº«å·¥å…·æ¨¡å—
        const utils = await sharedHandler.loadSharedModule('utils');
        result = utils.processData(data);
        break;
        
      case 'CALCULATE_WITH_MATH_LIB':
        // ä½¿ç”¨å…±äº«æ•°å­¦åº“
        const mathLib = await sharedHandler.loadSharedModule('mathLib');
        result = mathLib.complexCalculation(data);
        break;
        
      default:
        throw new Error(`Unknown task type: ${type}`);
    }
    
    self.postMessage({
      id: event.data.id,
      type: 'SUCCESS',
      data: result
    });
    
  } catch (error) {
    self.postMessage({
      id: event.data.id,
      type: 'ERROR',
      error: { message: error.message }
    });
  }
};
</code></pre>
<h2 id="é«˜çº§workeræ¨¡å¼"><a class="header" href="#é«˜çº§workeræ¨¡å¼">é«˜çº§Workeræ¨¡å¼</a></h2>
<h3 id="workeræ± ç®¡ç†"><a class="header" href="#workeræ± ç®¡ç†">Workeræ± ç®¡ç†</a></h3>
<pre><code class="language-javascript">// worker-pool.js - é«˜çº§Workeræ± ç®¡ç†
class AdvancedWorkerPool {
  constructor(options = {}) {
    this.maxWorkers = options.maxWorkers || navigator.hardwareConcurrency || 4;
    this.minWorkers = options.minWorkers || 1;
    this.idleTimeout = options.idleTimeout || 30000;
    this.maxTasksPerWorker = options.maxTasksPerWorker || 100;
    
    this.workerScript = options.workerScript;
    this.workerType = options.workerType || 'module';
    
    this.workers = [];
    this.taskQueue = [];
    this.runningTasks = new Map();
    this.workerStats = new Map();
    
    this.setupPool();
  }

  async setupPool() {
    // åˆ›å»ºæœ€å°æ•°é‡çš„Worker
    for (let i = 0; i &lt; this.minWorkers; i++) {
      await this.createWorker();
    }
  }

  async createWorker() {
    const worker = new Worker(this.workerScript, {
      type: this.workerType
    });

    const workerInfo = {
      id: Math.random().toString(36).substr(2, 9),
      worker,
      busy: false,
      taskCount: 0,
      totalTasks: 0,
      errors: 0,
      created: Date.now(),
      lastUsed: Date.now(),
      idleTimer: null
    };

    // è®¾ç½®æ¶ˆæ¯å¤„ç†
    worker.onmessage = (event) =&gt; {
      this.handleWorkerMessage(workerInfo, event);
    };

    worker.onerror = (error) =&gt; {
      this.handleWorkerError(workerInfo, error);
    };

    this.workers.push(workerInfo);
    this.workerStats.set(workerInfo.id, {
      tasksCompleted: 0,
      averageTaskTime: 0,
      errorRate: 0
    });

    return workerInfo;
  }

  async executeTask(taskData, options = {}) {
    return new Promise((resolve, reject) =&gt; {
      const task = {
        id: Math.random().toString(36).substr(2, 9),
        data: taskData,
        resolve,
        reject,
        created: Date.now(),
        timeout: options.timeout || 30000,
        priority: options.priority || 'normal'
      };

      this.taskQueue.push(task);
      this.assignTasks();
    });
  }

  async assignTasks() {
    // æŒ‰ä¼˜å…ˆçº§æ’åºä»»åŠ¡
    this.taskQueue.sort((a, b) =&gt; {
      const priorityOrder = { high: 3, normal: 2, low: 1 };
      return (priorityOrder[b.priority] || 2) - (priorityOrder[a.priority] || 2);
    });

    while (this.taskQueue.length &gt; 0) {
      const availableWorker = this.getAvailableWorker();
      
      if (!availableWorker) {
        // å°è¯•åˆ›å»ºæ–°Worker
        if (this.workers.length &lt; this.maxWorkers) {
          await this.createWorker();
          continue;
        } else {
          break; // æ²¡æœ‰å¯ç”¨Workerï¼Œç­‰å¾…
        }
      }

      const task = this.taskQueue.shift();
      this.assignTaskToWorker(availableWorker, task);
    }
  }

  getAvailableWorker() {
    // æ‰¾åˆ°æœ€é€‚åˆçš„Worker
    const availableWorkers = this.workers.filter(w =&gt; !w.busy);
    
    if (availableWorkers.length === 0) {
      return null;
    }

    // é€‰æ‹©ä»»åŠ¡æ•°æœ€å°‘çš„Worker
    return availableWorkers.reduce((best, current) =&gt; {
      return current.totalTasks &lt; best.totalTasks ? current : best;
    });
  }

  assignTaskToWorker(workerInfo, task) {
    workerInfo.busy = true;
    workerInfo.taskCount++;
    workerInfo.totalTasks++;
    workerInfo.lastUsed = Date.now();

    // æ¸…é™¤ç©ºé—²å®šæ—¶å™¨
    if (workerInfo.idleTimer) {
      clearTimeout(workerInfo.idleTimer);
      workerInfo.idleTimer = null;
    }

    // è®¾ç½®ä»»åŠ¡è¶…æ—¶
    const timeoutId = setTimeout(() =&gt; {
      this.handleTaskTimeout(task.id);
    }, task.timeout);

    this.runningTasks.set(task.id, {
      task,
      worker: workerInfo,
      startTime: Date.now(),
      timeoutId
    });

    // å‘é€ä»»åŠ¡åˆ°Worker
    workerInfo.worker.postMessage({
      id: task.id,
      data: task.data
    });
  }

  handleWorkerMessage(workerInfo, event) {
    const { id, success, result, error } = event.data;
    const taskInfo = this.runningTasks.get(id);
    
    if (!taskInfo) {
      console.warn(`Received result for unknown task ${id}`);
      return;
    }

    const { task, timeoutId } = taskInfo;
    const duration = Date.now() - taskInfo.startTime;

    // æ¸…é™¤è¶…æ—¶å®šæ—¶å™¨
    clearTimeout(timeoutId);
    this.runningTasks.delete(id);

    // æ›´æ–°WorkerçŠ¶æ€
    workerInfo.busy = false;
    workerInfo.taskCount--;
    workerInfo.lastUsed = Date.now();

    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    this.updateWorkerStats(workerInfo.id, duration, success);

    // å¤„ç†ä»»åŠ¡ç»“æœ
    if (success) {
      task.resolve(result);
    } else {
      task.reject(new Error(error));
      workerInfo.errors++;
    }

    // æ£€æŸ¥Workeræ˜¯å¦éœ€è¦å›æ”¶
    this.checkWorkerRecycling(workerInfo);

    // è®¾ç½®ç©ºé—²å®šæ—¶å™¨
    this.setIdleTimer(workerInfo);

    // ç»§ç»­åˆ†é…ä»»åŠ¡
    this.assignTasks();
  }

  handleWorkerError(workerInfo, error) {
    console.error(`Worker ${workerInfo.id} error:`, error);
    
    // æ ‡è®°æ‰€æœ‰è¿è¡Œåœ¨è¯¥Workerä¸Šçš„ä»»åŠ¡ä¸ºå¤±è´¥
    for (const [taskId, taskInfo] of this.runningTasks) {
      if (taskInfo.worker === workerInfo) {
        clearTimeout(taskInfo.timeoutId);
        taskInfo.task.reject(new Error(`Worker error: ${error.message}`));
        this.runningTasks.delete(taskId);
      }
    }

    // ä»æ± ä¸­ç§»é™¤é”™è¯¯çš„Worker
    this.removeWorker(workerInfo);
  }

  handleTaskTimeout(taskId) {
    const taskInfo = this.runningTasks.get(taskId);
    if (taskInfo) {
      taskInfo.task.reject(new Error('Task timeout'));
      this.runningTasks.delete(taskId);
      
      // é‡Šæ”¾Worker
      taskInfo.worker.busy = false;
      taskInfo.worker.taskCount--;
    }
  }

  updateWorkerStats(workerId, duration, success) {
    const stats = this.workerStats.get(workerId);
    if (stats) {
      stats.tasksCompleted++;
      stats.averageTaskTime = (stats.averageTaskTime + duration) / 2;
      
      if (!success) {
        stats.errorRate = (stats.errorRate * 0.9) + 0.1; // æŒ‡æ•°ç§»åŠ¨å¹³å‡
      } else {
        stats.errorRate = stats.errorRate * 0.95;
      }
    }
  }

  checkWorkerRecycling(workerInfo) {
    // å¦‚æœWorkeræ‰§è¡Œçš„ä»»åŠ¡æ•°è¿‡å¤šï¼Œå›æ”¶å®ƒ
    if (workerInfo.totalTasks &gt;= this.maxTasksPerWorker) {
      this.removeWorker(workerInfo);
      
      // å¦‚æœæ± ä¸­Workeræ•°é‡å°‘äºæœ€å°å€¼ï¼Œåˆ›å»ºæ–°çš„
      if (this.workers.length &lt; this.minWorkers) {
        this.createWorker();
      }
    }
  }

  setIdleTimer(workerInfo) {
    if (this.workers.length &gt; this.minWorkers) {
      workerInfo.idleTimer = setTimeout(() =&gt; {
        if (!workerInfo.busy) {
          this.removeWorker(workerInfo);
        }
      }, this.idleTimeout);
    }
  }

  removeWorker(workerInfo) {
    const index = this.workers.indexOf(workerInfo);
    if (index &gt; -1) {
      this.workers.splice(index, 1);
      this.workerStats.delete(workerInfo.id);
      
      if (workerInfo.idleTimer) {
        clearTimeout(workerInfo.idleTimer);
      }
      
      workerInfo.worker.terminate();
    }
  }

  // è·å–æ± çŠ¶æ€
  getPoolStats() {
    return {
      totalWorkers: this.workers.length,
      busyWorkers: this.workers.filter(w =&gt; w.busy).length,
      queuedTasks: this.taskQueue.length,
      runningTasks: this.runningTasks.size,
      workerStats: Object.fromEntries(this.workerStats)
    };
  }

  // ä¼˜é›…å…³é—­
  async shutdown() {
    // ç­‰å¾…æ‰€æœ‰è¿è¡Œä¸­çš„ä»»åŠ¡å®Œæˆ
    while (this.runningTasks.size &gt; 0) {
      await new Promise(resolve =&gt; setTimeout(resolve, 100));
    }

    // ç»ˆæ­¢æ‰€æœ‰Worker
    for (const workerInfo of this.workers) {
      if (workerInfo.idleTimer) {
        clearTimeout(workerInfo.idleTimer);
      }
      workerInfo.worker.terminate();
    }

    this.workers.length = 0;
    this.workerStats.clear();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const workerPool = new AdvancedWorkerPool({
  workerScript: './advanced-worker.js',
  workerType: 'module',
  maxWorkers: 8,
  minWorkers: 2,
  idleTimeout: 30000,
  maxTasksPerWorker: 50
});

// æ‰§è¡Œè®¡ç®—å¯†é›†å‹ä»»åŠ¡
async function runHeavyComputations() {
  const tasks = Array.from({ length: 20 }, (_, i) =&gt; ({
    operation: 'fibonacci',
    input: 40 + i,
    id: i
  }));

  try {
    const results = await Promise.all(
      tasks.map(task =&gt; 
        workerPool.executeTask(task, { 
          timeout: 10000, 
          priority: task.id &lt; 5 ? 'high' : 'normal' 
        })
      )
    );

    console.log('All computations completed:', results);
    console.log('Pool stats:', workerPool.getPoolStats());
  } catch (error) {
    console.error('Computation failed:', error);
  }
}

runHeavyComputations();
</code></pre>
<h3 id="service-workerä¸æ¨¡å—"><a class="header" href="#service-workerä¸æ¨¡å—">Service Workerä¸æ¨¡å—</a></h3>
<pre><code class="language-javascript">// service-worker.js - Service Workerä¸­çš„æ¨¡å—ä½¿ç”¨
import { CacheManager } from './cache-manager.js';
import { NotificationManager } from './notification-manager.js';
import { SyncManager } from './sync-manager.js';

const cacheManager = new CacheManager();
const notificationManager = new NotificationManager();
const syncManager = new SyncManager();

// Service Workerå®‰è£…
self.addEventListener('install', async (event) =&gt; {
  console.log('Service Worker installing...');
  
  event.waitUntil(
    cacheManager.precacheAssets([
      '/',
      '/app.js',
      '/styles.css',
      '/offline.html'
    ])
  );
});

// Service Workeræ¿€æ´»
self.addEventListener('activate', async (event) =&gt; {
  console.log('Service Worker activating...');
  
  event.waitUntil(
    Promise.all([
      cacheManager.cleanupOldCaches(),
      self.clients.claim()
    ])
  );
});

// ç½‘ç»œè¯·æ±‚æ‹¦æˆª
self.addEventListener('fetch', (event) =&gt; {
  event.respondWith(handleFetch(event.request));
});

// åå°åŒæ­¥
self.addEventListener('sync', (event) =&gt; {
  if (event.tag === 'background-sync') {
    event.waitUntil(syncManager.handleBackgroundSync());
  }
});

// æ¨é€é€šçŸ¥
self.addEventListener('push', (event) =&gt; {
  const data = event.data ? event.data.json() : {};
  event.waitUntil(notificationManager.showNotification(data));
});

async function handleFetch(request) {
  // åŠ¨æ€å¯¼å…¥å¤„ç†æ¨¡å—
  const { default: fetchHandler } = await import('./fetch-handlers.js');
  return fetchHandler.handle(request, cacheManager);
}

// cache-manager.js - ç¼“å­˜ç®¡ç†æ¨¡å—
export class CacheManager {
  constructor() {
    this.cacheName = 'app-cache-v1';
    this.dynamicCacheName = 'dynamic-cache-v1';
  }

  async precacheAssets(urls) {
    const cache = await caches.open(this.cacheName);
    return cache.addAll(urls);
  }

  async getCachedResponse(request) {
    const cache = await caches.open(this.cacheName);
    const response = await cache.match(request);
    
    if (response) {
      return response;
    }

    // å°è¯•åŠ¨æ€ç¼“å­˜
    const dynamicCache = await caches.open(this.dynamicCacheName);
    return dynamicCache.match(request);
  }

  async cacheResponse(request, response) {
    const cache = await caches.open(this.dynamicCacheName);
    return cache.put(request, response.clone());
  }

  async cleanupOldCaches() {
    const cacheNames = await caches.keys();
    const oldCaches = cacheNames.filter(name =&gt; 
      name !== this.cacheName &amp;&amp; name !== this.dynamicCacheName
    );

    return Promise.all(
      oldCaches.map(name =&gt; caches.delete(name))
    );
  }
}
</code></pre>
<p>é€šè¿‡è¿™äº›æŠ€æœ¯ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨Web Workersçš„å¤šçº¿ç¨‹èƒ½åŠ›ï¼ŒåŒæ—¶äº«å—ESæ¨¡å—ç³»ç»Ÿå¸¦æ¥çš„ä»£ç ç»„ç»‡å’Œå¤ç”¨ä¼˜åŠ¿ï¼Œæ„å»ºé«˜æ€§èƒ½çš„Webåº”ç”¨ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="wasmæ¨¡å—é›†æˆ"><a class="header" href="#wasmæ¨¡å—é›†æˆ">WASMæ¨¡å—é›†æˆ</a></h1>
<p>WebAssembly (WASM) æ˜¯ä¸€ç§äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ï¼Œå¯ä»¥åœ¨ç°ä»£æµè§ˆå™¨ä¸­ä»¥æ¥è¿‘åŸç”Ÿçš„é€Ÿåº¦è¿è¡Œã€‚æœ¬ç« å°†æ¢è®¨å¦‚ä½•å°†WASMæ¨¡å—ä¸JavaScriptæ¨¡å—ç³»ç»Ÿé›†æˆã€‚</p>
<h2 id="wasmæ¨¡å—åŸºç¡€"><a class="header" href="#wasmæ¨¡å—åŸºç¡€">WASMæ¨¡å—åŸºç¡€</a></h2>
<h3 id="wasmæ¨¡å—åŠ è½½"><a class="header" href="#wasmæ¨¡å—åŠ è½½">WASMæ¨¡å—åŠ è½½</a></h3>
<pre><code class="language-javascript">// wasm-loader.js - WASMæ¨¡å—åŠ è½½å™¨
class WasmModuleLoader {
  constructor() {
    this.moduleCache = new Map();
    this.loadingPromises = new Map();
  }

  // åŸºç¡€WASMæ¨¡å—åŠ è½½
  async loadWasmModule(url, importObject = {}) {
    if (this.moduleCache.has(url)) {
      return this.moduleCache.get(url);
    }

    if (this.loadingPromises.has(url)) {
      return this.loadingPromises.get(url);
    }

    const loadingPromise = this._loadModule(url, importObject);
    this.loadingPromises.set(url, loadingPromise);

    try {
      const module = await loadingPromise;
      this.moduleCache.set(url, module);
      this.loadingPromises.delete(url);
      return module;
    } catch (error) {
      this.loadingPromises.delete(url);
      throw error;
    }
  }

  async _loadModule(url, importObject) {
    // è·å–WASMå­—èŠ‚ç 
    const response = await fetch(url);
    const bytes = await response.arrayBuffer();

    // ç¼–è¯‘å’Œå®ä¾‹åŒ–WASMæ¨¡å—
    const wasmModule = await WebAssembly.compile(bytes);
    const wasmInstance = await WebAssembly.instantiate(wasmModule, importObject);

    return {
      module: wasmModule,
      instance: wasmInstance,
      exports: wasmInstance.exports
    };
  }

  // æµå¼åŠ è½½ï¼ˆé€‚ç”¨äºå¤§å‹WASMæ¨¡å—ï¼‰
  async loadWasmStreamingly(url, importObject = {}) {
    const response = await fetch(url);
    
    if (!WebAssembly.compileStreaming) {
      // é™çº§åˆ°æ™®é€šåŠ è½½
      return this.loadWasmModule(url, importObject);
    }

    try {
      const wasmModule = await WebAssembly.compileStreaming(response.clone());
      const wasmInstance = await WebAssembly.instantiate(wasmModule, importObject);

      return {
        module: wasmModule,
        instance: wasmInstance,
        exports: wasmInstance.exports
      };
    } catch (error) {
      console.warn('Streaming compilation failed, falling back to regular loading:', error);
      return this.loadWasmModule(url, importObject);
    }
  }

  // é¢„ç¼–è¯‘WASMæ¨¡å—
  async precompileWasm(url) {
    try {
      const response = await fetch(url);
      const wasmModule = await WebAssembly.compileStreaming(response);
      
      // å°†é¢„ç¼–è¯‘çš„æ¨¡å—å­˜å‚¨åœ¨ç¼“å­˜ä¸­
      this.moduleCache.set(url, { module: wasmModule, precompiled: true });
      return wasmModule;
    } catch (error) {
      console.error(`Failed to precompile WASM module ${url}:`, error);
      throw error;
    }
  }

  // ä»é¢„ç¼–è¯‘æ¨¡å—åˆ›å»ºå®ä¾‹
  async instantiatePrecompiled(url, importObject = {}) {
    const cached = this.moduleCache.get(url);
    
    if (!cached || !cached.precompiled) {
      throw new Error(`No precompiled module found for ${url}`);
    }

    const wasmInstance = await WebAssembly.instantiate(cached.module, importObject);
    
    return {
      module: cached.module,
      instance: wasmInstance,
      exports: wasmInstance.exports
    };
  }
}

// å…¨å±€WASMåŠ è½½å™¨å®ä¾‹
const wasmLoader = new WasmModuleLoader();

// ä½¿ç”¨ç¤ºä¾‹
async function loadMathWasm() {
  try {
    // å®šä¹‰å¯¼å…¥å¯¹è±¡
    const importObject = {
      env: {
        console_log: (value) =&gt; console.log('WASM Log:', value),
        Math_pow: Math.pow,
        Date_now: Date.now
      }
    };

    const wasmModule = await wasmLoader.loadWasmStreamingly('./math.wasm', importObject);
    
    // ä½¿ç”¨WASMå¯¼å‡ºçš„å‡½æ•°
    const result = wasmModule.exports.fibonacci(40);
    console.log('Fibonacci result:', result);
    
    return wasmModule;
  } catch (error) {
    console.error('Failed to load math WASM module:', error);
  }
}
</code></pre>
<h3 id="esæ¨¡å—ä¸wasmé›†æˆ"><a class="header" href="#esæ¨¡å—ä¸wasmé›†æˆ">ESæ¨¡å—ä¸WASMé›†æˆ</a></h3>
<pre><code class="language-javascript">// math-wasm.js - WASMæ¨¡å—çš„ESæ¨¡å—å°è£…
import wasmUrl from './math.wasm?url'; // Vite/Webpackçš„WASMå¯¼å…¥

class MathWasm {
  constructor() {
    this.wasmModule = null;
    this.loaded = false;
  }

  async initialize() {
    if (this.loaded) return;

    try {
      const importObject = {
        env: {
          memory: new WebAssembly.Memory({ initial: 256 }),
          console_log: this._consoleLog.bind(this),
          abort: this._abort.bind(this)
        }
      };

      // ä½¿ç”¨ESæ¨¡å—å¯¼å…¥WASM
      const wasmModule = await import('./math.wasm');
      
      // æˆ–è€…ä½¿ç”¨fetchåŠ è½½
      // const response = await fetch(wasmUrl);
      // const wasmModule = await WebAssembly.instantiateStreaming(response, importObject);

      this.wasmModule = wasmModule;
      this.loaded = true;

      console.log('Math WASM module loaded successfully');
    } catch (error) {
      console.error('Failed to initialize Math WASM:', error);
      throw error;
    }
  }

  // åŒ…è£…WASMå‡½æ•°ä¸ºJSæ–¹æ³•
  fibonacci(n) {
    this._ensureLoaded();
    return this.wasmModule.exports.fibonacci(n);
  }

  factorial(n) {
    this._ensureLoaded();
    return this.wasmModule.exports.factorial(n);
  }

  isPrime(n) {
    this._ensureLoaded();
    return Boolean(this.wasmModule.exports.is_prime(n));
  }

  // å¤„ç†å¤æ‚æ•°æ®ç±»å‹
  processArray(arr) {
    this._ensureLoaded();
    
    const memory = this.wasmModule.exports.memory;
    const malloc = this.wasmModule.exports.malloc;
    const free = this.wasmModule.exports.free;
    const processArray = this.wasmModule.exports.process_array;

    // åˆ†é…å†…å­˜
    const inputSize = arr.length * 4; // å‡è®¾æ˜¯32ä½æ•´æ•°
    const inputPtr = malloc(inputSize);
    
    try {
      // å¤åˆ¶æ•°æ®åˆ°WASMå†…å­˜
      const inputView = new Int32Array(memory.buffer, inputPtr, arr.length);
      inputView.set(arr);

      // è°ƒç”¨WASMå‡½æ•°
      const resultPtr = processArray(inputPtr, arr.length);
      
      // è¯»å–ç»“æœ
      const resultView = new Int32Array(memory.buffer, resultPtr, arr.length);
      const result = Array.from(resultView);

      // é‡Šæ”¾å†…å­˜
      free(inputPtr);
      free(resultPtr);

      return result;
    } catch (error) {
      free(inputPtr);
      throw error;
    }
  }

  _ensureLoaded() {
    if (!this.loaded) {
      throw new Error('WASM module not loaded. Call initialize() first.');
    }
  }

  _consoleLog(value) {
    console.log('WASM:', value);
  }

  _abort() {
    throw new Error('WASM execution aborted');
  }
}

// å¯¼å‡ºå•ä¾‹å®ä¾‹
export const mathWasm = new MathWasm();

// ä¹Ÿå¯ä»¥å¯¼å‡ºç±»ä¾›å¤šå®ä¾‹ä½¿ç”¨
export { MathWasm };

// é»˜è®¤å¯¼å‡ºåˆå§‹åŒ–å‡½æ•°
export default async function initMathWasm() {
  await mathWasm.initialize();
  return mathWasm;
}
</code></pre>
<h2 id="é«˜çº§wasmé›†æˆæ¨¡å¼"><a class="header" href="#é«˜çº§wasmé›†æˆæ¨¡å¼">é«˜çº§WASMé›†æˆæ¨¡å¼</a></h2>
<h3 id="wasmæ¨¡å—å·¥å‚"><a class="header" href="#wasmæ¨¡å—å·¥å‚">WASMæ¨¡å—å·¥å‚</a></h3>
<pre><code class="language-javascript">// wasm-module-factory.js - WASMæ¨¡å—å·¥å‚
class WasmModuleFactory {
  constructor() {
    this.modules = new Map();
    this.templates = new Map();
  }

  // æ³¨å†ŒWASMæ¨¡å—æ¨¡æ¿
  registerTemplate(name, config) {
    this.templates.set(name, {
      name,
      url: config.url,
      importObject: config.importObject || {},
      initFunction: config.initFunction,
      exportMappings: config.exportMappings || {},
      memoryConfig: config.memoryConfig
    });
  }

  // åˆ›å»ºWASMæ¨¡å—å®ä¾‹
  async createModule(templateName, instanceId = null) {
    const template = this.templates.get(templateName);
    if (!template) {
      throw new Error(`WASM template ${templateName} not found`);
    }

    const id = instanceId || `${templateName}_${Date.now()}`;
    
    if (this.modules.has(id)) {
      return this.modules.get(id);
    }

    try {
      const wasmInstance = await this._instantiateFromTemplate(template);
      const moduleWrapper = this._createModuleWrapper(wasmInstance, template);
      
      this.modules.set(id, moduleWrapper);
      return moduleWrapper;
    } catch (error) {
      console.error(`Failed to create WASM module ${templateName}:`, error);
      throw error;
    }
  }

  async _instantiateFromTemplate(template) {
    // å‡†å¤‡å¯¼å…¥å¯¹è±¡
    const importObject = this._prepareImportObject(template);
    
    // åŠ è½½å’Œå®ä¾‹åŒ–WASM
    const response = await fetch(template.url);
    const wasmModule = await WebAssembly.instantiateStreaming(response, importObject);
    
    return wasmModule;
  }

  _prepareImportObject(template) {
    const importObject = { ...template.importObject };
    
    // è®¾ç½®å†…å­˜
    if (template.memoryConfig) {
      importObject.env = importObject.env || {};
      importObject.env.memory = new WebAssembly.Memory(template.memoryConfig);
    }

    // æ·»åŠ æ ‡å‡†ç¯å¢ƒå‡½æ•°
    importObject.env = importObject.env || {};
    Object.assign(importObject.env, {
      console_log: console.log,
      console_error: console.error,
      Date_now: Date.now,
      Math_random: Math.random,
      Math_floor: Math.floor,
      Math_ceil: Math.ceil,
      performance_now: performance.now.bind(performance)
    });

    return importObject;
  }

  _createModuleWrapper(wasmInstance, template) {
    const wrapper = {
      instance: wasmInstance.instance,
      exports: wasmInstance.instance.exports,
      memory: wasmInstance.instance.exports.memory,
      
      // åŸå§‹å‡½æ•°è°ƒç”¨
      call: (funcName, ...args) =&gt; {
        const func = wasmInstance.instance.exports[funcName];
        if (!func) {
          throw new Error(`Function ${funcName} not found in WASM module`);
        }
        return func(...args);
      },

      // å†…å­˜æ“ä½œè¾…åŠ©å‡½æ•°
      memory: {
        read: (ptr, length, type = 'uint8') =&gt; {
          const memory = wasmInstance.instance.exports.memory;
          const TypedArray = this._getTypedArray(type);
          return new TypedArray(memory.buffer, ptr, length);
        },

        write: (ptr, data, type = 'uint8') =&gt; {
          const memory = wasmInstance.instance.exports.memory;
          const TypedArray = this._getTypedArray(type);
          const view = new TypedArray(memory.buffer, ptr, data.length);
          view.set(data);
        },

        allocate: (size) =&gt; {
          const malloc = wasmInstance.instance.exports.malloc;
          if (!malloc) {
            throw new Error('malloc function not found in WASM module');
          }
          return malloc(size);
        },

        free: (ptr) =&gt; {
          const free = wasmInstance.instance.exports.free;
          if (!free) {
            throw new Error('free function not found in WASM module');
          }
          free(ptr);
        }
      }
    };

    // æ·»åŠ æ˜ å°„çš„å¯¼å‡ºå‡½æ•°
    for (const [jsName, wasmName] of Object.entries(template.exportMappings)) {
      const wasmFunc = wasmInstance.instance.exports[wasmName];
      if (wasmFunc) {
        wrapper[jsName] = wasmFunc.bind(wasmInstance.instance.exports);
      }
    }

    // è°ƒç”¨åˆå§‹åŒ–å‡½æ•°
    if (template.initFunction &amp;&amp; typeof template.initFunction === 'function') {
      template.initFunction(wrapper);
    }

    return wrapper;
  }

  _getTypedArray(type) {
    const typeMap = {
      'int8': Int8Array,
      'uint8': Uint8Array,
      'int16': Int16Array,
      'uint16': Uint16Array,
      'int32': Int32Array,
      'uint32': Uint32Array,
      'float32': Float32Array,
      'float64': Float64Array
    };

    return typeMap[type] || Uint8Array;
  }

  // é”€æ¯æ¨¡å—å®ä¾‹
  destroyModule(instanceId) {
    const module = this.modules.get(instanceId);
    if (module &amp;&amp; module.memory &amp;&amp; module.memory.free) {
      // æ¸…ç†åˆ†é…çš„å†…å­˜
      // è¿™é‡Œéœ€è¦æ ¹æ®å…·ä½“çš„WASMæ¨¡å—å®ç°æ¥æ¸…ç†
    }
    
    this.modules.delete(instanceId);
  }

  // è·å–æ¨¡å—ç»Ÿè®¡ä¿¡æ¯
  getModuleStats() {
    return {
      templateCount: this.templates.size,
      instanceCount: this.modules.size,
      templates: Array.from(this.templates.keys()),
      instances: Array.from(this.modules.keys())
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const wasmFactory = new WasmModuleFactory();

// æ³¨å†Œå›¾åƒå¤„ç†WASMæ¨¡å—æ¨¡æ¿
wasmFactory.registerTemplate('imageProcessor', {
  url: './image-processor.wasm',
  memoryConfig: { initial: 1024 }, // 64MB
  exportMappings: {
    blur: 'image_blur',
    sharpen: 'image_sharpen',
    resize: 'image_resize'
  },
  initFunction: (wrapper) =&gt; {
    // æ¨¡å—åˆå§‹åŒ–é€»è¾‘
    console.log('Image processor WASM module initialized');
    
    // æ·»åŠ é«˜çº§æ–¹æ³•
    wrapper.processImage = async (imageData, operations) =&gt; {
      const ptr = wrapper.memory.allocate(imageData.length);
      
      try {
        wrapper.memory.write(ptr, imageData, 'uint8');
        
        for (const op of operations) {
          switch (op.type) {
            case 'blur':
              wrapper.blur(ptr, imageData.length, op.radius);
              break;
            case 'sharpen':
              wrapper.sharpen(ptr, imageData.length, op.amount);
              break;
          }
        }
        
        return wrapper.memory.read(ptr, imageData.length, 'uint8');
      } finally {
        wrapper.memory.free(ptr);
      }
    };
  }
});

// åˆ›å»ºå’Œä½¿ç”¨æ¨¡å—å®ä¾‹
async function processImageWithWasm(imageData) {
  const processor = await wasmFactory.createModule('imageProcessor', 'main-processor');
  
  const result = await processor.processImage(imageData, [
    { type: 'blur', radius: 5 },
    { type: 'sharpen', amount: 0.8 }
  ]);
  
  return result;
}
</code></pre>
<h3 id="workerä¸­çš„wasm"><a class="header" href="#workerä¸­çš„wasm">Workerä¸­çš„WASM</a></h3>
<pre><code class="language-javascript">// wasm-worker.js - åœ¨Workerä¸­ä½¿ç”¨WASM
import { WasmModuleFactory } from './wasm-module-factory.js';

class WasmWorker {
  constructor() {
    this.wasmFactory = new WasmModuleFactory();
    this.modules = new Map();
    this.setupWorker();
  }

  setupWorker() {
    // æ³¨å†ŒWASMæ¨¡å—æ¨¡æ¿
    this.wasmFactory.registerTemplate('mathProcessor', {
      url: './math-processor.wasm',
      memoryConfig: { initial: 256 },
      exportMappings: {
        matrixMultiply: 'matrix_multiply',
        fft: 'fast_fourier_transform',
        solve: 'linear_solve'
      }
    });

    // è®¾ç½®æ¶ˆæ¯å¤„ç†
    self.onmessage = async (event) =&gt; {
      await this.handleMessage(event);
    };
  }

  async handleMessage(event) {
    const { id, type, data } = event.data;

    try {
      let result;

      switch (type) {
        case 'LOAD_WASM_MODULE':
          result = await this.loadWasmModule(data.templateName, data.instanceId);
          break;

        case 'WASM_CALL':
          result = await this.callWasmFunction(data.instanceId, data.funcName, data.args);
          break;

        case 'WASM_PROCESS_ARRAY':
          result = await this.processArrayWithWasm(data.instanceId, data.operation, data.array);
          break;

        case 'DESTROY_WASM_MODULE':
          result = await this.destroyWasmModule(data.instanceId);
          break;

        default:
          throw new Error(`Unknown message type: ${type}`);
      }

      self.postMessage({
        id,
        type: 'SUCCESS',
        data: result
      });

    } catch (error) {
      self.postMessage({
        id,
        type: 'ERROR',
        error: {
          message: error.message,
          stack: error.stack
        }
      });
    }
  }

  async loadWasmModule(templateName, instanceId) {
    const module = await this.wasmFactory.createModule(templateName, instanceId);
    this.modules.set(instanceId, module);
    return { loaded: true, instanceId };
  }

  async callWasmFunction(instanceId, funcName, args) {
    const module = this.modules.get(instanceId);
    if (!module) {
      throw new Error(`WASM module ${instanceId} not found`);
    }

    return module.call(funcName, ...args);
  }

  async processArrayWithWasm(instanceId, operation, array) {
    const module = this.modules.get(instanceId);
    if (!module) {
      throw new Error(`WASM module ${instanceId} not found`);
    }

    // åˆ†é…å†…å­˜å¹¶å¤åˆ¶æ•°æ®
    const size = array.length * 4; // å‡è®¾32ä½æ•°å­—
    const ptr = module.memory.allocate(size);

    try {
      module.memory.write(ptr, array, 'float32');

      // è°ƒç”¨WASMå¤„ç†å‡½æ•°
      let resultPtr;
      switch (operation) {
        case 'fft':
          resultPtr = module.fft(ptr, array.length);
          break;
        case 'matrixMultiply':
          // éœ€è¦é¢å¤–çš„çŸ©é˜µç»´åº¦å‚æ•°
          resultPtr = module.matrixMultiply(ptr, Math.sqrt(array.length));
          break;
        default:
          throw new Error(`Unknown operation: ${operation}`);
      }

      // è¯»å–ç»“æœ
      const result = Array.from(module.memory.read(resultPtr, array.length, 'float32'));
      
      // æ¸…ç†å†…å­˜
      module.memory.free(resultPtr);
      
      return result;
    } finally {
      module.memory.free(ptr);
    }
  }

  async destroyWasmModule(instanceId) {
    this.wasmFactory.destroyModule(instanceId);
    this.modules.delete(instanceId);
    return { destroyed: true, instanceId };
  }
}

// åˆå§‹åŒ–Worker
const wasmWorker = new WasmWorker();

// ä¸»çº¿ç¨‹ä½¿ç”¨ç¤ºä¾‹
// wasm-worker-client.js
class WasmWorkerClient {
  constructor() {
    this.worker = new Worker('./wasm-worker.js', { type: 'module' });
    this.taskId = 0;
    this.pendingTasks = new Map();
    this.setupWorker();
  }

  setupWorker() {
    this.worker.onmessage = (event) =&gt; {
      const { id, type, data, error } = event.data;
      const task = this.pendingTasks.get(id);

      if (task) {
        this.pendingTasks.delete(id);
        
        if (type === 'SUCCESS') {
          task.resolve(data);
        } else {
          task.reject(new Error(error.message));
        }
      }
    };
  }

  async sendTask(type, data) {
    return new Promise((resolve, reject) =&gt; {
      const id = ++this.taskId;
      
      this.pendingTasks.set(id, { resolve, reject });
      
      this.worker.postMessage({ id, type, data });
      
      // è®¾ç½®è¶…æ—¶
      setTimeout(() =&gt; {
        if (this.pendingTasks.has(id)) {
          this.pendingTasks.delete(id);
          reject(new Error('Task timeout'));
        }
      }, 30000);
    });
  }

  async loadWasmModule(templateName, instanceId) {
    return this.sendTask('LOAD_WASM_MODULE', { templateName, instanceId });
  }

  async callWasmFunction(instanceId, funcName, args) {
    return this.sendTask('WASM_CALL', { instanceId, funcName, args });
  }

  async processArray(instanceId, operation, array) {
    return this.sendTask('WASM_PROCESS_ARRAY', { instanceId, operation, array });
  }

  terminate() {
    this.worker.terminate();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const wasmClient = new WasmWorkerClient();

async function performHeavyMathComputation() {
  try {
    // åŠ è½½WASMæ¨¡å—
    await wasmClient.loadWasmModule('mathProcessor', 'math-1');
    
    // ç”Ÿæˆæµ‹è¯•æ•°æ®
    const largeArray = new Float32Array(1024 * 1024);
    for (let i = 0; i &lt; largeArray.length; i++) {
      largeArray[i] = Math.random();
    }
    
    // åœ¨Workerä¸­æ‰§è¡ŒFFT
    const result = await wasmClient.processArray('math-1', 'fft', largeArray);
    
    console.log('FFT computation completed:', result.length);
    return result;
  } catch (error) {
    console.error('Computation failed:', error);
  }
}
</code></pre>
<h3 id="wasmä¸ç°ä»£æ„å»ºå·¥å…·é›†æˆ"><a class="header" href="#wasmä¸ç°ä»£æ„å»ºå·¥å…·é›†æˆ">WASMä¸ç°ä»£æ„å»ºå·¥å…·é›†æˆ</a></h3>
<pre><code class="language-javascript">// vite.config.js - Viteä¸­çš„WASMé…ç½®
import { defineConfig } from 'vite';

export default defineConfig({
  // WASMä¼˜åŒ–é…ç½®
  optimizeDeps: {
    exclude: ['*.wasm']
  },
  
  // æœåŠ¡å™¨é…ç½®
  server: {
    fs: {
      allow: ['..'] // å…è®¸è®¿é—®ä¸Šçº§ç›®å½•çš„WASMæ–‡ä»¶
    }
  },
  
  // æ„å»ºé…ç½®
  build: {
    target: 'esnext', // ç¡®ä¿æ”¯æŒé¡¶çº§await
    rollupOptions: {
      external: ['*.wasm'],
      output: {
        // WASMæ–‡ä»¶å¤„ç†
        assetFileNames: (assetInfo) =&gt; {
          if (assetInfo.name.endsWith('.wasm')) {
            return 'wasm/[name].[hash][extname]';
          }
          return 'assets/[name].[hash][extname]';
        }
      }
    }
  },
  
  // æ’ä»¶é…ç½®
  plugins: [
    // è‡ªå®šä¹‰WASMæ’ä»¶
    {
      name: 'wasm-plugin',
      configureServer(server) {
        server.middlewares.use('/wasm', (req, res, next) =&gt; {
          res.setHeader('Cross-Origin-Embedder-Policy', 'require-corp');
          res.setHeader('Cross-Origin-Opener-Policy', 'same-origin');
          next();
        });
      },
      load(id) {
        if (id.endsWith('.wasm')) {
          // è¿”å›WASMæ¨¡å—çš„ESæ¨¡å—åŒ…è£…
          return `
            const wasmUrl = new URL('${id}', import.meta.url).href;
            let wasmModule;
            
            export default async function(importObject = {}) {
              if (!wasmModule) {
                const response = await fetch(wasmUrl);
                wasmModule = await WebAssembly.instantiateStreaming(response, importObject);
              }
              return wasmModule;
            }
            
            export { wasmUrl };
          `;
        }
      }
    }
  ]
});

// webpack.config.js - Webpackä¸­çš„WASMé…ç½®
module.exports = {
  experiments: {
    asyncWebAssembly: true,
    syncWebAssembly: true
  },
  
  module: {
    rules: [
      {
        test: /\.wasm$/,
        type: 'webassembly/async'
      }
    ]
  },
  
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        wasm: {
          test: /\.wasm$/,
          name: 'wasm-modules',
          chunks: 'all'
        }
      }
    }
  }
};

// ç°ä»£WASMæ¨¡å—ä½¿ç”¨ç¤ºä¾‹
// image-processor.js
import wasmInit, { wasmUrl } from './image-processor.wasm';
import { WasmModuleCache } from './wasm-cache.js';

const wasmCache = new WasmModuleCache();

export class ImageProcessor {
  constructor() {
    this.wasmModule = null;
    this.initialized = false;
  }

  async initialize() {
    if (this.initialized) return;

    try {
      // å°è¯•ä»ç¼“å­˜è·å–
      this.wasmModule = await wasmCache.getOrLoad('image-processor', async () =&gt; {
        const importObject = {
          env: {
            memory: new WebAssembly.Memory({ initial: 1024 }),
            console_log: console.log
          }
        };
        
        return await wasmInit(importObject);
      });

      this.initialized = true;
    } catch (error) {
      console.error('Failed to initialize ImageProcessor WASM:', error);
      throw error;
    }
  }

  async processImage(imageData, filters = []) {
    await this.initialize();
    
    const { memory, process_image, malloc, free } = this.wasmModule.instance.exports;
    
    // åˆ†é…è¾“å…¥å†…å­˜
    const inputSize = imageData.data.length;
    const inputPtr = malloc(inputSize);
    
    try {
      // å¤åˆ¶å›¾åƒæ•°æ®åˆ°WASMå†…å­˜
      const inputView = new Uint8Array(memory.buffer, inputPtr, inputSize);
      inputView.set(imageData.data);
      
      // å¤„ç†æ¯ä¸ªæ»¤é•œ
      for (const filter of filters) {
        const filterConfig = this._encodeFilter(filter);
        process_image(inputPtr, imageData.width, imageData.height, filterConfig);
      }
      
      // è¯»å–å¤„ç†åçš„æ•°æ®
      const outputData = new Uint8Array(inputSize);
      outputData.set(inputView);
      
      return new ImageData(
        new Uint8ClampedArray(outputData),
        imageData.width,
        imageData.height
      );
      
    } finally {
      free(inputPtr);
    }
  }

  _encodeFilter(filter) {
    // å°†JavaScriptæ»¤é•œé…ç½®ç¼–ç ä¸ºWASMå¯ç†è§£çš„æ ¼å¼
    const filterTypes = {
      'blur': 1,
      'sharpen': 2,
      'brightness': 3,
      'contrast': 4
    };
    
    return (filterTypes[filter.type] || 0) | 
           ((filter.intensity || 1.0) * 255) &lt;&lt; 8;
  }
}

// WASMç¼“å­˜ç®¡ç†
class WasmModuleCache {
  constructor() {
    this.cache = new Map();
  }

  async getOrLoad(key, loaderFn) {
    if (this.cache.has(key)) {
      return this.cache.get(key);
    }

    const module = await loaderFn();
    this.cache.set(key, module);
    return module;
  }

  clear() {
    this.cache.clear();
  }
}
</code></pre>
<p>é€šè¿‡è¿™äº›æŠ€æœ¯ï¼Œå¯ä»¥å°†é«˜æ€§èƒ½çš„WASMæ¨¡å—æ— ç¼é›†æˆåˆ°JavaScriptæ¨¡å—åŒ–åº”ç”¨ä¸­ï¼Œå®ç°æ¥è¿‘åŸç”Ÿæ€§èƒ½çš„è®¡ç®—å¯†é›†å‹åŠŸèƒ½ï¼ŒåŒæ—¶ä¿æŒè‰¯å¥½çš„å¼€å‘ä½“éªŒå’Œä»£ç ç»„ç»‡ã€‚</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ„å»ºä¸€ä¸ªæ¨¡å—åŒ–åº“"><a class="header" href="#æ„å»ºä¸€ä¸ªæ¨¡å—åŒ–åº“">æ„å»ºä¸€ä¸ªæ¨¡å—åŒ–åº“</a></h1>
<p>æœ¬ç« å°†é€šè¿‡å®é™…æ¡ˆä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªç°ä»£åŒ–çš„JavaScriptæ¨¡å—åº“ï¼Œæ¶µç›–é¡¹ç›®æ¶æ„ã€æ¨¡å—è®¾è®¡ã€æ„å»ºé…ç½®å’Œå‘å¸ƒæµç¨‹ã€‚</p>
<h2 id="é¡¹ç›®éœ€æ±‚åˆ†æ"><a class="header" href="#é¡¹ç›®éœ€æ±‚åˆ†æ">é¡¹ç›®éœ€æ±‚åˆ†æ</a></h2>
<p>æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªåä¸º<code>@utils/toolkit</code>çš„å·¥å…·åº“ï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>å­—ç¬¦ä¸²å¤„ç†å·¥å…·</li>
<li>æ•°ç»„æ“ä½œå·¥å…·</li>
<li>æ—¥æœŸæ ¼å¼åŒ–å·¥å…·</li>
<li>å¼‚æ­¥å·¥å…·å‡½æ•°</li>
<li>æ•°æ®éªŒè¯å·¥å…·</li>
</ul>
<h3 id="è®¾è®¡ç›®æ ‡"><a class="header" href="#è®¾è®¡ç›®æ ‡">è®¾è®¡ç›®æ ‡</a></h3>
<ol>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong>ï¼šæ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œæ”¯æŒæŒ‰éœ€å¯¼å…¥</li>
<li><strong>å¤šæ ¼å¼æ”¯æŒ</strong>ï¼šåŒæ—¶æ”¯æŒESæ¨¡å—å’ŒCommonJS</li>
<li><strong>TypeScriptæ”¯æŒ</strong>ï¼šæä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰</li>
<li><strong>Tree Shakingå‹å¥½</strong>ï¼šæ”¯æŒæ„å»ºå·¥å…·çš„æ­»ä»£ç æ¶ˆé™¤</li>
<li><strong>ä½“ç§¯ä¼˜åŒ–</strong>ï¼šæœ€å°åŒ–æ‰“åŒ…ä½“ç§¯</li>
</ol>
<h2 id="é¡¹ç›®ç»“æ„è®¾è®¡"><a class="header" href="#é¡¹ç›®ç»“æ„è®¾è®¡">é¡¹ç›®ç»“æ„è®¾è®¡</a></h2>
<pre><code>toolkit/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ string/            # å­—ç¬¦ä¸²å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ capitalize.ts
â”‚   â”‚   â”œâ”€â”€ kebabCase.ts
â”‚   â”‚   â””â”€â”€ truncate.ts
â”‚   â”œâ”€â”€ array/             # æ•°ç»„å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ chunk.ts
â”‚   â”‚   â”œâ”€â”€ unique.ts
â”‚   â”‚   â””â”€â”€ groupBy.ts
â”‚   â”œâ”€â”€ date/              # æ—¥æœŸå·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ format.ts
â”‚   â”‚   â””â”€â”€ relative.ts
â”‚   â”œâ”€â”€ async/             # å¼‚æ­¥å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ delay.ts
â”‚   â”‚   â”œâ”€â”€ timeout.ts
â”‚   â”‚   â””â”€â”€ retry.ts
â”‚   â”œâ”€â”€ validation/        # éªŒè¯å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ email.ts
â”‚   â”‚   â”œâ”€â”€ url.ts
â”‚   â”‚   â””â”€â”€ phone.ts
â”‚   â””â”€â”€ index.ts           # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ dist/                  # æ„å»ºè¾“å‡ºç›®å½•
â”œâ”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ examples/              # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ rollup.config.js
â””â”€â”€ README.md
</code></pre>
<h2 id="æ¨¡å—å®ç°"><a class="header" href="#æ¨¡å—å®ç°">æ¨¡å—å®ç°</a></h2>
<h3 id="1-å­—ç¬¦ä¸²å·¥å…·æ¨¡å—"><a class="header" href="#1-å­—ç¬¦ä¸²å·¥å…·æ¨¡å—">1. å­—ç¬¦ä¸²å·¥å…·æ¨¡å—</a></h3>
<pre><code class="language-typescript">// src/string/capitalize.ts
export function capitalize(str: string): string {
  if (!str) return str;
  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
}

// src/string/kebabCase.ts
export function kebabCase(str: string): string {
  return str
    .replace(/([a-z])([A-Z])/g, '$1-$2')
    .replace(/[\s_]+/g, '-')
    .toLowerCase();
}

// src/string/truncate.ts
export interface TruncateOptions {
  length: number;
  suffix?: string;
  separator?: string;
}

export function truncate(str: string, options: TruncateOptions): string {
  const { length, suffix = '...', separator } = options;
  
  if (str.length &lt;= length) return str;
  
  let truncated = str.slice(0, length - suffix.length);
  
  if (separator) {
    const lastIndex = truncated.lastIndexOf(separator);
    if (lastIndex &gt; 0) {
      truncated = truncated.slice(0, lastIndex);
    }
  }
  
  return truncated + suffix;
}

// src/string/index.ts
export { capitalize } from './capitalize';
export { kebabCase } from './kebabCase';
export { truncate, type TruncateOptions } from './truncate';
</code></pre>
<h3 id="2-æ•°ç»„å·¥å…·æ¨¡å—"><a class="header" href="#2-æ•°ç»„å·¥å…·æ¨¡å—">2. æ•°ç»„å·¥å…·æ¨¡å—</a></h3>
<pre><code class="language-typescript">// src/array/chunk.ts
export function chunk&lt;T&gt;(array: T[], size: number): T[][] {
  if (size &lt;= 0) throw new Error('Chunk size must be positive');
  
  const chunks: T[][] = [];
  for (let i = 0; i &lt; array.length; i += size) {
    chunks.push(array.slice(i, i + size));
  }
  return chunks;
}

// src/array/unique.ts
export function unique&lt;T&gt;(array: T[]): T[] {
  return Array.from(new Set(array));
}

export function uniqueBy&lt;T, K&gt;(array: T[], keyFn: (item: T) =&gt; K): T[] {
  const seen = new Set&lt;K&gt;();
  return array.filter(item =&gt; {
    const key = keyFn(item);
    if (seen.has(key)) return false;
    seen.add(key);
    return true;
  });
}

// src/array/groupBy.ts
export function groupBy&lt;T, K extends string | number | symbol&gt;(
  array: T[], 
  keyFn: (item: T) =&gt; K
): Record&lt;K, T[]&gt; {
  return array.reduce((groups, item) =&gt; {
    const key = keyFn(item);
    if (!groups[key]) groups[key] = [];
    groups[key].push(item);
    return groups;
  }, {} as Record&lt;K, T[]&gt;);
}

// src/array/index.ts
export { chunk } from './chunk';
export { unique, uniqueBy } from './unique';
export { groupBy } from './groupBy';
</code></pre>
<h3 id="3-å¼‚æ­¥å·¥å…·æ¨¡å—"><a class="header" href="#3-å¼‚æ­¥å·¥å…·æ¨¡å—">3. å¼‚æ­¥å·¥å…·æ¨¡å—</a></h3>
<pre><code class="language-typescript">// src/async/delay.ts
export function delay(ms: number): Promise&lt;void&gt; {
  return new Promise(resolve =&gt; setTimeout(resolve, ms));
}

// src/async/timeout.ts
export class TimeoutError extends Error {
  constructor(message: string = 'Operation timed out') {
    super(message);
    this.name = 'TimeoutError';
  }
}

export function timeout&lt;T&gt;(
  promise: Promise&lt;T&gt;, 
  ms: number,
  errorMessage?: string
): Promise&lt;T&gt; {
  return Promise.race([
    promise,
    new Promise&lt;never&gt;((_, reject) =&gt; 
      setTimeout(() =&gt; reject(new TimeoutError(errorMessage)), ms)
    )
  ]);
}

// src/async/retry.ts
export interface RetryOptions {
  retries: number;
  delay?: number;
  backoff?: 'linear' | 'exponential';
  factor?: number;
}

export async function retry&lt;T&gt;(
  fn: () =&gt; Promise&lt;T&gt;,
  options: RetryOptions
): Promise&lt;T&gt; {
  const { retries, delay: baseDelay = 1000, backoff = 'linear', factor = 2 } = options;
  
  let lastError: Error;
  
  for (let attempt = 0; attempt &lt;= retries; attempt++) {
    try {
      return await fn();
    } catch (error) {
      lastError = error as Error;
      
      if (attempt === retries) break;
      
      const delayMs = backoff === 'exponential' 
        ? baseDelay * Math.pow(factor, attempt)
        : baseDelay * (attempt + 1);
        
      await delay(delayMs);
    }
  }
  
  throw lastError!;
}

// src/async/index.ts
export { delay } from './delay';
export { timeout, TimeoutError } from './timeout';
export { retry, type RetryOptions } from './retry';
</code></pre>
<h3 id="4-ä¸»å…¥å£æ–‡ä»¶"><a class="header" href="#4-ä¸»å…¥å£æ–‡ä»¶">4. ä¸»å…¥å£æ–‡ä»¶</a></h3>
<pre><code class="language-typescript">// src/index.ts
// å­—ç¬¦ä¸²å·¥å…·
export * as string from './string';
export { capitalize, kebabCase, truncate } from './string';

// æ•°ç»„å·¥å…·
export * as array from './array';
export { chunk, unique, uniqueBy, groupBy } from './array';

// æ—¥æœŸå·¥å…·
export * as date from './date';

// å¼‚æ­¥å·¥å…·
export * as async from './async';
export { delay, timeout, retry, TimeoutError } from './async';

// éªŒè¯å·¥å…·
export * as validation from './validation';

// ç±»å‹å¯¼å‡º
export type { TruncateOptions } from './string';
export type { RetryOptions } from './async';
</code></pre>
<h2 id="æ„å»ºé…ç½®"><a class="header" href="#æ„å»ºé…ç½®">æ„å»ºé…ç½®</a></h2>
<h3 id="1-typescripté…ç½®"><a class="header" href="#1-typescripté…ç½®">1. TypeScripté…ç½®</a></h3>
<pre><code class="language-json">{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "node",
    "declaration": true,
    "declarationMap": true,
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true
  },
  "include": ["src/**/*"],
  "exclude": ["dist", "node_modules", "tests"]
}
</code></pre>
<h3 id="2-rollupé…ç½®-1"><a class="header" href="#2-rollupé…ç½®-1">2. Rollupé…ç½®</a></h3>
<pre><code class="language-javascript">// rollup.config.js
import typescript from '@rollup/plugin-typescript';
import { nodeResolve } from '@rollup/plugin-node-resolve';
import { terser } from 'rollup-plugin-terser';

const isProduction = process.env.NODE_ENV === 'production';

export default [
  // ESæ¨¡å—æ„å»º
  {
    input: 'src/index.ts',
    output: {
      file: 'dist/index.esm.js',
      format: 'esm',
      sourcemap: true
    },
    plugins: [
      nodeResolve(),
      typescript({
        tsconfig: './tsconfig.json',
        declaration: true,
        declarationDir: './dist',
        rootDir: './src'
      }),
      ...(isProduction ? [terser()] : [])
    ]
  },
  // CommonJSæ„å»º
  {
    input: 'src/index.ts',
    output: {
      file: 'dist/index.cjs.js',
      format: 'cjs',
      sourcemap: true,
      exports: 'named'
    },
    plugins: [
      nodeResolve(),
      typescript({
        tsconfig: './tsconfig.json'
      }),
      ...(isProduction ? [terser()] : [])
    ]
  },
  // UMDæ„å»ºï¼ˆæµè§ˆå™¨å…¼å®¹ï¼‰
  {
    input: 'src/index.ts',
    output: {
      file: 'dist/index.umd.js',
      format: 'umd',
      name: 'UtilsToolkit',
      sourcemap: true
    },
    plugins: [
      nodeResolve(),
      typescript({
        tsconfig: './tsconfig.json'
      }),
      ...(isProduction ? [terser()] : [])
    ]
  }
];
</code></pre>
<h3 id="3-packagejsoné…ç½®"><a class="header" href="#3-packagejsoné…ç½®">3. Package.jsoné…ç½®</a></h3>
<pre><code class="language-json">{
  "name": "@utils/toolkit",
  "version": "1.0.0",
  "description": "A modular utility library for JavaScript",
  "main": "dist/index.cjs.js",
  "module": "dist/index.esm.js",
  "types": "dist/index.d.ts",
  "exports": {
    ".": {
      "import": "./dist/index.esm.js",
      "require": "./dist/index.cjs.js",
      "types": "./dist/index.d.ts"
    },
    "./string": {
      "import": "./dist/string/index.js",
      "require": "./dist/string/index.js",
      "types": "./dist/string/index.d.ts"
    },
    "./array": {
      "import": "./dist/array/index.js",
      "require": "./dist/array/index.js", 
      "types": "./dist/array/index.d.ts"
    },
    "./async": {
      "import": "./dist/async/index.js",
      "require": "./dist/async/index.js",
      "types": "./dist/async/index.d.ts"
    }
  },
  "files": [
    "dist"
  ],
  "scripts": {
    "build": "rollup -c",
    "build:prod": "NODE_ENV=production rollup -c",
    "dev": "rollup -c -w",
    "test": "jest",
    "test:watch": "jest --watch",
    "type-check": "tsc --noEmit",
    "lint": "eslint src --ext .ts",
    "prepublishOnly": "npm run build:prod"
  },
  "keywords": ["utilities", "toolkit", "javascript", "typescript"],
  "author": "Your Name",
  "license": "MIT",
  "devDependencies": {
    "@rollup/plugin-node-resolve": "^15.0.0",
    "@rollup/plugin-typescript": "^11.0.0",
    "@types/jest": "^29.0.0",
    "jest": "^29.0.0",
    "rollup": "^3.0.0",
    "rollup-plugin-terser": "^7.0.0",
    "typescript": "^5.0.0"
  }
}
</code></pre>
<h2 id="ä½¿ç”¨ç¤ºä¾‹"><a class="header" href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></h2>
<h3 id="1-å®Œæ•´å¯¼å…¥"><a class="header" href="#1-å®Œæ•´å¯¼å…¥">1. å®Œæ•´å¯¼å…¥</a></h3>
<pre><code class="language-javascript">import * as toolkit from '@utils/toolkit';

const result = toolkit.string.capitalize('hello world');
const chunks = toolkit.array.chunk([1, 2, 3, 4, 5], 2);
</code></pre>
<h3 id="2-æŒ‰éœ€å¯¼å…¥"><a class="header" href="#2-æŒ‰éœ€å¯¼å…¥">2. æŒ‰éœ€å¯¼å…¥</a></h3>
<pre><code class="language-javascript">import { capitalize, chunk } from '@utils/toolkit';

const title = capitalize('hello world');
const groups = chunk([1, 2, 3, 4, 5], 2);
</code></pre>
<h3 id="3-æ¨¡å—åŒ–å¯¼å…¥"><a class="header" href="#3-æ¨¡å—åŒ–å¯¼å…¥">3. æ¨¡å—åŒ–å¯¼å…¥</a></h3>
<pre><code class="language-javascript">import { capitalize, kebabCase } from '@utils/toolkit/string';
import { delay, retry } from '@utils/toolkit/async';

// å­—ç¬¦ä¸²å¤„ç†
const title = capitalize('hello world');
const slug = kebabCase('Hello World API');

// å¼‚æ­¥æ“ä½œ
await delay(1000);
const result = await retry(() =&gt; fetchData(), { retries: 3 });
</code></pre>
<h3 id="4-commonjsä½¿ç”¨"><a class="header" href="#4-commonjsä½¿ç”¨">4. CommonJSä½¿ç”¨</a></h3>
<pre><code class="language-javascript">const { capitalize, chunk } = require('@utils/toolkit');

const title = capitalize('hello world');
const groups = chunk([1, 2, 3, 4, 5], 2);
</code></pre>
<h2 id="æµ‹è¯•ç­–ç•¥"><a class="header" href="#æµ‹è¯•ç­–ç•¥">æµ‹è¯•ç­–ç•¥</a></h2>
<h3 id="1-å•å…ƒæµ‹è¯•"><a class="header" href="#1-å•å…ƒæµ‹è¯•">1. å•å…ƒæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// tests/string/capitalize.test.ts
import { capitalize } from '../../src/string/capitalize';

describe('capitalize', () =&gt; {
  test('should capitalize first letter', () =&gt; {
    expect(capitalize('hello')).toBe('Hello');
  });

  test('should handle empty string', () =&gt; {
    expect(capitalize('')).toBe('');
  });

  test('should handle already capitalized string', () =&gt; {
    expect(capitalize('Hello')).toBe('Hello');
  });
});
</code></pre>
<h3 id="2-é›†æˆæµ‹è¯•"><a class="header" href="#2-é›†æˆæµ‹è¯•">2. é›†æˆæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// tests/integration/exports.test.ts
import * as toolkit from '../../src';

describe('Module Exports', () =&gt; {
  test('should export all string utilities', () =&gt; {
    expect(typeof toolkit.capitalize).toBe('function');
    expect(typeof toolkit.kebabCase).toBe('function');
    expect(typeof toolkit.truncate).toBe('function');
  });

  test('should export namespaced modules', () =&gt; {
    expect(typeof toolkit.string.capitalize).toBe('function');
    expect(typeof toolkit.array.chunk).toBe('function');
    expect(typeof toolkit.async.delay).toBe('function');
  });
});
</code></pre>
<h2 id="ä¼˜åŒ–æŠ€å·§"><a class="header" href="#ä¼˜åŒ–æŠ€å·§">ä¼˜åŒ–æŠ€å·§</a></h2>
<h3 id="1-tree-shakingä¼˜åŒ–"><a class="header" href="#1-tree-shakingä¼˜åŒ–">1. Tree Shakingä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// ç¡®ä¿æ¯ä¸ªå‡½æ•°éƒ½æ˜¯ç‹¬ç«‹å¯¼å‡º
// âŒ ä¸å¥½çš„åšæ³•
const utils = {
  capitalize: (str) =&gt; str.charAt(0).toUpperCase() + str.slice(1),
  kebabCase: (str) =&gt; str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()
};
export default utils;

// âœ… å¥½çš„åšæ³•
export function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

export function kebabCase(str) {
  return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
}
</code></pre>
<h3 id="2-åŒ…ä½“ç§¯ä¼˜åŒ–"><a class="header" href="#2-åŒ…ä½“ç§¯ä¼˜åŒ–">2. åŒ…ä½“ç§¯ä¼˜åŒ–</a></h3>
<pre><code class="language-javascript">// é¿å…å¼•å…¥å¤§å‹ä¾èµ–
// âŒ å¼•å…¥æ•´ä¸ªlodash
import _ from 'lodash';

// âœ… åªå¼•å…¥éœ€è¦çš„å‡½æ•°
import { isEqual } from 'lodash/isEqual';

// âœ… æˆ–è€…è‡ªå·±å®ç°ç®€å•ç‰ˆæœ¬
export function isEqual(a, b) {
  return JSON.stringify(a) === JSON.stringify(b);
}
</code></pre>
<h3 id="3-ç±»å‹ä¼˜åŒ–"><a class="header" href="#3-ç±»å‹ä¼˜åŒ–">3. ç±»å‹ä¼˜åŒ–</a></h3>
<pre><code class="language-typescript">// ä½¿ç”¨æ³›å‹æä¾›æ›´å¥½çš„ç±»å‹æ¨æ–­
export function map&lt;T, U&gt;(array: T[], fn: (item: T) =&gt; U): U[] {
  return array.map(fn);
}

// ä½¿ç”¨æ¡ä»¶ç±»å‹
export type Flatten&lt;T&gt; = T extends (infer U)[] ? U : T;

export function flatten&lt;T&gt;(array: T[]): Flatten&lt;T&gt;[] {
  return array.flat() as Flatten&lt;T&gt;[];
}
</code></pre>
<h2 id="å‘å¸ƒæµç¨‹"><a class="header" href="#å‘å¸ƒæµç¨‹">å‘å¸ƒæµç¨‹</a></h2>
<h3 id="1-ç‰ˆæœ¬ç®¡ç†"><a class="header" href="#1-ç‰ˆæœ¬ç®¡ç†">1. ç‰ˆæœ¬ç®¡ç†</a></h3>
<pre><code class="language-bash"># æ›´æ–°ç‰ˆæœ¬å·
npm version patch  # ä¿®å¤bug
npm version minor  # æ–°åŠŸèƒ½
npm version major  # ç ´åæ€§å˜æ›´

# æ„å»ºå’Œå‘å¸ƒ
npm run build:prod
npm publish
</code></pre>
<h3 id="2-cicdé…ç½®"><a class="header" href="#2-cicdé…ç½®">2. CI/CDé…ç½®</a></h3>
<pre><code class="language-yaml"># .github/workflows/publish.yml
name: Publish to NPM

on:
  push:
    tags:
      - 'v*'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
          registry-url: 'https://registry.npmjs.org'
      
      - run: npm ci
      - run: npm test
      - run: npm run build:prod
      - run: npm publish
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
</code></pre>
<h3 id="3-è¯­ä¹‰åŒ–ç‰ˆæœ¬"><a class="header" href="#3-è¯­ä¹‰åŒ–ç‰ˆæœ¬">3. è¯­ä¹‰åŒ–ç‰ˆæœ¬</a></h3>
<pre><code class="language-json">{
  "scripts": {
    "release:patch": "npm version patch &amp;&amp; git push --tags",
    "release:minor": "npm version minor &amp;&amp; git push --tags", 
    "release:major": "npm version major &amp;&amp; git push --tags"
  }
}
</code></pre>
<h2 id="æœ€ä½³å®è·µæ€»ç»“-4"><a class="header" href="#æœ€ä½³å®è·µæ€»ç»“-4">æœ€ä½³å®è·µæ€»ç»“</a></h2>
<ol>
<li><strong>æ¨¡å—è®¾è®¡</strong>ï¼šä¿æŒå•ä¸€èŒè´£ï¼Œé¿å…æ¨¡å—é—´å¼ºè€¦åˆ</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šæä¾›å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰</li>
<li><strong>æ„å»ºä¼˜åŒ–</strong>ï¼šæ”¯æŒå¤šç§æ¨¡å—æ ¼å¼ï¼Œä¼˜åŒ–åŒ…ä½“ç§¯</li>
<li><strong>æµ‹è¯•è¦†ç›–</strong>ï¼šä¿è¯é«˜æµ‹è¯•è¦†ç›–ç‡å’Œè´¨é‡</li>
<li><strong>æ–‡æ¡£å®Œå–„</strong>ï¼šæä¾›æ¸…æ™°çš„APIæ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ</li>
<li><strong>æŒç»­é›†æˆ</strong>ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•å’Œå‘å¸ƒæµç¨‹</li>
</ol>
<p>é€šè¿‡è¿™ä¸ªå®Œæ•´çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªç°ä»£åŒ–ã€å¯ç»´æŠ¤çš„JavaScriptæ¨¡å—åº“ï¼Œä»é¡¹ç›®æ¶æ„åˆ°å‘å¸ƒæµç¨‹çš„æ¯ä¸ªç¯èŠ‚éƒ½è¿›è¡Œäº†è¯¦ç»†è¯´æ˜ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡">å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡"><a class="header" href="#å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡">å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡</a></h1>
<p>æœ¬ç« å°†æ¢è®¨å¦‚ä½•åœ¨å¤§å‹å‰ç«¯é¡¹ç›®ä¸­è¿›è¡Œæ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„è§„åˆ’ã€æ¨¡å—é—´é€šä¿¡ã€ä¾èµ–ç®¡ç†å’Œå›¢é˜Ÿåä½œç­‰æ–¹é¢çš„æœ€ä½³å®è·µã€‚</p>
<h2 id="é¡¹ç›®èƒŒæ™¯"><a class="header" href="#é¡¹ç›®èƒŒæ™¯">é¡¹ç›®èƒŒæ™¯</a></h2>
<p>æˆ‘ä»¬ä»¥ä¸€ä¸ªå¤§å‹ç”µå•†å¹³å°å‰ç«¯é¡¹ç›®ä¸ºä¾‹ï¼Œè¯¥é¡¹ç›®å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å¤šä¸ªå›¢é˜Ÿå¹¶è¡Œå¼€å‘</li>
<li>åŠŸèƒ½æ¨¡å—å¤æ‚ä¸”ç›¸äº’å…³è”</li>
<li>éœ€è¦æ”¯æŒå¤šç§ä¸šåŠ¡åœºæ™¯</li>
<li>ä»£ç åº“è§„æ¨¡è¶…è¿‡100ä¸‡è¡Œ</li>
<li>éœ€è¦æ”¯æŒå¾®å‰ç«¯æ¶æ„</li>
</ul>
<h2 id="æ•´ä½“æ¶æ„è®¾è®¡"><a class="header" href="#æ•´ä½“æ¶æ„è®¾è®¡">æ•´ä½“æ¶æ„è®¾è®¡</a></h2>
<h3 id="1-åˆ†å±‚æ¶æ„"><a class="header" href="#1-åˆ†å±‚æ¶æ„">1. åˆ†å±‚æ¶æ„</a></h3>
<pre><code>å¤§å‹ç”µå•†å¹³å°
â”œâ”€â”€ åº”ç”¨å±‚ (Applications)
â”‚   â”œâ”€â”€ ç”¨æˆ·ç«¯åº”ç”¨ (Customer App)
â”‚   â”œâ”€â”€ å•†å®¶ç«¯åº”ç”¨ (Merchant App)
â”‚   â””â”€â”€ ç®¡ç†ç«¯åº”ç”¨ (Admin App)
â”œâ”€â”€ ä¸šåŠ¡å±‚ (Business)
â”‚   â”œâ”€â”€ ç”¨æˆ·æ¨¡å— (User)
â”‚   â”œâ”€â”€ å•†å“æ¨¡å— (Product)
â”‚   â”œâ”€â”€ è®¢å•æ¨¡å— (Order)
â”‚   â”œâ”€â”€ æ”¯ä»˜æ¨¡å— (Payment)
â”‚   â””â”€â”€ è¥é”€æ¨¡å— (Marketing)
â”œâ”€â”€ åŸºç¡€è®¾æ–½å±‚ (Infrastructure)
â”‚   â”œâ”€â”€ ç½‘ç»œæœåŠ¡ (Network)
â”‚   â”œâ”€â”€ çŠ¶æ€ç®¡ç† (State)
â”‚   â”œâ”€â”€ è·¯ç”±ç®¡ç† (Router)
â”‚   â””â”€â”€ ç¼“å­˜æœåŠ¡ (Cache)
â””â”€â”€ é€šç”¨å±‚ (Common)
    â”œâ”€â”€ UIç»„ä»¶åº“ (Components)
    â”œâ”€â”€ å·¥å…·å‡½æ•° (Utils)
    â”œâ”€â”€ å¸¸é‡å®šä¹‰ (Constants)
    â””â”€â”€ ç±»å‹å®šä¹‰ (Types)
</code></pre>
<h3 id="2-ç›®å½•ç»“æ„è®¾è®¡"><a class="header" href="#2-ç›®å½•ç»“æ„è®¾è®¡">2. ç›®å½•ç»“æ„è®¾è®¡</a></h3>
<pre><code>ecommerce-platform/
â”œâ”€â”€ apps/                          # åº”ç”¨å±‚
â”‚   â”œâ”€â”€ customer/                  # ç”¨æˆ·ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ merchant/                  # å•†å®¶ç«¯åº”ç”¨
â”‚   â””â”€â”€ admin/                     # ç®¡ç†ç«¯åº”ç”¨
â”œâ”€â”€ packages/                      # å…±äº«åŒ…
â”‚   â”œâ”€â”€ business/                  # ä¸šåŠ¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”œâ”€â”€ product/
â”‚   â”‚   â”œâ”€â”€ order/
â”‚   â”‚   â”œâ”€â”€ payment/
â”‚   â”‚   â””â”€â”€ marketing/
â”‚   â”œâ”€â”€ infrastructure/            # åŸºç¡€è®¾æ–½
â”‚   â”‚   â”œâ”€â”€ network/
â”‚   â”‚   â”œâ”€â”€ state/
â”‚   â”‚   â”œâ”€â”€ router/
â”‚   â”‚   â””â”€â”€ cache/
â”‚   â”œâ”€â”€ ui/                        # UIç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ themes/
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â””â”€â”€ common/                    # é€šç”¨å·¥å…·
â”‚       â”œâ”€â”€ utils/
â”‚       â”œâ”€â”€ constants/
â”‚       â”œâ”€â”€ types/
â”‚       â””â”€â”€ hooks/
â”œâ”€â”€ tools/                         # å¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ build/
â”‚   â”œâ”€â”€ eslint-config/
â”‚   â””â”€â”€ test-utils/
â”œâ”€â”€ docs/                          # æ–‡æ¡£
â””â”€â”€ scripts/                       # è„šæœ¬
</code></pre>
<h2 id="æ¨¡å—è®¾è®¡åŸåˆ™-1"><a class="header" href="#æ¨¡å—è®¾è®¡åŸåˆ™-1">æ¨¡å—è®¾è®¡åŸåˆ™</a></h2>
<h3 id="1-é¢†åŸŸé©±åŠ¨è®¾è®¡"><a class="header" href="#1-é¢†åŸŸé©±åŠ¨è®¾è®¡">1. é¢†åŸŸé©±åŠ¨è®¾è®¡</a></h3>
<p>æ¯ä¸ªä¸šåŠ¡æ¨¡å—æŒ‰ç…§é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)åŸåˆ™ç»„ç»‡ï¼š</p>
<pre><code class="language-typescript">// packages/business/user/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ domain/                    # é¢†åŸŸå±‚
â”‚   â”‚   â”œâ”€â”€ entities/              # å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ User.ts
â”‚   â”‚   â”‚   â””â”€â”€ Profile.ts
â”‚   â”‚   â”œâ”€â”€ valueObjects/          # å€¼å¯¹è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ Email.ts
â”‚   â”‚   â”‚   â””â”€â”€ Phone.ts
â”‚   â”‚   â”œâ”€â”€ services/              # é¢†åŸŸæœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ UserService.ts
â”‚   â”‚   â””â”€â”€ repositories/          # ä»“å‚¨æ¥å£
â”‚   â”‚       â””â”€â”€ UserRepository.ts
â”‚   â”œâ”€â”€ infrastructure/            # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ repositories/          # ä»“å‚¨å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ ApiUserRepository.ts
â”‚   â”‚   â””â”€â”€ services/              # å¤–éƒ¨æœåŠ¡
â”‚   â”‚       â””â”€â”€ AuthService.ts
â”‚   â”œâ”€â”€ application/               # åº”ç”¨å±‚
â”‚   â”‚   â”œâ”€â”€ useCases/              # ç”¨ä¾‹
â”‚   â”‚   â”‚   â”œâ”€â”€ CreateUser.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ UpdateProfile.ts
â”‚   â”‚   â”‚   â””â”€â”€ GetUserById.ts
â”‚   â”‚   â””â”€â”€ dtos/                  # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚       â”œâ”€â”€ CreateUserDto.ts
â”‚   â”‚       â””â”€â”€ UpdateProfileDto.ts
â”‚   â””â”€â”€ presentation/              # è¡¨ç¤ºå±‚
â”‚       â”œâ”€â”€ components/            # ç»„ä»¶
â”‚       â”œâ”€â”€ hooks/                 # é’©å­
â”‚       â””â”€â”€ stores/                # çŠ¶æ€ç®¡ç†
â””â”€â”€ package.json
</code></pre>
<h3 id="2-æ¨¡å—è¾¹ç•Œå®šä¹‰"><a class="header" href="#2-æ¨¡å—è¾¹ç•Œå®šä¹‰">2. æ¨¡å—è¾¹ç•Œå®šä¹‰</a></h3>
<pre><code class="language-typescript">// packages/business/user/src/index.ts
// åªå¯¼å‡ºåº”ç”¨å±‚å’Œè¡¨ç¤ºå±‚çš„å…¬å…±æ¥å£
export { CreateUser, UpdateProfile, GetUserById } from './application/useCases';
export { CreateUserDto, UpdateProfileDto } from './application/dtos';
export { UserProfile, UserSettings } from './presentation/components';
export { useUser, useUserProfile } from './presentation/hooks';
export { userStore } from './presentation/stores';

// ç±»å‹å®šä¹‰
export type { User, Profile } from './domain/entities';
export type { Email, Phone } from './domain/valueObjects';
</code></pre>
<h3 id="3-ä¾èµ–æ³¨å…¥é…ç½®"><a class="header" href="#3-ä¾èµ–æ³¨å…¥é…ç½®">3. ä¾èµ–æ³¨å…¥é…ç½®</a></h3>
<pre><code class="language-typescript">// packages/business/user/src/container.ts
import { Container } from 'inversify';
import { UserRepository } from './domain/repositories/UserRepository';
import { ApiUserRepository } from './infrastructure/repositories/ApiUserRepository';
import { CreateUser } from './application/useCases/CreateUser';

const userContainer = new Container();

// ç»‘å®šä¾èµ–
userContainer.bind&lt;UserRepository&gt;('UserRepository').to(ApiUserRepository);
userContainer.bind&lt;CreateUser&gt;('CreateUser').to(CreateUser);

export { userContainer };
</code></pre>
<h2 id="æ¨¡å—é—´é€šä¿¡ç­–ç•¥"><a class="header" href="#æ¨¡å—é—´é€šä¿¡ç­–ç•¥">æ¨¡å—é—´é€šä¿¡ç­–ç•¥</a></h2>
<h3 id="1-äº‹ä»¶é©±åŠ¨æ¶æ„"><a class="header" href="#1-äº‹ä»¶é©±åŠ¨æ¶æ„">1. äº‹ä»¶é©±åŠ¨æ¶æ„</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/events/src/EventBus.ts
export interface Event {
  type: string;
  payload: any;
  timestamp: Date;
  source: string;
}

export class EventBus {
  private listeners: Map&lt;string, Set&lt;(event: Event) =&gt; void&gt;&gt; = new Map();

  subscribe(eventType: string, listener: (event: Event) =&gt; void): void {
    if (!this.listeners.has(eventType)) {
      this.listeners.set(eventType, new Set());
    }
    this.listeners.get(eventType)!.add(listener);
  }

  unsubscribe(eventType: string, listener: (event: Event) =&gt; void): void {
    this.listeners.get(eventType)?.delete(listener);
  }

  publish(event: Event): void {
    const listeners = this.listeners.get(event.type);
    if (listeners) {
      listeners.forEach(listener =&gt; listener(event));
    }
  }
}

// å•ä¾‹å®ä¾‹
export const eventBus = new EventBus();
</code></pre>
<h3 id="2-è·¨æ¨¡å—é€šä¿¡ç¤ºä¾‹"><a class="header" href="#2-è·¨æ¨¡å—é€šä¿¡ç¤ºä¾‹">2. è·¨æ¨¡å—é€šä¿¡ç¤ºä¾‹</a></h3>
<pre><code class="language-typescript">// packages/business/order/src/application/useCases/CreateOrder.ts
import { eventBus } from '@platform/infrastructure/events';
import { Order } from '../domain/entities/Order';

export class CreateOrder {
  async execute(orderData: CreateOrderDto): Promise&lt;Order&gt; {
    const order = await this.orderRepository.create(orderData);
    
    // å‘å¸ƒè®¢å•åˆ›å»ºäº‹ä»¶
    eventBus.publish({
      type: 'ORDER_CREATED',
      payload: { orderId: order.id, userId: order.userId },
      timestamp: new Date(),
      source: 'order-module'
    });
    
    return order;
  }
}

// packages/business/user/src/application/useCases/UpdateUserPoints.ts
import { eventBus } from '@platform/infrastructure/events';

export class UpdateUserPoints {
  constructor() {
    // ç›‘å¬è®¢å•åˆ›å»ºäº‹ä»¶
    eventBus.subscribe('ORDER_CREATED', this.handleOrderCreated.bind(this));
  }

  private async handleOrderCreated(event: Event): Promise&lt;void&gt; {
    const { userId } = event.payload;
    await this.userRepository.addPoints(userId, 100);
  }
}
</code></pre>
<h2 id="çŠ¶æ€ç®¡ç†æ¶æ„"><a class="header" href="#çŠ¶æ€ç®¡ç†æ¶æ„">çŠ¶æ€ç®¡ç†æ¶æ„</a></h2>
<h3 id="1-åˆ†å±‚çŠ¶æ€ç®¡ç†"><a class="header" href="#1-åˆ†å±‚çŠ¶æ€ç®¡ç†">1. åˆ†å±‚çŠ¶æ€ç®¡ç†</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/state/src/Store.ts
import { configureStore } from '@reduxjs/toolkit';
import { userSlice } from '@platform/business/user';
import { productSlice } from '@platform/business/product';
import { orderSlice } from '@platform/business/order';

export const store = configureStore({
  reducer: {
    // ä¸šåŠ¡çŠ¶æ€
    user: userSlice.reducer,
    product: productSlice.reducer,
    order: orderSlice.reducer,
    
    // åº”ç”¨çŠ¶æ€
    ui: uiSlice.reducer,
    router: routerSlice.reducer,
    
    // åŸºç¡€è®¾æ–½çŠ¶æ€
    network: networkSlice.reducer,
    cache: cacheSlice.reducer
  },
  middleware: (getDefaultMiddleware) =&gt;
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: ['persist/PERSIST']
      }
    }).concat(
      // è‡ªå®šä¹‰ä¸­é—´ä»¶
      eventMiddleware,
      cacheMiddleware,
      loggerMiddleware
    )
});

export type RootState = ReturnType&lt;typeof store.getState&gt;;
export type AppDispatch = typeof store.dispatch;
</code></pre>
<h3 id="2-æ¨¡å—çŠ¶æ€éš”ç¦»"><a class="header" href="#2-æ¨¡å—çŠ¶æ€éš”ç¦»">2. æ¨¡å—çŠ¶æ€éš”ç¦»</a></h3>
<pre><code class="language-typescript">// packages/business/user/src/presentation/stores/userSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

interface UserState {
  currentUser: User | null;
  profile: Profile | null;
  loading: boolean;
  error: string | null;
}

const initialState: UserState = {
  currentUser: null,
  profile: null,
  loading: false,
  error: null
};

export const userSlice = createSlice({
  name: 'user',
  initialState,
  reducers: {
    setUser: (state, action: PayloadAction&lt;User&gt;) =&gt; {
      state.currentUser = action.payload;
    },
    setProfile: (state, action: PayloadAction&lt;Profile&gt;) =&gt; {
      state.profile = action.payload;
    },
    setLoading: (state, action: PayloadAction&lt;boolean&gt;) =&gt; {
      state.loading = action.payload;
    },
    setError: (state, action: PayloadAction&lt;string&gt;) =&gt; {
      state.error = action.payload;
    }
  }
});

export const { setUser, setProfile, setLoading, setError } = userSlice.actions;
</code></pre>
<h2 id="ç»„ä»¶åº“è®¾è®¡"><a class="header" href="#ç»„ä»¶åº“è®¾è®¡">ç»„ä»¶åº“è®¾è®¡</a></h2>
<h3 id="1-è®¾è®¡ç³»ç»Ÿç»„ä»¶"><a class="header" href="#1-è®¾è®¡ç³»ç»Ÿç»„ä»¶">1. è®¾è®¡ç³»ç»Ÿç»„ä»¶</a></h3>
<pre><code class="language-typescript">// packages/ui/components/src/Button/Button.tsx
import React from 'react';
import { styled } from '@platform/ui/themes';

export interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'danger';
  size?: 'small' | 'medium' | 'large';
  disabled?: boolean;
  loading?: boolean;
  children: React.ReactNode;
  onClick?: () =&gt; void;
}

const StyledButton = styled.button&lt;ButtonProps&gt;`
  /* ä½¿ç”¨è®¾è®¡ç³»ç»Ÿçš„token */
  font-family: ${({ theme }) =&gt; theme.typography.fontFamily};
  font-size: ${({ theme, size }) =&gt; theme.typography.fontSize[size || 'medium']};
  padding: ${({ theme, size }) =&gt; theme.spacing.button[size || 'medium']};
  border-radius: ${({ theme }) =&gt; theme.borderRadius.medium};
  
  /* å˜ä½“æ ·å¼ */
  ${({ theme, variant }) =&gt; {
    switch (variant) {
      case 'primary':
        return `
          background-color: ${theme.colors.primary[500]};
          color: ${theme.colors.white};
          border: none;
        `;
      case 'secondary':
        return `
          background-color: transparent;
          color: ${theme.colors.primary[500]};
          border: 1px solid ${theme.colors.primary[500]};
        `;
      case 'danger':
        return `
          background-color: ${theme.colors.danger[500]};
          color: ${theme.colors.white};
          border: none;
        `;
      default:
        return '';
    }
  }}
`;

export const Button: React.FC&lt;ButtonProps&gt; = ({
  variant = 'primary',
  size = 'medium',
  disabled = false,
  loading = false,
  children,
  onClick
}) =&gt; {
  return (
    &lt;StyledButton
      variant={variant}
      size={size}
      disabled={disabled || loading}
      onClick={onClick}
    &gt;
      {loading ? 'Loading...' : children}
    &lt;/StyledButton&gt;
  );
};
</code></pre>
<h3 id="2-å¤åˆç»„ä»¶æ¨¡å¼"><a class="header" href="#2-å¤åˆç»„ä»¶æ¨¡å¼">2. å¤åˆç»„ä»¶æ¨¡å¼</a></h3>
<pre><code class="language-typescript">// packages/ui/components/src/DataTable/DataTable.tsx
import React from 'react';

interface DataTableProps&lt;T&gt; {
  data: T[];
  children: React.ReactNode;
}

interface DataTableHeaderProps {
  children: React.ReactNode;
}

interface DataTableBodyProps {
  children: React.ReactNode;
}

interface DataTableRowProps&lt;T&gt; {
  item: T;
  children: (item: T) =&gt; React.ReactNode;
}

function DataTable&lt;T&gt;({ data, children }: DataTableProps&lt;T&gt;) {
  return (
    &lt;table className="data-table"&gt;
      {children}
    &lt;/table&gt;
  );
}

function DataTableHeader({ children }: DataTableHeaderProps) {
  return (
    &lt;thead&gt;
      &lt;tr&gt;{children}&lt;/tr&gt;
    &lt;/thead&gt;
  );
}

function DataTableBody&lt;T&gt;({ children }: DataTableBodyProps) {
  return &lt;tbody&gt;{children}&lt;/tbody&gt;;
}

function DataTableRow&lt;T&gt;({ item, children }: DataTableRowProps&lt;T&gt;) {
  return &lt;tr&gt;{children(item)}&lt;/tr&gt;;
}

// å¤åˆç»„ä»¶å¯¼å‡º
DataTable.Header = DataTableHeader;
DataTable.Body = DataTableBody;
DataTable.Row = DataTableRow;

export { DataTable };
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-4"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥-4">æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</a></h2>
<h3 id="1-ä»£ç åˆ†å‰²ç­–ç•¥"><a class="header" href="#1-ä»£ç åˆ†å‰²ç­–ç•¥">1. ä»£ç åˆ†å‰²ç­–ç•¥</a></h3>
<pre><code class="language-typescript">// apps/customer/src/routes/index.tsx
import { lazy, Suspense } from 'react';
import { Routes, Route } from 'react-router-dom';
import { LoadingSpinner } from '@platform/ui/components';

// è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
const HomePage = lazy(() =&gt; import('../pages/HomePage'));
const ProductPage = lazy(() =&gt; import('../pages/ProductPage'));
const OrderPage = lazy(() =&gt; import('../pages/OrderPage'));
const UserPage = lazy(() =&gt; import('../pages/UserPage'));

export function AppRoutes() {
  return (
    &lt;Suspense fallback={&lt;LoadingSpinner /&gt;}&gt;
      &lt;Routes&gt;
        &lt;Route path="/" element={&lt;HomePage /&gt;} /&gt;
        &lt;Route path="/products/*" element={&lt;ProductPage /&gt;} /&gt;
        &lt;Route path="/orders/*" element={&lt;OrderPage /&gt;} /&gt;
        &lt;Route path="/user/*" element={&lt;UserPage /&gt;} /&gt;
      &lt;/Routes&gt;
    &lt;/Suspense&gt;
  );
}
</code></pre>
<h3 id="2-æ¨¡å—çº§åˆ«çš„æ‡’åŠ è½½"><a class="header" href="#2-æ¨¡å—çº§åˆ«çš„æ‡’åŠ è½½">2. æ¨¡å—çº§åˆ«çš„æ‡’åŠ è½½</a></h3>
<pre><code class="language-typescript">// packages/business/product/src/index.ts
import { lazy } from 'react';

// æ‡’åŠ è½½å¤æ‚ç»„ä»¶
export const ProductCatalog = lazy(() =&gt; import('./presentation/components/ProductCatalog'));
export const ProductDetail = lazy(() =&gt; import('./presentation/components/ProductDetail'));

// ç«‹å³å¯¼å‡ºè½»é‡çº§æ¨¡å—
export { useProduct } from './presentation/hooks/useProduct';
export { productStore } from './presentation/stores/productSlice';
export type { Product, ProductCategory } from './domain/entities';
</code></pre>
<h3 id="3-ç¼“å­˜ç­–ç•¥"><a class="header" href="#3-ç¼“å­˜ç­–ç•¥">3. ç¼“å­˜ç­–ç•¥</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/cache/src/CacheManager.ts
export class CacheManager {
  private cache = new Map&lt;string, { data: any; expiry: number }&gt;();

  set&lt;T&gt;(key: string, data: T, ttl: number = 5 * 60 * 1000): void {
    this.cache.set(key, {
      data,
      expiry: Date.now() + ttl
    });
  }

  get&lt;T&gt;(key: string): T | null {
    const cached = this.cache.get(key);
    if (!cached) return null;

    if (Date.now() &gt; cached.expiry) {
      this.cache.delete(key);
      return null;
    }

    return cached.data as T;
  }

  invalidate(pattern: string): void {
    const regex = new RegExp(pattern);
    for (const key of this.cache.keys()) {
      if (regex.test(key)) {
        this.cache.delete(key);
      }
    }
  }
}

export const cacheManager = new CacheManager();
</code></pre>
<h2 id="æ„å»ºå’Œéƒ¨ç½²"><a class="header" href="#æ„å»ºå’Œéƒ¨ç½²">æ„å»ºå’Œéƒ¨ç½²</a></h2>
<h3 id="1-monorepoæ„å»ºé…ç½®"><a class="header" href="#1-monorepoæ„å»ºé…ç½®">1. Monorepoæ„å»ºé…ç½®</a></h3>
<pre><code class="language-javascript">// turbo.json
{
  "pipeline": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": ["dist/**", ".next/**"]
    },
    "test": {
      "dependsOn": ["^build"],
      "outputs": ["coverage/**"]
    },
    "lint": {
      "outputs": []
    },
    "dev": {
      "cache": false
    }
  }
}
</code></pre>
<h3 id="2-å¾®å‰ç«¯éƒ¨ç½²ç­–ç•¥"><a class="header" href="#2-å¾®å‰ç«¯éƒ¨ç½²ç­–ç•¥">2. å¾®å‰ç«¯éƒ¨ç½²ç­–ç•¥</a></h3>
<pre><code class="language-typescript">// tools/build/webpack.config.js
const ModuleFederationPlugin = require('@module-federation/webpack');

module.exports = {
  plugins: [
    new ModuleFederationPlugin({
      name: 'customer_app',
      filename: 'remoteEntry.js',
      exposes: {
        './App': './src/App',
        './routes': './src/routes'
      },
      shared: {
        react: { singleton: true },
        'react-dom': { singleton: true },
        '@platform/ui': { singleton: true }
      }
    })
  ]
};
</code></pre>
<h2 id="å›¢é˜Ÿåä½œ"><a class="header" href="#å›¢é˜Ÿåä½œ">å›¢é˜Ÿåä½œ</a></h2>
<h3 id="1-æ¨¡å—æ‰€æœ‰æƒ"><a class="header" href="#1-æ¨¡å—æ‰€æœ‰æƒ">1. æ¨¡å—æ‰€æœ‰æƒ</a></h3>
<pre><code class="language-yaml"># .github/CODEOWNERS
# ä¸šåŠ¡æ¨¡å—æ‰€æœ‰æƒ
/packages/business/user/ @user-team
/packages/business/product/ @product-team
/packages/business/order/ @order-team
/packages/business/payment/ @payment-team

# åŸºç¡€è®¾æ–½
/packages/infrastructure/ @platform-team
/packages/ui/ @design-system-team

# åº”ç”¨
/apps/customer/ @frontend-team
/apps/merchant/ @merchant-team
/apps/admin/ @admin-team
</code></pre>
<h3 id="2-å¼€å‘å·¥ä½œæµ"><a class="header" href="#2-å¼€å‘å·¥ä½œæµ">2. å¼€å‘å·¥ä½œæµ</a></h3>
<pre><code class="language-typescript">// scripts/dev-workflow.ts
export class DevWorkflow {
  async runTests(modules: string[]): Promise&lt;void&gt; {
    // åªè¿è¡Œç›¸å…³æ¨¡å—çš„æµ‹è¯•
    for (const module of modules) {
      await this.runModuleTests(module);
    }
  }

  async buildAffectedModules(changedFiles: string[]): Promise&lt;void&gt; {
    const affectedModules = this.getAffectedModules(changedFiles);
    await this.buildModules(affectedModules);
  }

  private getAffectedModules(changedFiles: string[]): string[] {
    // åŸºäºä¾èµ–å›¾åˆ†æå½±å“çš„æ¨¡å—
    return this.dependencyGraph.getAffected(changedFiles);
  }
}
</code></pre>
<h2 id="ç›‘æ§å’Œç»´æŠ¤"><a class="header" href="#ç›‘æ§å’Œç»´æŠ¤">ç›‘æ§å’Œç»´æŠ¤</a></h2>
<h3 id="1-æ¨¡å—å¥åº·åº¦ç›‘æ§"><a class="header" href="#1-æ¨¡å—å¥åº·åº¦ç›‘æ§">1. æ¨¡å—å¥åº·åº¦ç›‘æ§</a></h3>
<pre><code class="language-typescript">// tools/monitoring/src/ModuleHealthChecker.ts
export class ModuleHealthChecker {
  checkDependencyHealth(): HealthReport {
    const report: HealthReport = {
      circularDependencies: this.findCircularDependencies(),
      unusedDependencies: this.findUnusedDependencies(),
      outdatedDependencies: this.findOutdatedDependencies(),
      bundleSize: this.analyzeBundleSize()
    };
    return report;
  }

  generateReport(): void {
    const health = this.checkDependencyHealth();
    console.log('æ¨¡å—å¥åº·åº¦æŠ¥å‘Š:', health);
  }
}
</code></pre>
<h3 id="2-æ€§èƒ½ç›‘æ§"><a class="header" href="#2-æ€§èƒ½ç›‘æ§">2. æ€§èƒ½ç›‘æ§</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/monitoring/src/PerformanceMonitor.ts
export class PerformanceMonitor {
  trackModuleLoad(moduleName: string): void {
    const startTime = performance.now();
    
    // ç›‘æ§æ¨¡å—åŠ è½½æ—¶é—´
    import(moduleName).then(() =&gt; {
      const loadTime = performance.now() - startTime;
      this.reportMetric('module_load_time', loadTime, { module: moduleName });
    });
  }

  trackComponentRender(componentName: string, renderTime: number): void {
    this.reportMetric('component_render_time', renderTime, { component: componentName });
  }

  private reportMetric(metric: string, value: number, tags: Record&lt;string, string&gt;): void {
    // å‘é€åˆ°ç›‘æ§ç³»ç»Ÿ
    analytics.track(metric, value, tags);
  }
}
</code></pre>
<h2 id="æœ€ä½³å®è·µæ€»ç»“-5"><a class="header" href="#æœ€ä½³å®è·µæ€»ç»“-5">æœ€ä½³å®è·µæ€»ç»“</a></h2>
<h3 id="1-æ¶æ„è®¾è®¡åŸåˆ™"><a class="header" href="#1-æ¶æ„è®¾è®¡åŸåˆ™">1. æ¶æ„è®¾è®¡åŸåˆ™</a></h3>
<ul>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä¸ªä¸šåŠ¡é¢†åŸŸ</li>
<li><strong>ä¾èµ–å€’ç½®</strong>ï¼šä¾èµ–æŠ½è±¡è€Œä¸æ˜¯å…·ä½“å®ç°</li>
<li><strong>å¼€æ”¾å°é—­</strong>ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­</li>
<li><strong>æ¥å£éš”ç¦»</strong>ï¼šå®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£</li>
</ul>
<h3 id="2-æ¨¡å—åŒ–ç­–ç•¥"><a class="header" href="#2-æ¨¡å—åŒ–ç­–ç•¥">2. æ¨¡å—åŒ–ç­–ç•¥</a></h3>
<ul>
<li><strong>æ¸…æ™°çš„è¾¹ç•Œ</strong>ï¼šæ˜ç¡®å®šä¹‰æ¨¡å—çš„è¾“å…¥å’Œè¾“å‡º</li>
<li><strong>æ¾è€¦åˆ</strong>ï¼šå‡å°‘æ¨¡å—é—´çš„ç›´æ¥ä¾èµ–</li>
<li><strong>é«˜å†…èš</strong>ï¼šç›¸å…³åŠŸèƒ½åº”è¯¥åœ¨åŒä¸€ä¸ªæ¨¡å—å†…</li>
<li><strong>å¯æµ‹è¯•æ€§</strong>ï¼šæ¨¡å—åº”è¯¥æ˜“äºå•ç‹¬æµ‹è¯•</li>
</ul>
<h3 id="3-å›¢é˜Ÿåä½œ-1"><a class="header" href="#3-å›¢é˜Ÿåä½œ-1">3. å›¢é˜Ÿåä½œ</a></h3>
<ul>
<li><strong>æ¨¡å—æ‰€æœ‰æƒ</strong>ï¼šæ¯ä¸ªæ¨¡å—æœ‰æ˜ç¡®çš„è´Ÿè´£å›¢é˜Ÿ</li>
<li><strong>APIå¥‘çº¦</strong>ï¼šæ¨¡å—é—´é€šè¿‡ç¨³å®šçš„APIè¿›è¡Œäº¤äº’</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬ç®¡ç†æ¨¡å—æ›´æ–°</li>
<li><strong>æ–‡æ¡£ç»´æŠ¤</strong>ï¼šä¿æŒAPIæ–‡æ¡£å’Œæ¶æ„æ–‡æ¡£çš„æ›´æ–°</li>
</ul>
<h3 id="4-æ€§èƒ½ä¼˜åŒ–-1"><a class="header" href="#4-æ€§èƒ½ä¼˜åŒ–-1">4. æ€§èƒ½ä¼˜åŒ–</a></h3>
<ul>
<li><strong>ä»£ç åˆ†å‰²</strong>ï¼šæŒ‰éœ€åŠ è½½æ¨¡å—å’Œç»„ä»¶</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šåˆç†ä½¿ç”¨å„ç§ç¼“å­˜æœºåˆ¶</li>
<li><strong>åŒ…ä½“ç§¯ä¼˜åŒ–</strong>ï¼šé¿å…é‡å¤ä¾èµ–å’Œæ— ç”¨ä»£ç </li>
<li><strong>è¿è¡Œæ—¶ä¼˜åŒ–</strong>ï¼šä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨ã€memoç­‰æŠ€æœ¯</li>
</ul>
<p>é€šè¿‡è¿™å¥—å®Œæ•´çš„å¤§å‹é¡¹ç›®æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºå¯ç»´æŠ¤ã€å¯æ‰©å±•ã€é«˜æ€§èƒ½çš„ä¼ä¸šçº§å‰ç«¯åº”ç”¨ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ¨¡å—æ‡’åŠ è½½å®ç°">æ¨¡å—æ‡’åŠ è½½å®ç°</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ¨¡å—æ‡’åŠ è½½å®ç°"><a class="header" href="#æ¨¡å—æ‡’åŠ è½½å®ç°">æ¨¡å—æ‡’åŠ è½½å®ç°</a></h1>
<p>æœ¬ç« å°†æ·±å…¥æ¢è®¨JavaScriptæ¨¡å—æ‡’åŠ è½½çš„å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä»£ç åˆ†å‰²ã€åŠ¨æ€å¯¼å…¥ã€é¢„åŠ è½½ç­–ç•¥å’Œæ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚</p>
<h2 id="æ‡’åŠ è½½æ¦‚è¿°"><a class="header" href="#æ‡’åŠ è½½æ¦‚è¿°">æ‡’åŠ è½½æ¦‚è¿°</a></h2>
<h3 id="ä»€ä¹ˆæ˜¯æ‡’åŠ è½½"><a class="header" href="#ä»€ä¹ˆæ˜¯æ‡’åŠ è½½">ä»€ä¹ˆæ˜¯æ‡’åŠ è½½</a></h3>
<p>æ‡’åŠ è½½ï¼ˆLazy Loadingï¼‰æ˜¯ä¸€ç§ä¼˜åŒ–ç­–ç•¥ï¼Œå°†èµ„æºçš„åŠ è½½æ¨è¿Ÿåˆ°å®é™…éœ€è¦æ—¶æ‰è¿›è¡Œã€‚åœ¨æ¨¡å—åŒ–å¼€å‘ä¸­ï¼Œæ‡’åŠ è½½å¯ä»¥ï¼š</p>
<ul>
<li>å‡å°‘åˆå§‹åŠ è½½æ—¶é—´</li>
<li>é™ä½å†…å­˜å ç”¨</li>
<li>æŒ‰éœ€åŠ è½½åŠŸèƒ½æ¨¡å—</li>
<li>æ”¹å–„ç”¨æˆ·ä½“éªŒ</li>
</ul>
<h3 id="æ‡’åŠ è½½çš„åº”ç”¨åœºæ™¯"><a class="header" href="#æ‡’åŠ è½½çš„åº”ç”¨åœºæ™¯">æ‡’åŠ è½½çš„åº”ç”¨åœºæ™¯</a></h3>
<ol>
<li><strong>è·¯ç”±çº§åˆ«</strong>ï¼šé¡µé¢è·¯ç”±æŒ‰éœ€åŠ è½½</li>
<li><strong>ç»„ä»¶çº§åˆ«</strong>ï¼šå¤æ‚ç»„ä»¶å»¶è¿ŸåŠ è½½</li>
<li><strong>åŠŸèƒ½æ¨¡å—</strong>ï¼šå¯é€‰åŠŸèƒ½çš„åŠ¨æ€åŠ è½½</li>
<li><strong>ç¬¬ä¸‰æ–¹åº“</strong>ï¼šå¤§å‹ä¾èµ–çš„å»¶è¿Ÿå¼•å…¥</li>
</ol>
<h2 id="åŸºç¡€å®ç°æ–¹æ¡ˆ"><a class="header" href="#åŸºç¡€å®ç°æ–¹æ¡ˆ">åŸºç¡€å®ç°æ–¹æ¡ˆ</a></h2>
<h3 id="1-åŠ¨æ€å¯¼å…¥åŸºç¡€"><a class="header" href="#1-åŠ¨æ€å¯¼å…¥åŸºç¡€">1. åŠ¨æ€å¯¼å…¥åŸºç¡€</a></h3>
<pre><code class="language-javascript">// ä¼ ç»Ÿçš„é™æ€å¯¼å…¥
import { heavyFunction } from './heavy-module.js';

// åŠ¨æ€å¯¼å…¥ - è¿”å›Promise
const loadHeavyModule = async () =&gt; {
  const { heavyFunction } = await import('./heavy-module.js');
  return heavyFunction;
};

// ä½¿ç”¨ç¤ºä¾‹
async function handleClick() {
  const heavyFunction = await loadHeavyModule();
  const result = heavyFunction(data);
  console.log(result);
}
</code></pre>
<h3 id="2-æ¡ä»¶æ‡’åŠ è½½"><a class="header" href="#2-æ¡ä»¶æ‡’åŠ è½½">2. æ¡ä»¶æ‡’åŠ è½½</a></h3>
<pre><code class="language-javascript">// åŸºäºæ¡ä»¶çš„æ‡’åŠ è½½
class FeatureManager {
  private loadedModules = new Map();

  async loadFeature(featureName: string, condition: boolean) {
    if (!condition) return null;
    
    if (this.loadedModules.has(featureName)) {
      return this.loadedModules.get(featureName);
    }

    let module;
    switch (featureName) {
      case 'charts':
        module = await import('./features/charts.js');
        break;
      case 'editor':
        module = await import('./features/editor.js');
        break;
      case 'analytics':
        module = await import('./features/analytics.js');
        break;
      default:
        throw new Error(`Unknown feature: ${featureName}`);
    }

    this.loadedModules.set(featureName, module);
    return module;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const featureManager = new FeatureManager();

// åŸºäºç”¨æˆ·æƒé™åŠ è½½åŠŸèƒ½
if (user.hasPermission('analytics')) {
  const analytics = await featureManager.loadFeature('analytics', true);
  analytics.initialize();
}
</code></pre>
<h2 id="reactä¸­çš„æ‡’åŠ è½½"><a class="header" href="#reactä¸­çš„æ‡’åŠ è½½">Reactä¸­çš„æ‡’åŠ è½½</a></h2>
<h3 id="1-ç»„ä»¶æ‡’åŠ è½½"><a class="header" href="#1-ç»„ä»¶æ‡’åŠ è½½">1. ç»„ä»¶æ‡’åŠ è½½</a></h3>
<pre><code class="language-jsx">// React.lazy åŸºç¡€ç”¨æ³•
import React, { Suspense, lazy } from 'react';

// æ‡’åŠ è½½ç»„ä»¶
const LazyComponent = lazy(() =&gt; import('./HeavyComponent'));
const LazyModal = lazy(() =&gt; import('./Modal'));

function App() {
  const [showModal, setShowModal] = useState(false);

  return (
    &lt;div&gt;
      &lt;Suspense fallback={&lt;div&gt;Loading component...&lt;/div&gt;}&gt;
        &lt;LazyComponent /&gt;
      &lt;/Suspense&gt;
      
      {showModal &amp;&amp; (
        &lt;Suspense fallback={&lt;div&gt;Loading modal...&lt;/div&gt;}&gt;
          &lt;LazyModal onClose={() =&gt; setShowModal(false)} /&gt;
        &lt;/Suspense&gt;
      )}
    &lt;/div&gt;
  );
}
</code></pre>
<h3 id="2-é«˜çº§æ‡’åŠ è½½hook"><a class="header" href="#2-é«˜çº§æ‡’åŠ è½½hook">2. é«˜çº§æ‡’åŠ è½½Hook</a></h3>
<pre><code class="language-typescript">// useLazyComponent Hook
import { useState, useCallback, ComponentType } from 'react';

type LazyComponentLoader&lt;T = {}&gt; = () =&gt; Promise&lt;{ default: ComponentType&lt;T&gt; }&gt;;

interface UseLazyComponentReturn&lt;T&gt; {
  LazyComponent: ComponentType&lt;T&gt; | null;
  loading: boolean;
  error: Error | null;
  loadComponent: () =&gt; Promise&lt;void&gt;;
}

function useLazyComponent&lt;T = {}&gt;(
  loader: LazyComponentLoader&lt;T&gt;
): UseLazyComponentReturn&lt;T&gt; {
  const [LazyComponent, setLazyComponent] = useState&lt;ComponentType&lt;T&gt; | null&gt;(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState&lt;Error | null&gt;(null);

  const loadComponent = useCallback(async () =&gt; {
    if (LazyComponent) return; // å·²åŠ è½½

    setLoading(true);
    setError(null);

    try {
      const module = await loader();
      setLazyComponent(() =&gt; module.default);
    } catch (err) {
      setError(err as Error);
    } finally {
      setLoading(false);
    }
  }, [loader, LazyComponent]);

  return { LazyComponent, loading, error, loadComponent };
}

// ä½¿ç”¨ç¤ºä¾‹
function FeaturePage() {
  const { 
    LazyComponent: ChartComponent, 
    loading, 
    error, 
    loadComponent 
  } = useLazyComponent(() =&gt; import('./ChartComponent'));

  return (
    &lt;div&gt;
      &lt;button onClick={loadComponent}&gt;
        Load Chart Component
      &lt;/button&gt;
      
      {loading &amp;&amp; &lt;div&gt;Loading chart...&lt;/div&gt;}
      {error &amp;&amp; &lt;div&gt;Error loading chart: {error.message}&lt;/div&gt;}
      {ChartComponent &amp;&amp; &lt;ChartComponent data={data} /&gt;}
    &lt;/div&gt;
  );
}
</code></pre>
<h3 id="3-è·¯ç”±æ‡’åŠ è½½"><a class="header" href="#3-è·¯ç”±æ‡’åŠ è½½">3. è·¯ç”±æ‡’åŠ è½½</a></h3>
<pre><code class="language-jsx">// React Routeræ‡’åŠ è½½
import { Routes, Route } from 'react-router-dom';
import { lazy, Suspense } from 'react';

// æ‡’åŠ è½½é¡µé¢ç»„ä»¶
const HomePage = lazy(() =&gt; import('./pages/HomePage'));
const AboutPage = lazy(() =&gt; import('./pages/AboutPage'));
const ProfilePage = lazy(() =&gt; import('./pages/ProfilePage'));
const AdminPage = lazy(() =&gt; import('./pages/AdminPage'));

// åŠ è½½æç¤ºç»„ä»¶
function PageLoader() {
  return (
    &lt;div className="page-loader"&gt;
      &lt;div className="spinner" /&gt;
      &lt;p&gt;Loading page...&lt;/p&gt;
    &lt;/div&gt;
  );
}

function AppRouter() {
  return (
    &lt;Suspense fallback={&lt;PageLoader /&gt;}&gt;
      &lt;Routes&gt;
        &lt;Route path="/" element={&lt;HomePage /&gt;} /&gt;
        &lt;Route path="/about" element={&lt;AboutPage /&gt;} /&gt;
        &lt;Route path="/profile" element={&lt;ProfilePage /&gt;} /&gt;
        &lt;Route path="/admin" element={&lt;AdminPage /&gt;} /&gt;
      &lt;/Routes&gt;
    &lt;/Suspense&gt;
  );
}
</code></pre>
<h2 id="é«˜çº§æ‡’åŠ è½½ç­–ç•¥"><a class="header" href="#é«˜çº§æ‡’åŠ è½½ç­–ç•¥">é«˜çº§æ‡’åŠ è½½ç­–ç•¥</a></h2>
<h3 id="1-é¢„åŠ è½½ç­–ç•¥"><a class="header" href="#1-é¢„åŠ è½½ç­–ç•¥">1. é¢„åŠ è½½ç­–ç•¥</a></h3>
<pre><code class="language-typescript">// æ™ºèƒ½é¢„åŠ è½½ç®¡ç†å™¨
class PreloadManager {
  private preloadCache = new Map&lt;string, Promise&lt;any&gt;&gt;();
  private priorityQueue: string[] = [];

  // é¢„åŠ è½½èµ„æº
  preload(modulePath: string, priority: 'high' | 'low' = 'low'): Promise&lt;any&gt; {
    if (this.preloadCache.has(modulePath)) {
      return this.preloadCache.get(modulePath)!;
    }

    const promise = import(modulePath);
    this.preloadCache.set(modulePath, promise);

    if (priority === 'high') {
      this.priorityQueue.unshift(modulePath);
    } else {
      this.priorityQueue.push(modulePath);
    }

    return promise;
  }

  // åœ¨ç©ºé—²æ—¶é—´é¢„åŠ è½½
  preloadOnIdle(modules: string[]): void {
    if ('requestIdleCallback' in window) {
      window.requestIdleCallback(() =&gt; {
        modules.forEach(module =&gt; this.preload(module, 'low'));
      });
    } else {
      // é™çº§æ–¹æ¡ˆ
      setTimeout(() =&gt; {
        modules.forEach(module =&gt; this.preload(module, 'low'));
      }, 100);
    }
  }

  // åŸºäºç”¨æˆ·äº¤äº’é¢„åŠ è½½
  preloadOnHover(element: HTMLElement, modulePath: string): void {
    element.addEventListener('mouseenter', () =&gt; {
      this.preload(modulePath, 'high');
    }, { once: true });
  }

  // åŸºäºç½‘ç»œçŠ¶æ€çš„æ™ºèƒ½é¢„åŠ è½½
  smartPreload(modules: string[]): void {
    if ('connection' in navigator) {
      const connection = (navigator as any).connection;
      
      // å¿«é€Ÿç½‘ç»œè¿æ¥æ—¶é¢„åŠ è½½æ›´å¤š
      if (connection.effectiveType === '4g') {
        modules.forEach(module =&gt; this.preload(module));
      } else if (connection.effectiveType === '3g') {
        // 3Gç½‘ç»œåªé¢„åŠ è½½é«˜ä¼˜å…ˆçº§æ¨¡å—
        modules.slice(0, 2).forEach(module =&gt; this.preload(module));
      }
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const preloadManager = new PreloadManager();

// é¡µé¢åŠ è½½åé¢„åŠ è½½ä¸‹ä¸€å¯èƒ½è®¿é—®çš„é¡µé¢
useEffect(() =&gt; {
  preloadManager.preloadOnIdle([
    './pages/ProfilePage',
    './pages/SettingsPage'
  ]);
}, []);

// æ‚¬åœæ—¶é¢„åŠ è½½
useEffect(() =&gt; {
  const profileLink = document.querySelector('[data-route="/profile"]');
  if (profileLink) {
    preloadManager.preloadOnHover(profileLink, './pages/ProfilePage');
  }
}, []);
</code></pre>
<h3 id="2-æ¸è¿›å¼åŠ è½½"><a class="header" href="#2-æ¸è¿›å¼åŠ è½½">2. æ¸è¿›å¼åŠ è½½</a></h3>
<pre><code class="language-typescript">// æ¸è¿›å¼æ¨¡å—åŠ è½½å™¨
class ProgressiveLoader {
  async loadModuleProgressively&lt;T&gt;(
    modulePath: string,
    onProgress?: (progress: number) =&gt; void
  ): Promise&lt;T&gt; {
    // æ¨¡æ‹ŸåŠ è½½è¿›åº¦ï¼ˆå®é™…ä¸­å¯èƒ½éœ€è¦è‡ªå®šä¹‰åŠ è½½å™¨ï¼‰
    const steps = [
      { progress: 0.2, message: 'Downloading module...' },
      { progress: 0.5, message: 'Parsing module...' },
      { progress: 0.8, message: 'Initializing...' },
      { progress: 1.0, message: 'Complete!' }
    ];

    for (const step of steps) {
      await this.delay(100); // æ¨¡æ‹ŸåŠ è½½æ—¶é—´
      onProgress?.(step.progress);
    }

    return import(modulePath);
  }

  private delay(ms: number): Promise&lt;void&gt; {
    return new Promise(resolve =&gt; setTimeout(resolve, ms));
  }
}

// ä½¿ç”¨ç¤ºä¾‹
function ProgressiveLoadingComponent() {
  const [progress, setProgress] = useState(0);
  const [module, setModule] = useState(null);

  const loadModule = async () =&gt; {
    const loader = new ProgressiveLoader();
    const loadedModule = await loader.loadModuleProgressively(
      './heavy-module.js',
      setProgress
    );
    setModule(loadedModule);
  };

  return (
    &lt;div&gt;
      {progress &lt; 1 &amp;&amp; (
        &lt;div className="progress-bar"&gt;
          &lt;div 
            className="progress-fill" 
            style={{ width: `${progress * 100}%` }}
          /&gt;
          &lt;span&gt;{Math.round(progress * 100)}%&lt;/span&gt;
        &lt;/div&gt;
      )}
      {module &amp;&amp; &lt;div&gt;Module loaded successfully!&lt;/div&gt;}
    &lt;/div&gt;
  );
}
</code></pre>
<h3 id="3-ç¼“å­˜ä¼˜åŒ–"><a class="header" href="#3-ç¼“å­˜ä¼˜åŒ–">3. ç¼“å­˜ä¼˜åŒ–</a></h3>
<pre><code class="language-typescript">// æ¨¡å—ç¼“å­˜ç®¡ç†å™¨
class ModuleCacheManager {
  private cache = new Map&lt;string, any&gt;();
  private metadata = new Map&lt;string, { 
    lastAccessed: number; 
    accessCount: number; 
    size: number 
  }&gt;();

  async getModule&lt;T&gt;(modulePath: string): Promise&lt;T&gt; {
    // æ£€æŸ¥ç¼“å­˜
    if (this.cache.has(modulePath)) {
      this.updateMetadata(modulePath);
      return this.cache.get(modulePath);
    }

    // åŠ è½½æ¨¡å—
    const module = await import(modulePath);
    
    // ç¼“å­˜æ¨¡å—
    this.cache.set(modulePath, module);
    this.metadata.set(modulePath, {
      lastAccessed: Date.now(),
      accessCount: 1,
      size: this.estimateSize(module)
    });

    // æ£€æŸ¥ç¼“å­˜å¤§å°é™åˆ¶
    this.evictIfNecessary();

    return module;
  }

  private updateMetadata(modulePath: string): void {
    const meta = this.metadata.get(modulePath);
    if (meta) {
      meta.lastAccessed = Date.now();
      meta.accessCount++;
    }
  }

  private estimateSize(module: any): number {
    // ç®€å•çš„å¤§å°ä¼°ç®—
    return JSON.stringify(module).length;
  }

  private evictIfNecessary(): void {
    const maxCacheSize = 10 * 1024 * 1024; // 10MB
    let currentSize = 0;

    for (const [, meta] of this.metadata) {
      currentSize += meta.size;
    }

    if (currentSize &gt; maxCacheSize) {
      // LRUæ·˜æ±°ç­–ç•¥
      const entries = Array.from(this.metadata.entries())
        .sort(([, a], [, b]) =&gt; a.lastAccessed - b.lastAccessed);

      const toEvict = entries.slice(0, Math.ceil(entries.length * 0.2));
      for (const [modulePath] of toEvict) {
        this.cache.delete(modulePath);
        this.metadata.delete(modulePath);
      }
    }
  }

  // é¢„çƒ­ç¼“å­˜
  async warmUp(modulePaths: string[]): Promise&lt;void&gt; {
    const promises = modulePaths.map(path =&gt; this.getModule(path));
    await Promise.allSettled(promises);
  }

  // æ¸…ç†ç¼“å­˜
  clear(): void {
    this.cache.clear();
    this.metadata.clear();
  }
}

// å…¨å±€ç¼“å­˜å®ä¾‹
export const moduleCache = new ModuleCacheManager();
</code></pre>
<h2 id="æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ–"><a class="header" href="#æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ–">æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ–</a></h2>
<h3 id="1-åŠ è½½æ€§èƒ½ç›‘æ§"><a class="header" href="#1-åŠ è½½æ€§èƒ½ç›‘æ§">1. åŠ è½½æ€§èƒ½ç›‘æ§</a></h3>
<pre><code class="language-typescript">// æ¨¡å—åŠ è½½æ€§èƒ½ç›‘æ§
class ModulePerformanceMonitor {
  private metrics = new Map&lt;string, {
    loadTime: number;
    loadCount: number;
    errors: number;
    averageLoadTime: number;
  }&gt;();

  async monitorLoad&lt;T&gt;(modulePath: string, loader: () =&gt; Promise&lt;T&gt;): Promise&lt;T&gt; {
    const startTime = performance.now();
    
    try {
      const result = await loader();
      const loadTime = performance.now() - startTime;
      
      this.recordSuccess(modulePath, loadTime);
      return result;
    } catch (error) {
      this.recordError(modulePath);
      throw error;
    }
  }

  private recordSuccess(modulePath: string, loadTime: number): void {
    const existing = this.metrics.get(modulePath);
    
    if (existing) {
      existing.loadCount++;
      existing.averageLoadTime = (existing.averageLoadTime * (existing.loadCount - 1) + loadTime) / existing.loadCount;
    } else {
      this.metrics.set(modulePath, {
        loadTime,
        loadCount: 1,
        errors: 0,
        averageLoadTime: loadTime
      });
    }
  }

  private recordError(modulePath: string): void {
    const existing = this.metrics.get(modulePath);
    if (existing) {
      existing.errors++;
    } else {
      this.metrics.set(modulePath, {
        loadTime: 0,
        loadCount: 0,
        errors: 1,
        averageLoadTime: 0
      });
    }
  }

  getReport(): Record&lt;string, any&gt; {
    const report: Record&lt;string, any&gt; = {};
    
    for (const [modulePath, metrics] of this.metrics) {
      report[modulePath] = {
        ...metrics,
        successRate: metrics.loadCount / (metrics.loadCount + metrics.errors)
      };
    }
    
    return report;
  }

  // æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆ
  getSlowModules(threshold: number = 1000): string[] {
    return Array.from(this.metrics.entries())
      .filter(([, metrics]) =&gt; metrics.averageLoadTime &gt; threshold)
      .map(([modulePath]) =&gt; modulePath);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const monitor = new ModulePerformanceMonitor();

async function loadModuleWithMonitoring(modulePath: string) {
  return monitor.monitorLoad(modulePath, () =&gt; import(modulePath));
}
</code></pre>
<h3 id="2-è‡ªé€‚åº”åŠ è½½ç­–ç•¥"><a class="header" href="#2-è‡ªé€‚åº”åŠ è½½ç­–ç•¥">2. è‡ªé€‚åº”åŠ è½½ç­–ç•¥</a></h3>
<pre><code class="language-typescript">// è‡ªé€‚åº”æ¨¡å—åŠ è½½å™¨
class AdaptiveModuleLoader {
  private networkSpeed: 'slow' | 'medium' | 'fast' = 'medium';
  private userEngagement: 'low' | 'medium' | 'high' = 'medium';

  constructor() {
    this.detectNetworkSpeed();
    this.trackUserEngagement();
  }

  async loadModule&lt;T&gt;(
    modulePath: string, 
    options: {
      priority?: 'low' | 'medium' | 'high';
      fallback?: () =&gt; Promise&lt;T&gt;;
    } = {}
  ): Promise&lt;T&gt; {
    const strategy = this.getLoadingStrategy(options.priority);
    
    try {
      switch (strategy) {
        case 'immediate':
          return await import(modulePath);
          
        case 'deferred':
          await this.delay(500); // å»¶è¿ŸåŠ è½½
          return await import(modulePath);
          
        case 'conditional':
          if (this.shouldLoadModule()) {
            return await import(modulePath);
          } else if (options.fallback) {
            return await options.fallback();
          }
          throw new Error('Module loading skipped');
          
        default:
          return await import(modulePath);
      }
    } catch (error) {
      if (options.fallback) {
        return await options.fallback();
      }
      throw error;
    }
  }

  private getLoadingStrategy(priority?: 'low' | 'medium' | 'high'): 'immediate' | 'deferred' | 'conditional' {
    // é«˜ä¼˜å…ˆçº§æ¨¡å—ç«‹å³åŠ è½½
    if (priority === 'high') return 'immediate';
    
    // æ…¢ç½‘ç»œä¸‹å»¶è¿ŸåŠ è½½ä½ä¼˜å…ˆçº§æ¨¡å—
    if (this.networkSpeed === 'slow' &amp;&amp; priority === 'low') {
      return 'conditional';
    }
    
    // ä½å‚ä¸åº¦ç”¨æˆ·å»¶è¿ŸåŠ è½½
    if (this.userEngagement === 'low') {
      return 'deferred';
    }
    
    return 'immediate';
  }

  private detectNetworkSpeed(): void {
    if ('connection' in navigator) {
      const connection = (navigator as any).connection;
      const effectiveType = connection.effectiveType;
      
      if (effectiveType === '4g') {
        this.networkSpeed = 'fast';
      } else if (effectiveType === '3g') {
        this.networkSpeed = 'medium';
      } else {
        this.networkSpeed = 'slow';
      }
    }
  }

  private trackUserEngagement(): void {
    let interactionCount = 0;
    const startTime = Date.now();

    ['click', 'keydown', 'scroll'].forEach(event =&gt; {
      document.addEventListener(event, () =&gt; {
        interactionCount++;
      });
    });

    // 5ç§’åè¯„ä¼°ç”¨æˆ·å‚ä¸åº¦
    setTimeout(() =&gt; {
      const timeSpent = Date.now() - startTime;
      const engagementScore = interactionCount / (timeSpent / 1000);
      
      if (engagementScore &gt; 2) {
        this.userEngagement = 'high';
      } else if (engagementScore &gt; 0.5) {
        this.userEngagement = 'medium';
      } else {
        this.userEngagement = 'low';
      }
    }, 5000);
  }

  private shouldLoadModule(): boolean {
    return this.networkSpeed !== 'slow' &amp;&amp; this.userEngagement !== 'low';
  }

  private delay(ms: number): Promise&lt;void&gt; {
    return new Promise(resolve =&gt; setTimeout(resolve, ms));
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const adaptiveLoader = new AdaptiveModuleLoader();

// é«˜ä¼˜å…ˆçº§æ¨¡å—ï¼ˆç«‹å³åŠ è½½ï¼‰
const criticalModule = await adaptiveLoader.loadModule('./critical-module.js', {
  priority: 'high'
});

// ä½ä¼˜å…ˆçº§æ¨¡å—ï¼ˆå¯èƒ½å»¶è¿Ÿæˆ–è·³è¿‡ï¼‰
const optionalModule = await adaptiveLoader.loadModule('./optional-module.js', {
  priority: 'low',
  fallback: () =&gt; Promise.resolve({ default: () =&gt; 'Fallback content' })
});
</code></pre>
<h2 id="æ„å»ºå·¥å…·é›†æˆ-2"><a class="header" href="#æ„å»ºå·¥å…·é›†æˆ-2">æ„å»ºå·¥å…·é›†æˆ</a></h2>
<h3 id="1-webpackä»£ç åˆ†å‰²"><a class="header" href="#1-webpackä»£ç åˆ†å‰²">1. Webpackä»£ç åˆ†å‰²</a></h3>
<pre><code class="language-javascript">// webpack.config.js
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        // ä¾›åº”å•†ä»£ç åˆ†å‰²
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
        // å¼‚æ­¥ä»£ç åˆ†å‰²
        async: {
          chunks: 'async',
          minSize: 30000,
          maxSize: 244000,
        },
        // å…¬å…±ä»£ç åˆ†å‰²
        common: {
          name: 'common',
          minChunks: 2,
          chunks: 'all',
          enforce: true
        }
      }
    }
  },
  
  // åŠ¨æ€å¯¼å…¥æ”¯æŒ
  plugins: [
    new webpack.optimize.SplitChunksPlugin({
      chunks: 'async',
      name: (module, chunks, cacheGroupKey) =&gt; {
        const moduleFileName = module
          .identifier()
          .split('/')
          .reduceRight(item =&gt; item);
        return `${cacheGroupKey}-${moduleFileName}`;
      }
    })
  ]
};
</code></pre>
<h3 id="2-rollupæ‡’åŠ è½½é…ç½®"><a class="header" href="#2-rollupæ‡’åŠ è½½é…ç½®">2. Rollupæ‡’åŠ è½½é…ç½®</a></h3>
<pre><code class="language-javascript">// rollup.config.js
export default {
  input: 'src/main.js',
  output: {
    dir: 'dist',
    format: 'es',
    // åŠ¨æ€å¯¼å…¥ä½œä¸ºå•ç‹¬çš„chunk
    chunkFileNames: 'chunks/[name]-[hash].js'
  },
  plugins: [
    // ä»£ç åˆ†å‰²æ’ä»¶
    resolve(),
    commonjs(),
    // è‡ªå®šä¹‰åŠ¨æ€å¯¼å…¥å¤„ç†
    {
      name: 'dynamic-import-handler',
      generateBundle(options, bundle) {
        // å¤„ç†åŠ¨æ€å¯¼å…¥çš„chunk
        Object.keys(bundle).forEach(fileName =&gt; {
          const chunk = bundle[fileName];
          if (chunk.type === 'chunk' &amp;&amp; chunk.isDynamicEntry) {
            // æ·»åŠ é¢„åŠ è½½æç¤º
            chunk.code = `/* webpackPreload: true */ ${chunk.code}`;
          }
        });
      }
    }
  ]
};
</code></pre>
<h2 id="å®é™…åº”ç”¨æ¡ˆä¾‹"><a class="header" href="#å®é™…åº”ç”¨æ¡ˆä¾‹">å®é™…åº”ç”¨æ¡ˆä¾‹</a></h2>
<h3 id="1-ç”µå•†ç½‘ç«™çš„æ‡’åŠ è½½ç­–ç•¥"><a class="header" href="#1-ç”µå•†ç½‘ç«™çš„æ‡’åŠ è½½ç­–ç•¥">1. ç”µå•†ç½‘ç«™çš„æ‡’åŠ è½½ç­–ç•¥</a></h3>
<pre><code class="language-typescript">// ç”µå•†ç½‘ç«™æ¨¡å—æ‡’åŠ è½½æ–¹æ¡ˆ
class EcommerceModuleLoader {
  private moduleCache = new Map();

  // å•†å“åˆ—è¡¨é¡µé¢çš„æ‡’åŠ è½½
  async loadProductCatalog() {
    const modules = await Promise.allSettled([
      import('./components/ProductGrid'),
      import('./components/FilterPanel'),
      import('./components/SortDropdown')
    ]);

    return {
      ProductGrid: modules[0].status === 'fulfilled' ? modules[0].value.default : null,
      FilterPanel: modules[1].status === 'fulfilled' ? modules[1].value.default : null,
      SortDropdown: modules[2].status === 'fulfilled' ? modules[2].value.default : null
    };
  }

  // è´­ç‰©è½¦ç›¸å…³åŠŸèƒ½çš„æ‡’åŠ è½½
  async loadCartFeatures() {
    return import('./features/cart').then(module =&gt; ({
      Cart: module.Cart,
      CartItem: module.CartItem,
      CartSummary: module.CartSummary,
      useCart: module.useCart
    }));
  }

  // æ”¯ä»˜æµç¨‹çš„æ‡’åŠ è½½
  async loadPaymentFlow(paymentMethod: string) {
    switch (paymentMethod) {
      case 'stripe':
        return import('./payment/StripePayment');
      case 'paypal':
        return import('./payment/PayPalPayment');
      case 'alipay':
        return import('./payment/AlipayPayment');
      default:
        return import('./payment/DefaultPayment');
    }
  }

  // ç®¡ç†åå°åŠŸèƒ½çš„æ‡’åŠ è½½
  async loadAdminFeatures(userRole: string) {
    if (userRole !== 'admin') return null;

    const [
      { AdminDashboard },
      { ProductManager },
      { OrderManager },
      { UserManager }
    ] = await Promise.all([
      import('./admin/Dashboard'),
      import('./admin/ProductManager'),
      import('./admin/OrderManager'),
      import('./admin/UserManager')
    ]);

    return {
      AdminDashboard,
      ProductManager,
      OrderManager,
      UserManager
    };
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const moduleLoader = new EcommerceModuleLoader();

// é¡µé¢çº§åˆ«çš„æ‡’åŠ è½½
function ProductPage() {
  const [modules, setModules] = useState(null);

  useEffect(() =&gt; {
    moduleLoader.loadProductCatalog().then(setModules);
  }, []);

  if (!modules) return &lt;div&gt;Loading...&lt;/div&gt;;

  return (
    &lt;div&gt;
      {modules.ProductGrid &amp;&amp; &lt;modules.ProductGrid /&gt;}
      {modules.FilterPanel &amp;&amp; &lt;modules.FilterPanel /&gt;}
      {modules.SortDropdown &amp;&amp; &lt;modules.SortDropdown /&gt;}
    &lt;/div&gt;
  );
}
</code></pre>
<h3 id="2-å¤šè¯­è¨€ç½‘ç«™çš„æ‡’åŠ è½½"><a class="header" href="#2-å¤šè¯­è¨€ç½‘ç«™çš„æ‡’åŠ è½½">2. å¤šè¯­è¨€ç½‘ç«™çš„æ‡’åŠ è½½</a></h3>
<pre><code class="language-typescript">// å¤šè¯­è¨€èµ„æºæ‡’åŠ è½½
class I18nLazyLoader {
  private loadedLanguages = new Set&lt;string&gt;();
  private languageCache = new Map&lt;string, any&gt;();

  async loadLanguage(locale: string): Promise&lt;any&gt; {
    // æ£€æŸ¥ç¼“å­˜
    if (this.languageCache.has(locale)) {
      return this.languageCache.get(locale);
    }

    // æ£€æŸ¥æ˜¯å¦å·²åœ¨åŠ è½½ä¸­
    if (this.loadedLanguages.has(locale)) {
      return new Promise(resolve =&gt; {
        const checkCache = () =&gt; {
          if (this.languageCache.has(locale)) {
            resolve(this.languageCache.get(locale));
          } else {
            setTimeout(checkCache, 50);
          }
        };
        checkCache();
      });
    }

    this.loadedLanguages.add(locale);

    try {
      // åŠ¨æ€åŠ è½½è¯­è¨€åŒ…
      const translations = await import(`./locales/${locale}.json`);
      this.languageCache.set(locale, translations.default);
      return translations.default;
    } catch (error) {
      // é™çº§åˆ°è‹±è¯­
      if (locale !== 'en') {
        return this.loadLanguage('en');
      }
      throw error;
    }
  }

  // é¢„åŠ è½½ç”¨æˆ·å¯èƒ½éœ€è¦çš„è¯­è¨€
  async preloadLanguages(preferredLanguages: string[]): Promise&lt;void&gt; {
    const promises = preferredLanguages.map(lang =&gt; 
      this.loadLanguage(lang).catch(() =&gt; null) // å¿½ç•¥åŠ è½½å¤±è´¥
    );
    await Promise.allSettled(promises);
  }

  // æ™ºèƒ½è¯­è¨€åˆ‡æ¢
  async switchLanguage(locale: string): Promise&lt;any&gt; {
    const translations = await this.loadLanguage(locale);
    
    // æ›´æ–°é¡µé¢è¯­è¨€
    document.documentElement.lang = locale;
    
    // è§¦å‘è¯­è¨€æ›´æ–°äº‹ä»¶
    window.dispatchEvent(new CustomEvent('languageChanged', {
      detail: { locale, translations }
    }));

    return translations;
  }
}

// React Hook for i18n lazy loading
function useI18nLazy(locale: string) {
  const [translations, setTranslations] = useState(null);
  const [loading, setLoading] = useState(false);
  const loader = useRef(new I18nLazyLoader());

  useEffect(() =&gt; {
    setLoading(true);
    loader.current.loadLanguage(locale)
      .then(setTranslations)
      .finally(() =&gt; setLoading(false));
  }, [locale]);

  const switchLanguage = useCallback((newLocale: string) =&gt; {
    return loader.current.switchLanguage(newLocale);
  }, []);

  return { translations, loading, switchLanguage };
}
</code></pre>
<h2 id="æœ€ä½³å®è·µæ€»ç»“-6"><a class="header" href="#æœ€ä½³å®è·µæ€»ç»“-6">æœ€ä½³å®è·µæ€»ç»“</a></h2>
<h3 id="1-æ‡’åŠ è½½ç­–ç•¥é€‰æ‹©"><a class="header" href="#1-æ‡’åŠ è½½ç­–ç•¥é€‰æ‹©">1. æ‡’åŠ è½½ç­–ç•¥é€‰æ‹©</a></h3>
<ul>
<li><strong>è·¯ç”±çº§åˆ«</strong>ï¼šé€‚åˆé¡µé¢è¾ƒå¤šçš„åº”ç”¨</li>
<li><strong>ç»„ä»¶çº§åˆ«</strong>ï¼šé€‚åˆå¤æ‚çš„äº¤äº’ç»„ä»¶</li>
<li><strong>åŠŸèƒ½çº§åˆ«</strong>ï¼šé€‚åˆå¯é€‰åŠŸèƒ½æ¨¡å—</li>
<li><strong>èµ„æºçº§åˆ«</strong>ï¼šé€‚åˆå¤§å‹ä¾èµ–åº“</li>
</ul>
<h3 id="2-æ€§èƒ½ä¼˜åŒ–æŠ€å·§"><a class="header" href="#2-æ€§èƒ½ä¼˜åŒ–æŠ€å·§">2. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</a></h3>
<ul>
<li><strong>é¢„åŠ è½½</strong>ï¼šåŸºäºç”¨æˆ·è¡Œä¸ºé¢„æµ‹éœ€è¦çš„æ¨¡å—</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šåˆç†ä½¿ç”¨å†…å­˜å’ŒæŒä¹…åŒ–ç¼“å­˜</li>
<li><strong>é™çº§æ–¹æ¡ˆ</strong>ï¼šæä¾›åŠ è½½å¤±è´¥æ—¶çš„å¤‡é€‰æ–¹æ¡ˆ</li>
<li><strong>ç›‘æ§æŒ‡æ ‡</strong>ï¼šè·Ÿè¸ªåŠ è½½æ€§èƒ½å’ŒæˆåŠŸç‡</li>
</ul>
<h3 id="3-ç”¨æˆ·ä½“éªŒè€ƒè™‘"><a class="header" href="#3-ç”¨æˆ·ä½“éªŒè€ƒè™‘">3. ç”¨æˆ·ä½“éªŒè€ƒè™‘</a></h3>
<ul>
<li><strong>åŠ è½½æŒ‡ç¤ºå™¨</strong>ï¼šæä¾›æ¸…æ™°çš„åŠ è½½çŠ¶æ€åé¦ˆ</li>
<li><strong>æ¸è¿›å¢å¼º</strong>ï¼šç¡®ä¿æ ¸å¿ƒåŠŸèƒ½åœ¨æ¨¡å—åŠ è½½å‰å¯ç”¨</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šä¼˜é›…å¤„ç†åŠ è½½å¤±è´¥çš„æƒ…å†µ</li>
<li><strong>æ— æ„ŸçŸ¥åˆ‡æ¢</strong>ï¼šå°½é‡å‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´</li>
</ul>
<h3 id="4-å¼€å‘å·¥å…·é›†æˆ"><a class="header" href="#4-å¼€å‘å·¥å…·é›†æˆ">4. å¼€å‘å·¥å…·é›†æˆ</a></h3>
<ul>
<li><strong>æ„å»ºä¼˜åŒ–</strong>ï¼šé…ç½®åˆé€‚çš„ä»£ç åˆ†å‰²ç­–ç•¥</li>
<li><strong>å¼€å‘è°ƒè¯•</strong>ï¼šä½¿ç”¨å¼€å‘å·¥å…·ç›‘æ§æ¨¡å—åŠ è½½</li>
<li><strong>æµ‹è¯•ç­–ç•¥</strong>ï¼šæ¨¡æ‹Ÿä¸åŒç½‘ç»œæ¡ä»¶è¿›è¡Œæµ‹è¯•</li>
<li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šå»ºç«‹å®Œå–„çš„æ€§èƒ½ç›‘æ§ä½“ç³»</li>
</ul>
<p>é€šè¿‡åˆç†åº”ç”¨è¿™äº›æ‡’åŠ è½½æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾è‘—æå‡åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶ä¿æŒä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#æ¨¡å—ç›¸å…³å·¥å…·å¯¹æ¯”">æ¨¡å—ç›¸å…³å·¥å…·å¯¹æ¯”</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="æ¨¡å—ç›¸å…³å·¥å…·å¯¹æ¯”"><a class="header" href="#æ¨¡å—ç›¸å…³å·¥å…·å¯¹æ¯”">æ¨¡å—ç›¸å…³å·¥å…·å¯¹æ¯”</a></h1>
<p>æœ¬ç« å°†å…¨é¢å¯¹æ¯”å„ç§JavaScriptæ¨¡å—åŒ–ç›¸å…³çš„å·¥å…·ï¼ŒåŒ…æ‹¬æ‰“åŒ…å·¥å…·ã€è½¬è¯‘å·¥å…·ã€è¿è¡Œæ—¶ç¯å¢ƒå’Œå¼€å‘å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„å·¥å…·é“¾ã€‚</p>
<h2 id="æ‰“åŒ…å·¥å…·å¯¹æ¯”"><a class="header" href="#æ‰“åŒ…å·¥å…·å¯¹æ¯”">æ‰“åŒ…å·¥å…·å¯¹æ¯”</a></h2>
<h3 id="ä¸»æµæ‰“åŒ…å·¥å…·æ¦‚è§ˆ"><a class="header" href="#ä¸»æµæ‰“åŒ…å·¥å…·æ¦‚è§ˆ">ä¸»æµæ‰“åŒ…å·¥å…·æ¦‚è§ˆ</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å·¥å…·</th><th>ç±»å‹</th><th>ä¸»è¦ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th><th>å­¦ä¹ æ›²çº¿</th></tr>
</thead>
<tbody>
<tr><td>Webpack</td><td>æ¨¡å—æ‰“åŒ…å™¨</td><td>åŠŸèƒ½å¼ºå¤§ã€ç”Ÿæ€ä¸°å¯Œã€é…ç½®å¤æ‚</td><td>å¤§å‹é¡¹ç›®ã€å¤æ‚éœ€æ±‚</td><td>é™¡å³­</td></tr>
<tr><td>Rollup</td><td>ESæ¨¡å—æ‰“åŒ…å™¨</td><td>ä½“ç§¯å°ã€Tree Shakingä¼˜ç§€</td><td>åº“å¼€å‘ã€ç°ä»£é¡¹ç›®</td><td>ä¸­ç­‰</td></tr>
<tr><td>Parcel</td><td>é›¶é…ç½®æ‰“åŒ…å™¨</td><td>å¼€ç®±å³ç”¨ã€è‡ªåŠ¨ä¼˜åŒ–</td><td>å¿«é€ŸåŸå‹ã€ä¸­å°é¡¹ç›®</td><td>å¹³ç¼“</td></tr>
<tr><td>Vite</td><td>ç°ä»£æ„å»ºå·¥å…·</td><td>å¿«é€Ÿå¯åŠ¨ã€HMRä¼˜ç§€</td><td>ç°ä»£å‰ç«¯é¡¹ç›®</td><td>å¹³ç¼“</td></tr>
<tr><td>esbuild</td><td>é«˜æ€§èƒ½æ‰“åŒ…å™¨</td><td>æå¿«é€Ÿåº¦ã€Goè¯­è¨€ç¼–å†™</td><td>å¼€å‘æ„å»ºã€CI/CD</td><td>ä¸­ç­‰</td></tr>
<tr><td>SWC</td><td>Rustç¼–è¯‘å™¨</td><td>æå¿«ç¼–è¯‘ã€Babelæ›¿ä»£</td><td>å¤§å‹é¡¹ç›®ç¼–è¯‘</td><td>ä¸­ç­‰</td></tr>
</tbody>
</table>
</div>
<h3 id="è¯¦ç»†å¯¹æ¯”åˆ†æ"><a class="header" href="#è¯¦ç»†å¯¹æ¯”åˆ†æ">è¯¦ç»†å¯¹æ¯”åˆ†æ</a></h3>
<h4 id="1-webpack"><a class="header" href="#1-webpack">1. Webpack</a></h4>
<pre><code class="language-javascript">// webpack.config.js - å¤æ‚ä½†å¼ºå¤§çš„é…ç½®
const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');
const MiniCssExtractPlugin = require('mini-css-extract-plugin');

module.exports = {
  entry: './src/index.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: '[name].[contenthash].js',
    clean: true
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        exclude: /node_modules/,
        use: 'babel-loader'
      },
      {
        test: /\.css$/,
        use: [MiniCssExtractPlugin.loader, 'css-loader']
      },
      {
        test: /\.(png|svg|jpg|jpeg|gif)$/i,
        type: 'asset/resource'
      }
    ]
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: './src/index.html'
    }),
    new MiniCssExtractPlugin({
      filename: '[name].[contenthash].css'
    })
  ],
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all'
        }
      }
    }
  }
};
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>ç”Ÿæ€ç³»ç»Ÿæœ€æˆç†Ÿï¼Œæ’ä»¶å’Œloaderä¸°å¯Œ</li>
<li>æ”¯æŒå„ç§èµ„æºç±»å‹ï¼ˆJSã€CSSã€å›¾ç‰‡ã€å­—ä½“ç­‰ï¼‰</li>
<li>å¼ºå¤§çš„ä»£ç åˆ†å‰²å’Œä¼˜åŒ–åŠŸèƒ½</li>
<li>å¹¿æ³›çš„ç¤¾åŒºæ”¯æŒå’Œæ–‡æ¡£</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>é…ç½®å¤æ‚ï¼Œå­¦ä¹ æ›²çº¿é™¡å³­</li>
<li>æ„å»ºé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢</li>
<li>é…ç½®æ–‡ä»¶å¯èƒ½å˜å¾—éå¸¸å¤æ‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å¤§å‹å¤æ‚é¡¹ç›®</li>
<li>éœ€è¦ç²¾ç»†æ§åˆ¶æ„å»ºè¿‡ç¨‹</li>
<li>é—ç•™é¡¹ç›®è¿ç§»</li>
</ul>
<h4 id="2-rollup"><a class="header" href="#2-rollup">2. Rollup</a></h4>
<pre><code class="language-javascript">// rollup.config.js - ç®€æ´ä¸“æ³¨çš„é…ç½®
import resolve from '@rollup/plugin-node-resolve';
import commonjs from '@rollup/plugin-commonjs';
import babel from '@rollup/plugin-babel';
import terser from '@rollup/plugin-terser';

export default {
  input: 'src/main.js',
  output: [
    {
      file: 'dist/bundle.cjs.js',
      format: 'cjs'
    },
    {
      file: 'dist/bundle.esm.js',
      format: 'es'
    },
    {
      file: 'dist/bundle.umd.js',
      format: 'umd',
      name: 'MyLibrary'
    }
  ],
  plugins: [
    resolve(),
    commonjs(),
    babel({
      babelHelpers: 'bundled',
      exclude: 'node_modules/**'
    }),
    terser()
  ],
  external: ['lodash'] // æ’é™¤å¤–éƒ¨ä¾èµ–
};
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>ä¼˜ç§€çš„Tree Shakingï¼Œç”Ÿæˆçš„åŒ…ä½“ç§¯å°</li>
<li>åŸç”Ÿæ”¯æŒESæ¨¡å—</li>
<li>é…ç½®ç›¸å¯¹ç®€å•</li>
<li>é€‚åˆåº“å¼€å‘</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>å¯¹CSSã€å›¾ç‰‡ç­‰éJSèµ„æºæ”¯æŒæœ‰é™</li>
<li>æ’ä»¶ç”Ÿæ€ç›¸æ¯”Webpackè¾ƒå°</li>
<li>ä¸é€‚åˆå¤æ‚çš„åº”ç”¨å¼€å‘</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>JavaScriptåº“å¼€å‘</li>
<li>ç°ä»£ESæ¨¡å—é¡¹ç›®</li>
<li>éœ€è¦æœ€å°åŒ–åŒ…ä½“ç§¯çš„é¡¹ç›®</li>
</ul>
<h4 id="3-vite"><a class="header" href="#3-vite">3. Vite</a></h4>
<pre><code class="language-javascript">// vite.config.js - ç°ä»£åŒ–çš„é…ç½®
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import { resolve } from 'path';

export default defineConfig({
  plugins: [vue()],
  build: {
    lib: {
      entry: resolve(__dirname, 'src/main.ts'),
      name: 'MyLib',
      fileName: 'my-lib'
    },
    rollupOptions: {
      external: ['vue'],
      output: {
        globals: {
          vue: 'Vue'
        }
      }
    }
  },
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  server: {
    hmr: true,
    port: 3000
  }
});
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>å¼€å‘æœåŠ¡å™¨å¯åŠ¨æå¿«</li>
<li>ä¼˜ç§€çš„çƒ­æ¨¡å—é‡è½½(HMR)</li>
<li>åŸºäºRollupï¼Œç”Ÿäº§æ„å»ºä¼˜åŒ–å¥½</li>
<li>å¼€ç®±å³ç”¨çš„TypeScriptæ”¯æŒ</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>ç›¸å¯¹è¾ƒæ–°ï¼Œç”Ÿæ€è¿˜åœ¨å‘å±•</li>
<li>æŸäº›å¤æ‚åœºæ™¯å¯èƒ½éœ€è¦é¢å¤–é…ç½®</li>
<li>ä¸»è¦é’ˆå¯¹ç°ä»£æµè§ˆå™¨</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>ç°ä»£å‰ç«¯é¡¹ç›®ï¼ˆVueã€Reactã€Svelteï¼‰</li>
<li>éœ€è¦å¿«é€Ÿå¼€å‘ä½“éªŒçš„é¡¹ç›®</li>
<li>TypeScripté¡¹ç›®</li>
</ul>
<h4 id="4-esbuild"><a class="header" href="#4-esbuild">4. esbuild</a></h4>
<pre><code class="language-javascript">// esbuildé…ç½® - æç®€é«˜æ•ˆ
const esbuild = require('esbuild');

esbuild.build({
  entryPoints: ['src/index.js'],
  bundle: true,
  outfile: 'dist/bundle.js',
  minify: true,
  sourcemap: true,
  target: ['es2015'],
  loader: {
    '.png': 'dataurl',
    '.svg': 'text'
  },
  define: {
    'process.env.NODE_ENV': '"production"'
  }
}).catch(() =&gt; process.exit(1));
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æ„å»ºé€Ÿåº¦æå¿«ï¼ˆGoè¯­è¨€ç¼–å†™ï¼‰</li>
<li>å†…ç½®TypeScriptæ”¯æŒ</li>
<li>é›¶é…ç½®å³å¯ä½¿ç”¨</li>
<li>ä½“ç§¯å°ï¼Œä¾èµ–å°‘</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>åŠŸèƒ½ç›¸å¯¹ç®€å•</li>
<li>æ’ä»¶ç”Ÿæ€æœ‰é™</li>
<li>ä¸æ”¯æŒæŸäº›é«˜çº§ç‰¹æ€§ï¼ˆå¦‚è£…é¥°å™¨ï¼‰</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>éœ€è¦æå¿«æ„å»ºé€Ÿåº¦çš„é¡¹ç›®</li>
<li>ç®€å•çš„æ‰“åŒ…éœ€æ±‚</li>
<li>CI/CDæµæ°´çº¿</li>
</ul>
<h3 id="æ„å»ºæ€§èƒ½å¯¹æ¯”"><a class="header" href="#æ„å»ºæ€§èƒ½å¯¹æ¯”">æ„å»ºæ€§èƒ½å¯¹æ¯”</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å·¥å…·</th><th>å†·å¯åŠ¨æ—¶é—´</th><th>çƒ­æ›´æ–°æ—¶é—´</th><th>æ„å»ºæ—¶é—´</th><th>å†…å­˜å ç”¨</th></tr>
</thead>
<tbody>
<tr><td>Webpack</td><td>10-30s</td><td>1-3s</td><td>30-120s</td><td>é«˜</td></tr>
<tr><td>Rollup</td><td>5-15s</td><td>2-5s</td><td>15-60s</td><td>ä¸­</td></tr>
<tr><td>Vite</td><td>1-3s</td><td>&lt;1s</td><td>10-40s</td><td>ä¸­</td></tr>
<tr><td>esbuild</td><td>&lt;1s</td><td>&lt;1s</td><td>5-20s</td><td>ä½</td></tr>
<tr><td>Parcel</td><td>5-20s</td><td>1-2s</td><td>20-80s</td><td>ä¸­</td></tr>
</tbody>
</table>
</div>
<p><em>æ³¨ï¼šæ—¶é—´åŸºäºä¸­ç­‰è§„æ¨¡é¡¹ç›®çš„å¤§è‡´ä¼°ç®—</em></p>
<h2 id="è½¬è¯‘å·¥å…·å¯¹æ¯”"><a class="header" href="#è½¬è¯‘å·¥å…·å¯¹æ¯”">è½¬è¯‘å·¥å…·å¯¹æ¯”</a></h2>
<h3 id="babel-vs-swc-vs-esbuild"><a class="header" href="#babel-vs-swc-vs-esbuild">Babel vs SWC vs esbuild</a></h3>
<h4 id="1-babel"><a class="header" href="#1-babel">1. Babel</a></h4>
<pre><code class="language-javascript">// babel.config.js - çµæ´»å¼ºå¤§çš„è½¬è¯‘é…ç½®
module.exports = {
  presets: [
    ['@babel/preset-env', {
      targets: {
        browsers: ['&gt; 1%', 'last 2 versions']
      },
      useBuiltIns: 'usage',
      corejs: 3
    }],
    '@babel/preset-typescript',
    '@babel/preset-react'
  ],
  plugins: [
    '@babel/plugin-proposal-class-properties',
    '@babel/plugin-proposal-decorators',
    ['@babel/plugin-transform-runtime', {
      corejs: 3,
      helpers: true,
      regenerator: true
    }]
  ]
};
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æ’ä»¶ç”Ÿæ€æœ€ä¸°å¯Œ</li>
<li>æ”¯æŒæœ€æ–°å’Œå®éªŒæ€§è¯­æ³•</li>
<li>é«˜åº¦å¯é…ç½®</li>
<li>ç¤¾åŒºæ”¯æŒæœ€å¥½</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>è½¬è¯‘é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢</li>
<li>é…ç½®å¤æ‚</li>
<li>è¾“å‡ºä»£ç å¯èƒ½å†—ä½™</li>
</ul>
<h4 id="2-swc"><a class="header" href="#2-swc">2. SWC</a></h4>
<pre><code class="language-javascript">// .swcrc - é«˜æ€§èƒ½çš„Rustè½¬è¯‘å™¨
{
  "jsc": {
    "parser": {
      "syntax": "typescript",
      "tsx": true,
      "decorators": true
    },
    "transform": {
      "react": {
        "pragma": "React.createElement",
        "pragmaFrag": "React.Fragment",
        "throwIfNamespace": true
      }
    },
    "target": "es2015"
  },
  "module": {
    "type": "es6"
  },
  "minify": true
}
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>è½¬è¯‘é€Ÿåº¦æå¿«ï¼ˆRustç¼–å†™ï¼‰</li>
<li>å†…å­˜ä½¿ç”¨æ›´å°‘</li>
<li>æ”¯æŒå¤§éƒ¨åˆ†BabelåŠŸèƒ½</li>
<li>å¯ä½œä¸ºWebpack loaderä½¿ç”¨</li>
</ul>
<p><strong>åŠ£åŠ¿ï¼š</strong></p>
<ul>
<li>æ’ä»¶ç”Ÿæ€ç›¸å¯¹è¾ƒå°</li>
<li>æŸäº›é«˜çº§åŠŸèƒ½å¯èƒ½ä¸æ”¯æŒ</li>
<li>é”™è¯¯ä¿¡æ¯ä¸å¦‚Babelè¯¦ç»†</li>
</ul>
<h4 id="3-typescriptç¼–è¯‘å™¨"><a class="header" href="#3-typescriptç¼–è¯‘å™¨">3. TypeScriptç¼–è¯‘å™¨</a></h4>
<pre><code class="language-json">// tsconfig.json - å®˜æ–¹TypeScriptç¼–è¯‘å™¨
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "node",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    "outDir": "./dist",
    "rootDir": "./src"
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
</code></pre>
<p><strong>è½¬è¯‘å·¥å…·æ€§èƒ½å¯¹æ¯”ï¼š</strong></p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>å·¥å…·</th><th>è½¬è¯‘é€Ÿåº¦</th><th>ç±»å‹æ£€æŸ¥</th><th>æ’ä»¶æ”¯æŒ</th><th>å­¦ä¹ æˆæœ¬</th></tr>
</thead>
<tbody>
<tr><td>Babel</td><td>â­â­â­</td><td>âŒ</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td></tr>
<tr><td>SWC</td><td>â­â­â­â­â­</td><td>âŒ</td><td>â­â­â­</td><td>â­â­â­</td></tr>
<tr><td>esbuild</td><td>â­â­â­â­â­</td><td>âŒ</td><td>â­â­</td><td>â­â­</td></tr>
<tr><td>TypeScript</td><td>â­â­â­</td><td>â­â­â­â­â­</td><td>â­â­</td><td>â­â­â­</td></tr>
</tbody>
</table>
</div>
<h2 id="è¿è¡Œæ—¶ç¯å¢ƒå¯¹æ¯”"><a class="header" href="#è¿è¡Œæ—¶ç¯å¢ƒå¯¹æ¯”">è¿è¡Œæ—¶ç¯å¢ƒå¯¹æ¯”</a></h2>
<h3 id="nodejs-vs-deno-vs-bun"><a class="header" href="#nodejs-vs-deno-vs-bun">Node.js vs Deno vs Bun</a></h3>
<h4 id="1-nodejs"><a class="header" href="#1-nodejs">1. Node.js</a></h4>
<pre><code class="language-javascript">// package.json - ä¼ ç»Ÿçš„Node.jsé¡¹ç›®
{
  "name": "nodejs-project",
  "type": "module", // å¯ç”¨ESæ¨¡å—
  "engines": {
    "node": "&gt;=18.0.0"
  },
  "scripts": {
    "start": "node src/index.js",
    "dev": "node --watch src/index.js"
  },
  "dependencies": {
    "express": "^4.18.0",
    "lodash": "^4.17.21"
  }
}

// src/index.js
import express from 'express';
import { readFile } from 'fs/promises';

const app = express();
const port = process.env.PORT || 3000;

app.listen(port, () =&gt; {
  console.log(`Server running on port ${port}`);
});
</code></pre>
<h4 id="2-deno"><a class="header" href="#2-deno">2. Deno</a></h4>
<pre><code class="language-typescript">// deno.json - ç°ä»£çš„Denoé…ç½®
{
  "tasks": {
    "start": "deno run --allow-net --allow-read src/main.ts",
    "dev": "deno run --allow-net --allow-read --watch src/main.ts"
  },
  "imports": {
    "express": "npm:express@^4.18.0",
    "std/": "https://deno.land/std@0.200.0/"
  }
}

// src/main.ts - æ— éœ€package.json
import { serve } from "std/http/server.ts";
import express from "express";

const handler = (req: Request): Response =&gt; {
  return new Response("Hello from Deno!");
};

serve(handler, { port: 3000 });
</code></pre>
<h4 id="3-bun"><a class="header" href="#3-bun">3. Bun</a></h4>
<pre><code class="language-javascript">// buné¡¹ç›®ç»“æ„æ›´ç®€æ´
// package.json
{
  "name": "bun-project",
  "scripts": {
    "start": "bun run src/index.ts",
    "dev": "bun --watch src/index.ts"
  },
  "dependencies": {
    "@types/bun": "latest"
  }
}

// src/index.ts - å†…ç½®TypeScriptæ”¯æŒ
import { serve } from "bun";

serve({
  port: 3000,
  fetch(req) {
    return new Response("Hello from Bun!");
  },
});

console.log("Server running on http://localhost:3000");
</code></pre>
<h3 id="è¿è¡Œæ—¶ç‰¹æ€§å¯¹æ¯”"><a class="header" href="#è¿è¡Œæ—¶ç‰¹æ€§å¯¹æ¯”">è¿è¡Œæ—¶ç‰¹æ€§å¯¹æ¯”</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç‰¹æ€§</th><th>Node.js</th><th>Deno</th><th>Bun</th></tr>
</thead>
<tbody>
<tr><td><strong>å¯åŠ¨é€Ÿåº¦</strong></td><td>å¿«</td><td>ä¸­ç­‰</td><td>æœ€å¿«</td></tr>
<tr><td><strong>åŒ…ç®¡ç†</strong></td><td>npm/yarn/pnpm</td><td>å†…ç½®/npmå…¼å®¹</td><td>å†…ç½®</td></tr>
<tr><td><strong>TypeScript</strong></td><td>éœ€è¦è½¬è¯‘</td><td>åŸç”Ÿæ”¯æŒ</td><td>åŸç”Ÿæ”¯æŒ</td></tr>
<tr><td><strong>å®‰å…¨æ€§</strong></td><td>å®Œå…¨æƒé™</td><td>é»˜è®¤å®‰å…¨</td><td>å®Œå…¨æƒé™</td></tr>
<tr><td><strong>ç”Ÿæ€ç³»ç»Ÿ</strong></td><td>æœ€ä¸°å¯Œ</td><td>å‘å±•ä¸­</td><td>å‘å±•ä¸­</td></tr>
<tr><td><strong>Webæ ‡å‡†</strong></td><td>éƒ¨åˆ†æ”¯æŒ</td><td>å®Œæ•´æ”¯æŒ</td><td>éƒ¨åˆ†æ”¯æŒ</td></tr>
<tr><td><strong>æ€§èƒ½</strong></td><td>å¥½</td><td>å¥½</td><td>æœ€å¥½</td></tr>
</tbody>
</table>
</div>
<h3 id="æ¨¡å—è§£æå¯¹æ¯”"><a class="header" href="#æ¨¡å—è§£æå¯¹æ¯”">æ¨¡å—è§£æå¯¹æ¯”</a></h3>
<pre><code class="language-javascript">// Node.js - CommonJS/ESMæ··åˆ
// CommonJSæ–¹å¼
const lodash = require('lodash');
module.exports = { utils: lodash };

// ESMæ–¹å¼ (éœ€è¦"type": "module")
import lodash from 'lodash';
export { lodash as utils };

// Deno - åŸºäºURLçš„æ¨¡å—ç³»ç»Ÿ
import { serve } from "https://deno.land/std@0.200.0/http/server.ts";
import lodash from "npm:lodash@4.17.21";

// Bun - å…¼å®¹Node.js + å¢å¼º
import lodash from 'lodash';
import { file } from 'bun'; // Bunç‰¹æœ‰API
</code></pre>
<h2 id="å¼€å‘å·¥å…·å¯¹æ¯”"><a class="header" href="#å¼€å‘å·¥å…·å¯¹æ¯”">å¼€å‘å·¥å…·å¯¹æ¯”</a></h2>
<h3 id="åŒ…ç®¡ç†å™¨å¯¹æ¯”"><a class="header" href="#åŒ…ç®¡ç†å™¨å¯¹æ¯”">åŒ…ç®¡ç†å™¨å¯¹æ¯”</a></h3>
<h4 id="npm-vs-yarn-vs-pnpm"><a class="header" href="#npm-vs-yarn-vs-pnpm">npm vs yarn vs pnpm</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç‰¹æ€§</th><th>npm</th><th>Yarn Classic</th><th>Yarn Berry</th><th>pnpm</th></tr>
</thead>
<tbody>
<tr><td><strong>å®‰è£…é€Ÿåº¦</strong></td><td>ä¸­ç­‰</td><td>å¿«</td><td>å¿«</td><td>æœ€å¿«</td></tr>
<tr><td><strong>ç£ç›˜ä½¿ç”¨</strong></td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>æœ€ä½</td></tr>
<tr><td><strong>Monorepoæ”¯æŒ</strong></td><td>åŸºç¡€</td><td>å¥½</td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td></tr>
<tr><td><strong>ç¦»çº¿å®‰è£…</strong></td><td>æœ‰é™</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr>
<tr><td><strong>ä¸¥æ ¼æ€§</strong></td><td>å®½æ¾</td><td>å®½æ¾</td><td>ä¸¥æ ¼</td><td>ä¸¥æ ¼</td></tr>
<tr><td><strong>PnPæ”¯æŒ</strong></td><td>âŒ</td><td>âŒ</td><td>âœ…</td><td>âŒ</td></tr>
</tbody>
</table>
</div>
<h4 id="æ€§èƒ½åŸºå‡†æµ‹è¯•-1"><a class="header" href="#æ€§èƒ½åŸºå‡†æµ‹è¯•-1">æ€§èƒ½åŸºå‡†æµ‹è¯•</a></h4>
<pre><code class="language-bash"># å®‰è£…æ—¶é—´æµ‹è¯• (Reacté¡¹ç›®)
npm install     # ~45s
yarn install    # ~35s
pnpm install    # ~20s
bun install     # ~15s

# ç£ç›˜ä½¿ç”¨æµ‹è¯• (node_moduleså¤§å°)
npm:  150MB
yarn: 145MB  
pnpm: 50MB (ç¡¬é“¾æ¥)
</code></pre>
<h3 id="æµ‹è¯•æ¡†æ¶å¯¹æ¯”"><a class="header" href="#æµ‹è¯•æ¡†æ¶å¯¹æ¯”">æµ‹è¯•æ¡†æ¶å¯¹æ¯”</a></h3>
<h4 id="jest-vs-vitest-vs-playwright"><a class="header" href="#jest-vs-vitest-vs-playwright">Jest vs Vitest vs Playwright</a></h4>
<pre><code class="language-javascript">// Jesté…ç½® - æˆç†Ÿç¨³å®š
// jest.config.js
module.exports = {
  testEnvironment: 'jsdom',
  setupFilesAfterEnv: ['&lt;rootDir&gt;/src/setupTests.js'],
  moduleNameMapping: {
    '^@/(.*)$': '&lt;rootDir&gt;/src/$1'
  },
  collectCoverageFrom: [
    'src/**/*.{js,jsx,ts,tsx}',
    '!src/index.js'
  ]
};

// Vitesté…ç½® - å¿«é€Ÿç°ä»£
// vitest.config.js
import { defineConfig } from 'vitest/config';

export default defineConfig({
  test: {
    environment: 'jsdom',
    setupFiles: ['./src/setupTests.js'],
    coverage: {
      reporter: ['text', 'html']
    }
  }
});

// Playwrighté…ç½® - E2Eæµ‹è¯•
// playwright.config.js
module.exports = {
  testDir: './tests',
  timeout: 30000,
  retries: 2,
  use: {
    browserName: 'chromium',
    headless: true,
    screenshot: 'only-on-failure'
  },
  projects: [
    { name: 'Chrome', use: { ...devices['Desktop Chrome'] } },
    { name: 'Firefox', use: { ...devices['Desktop Firefox'] } },
    { name: 'Safari', use: { ...devices['Desktop Safari'] } }
  ]
};
</code></pre>
<h3 id="lintingå·¥å…·å¯¹æ¯”"><a class="header" href="#lintingå·¥å…·å¯¹æ¯”">Lintingå·¥å…·å¯¹æ¯”</a></h3>
<h4 id="eslint-vs-rome-vs-biome"><a class="header" href="#eslint-vs-rome-vs-biome">ESLint vs Rome vs Biome</a></h4>
<pre><code class="language-javascript">// ESLinté…ç½® - åŠŸèƒ½æœ€å…¨
// .eslintrc.js
module.exports = {
  extends: [
    'eslint:recommended',
    '@typescript-eslint/recommended',
    'plugin:react/recommended'
  ],
  parser: '@typescript-eslint/parser',
  plugins: ['@typescript-eslint', 'react'],
  rules: {
    'no-unused-vars': 'error',
    '@typescript-eslint/no-explicit-any': 'warn'
  }
};

// Biomeé…ç½® - ç°ä»£åŒ–å·¥å…·
// biome.json
{
  "linter": {
    "enabled": true,
    "rules": {
      "recommended": true,
      "style": {
        "noUnusedImports": "error"
      }
    }
  },
  "formatter": {
    "enabled": true,
    "indentStyle": "space",
    "indentSize": 2
  }
}
</code></pre>
<h2 id="é€‰å‹å»ºè®®"><a class="header" href="#é€‰å‹å»ºè®®">é€‰å‹å»ºè®®</a></h2>
<h3 id="åŸºäºé¡¹ç›®ç±»å‹çš„æ¨è"><a class="header" href="#åŸºäºé¡¹ç›®ç±»å‹çš„æ¨è">åŸºäºé¡¹ç›®ç±»å‹çš„æ¨è</a></h3>
<h4 id="1-å°å‹é¡¹ç›®åŸå‹å¼€å‘"><a class="header" href="#1-å°å‹é¡¹ç›®åŸå‹å¼€å‘">1. å°å‹é¡¹ç›®/åŸå‹å¼€å‘</a></h4>
<pre><code class="language-javascript">// æ¨èå·¥å…·é“¾
{
  "bundler": "Vite",
  "runtime": "Node.js/Bun", 
  "packageManager": "pnpm",
  "testing": "Vitest",
  "linting": "Biome"
}
</code></pre>
<h4 id="2-ä¸­å‹webåº”ç”¨"><a class="header" href="#2-ä¸­å‹webåº”ç”¨">2. ä¸­å‹Webåº”ç”¨</a></h4>
<pre><code class="language-javascript">// æ¨èå·¥å…·é“¾
{
  "bundler": "Vite/Webpack",
  "transpiler": "SWC/Babel",
  "runtime": "Node.js",
  "packageManager": "pnpm/yarn",
  "testing": "Jest/Vitest",
  "linting": "ESLint + Prettier"
}
</code></pre>
<h4 id="3-å¤§å‹ä¼ä¸šé¡¹ç›®"><a class="header" href="#3-å¤§å‹ä¼ä¸šé¡¹ç›®">3. å¤§å‹ä¼ä¸šé¡¹ç›®</a></h4>
<pre><code class="language-javascript">// æ¨èå·¥å…·é“¾
{
  "bundler": "Webpack",
  "transpiler": "Babel/SWC",
  "runtime": "Node.js",
  "packageManager": "yarn/pnpm",
  "testing": "Jest + Playwright",
  "linting": "ESLint + Prettier",
  "monorepo": "Lerna/Nx"
}
</code></pre>
<h4 id="4-åº“å¼€å‘"><a class="header" href="#4-åº“å¼€å‘">4. åº“å¼€å‘</a></h4>
<pre><code class="language-javascript">// æ¨èå·¥å…·é“¾
{
  "bundler": "Rollup",
  "transpiler": "Babel/SWC",
  "testing": "Jest/Vitest",
  "packaging": "å¤šæ ¼å¼è¾“å‡º(CJS/ESM/UMD)"
}
</code></pre>
<h3 id="æ€§èƒ½ä¼˜å…ˆçš„é€‰æ‹©"><a class="header" href="#æ€§èƒ½ä¼˜å…ˆçš„é€‰æ‹©">æ€§èƒ½ä¼˜å…ˆçš„é€‰æ‹©</a></h3>
<pre><code class="language-javascript">// æœ€å¿«æ„å»ºé€Ÿåº¦
{
  "bundler": "esbuild",
  "transpiler": "esbuild",
  "runtime": "Bun",
  "packageManager": "bun/pnpm"
}

// æœ€ä½³å¼€å‘ä½“éªŒ
{
  "bundler": "Vite",
  "transpiler": "SWC",
  "runtime": "Node.js",
  "packageManager": "pnpm",
  "testing": "Vitest"
}
</code></pre>
<h3 id="å†³ç­–çŸ©é˜µ"><a class="header" href="#å†³ç­–çŸ©é˜µ">å†³ç­–çŸ©é˜µ</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>éœ€æ±‚</th><th>ä¼˜å…ˆè€ƒè™‘</th><th>æ¬¡è¦é€‰æ‹©</th><th>ä¸æ¨è</th></tr>
</thead>
<tbody>
<tr><td><strong>å¿«é€Ÿå¼€å‘</strong></td><td>Vite + Vitest</td><td>Parcel</td><td>Webpack</td></tr>
<tr><td><strong>æœ€å°åŒ…ä½“ç§¯</strong></td><td>Rollup + Terser</td><td>esbuild</td><td>Parcel</td></tr>
<tr><td><strong>å¤æ‚é…ç½®</strong></td><td>Webpack</td><td>Rollup</td><td>Parcel</td></tr>
<tr><td><strong>åº“å¼€å‘</strong></td><td>Rollup</td><td>Webpack</td><td>Vite</td></tr>
<tr><td><strong>æ€§èƒ½æè‡´</strong></td><td>esbuild + SWC</td><td>Rollup</td><td>Webpack</td></tr>
<tr><td><strong>ä¼ä¸šçº§</strong></td><td>Webpack + Jest</td><td>Vite + Vitest</td><td>esbuild</td></tr>
</tbody>
</table>
</div>
<h2 id="è¿ç§»æŒ‡å—"><a class="header" href="#è¿ç§»æŒ‡å—">è¿ç§»æŒ‡å—</a></h2>
<h3 id="ä»webpackè¿ç§»åˆ°vite"><a class="header" href="#ä»webpackè¿ç§»åˆ°vite">ä»Webpackè¿ç§»åˆ°Vite</a></h3>
<pre><code class="language-javascript">// webpack.config.js (è¿ç§»å‰)
module.exports = {
  entry: './src/main.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'bundle.js'
  },
  module: {
    rules: [
      { test: /\.vue$/, loader: 'vue-loader' },
      { test: /\.css$/, use: ['style-loader', 'css-loader'] }
    ]
  },
  plugins: [new VueLoaderPlugin()]
};

// vite.config.js (è¿ç§»å)
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';

export default defineConfig({
  plugins: [vue()],
  build: {
    outDir: 'dist'
  }
});
</code></pre>
<h3 id="ä»npmè¿ç§»åˆ°pnpm"><a class="header" href="#ä»npmè¿ç§»åˆ°pnpm">ä»npmè¿ç§»åˆ°pnpm</a></h3>
<pre><code class="language-bash"># 1. åˆ é™¤node_moduleså’Œpackage-lock.json
rm -rf node_modules package-lock.json

# 2. å®‰è£…pnpm
npm install -g pnpm

# 3. å®‰è£…ä¾èµ–
pnpm install

# 4. æ›´æ–°è„šæœ¬
# package.jsonä¸­å°†npmæ›¿æ¢ä¸ºpnpm
</code></pre>
<h2 id="æ€»ç»“-18"><a class="header" href="#æ€»ç»“-18">æ€»ç»“</a></h2>
<h3 id="å·¥å…·é€‰æ‹©çš„å…³é”®å› ç´ "><a class="header" href="#å·¥å…·é€‰æ‹©çš„å…³é”®å› ç´ ">å·¥å…·é€‰æ‹©çš„å…³é”®å› ç´ </a></h3>
<ol>
<li><strong>é¡¹ç›®è§„æ¨¡</strong>ï¼šå°é¡¹ç›®é€‰æ‹©ç®€å•å·¥å…·ï¼Œå¤§é¡¹ç›®é€‰æ‹©åŠŸèƒ½å…¨é¢çš„å·¥å…·</li>
<li><strong>å›¢é˜ŸæŠ€èƒ½</strong>ï¼šè€ƒè™‘å›¢é˜Ÿçš„å­¦ä¹ æˆæœ¬å’Œç»´æŠ¤èƒ½åŠ›</li>
<li><strong>æ€§èƒ½è¦æ±‚</strong>ï¼šå¼€å‘é€Ÿåº¦vsæ„å»ºé€Ÿåº¦vsè¿è¡Œæ€§èƒ½</li>
<li><strong>ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šæ’ä»¶æ”¯æŒã€ç¤¾åŒºæ´»è·ƒåº¦ã€æ–‡æ¡£è´¨é‡</li>
<li><strong>é•¿æœŸç»´æŠ¤</strong>ï¼šå·¥å…·çš„ç¨³å®šæ€§å’Œå‘å±•å‰æ™¯</li>
</ol>
<h3 id="è¶‹åŠ¿é¢„æµ‹"><a class="header" href="#è¶‹åŠ¿é¢„æµ‹">è¶‹åŠ¿é¢„æµ‹</a></h3>
<ul>
<li><strong>ç¼–è¯‘é€Ÿåº¦</strong>ï¼šRust/Goå·¥å…·å°†æ›´å¤šæ›¿ä»£JavaScriptå·¥å…·</li>
<li><strong>é›¶é…ç½®</strong>ï¼šå¼€ç®±å³ç”¨çš„å·¥å…·å°†æ›´å—æ¬¢è¿</li>
<li><strong>åŸç”Ÿæ”¯æŒ</strong>ï¼šTypeScriptã€ESMçš„åŸç”Ÿæ”¯æŒå°†æˆä¸ºæ ‡é…</li>
<li><strong>ç»Ÿä¸€å·¥å…·é“¾</strong>ï¼šé›†æˆåº¦æ›´é«˜çš„å·¥å…·é“¾å°†ç®€åŒ–å¼€å‘æµç¨‹</li>
</ul>
<p>é€‰æ‹©å·¥å…·æ—¶ï¼Œåº”è¯¥æ ¹æ®å…·ä½“é¡¹ç›®éœ€æ±‚å’Œå›¢é˜Ÿæƒ…å†µï¼Œæƒè¡¡å„ç§å› ç´ ï¼Œè€Œä¸æ˜¯ç›²ç›®è¿½æ±‚æœ€æ–°æˆ–æœ€å¿«çš„å·¥å…·ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#å¸¸è§é—®é¢˜è§£ç­”">å¸¸è§é—®é¢˜è§£ç­”</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="å¸¸è§é—®é¢˜è§£ç­”"><a class="header" href="#å¸¸è§é—®é¢˜è§£ç­”">å¸¸è§é—®é¢˜è§£ç­”</a></h1>
<p>æœ¬ç« æ±‡æ€»äº†JavaScriptæ¨¡å—åŒ–å¼€å‘ä¸­æœ€å¸¸é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿè§£å†³å®é™…å¼€å‘ä¸­çš„å›°æƒ‘ã€‚</p>
<h2 id="åŸºç¡€æ¦‚å¿µé—®é¢˜"><a class="header" href="#åŸºç¡€æ¦‚å¿µé—®é¢˜">åŸºç¡€æ¦‚å¿µé—®é¢˜</a></h2>
<h3 id="q1-esæ¨¡å—å’Œcommonjsæœ‰ä»€ä¹ˆåŒºåˆ«"><a class="header" href="#q1-esæ¨¡å—å’Œcommonjsæœ‰ä»€ä¹ˆåŒºåˆ«">Q1: ESæ¨¡å—å’ŒCommonJSæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></h3>
<p><strong>A:</strong> ä¸»è¦åŒºåˆ«åŒ…æ‹¬ï¼š</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ç‰¹æ€§</th><th>ESæ¨¡å— (ESM)</th><th>CommonJS (CJS)</th></tr>
</thead>
<tbody>
<tr><td><strong>è¯­æ³•</strong></td><td><code>import</code>/<code>export</code></td><td><code>require()</code>/<code>module.exports</code></td></tr>
<tr><td><strong>åŠ è½½æ—¶æœº</strong></td><td>ç¼–è¯‘æ—¶é™æ€åˆ†æ</td><td>è¿è¡Œæ—¶åŠ¨æ€åŠ è½½</td></tr>
<tr><td><strong>Tree Shaking</strong></td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr>
<tr><td><strong>å¾ªç¯ä¾èµ–</strong></td><td>æ›´å¥½å¤„ç†</td><td>å¯èƒ½æœ‰é—®é¢˜</td></tr>
<tr><td><strong>é¡¶å±‚await</strong></td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr>
<tr><td><strong>æµè§ˆå™¨æ”¯æŒ</strong></td><td>åŸç”Ÿæ”¯æŒ</td><td>éœ€è¦æ‰“åŒ…</td></tr>
</tbody>
</table>
</div>
<pre><code class="language-javascript">// ESæ¨¡å—
import { functionA } from './moduleA.js';
export const functionB = () =&gt; {};

// CommonJS
const { functionA } = require('./moduleA.js');
module.exports = { functionB: () =&gt; {} };
</code></pre>
<h3 id="q2-ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŠ¨æ€å¯¼å…¥"><a class="header" href="#q2-ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŠ¨æ€å¯¼å…¥">Q2: ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŠ¨æ€å¯¼å…¥ï¼Ÿ</a></h3>
<p><strong>A:</strong> åŠ¨æ€å¯¼å…¥é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p>
<pre><code class="language-javascript">// 1. ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
const loadChart = async () =&gt; {
  const { Chart } = await import('./chart-library.js');
  return new Chart();
};

// 2. æ¡ä»¶æ€§æ¨¡å—åŠ è½½
if (user.hasFeature('advanced')) {
  const advanced = await import('./advanced-features.js');
  advanced.initialize();
}

// 3. è¿è¡Œæ—¶æ¨¡å—é€‰æ‹©
const getTranslator = async (language) =&gt; {
  return await import(`./translators/${language}.js`);
};

// 4. é™çº§å’Œé”™è¯¯å¤„ç†
try {
  const modernModule = await import('./modern-features.js');
  return modernModule.default;
} catch {
  const fallback = await import('./fallback.js');
  return fallback.default;
}
</code></pre>
<h3 id="q3-å¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜"><a class="header" href="#q3-å¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜">Q3: å¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ï¼Ÿ</a></h3>
<p><strong>A:</strong> è§£å†³å¾ªç¯ä¾èµ–çš„å‡ ç§æ–¹æ³•ï¼š</p>
<h4 id="æ–¹æ³•1-é‡æ–°è®¾è®¡æ¨¡å—ç»“æ„"><a class="header" href="#æ–¹æ³•1-é‡æ–°è®¾è®¡æ¨¡å—ç»“æ„">æ–¹æ³•1: é‡æ–°è®¾è®¡æ¨¡å—ç»“æ„</a></h4>
<pre><code class="language-javascript">// é—®é¢˜ï¼šAä¾èµ–Bï¼ŒBä¾èµ–A
// moduleA.js
import { functionB } from './moduleB.js';
export const functionA = () =&gt; functionB();

// moduleB.js  
import { functionA } from './moduleA.js'; // å¾ªç¯ä¾èµ–
export const functionB = () =&gt; functionA();

// è§£å†³ï¼šæå–å…¬å…±ä¾èµ–
// shared.js
export const sharedFunction = () =&gt; {};

// moduleA.js
import { sharedFunction } from './shared.js';
export const functionA = () =&gt; sharedFunction();

// moduleB.js
import { sharedFunction } from './shared.js';
export const functionB = () =&gt; sharedFunction();
</code></pre>
<h4 id="æ–¹æ³•2-ä½¿ç”¨ä¾èµ–æ³¨å…¥"><a class="header" href="#æ–¹æ³•2-ä½¿ç”¨ä¾èµ–æ³¨å…¥">æ–¹æ³•2: ä½¿ç”¨ä¾èµ–æ³¨å…¥</a></h4>
<pre><code class="language-javascript">// moduleA.js
export class ServiceA {
  constructor(serviceB) {
    this.serviceB = serviceB;
  }
  
  doSomething() {
    return this.serviceB.helper();
  }
}

// moduleB.js
export class ServiceB {
  constructor(serviceA) {
    this.serviceA = serviceA;
  }
  
  helper() {
    return 'result';
  }
}

// container.js
import { ServiceA } from './moduleA.js';
import { ServiceB } from './moduleB.js';

const serviceB = new ServiceB();
const serviceA = new ServiceA(serviceB);
serviceB.serviceA = serviceA; // å¦‚æœéœ€è¦çš„è¯
</code></pre>
<h3 id="q4-tree-shakingä¸å·¥ä½œæ€ä¹ˆåŠ"><a class="header" href="#q4-tree-shakingä¸å·¥ä½œæ€ä¹ˆåŠ">Q4: Tree Shakingä¸å·¥ä½œæ€ä¹ˆåŠï¼Ÿ</a></h3>
<p><strong>A:</strong> ç¡®ä¿Tree Shakingæ­£å¸¸å·¥ä½œçš„æ£€æŸ¥æ¸…å•ï¼š</p>
<pre><code class="language-javascript">// 1. ä½¿ç”¨ESæ¨¡å—è¯­æ³•
// âœ… æ­£ç¡®
export const functionA = () =&gt; {};
export const functionB = () =&gt; {};

// âŒ é”™è¯¯ - ä¼šå¯¼è‡´æ•´ä¸ªå¯¹è±¡è¢«åŒ…å«
export default {
  functionA: () =&gt; {},
  functionB: () =&gt; {}
};

// 2. é¿å…å‰¯ä½œç”¨
// âŒ æœ‰å‰¯ä½œç”¨çš„æ¨¡å—
console.log('Module loaded'); // å‰¯ä½œç”¨
export const pureFunction = () =&gt; {};

// âœ… çº¯æ¨¡å—
export const pureFunction = () =&gt; {};

// 3. æ­£ç¡®é…ç½®package.json
{
  "name": "my-package",
  "sideEffects": false, // æ ‡è®°ä¸ºæ— å‰¯ä½œç”¨
  // æˆ–è€…æŒ‡å®šæœ‰å‰¯ä½œç”¨çš„æ–‡ä»¶
  "sideEffects": ["./src/polyfills.js", "*.css"]
}

// 4. æ‰“åŒ…å·¥å…·é…ç½®
// webpack.config.js
module.exports = {
  mode: 'production', // å¯ç”¨Tree Shaking
  optimization: {
    usedExports: true,
    sideEffects: false
  }
};
</code></pre>
<h2 id="æ„å»ºå’Œå·¥å…·é—®é¢˜"><a class="header" href="#æ„å»ºå’Œå·¥å…·é—®é¢˜">æ„å»ºå’Œå·¥å…·é—®é¢˜</a></h2>
<h3 id="q5-æ¨¡å—è§£æå¤±è´¥æ€ä¹ˆåŠ"><a class="header" href="#q5-æ¨¡å—è§£æå¤±è´¥æ€ä¹ˆåŠ">Q5: æ¨¡å—è§£æå¤±è´¥æ€ä¹ˆåŠï¼Ÿ</a></h3>
<p><strong>A:</strong> å¸¸è§çš„æ¨¡å—è§£æé—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼š</p>
<pre><code class="language-javascript">// 1. æ–‡ä»¶æ‰©å±•åé—®é¢˜
// âŒ é”™è¯¯
import utils from './utils'; // ç¼ºå°‘æ‰©å±•å

// âœ… æ­£ç¡®
import utils from './utils.js';

// 2. ç›¸å¯¹è·¯å¾„é—®é¢˜
// âŒ é”™è¯¯
import utils from 'utils'; // åº”è¯¥æ˜¯ç›¸å¯¹è·¯å¾„

// âœ… æ­£ç¡®
import utils from './utils.js';
import utils from '../shared/utils.js';

// 3. Node.jsæ¨¡å—è§£æé…ç½®
// package.json
{
  "type": "module", // å¯ç”¨ESæ¨¡å—
  "main": "./dist/index.cjs.js",
  "module": "./dist/index.esm.js",
  "exports": {
    ".": {
      "import": "./dist/index.esm.js",
      "require": "./dist/index.cjs.js"
    }
  }
}

// 4. TypeScriptè·¯å¾„æ˜ å°„
// tsconfig.json
{
  "compilerOptions": {
    "baseUrl": "./src",
    "paths": {
      "@/*": ["*"],
      "@/components/*": ["components/*"]
    }
  }
}
</code></pre>
<h3 id="q6-å¦‚ä½•è°ƒè¯•æ¨¡å—åŠ è½½é—®é¢˜"><a class="header" href="#q6-å¦‚ä½•è°ƒè¯•æ¨¡å—åŠ è½½é—®é¢˜">Q6: å¦‚ä½•è°ƒè¯•æ¨¡å—åŠ è½½é—®é¢˜ï¼Ÿ</a></h3>
<p><strong>A:</strong> è°ƒè¯•æ¨¡å—åŠ è½½çš„æ–¹æ³•ï¼š</p>
<pre><code class="language-javascript">// 1. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·
// åœ¨Networké¢æ¿æŸ¥çœ‹æ¨¡å—åŠ è½½æƒ…å†µ
// åœ¨Sourcesé¢æ¿è®¾ç½®æ–­ç‚¹

// 2. Node.jsè°ƒè¯•
// å¯ç”¨æ¨¡å—åŠ è½½è·Ÿè¸ª
node --trace-warnings --experimental-loader ./my-loader.js app.js

// 3. æ·»åŠ è°ƒè¯•æ—¥å¿—
const originalImport = window.__import__ || import;
window.__import__ = function(specifier) {
  console.log('Loading module:', specifier);
  return originalImport(specifier)
    .then(module =&gt; {
      console.log('Module loaded:', specifier, module);
      return module;
    })
    .catch(error =&gt; {
      console.error('Module load failed:', specifier, error);
      throw error;
    });
};

// 4. ä½¿ç”¨Webpack Bundle Analyzer
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

module.exports = {
  plugins: [
    new BundleAnalyzerPlugin({
      analyzerMode: 'server',
      openAnalyzer: true
    })
  ]
};
</code></pre>
<h3 id="q7-å¦‚ä½•ä¼˜åŒ–æ„å»ºæ€§èƒ½"><a class="header" href="#q7-å¦‚ä½•ä¼˜åŒ–æ„å»ºæ€§èƒ½">Q7: å¦‚ä½•ä¼˜åŒ–æ„å»ºæ€§èƒ½ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ„å»ºæ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<pre><code class="language-javascript">// 1. å¯ç”¨å¹¶è¡Œæ„å»º
// webpack.config.js
const os = require('os');

module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        use: [
          {
            loader: 'thread-loader',
            options: {
              workers: os.cpus().length - 1
            }
          },
          'babel-loader'
        ]
      }
    ]
  }
};

// 2. ç¼“å­˜é…ç½®
module.exports = {
  cache: {
    type: 'filesystem',
    cacheDirectory: path.resolve(__dirname, '.webpack-cache')
  }
};

// 3. å‡å°‘è§£æèŒƒå›´
module.exports = {
  resolve: {
    modules: [path.resolve(__dirname, 'src'), 'node_modules'],
    extensions: ['.js', '.jsx'] // åªåŒ…å«å¿…è¦çš„æ‰©å±•å
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        include: path.resolve(__dirname, 'src'), // é™åˆ¶å¤„ç†èŒƒå›´
        exclude: /node_modules/
      }
    ]
  }
};

// 4. ä½¿ç”¨æ›´å¿«çš„å·¥å…·
// vite.config.js
import { defineConfig } from 'vite';

export default defineConfig({
  esbuild: {
    target: 'es2020'
  },
  optimizeDeps: {
    include: ['react', 'react-dom']
  }
});
</code></pre>
<h2 id="å…¼å®¹æ€§é—®é¢˜"><a class="header" href="#å…¼å®¹æ€§é—®é¢˜">å…¼å®¹æ€§é—®é¢˜</a></h2>
<h3 id="q8-å¦‚ä½•åœ¨nodejsä¸­åŒæ—¶æ”¯æŒesmå’Œcommonjs"><a class="header" href="#q8-å¦‚ä½•åœ¨nodejsä¸­åŒæ—¶æ”¯æŒesmå’Œcommonjs">Q8: å¦‚ä½•åœ¨Node.jsä¸­åŒæ—¶æ”¯æŒESMå’ŒCommonJSï¼Ÿ</a></h3>
<p><strong>A:</strong> åˆ›å»ºåŒæ¨¡å¼åŒ…çš„æ–¹æ³•ï¼š</p>
<pre><code class="language-javascript">// 1. ä½¿ç”¨æ¡ä»¶å¯¼å‡º
// package.json
{
  "name": "my-package",
  "main": "./dist/index.cjs",
  "module": "./dist/index.mjs",
  "exports": {
    ".": {
      "import": "./dist/index.mjs",
      "require": "./dist/index.cjs"
    }
  }
}

// 2. æºç ç¤ºä¾‹
// src/index.js (å…±åŒæºç )
export function myFunction() {
  return 'Hello World';
}

// æ„å»ºè„šæœ¬ç”Ÿæˆä¸¤ä¸ªç‰ˆæœ¬
// dist/index.mjs (ESMç‰ˆæœ¬)
export function myFunction() {
  return 'Hello World';
}

// dist/index.cjs (CommonJSç‰ˆæœ¬)
function myFunction() {
  return 'Hello World';
}
module.exports = { myFunction };

// 3. åŠ¨æ€æ£€æµ‹ç¯å¢ƒ
// utils.js
const isESM = typeof module === 'undefined';

if (isESM) {
  // ESMç¯å¢ƒ
  export { myFunction };
} else {
  // CommonJSç¯å¢ƒ  
  module.exports = { myFunction };
}
</code></pre>
<h3 id="q9-å¦‚ä½•å¤„ç†ç¬¬ä¸‰æ–¹åº“çš„æ¨¡å—å…¼å®¹æ€§"><a class="header" href="#q9-å¦‚ä½•å¤„ç†ç¬¬ä¸‰æ–¹åº“çš„æ¨¡å—å…¼å®¹æ€§">Q9: å¦‚ä½•å¤„ç†ç¬¬ä¸‰æ–¹åº“çš„æ¨¡å—å…¼å®¹æ€§ï¼Ÿ</a></h3>
<p><strong>A:</strong> å¤„ç†ç¬¬ä¸‰æ–¹åº“å…¼å®¹æ€§é—®é¢˜ï¼š</p>
<pre><code class="language-javascript">// 1. ä½¿ç”¨æ‰“åŒ…å·¥å…·è½¬æ¢
// webpack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /node_modules\/problematic-package/,
        use: 'babel-loader'
      }
    ]
  }
};

// 2. åˆ›å»ºåŒ…è£…æ¨¡å—
// wrappers/old-library.js
import oldLibrary from 'old-commonjs-library';

// åŒ…è£…æˆESMæ¥å£
export const { functionA, functionB } = oldLibrary;
export default oldLibrary;

// 3. ä½¿ç”¨åŠ¨æ€å¯¼å…¥å¤„ç†å¼‚æ­¥åŠ è½½
const loadLibrary = async () =&gt; {
  try {
    // å°è¯•ESMç‰ˆæœ¬
    return await import('modern-library');
  } catch {
    // é™çº§åˆ°CommonJSç‰ˆæœ¬
    const lib = await import('old-library');
    return lib.default || lib;
  }
};

// 4. é…ç½®æ¨¡å—è§£æåˆ«å
// webpack.config.js
module.exports = {
  resolve: {
    alias: {
      'problematic-lib': path.resolve(__dirname, 'src/wrappers/problematic-lib.js')
    }
  }
};
</code></pre>
<h3 id="q10-å¦‚ä½•åœ¨æµè§ˆå™¨ä¸­å¤„ç†æ¨¡å—å…¼å®¹æ€§"><a class="header" href="#q10-å¦‚ä½•åœ¨æµè§ˆå™¨ä¸­å¤„ç†æ¨¡å—å…¼å®¹æ€§">Q10: å¦‚ä½•åœ¨æµè§ˆå™¨ä¸­å¤„ç†æ¨¡å—å…¼å®¹æ€§ï¼Ÿ</a></h3>
<p><strong>A:</strong> æµè§ˆå™¨æ¨¡å—å…¼å®¹æ€§å¤„ç†ï¼š</p>
<pre><code class="language-html">&lt;!-- 1. ç°ä»£æµè§ˆå™¨å’Œæ—§æµè§ˆå™¨åˆ†åˆ«å¤„ç† --&gt;
&lt;script type="module" src="modern.js"&gt;&lt;/script&gt;
&lt;script nomodule src="legacy.js"&gt;&lt;/script&gt;

&lt;!-- 2. åŠ¨æ€æ£€æµ‹å’ŒåŠ è½½ --&gt;
&lt;script&gt;
  if ('noModule' in HTMLScriptElement.prototype) {
    // æ”¯æŒESæ¨¡å—çš„ç°ä»£æµè§ˆå™¨
    import('./modern-app.js').then(app =&gt; app.init());
  } else {
    // æ—§æµè§ˆå™¨åŠ è½½æ‰“åŒ…åçš„ç‰ˆæœ¬
    const script = document.createElement('script');
    script.src = 'legacy-app.js';
    document.head.appendChild(script);
  }
&lt;/script&gt;

&lt;!-- 3. ä½¿ç”¨importmapå¤„ç†æ¨¡å—æ˜ å°„ --&gt;
&lt;script type="importmap"&gt;
{
  "imports": {
    "react": "https://esm.sh/react@18",
    "react-dom": "https://esm.sh/react-dom@18"
  }
}
&lt;/script&gt;
&lt;script type="module"&gt;
  import React from 'react';
  import ReactDOM from 'react-dom';
&lt;/script&gt;
</code></pre>
<h2 id="æ€§èƒ½ä¼˜åŒ–é—®é¢˜"><a class="header" href="#æ€§èƒ½ä¼˜åŒ–é—®é¢˜">æ€§èƒ½ä¼˜åŒ–é—®é¢˜</a></h2>
<h3 id="q11-å¦‚ä½•å‡å°‘æ¨¡å—åŠ è½½æ—¶é—´"><a class="header" href="#q11-å¦‚ä½•å‡å°‘æ¨¡å—åŠ è½½æ—¶é—´">Q11: å¦‚ä½•å‡å°‘æ¨¡å—åŠ è½½æ—¶é—´ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ¨¡å—åŠ è½½æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<pre><code class="language-javascript">// 1. é¢„åŠ è½½å…³é”®æ¨¡å—
// åœ¨HTMLä¸­é¢„åŠ è½½
&lt;link rel="modulepreload" href="./critical-module.js"&gt;

// åœ¨JavaScriptä¸­é¢„åŠ è½½
const preloadModule = (url) =&gt; {
  const link = document.createElement('link');
  link.rel = 'modulepreload';
  link.href = url;
  document.head.appendChild(link);
};

// 2. ä»£ç åˆ†å‰²ä¼˜åŒ–
// è·¯ç”±çº§åˆ†å‰²
const HomePage = lazy(() =&gt; import('./pages/HomePage'));
const AboutPage = lazy(() =&gt; import('./pages/AboutPage'));

// åŠŸèƒ½çº§åˆ†å‰²
const loadFeature = async (featureName) =&gt; {
  const features = {
    charts: () =&gt; import('./features/charts'),
    editor: () =&gt; import('./features/editor')
  };
  return features[featureName]?.();
};

// 3. æ‰“åŒ…ä¼˜åŒ–
// webpack.config.js
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
        common: {
          minChunks: 2,
          chunks: 'all',
          enforce: true
        }
      }
    }
  }
};

// 4. ä½¿ç”¨CDNå’Œç¼“å­˜
// é…ç½®é•¿æœŸç¼“å­˜
module.exports = {
  output: {
    filename: '[name].[contenthash].js',
    chunkFilename: '[name].[contenthash].chunk.js'
  }
};
</code></pre>
<h3 id="q12-å¦‚ä½•ç›‘æ§æ¨¡å—åŠ è½½æ€§èƒ½"><a class="header" href="#q12-å¦‚ä½•ç›‘æ§æ¨¡å—åŠ è½½æ€§èƒ½">Q12: å¦‚ä½•ç›‘æ§æ¨¡å—åŠ è½½æ€§èƒ½ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ¨¡å—æ€§èƒ½ç›‘æ§æ–¹æ³•ï¼š</p>
<pre><code class="language-javascript">// 1. ä½¿ç”¨Performance API
const modulePerformance = new Map();

const originalImport = window.import || import;
window.import = function(specifier) {
  const startTime = performance.now();
  
  return originalImport(specifier).then(module =&gt; {
    const loadTime = performance.now() - startTime;
    modulePerformance.set(specifier, {
      loadTime,
      timestamp: Date.now(),
      size: JSON.stringify(module).length
    });
    
    // å‘é€æ€§èƒ½æ•°æ®
    if (window.analytics) {
      window.analytics.track('module_loaded', {
        module: specifier,
        loadTime,
        size: JSON.stringify(module).length
      });
    }
    
    return module;
  });
};

// 2. ç›‘æ§Core Web Vitals
const observer = new PerformanceObserver((list) =&gt; {
  for (const entry of list.getEntries()) {
    if (entry.entryType === 'largest-contentful-paint') {
      console.log('LCP:', entry.startTime);
    }
  }
});

observer.observe({ entryTypes: ['largest-contentful-paint'] });

// 3. æ¨¡å—åŠ è½½ç€‘å¸ƒå›¾åˆ†æ
const analyzeModuleLoading = () =&gt; {
  const entries = performance.getEntriesByType('resource');
  const moduleEntries = entries.filter(entry =&gt; 
    entry.name.includes('.js') || entry.name.includes('.mjs')
  );
  
  console.table(moduleEntries.map(entry =&gt; ({
    name: entry.name,
    duration: entry.duration,
    transferSize: entry.transferSize,
    startTime: entry.startTime
  })));
};
</code></pre>
<h2 id="è°ƒè¯•å’Œæµ‹è¯•é—®é¢˜"><a class="header" href="#è°ƒè¯•å’Œæµ‹è¯•é—®é¢˜">è°ƒè¯•å’Œæµ‹è¯•é—®é¢˜</a></h2>
<h3 id="q13-å¦‚ä½•æµ‹è¯•æ¨¡å—åŒ–ä»£ç "><a class="header" href="#q13-å¦‚ä½•æµ‹è¯•æ¨¡å—åŒ–ä»£ç ">Q13: å¦‚ä½•æµ‹è¯•æ¨¡å—åŒ–ä»£ç ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ¨¡å—åŒ–ä»£ç æµ‹è¯•ç­–ç•¥ï¼š</p>
<pre><code class="language-javascript">// 1. å•å…ƒæµ‹è¯•
// math.js
export const add = (a, b) =&gt; a + b;
export const multiply = (a, b) =&gt; a * b;

// math.test.js
import { add, multiply } from './math.js';

describe('Math utilities', () =&gt; {
  test('add function', () =&gt; {
    expect(add(2, 3)).toBe(5);
  });
  
  test('multiply function', () =&gt; {
    expect(multiply(2, 3)).toBe(6);
  });
});

// 2. æ¨¡æ‹Ÿ(Mock)å¤–éƒ¨ä¾èµ–
// api.js
export const fetchUser = async (id) =&gt; {
  const response = await fetch(`/api/users/${id}`);
  return response.json();
};

// userService.test.js
import { fetchUser } from './api.js';
jest.mock('./api.js');

const mockFetchUser = fetchUser as jest.MockedFunction&lt;typeof fetchUser&gt;;

test('user service', async () =&gt; {
  mockFetchUser.mockResolvedValue({ id: 1, name: 'John' });
  
  const user = await fetchUser(1);
  expect(user.name).toBe('John');
});

// 3. æµ‹è¯•åŠ¨æ€å¯¼å…¥
test('dynamic import', async () =&gt; {
  const module = await import('./utils.js');
  expect(typeof module.utilFunction).toBe('function');
});

// 4. é›†æˆæµ‹è¯•
// app.test.js
import { JSDOM } from 'jsdom';

const dom = new JSDOM('&lt;!DOCTYPE html&gt;&lt;div id="app"&gt;&lt;/div&gt;');
global.window = dom.window;
global.document = window.document;

import('./app.js').then(app =&gt; {
  app.init();
  // æµ‹è¯•åº”ç”¨åˆå§‹åŒ–åçš„çŠ¶æ€
});
</code></pre>
<h3 id="q14-å¦‚ä½•å¤„ç†æ¨¡å—ä¸­çš„é”™è¯¯"><a class="header" href="#q14-å¦‚ä½•å¤„ç†æ¨¡å—ä¸­çš„é”™è¯¯">Q14: å¦‚ä½•å¤„ç†æ¨¡å—ä¸­çš„é”™è¯¯ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ¨¡å—é”™è¯¯å¤„ç†æœ€ä½³å®è·µï¼š</p>
<pre><code class="language-javascript">// 1. é™æ€å¯¼å…¥é”™è¯¯å¤„ç†
// ä½¿ç”¨try-catchåŒ…è£…ä½¿ç”¨æ¨¡å—çš„ä»£ç 
try {
  import('./risky-module.js').then(module =&gt; {
    module.dangerousFunction();
  });
} catch (error) {
  console.error('Module error:', error);
}

// 2. åŠ¨æ€å¯¼å…¥é”™è¯¯å¤„ç†
const loadModuleWithFallback = async (modulePath, fallbackPath) =&gt; {
  try {
    return await import(modulePath);
  } catch (error) {
    console.warn(`Failed to load ${modulePath}, using fallback:`, error);
    return await import(fallbackPath);
  }
};

// 3. æ¨¡å—å†…éƒ¨é”™è¯¯å¤„ç†
// robust-module.js
class ModuleError extends Error {
  constructor(message, code) {
    super(message);
    this.name = 'ModuleError';
    this.code = code;
  }
}

export const riskyFunction = (input) =&gt; {
  try {
    if (!input) {
      throw new ModuleError('Input is required', 'MISSING_INPUT');
    }
    // å±é™©æ“ä½œ
    return processInput(input);
  } catch (error) {
    // è®°å½•é”™è¯¯
    console.error('Function failed:', error);
    
    // é‡æ–°æŠ›å‡ºåŒ…è£…åçš„é”™è¯¯
    if (error instanceof ModuleError) {
      throw error;
    } else {
      throw new ModuleError('Processing failed', 'PROCESSING_ERROR');
    }
  }
};

// 4. å…¨å±€é”™è¯¯å¤„ç†
window.addEventListener('unhandledrejection', (event) =&gt; {
  if (event.reason?.code === 'MODULE_LOAD_ERROR') {
    // å¤„ç†æ¨¡å—åŠ è½½é”™è¯¯
    console.error('Module load failed:', event.reason);
    event.preventDefault();
  }
});
</code></pre>
<h2 id="éƒ¨ç½²å’Œç”Ÿäº§é—®é¢˜"><a class="header" href="#éƒ¨ç½²å’Œç”Ÿäº§é—®é¢˜">éƒ¨ç½²å’Œç”Ÿäº§é—®é¢˜</a></h2>
<h3 id="q15-å¦‚ä½•ä¼˜åŒ–ç”Ÿäº§ç¯å¢ƒçš„æ¨¡å—åŠ è½½"><a class="header" href="#q15-å¦‚ä½•ä¼˜åŒ–ç”Ÿäº§ç¯å¢ƒçš„æ¨¡å—åŠ è½½">Q15: å¦‚ä½•ä¼˜åŒ–ç”Ÿäº§ç¯å¢ƒçš„æ¨¡å—åŠ è½½ï¼Ÿ</a></h3>
<p><strong>A:</strong> ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ç­–ç•¥ï¼š</p>
<pre><code class="language-javascript">// 1. å¯ç”¨å‹ç¼©å’Œä¼˜åŒ–
// webpack.config.js
const TerserPlugin = require('terser-webpack-plugin');

module.exports = {
  mode: 'production',
  optimization: {
    minimize: true,
    minimizer: [
      new TerserPlugin({
        terserOptions: {
          compress: {
            drop_console: true, // ç§»é™¤console.log
            drop_debugger: true // ç§»é™¤debugger
          }
        }
      })
    ]
  }
};

// 2. é…ç½®ç¼“å­˜ç­–ç•¥
// æœåŠ¡å™¨é…ç½®ç¤ºä¾‹
app.use('/static', express.static('public', {
  maxAge: '1y', // é™æ€èµ„æºç¼“å­˜1å¹´
  etag: true,
  lastModified: true
}));

// 3. ä½¿ç”¨Service Workerç¼“å­˜æ¨¡å—
// sw.js
const CACHE_NAME = 'modules-v1';
const urlsToCache = [
  '/dist/main.js',
  '/dist/vendor.js',
  '/dist/runtime.js'
];

self.addEventListener('install', (event) =&gt; {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then((cache) =&gt; cache.addAll(urlsToCache))
  );
});

self.addEventListener('fetch', (event) =&gt; {
  if (event.request.url.includes('.js')) {
    event.respondWith(
      caches.match(event.request)
        .then((response) =&gt; response || fetch(event.request))
    );
  }
});

// 4. HTTP/2 Server Push
// æœåŠ¡å™¨é…ç½®
app.get('/', (req, res) =&gt; {
  // æ¨é€å…³é”®æ¨¡å—
  res.push('/dist/critical.js', {
    response: { 'content-type': 'application/javascript' }
  });
  
  res.send(indexHTML);
});
</code></pre>
<h3 id="q16-å¦‚ä½•å¤„ç†æ¨¡å—ç‰ˆæœ¬æ›´æ–°"><a class="header" href="#q16-å¦‚ä½•å¤„ç†æ¨¡å—ç‰ˆæœ¬æ›´æ–°">Q16: å¦‚ä½•å¤„ç†æ¨¡å—ç‰ˆæœ¬æ›´æ–°ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ¨¡å—ç‰ˆæœ¬ç®¡ç†ç­–ç•¥ï¼š</p>
<pre><code class="language-javascript">// 1. ç‰ˆæœ¬åŒ–æ–‡ä»¶å
// webpack.config.js
module.exports = {
  output: {
    filename: '[name].[contenthash].js',
    chunkFilename: '[name].[contenthash].chunk.js'
  }
};

// 2. ç‰ˆæœ¬æ£€æŸ¥å’Œçƒ­æ›´æ–°
class ModuleVersionManager {
  constructor() {
    this.currentVersion = this.getCurrentVersion();
    this.checkInterval = 30000; // 30ç§’æ£€æŸ¥ä¸€æ¬¡
  }
  
  getCurrentVersion() {
    return document.querySelector('meta[name="app-version"]')?.content;
  }
  
  async checkForUpdates() {
    try {
      const response = await fetch('/api/version');
      const { version } = await response.json();
      
      if (version !== this.currentVersion) {
        this.handleVersionUpdate(version);
      }
    } catch (error) {
      console.error('Version check failed:', error);
    }
  }
  
  handleVersionUpdate(newVersion) {
    // é€šçŸ¥ç”¨æˆ·æœ‰æ–°ç‰ˆæœ¬
    if (confirm('æ–°ç‰ˆæœ¬å¯ç”¨ï¼Œæ˜¯å¦åˆ·æ–°é¡µé¢ï¼Ÿ')) {
      window.location.reload();
    }
  }
  
  startVersionChecking() {
    setInterval(() =&gt; this.checkForUpdates(), this.checkInterval);
  }
}

// 3. æ¸è¿›å¼æ›´æ–°
const updateModule = async (moduleName) =&gt; {
  try {
    // é¢„åŠ è½½æ–°ç‰ˆæœ¬
    const newModule = await import(`./modules/${moduleName}.js?v=${Date.now()}`);
    
    // å¹³æ»‘åˆ‡æ¢
    if (window.modules?.[moduleName]) {
      // è°ƒç”¨æ—§æ¨¡å—çš„æ¸…ç†å‡½æ•°
      window.modules[moduleName].cleanup?.();
    }
    
    // æ›´æ–°æ¨¡å—å¼•ç”¨
    window.modules = window.modules || {};
    window.modules[moduleName] = newModule;
    
    // åˆå§‹åŒ–æ–°æ¨¡å—
    newModule.init?.();
    
  } catch (error) {
    console.error(`Failed to update module ${moduleName}:`, error);
  }
};
</code></pre>
<h2 id="å…¶ä»–å¸¸è§é—®é¢˜"><a class="header" href="#å…¶ä»–å¸¸è§é—®é¢˜">å…¶ä»–å¸¸è§é—®é¢˜</a></h2>
<h3 id="q17-å¦‚ä½•åœ¨æ¨¡å—é—´å…±äº«æ•°æ®"><a class="header" href="#q17-å¦‚ä½•åœ¨æ¨¡å—é—´å…±äº«æ•°æ®">Q17: å¦‚ä½•åœ¨æ¨¡å—é—´å…±äº«æ•°æ®ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ¨¡å—é—´æ•°æ®å…±äº«æ–¹æ¡ˆï¼š</p>
<pre><code class="language-javascript">// 1. ä½¿ç”¨å…±äº«çŠ¶æ€æ¨¡å—
// store.js
class Store {
  constructor() {
    this.state = {};
    this.listeners = [];
  }
  
  setState(updates) {
    this.state = { ...this.state, ...updates };
    this.listeners.forEach(listener =&gt; listener(this.state));
  }
  
  getState() {
    return this.state;
  }
  
  subscribe(listener) {
    this.listeners.push(listener);
    return () =&gt; {
      this.listeners = this.listeners.filter(l =&gt; l !== listener);
    };
  }
}

export const store = new Store();

// moduleA.js
import { store } from './store.js';

export const updateData = (data) =&gt; {
  store.setState({ moduleAData: data });
};

// moduleB.js
import { store } from './store.js';

const unsubscribe = store.subscribe((state) =&gt; {
  console.log('State updated:', state.moduleAData);
});

// 2. ä½¿ç”¨äº‹ä»¶ç³»ç»Ÿ
// eventBus.js
class EventBus {
  constructor() {
    this.events = {};
  }
  
  on(event, callback) {
    if (!this.events[event]) {
      this.events[event] = [];
    }
    this.events[event].push(callback);
  }
  
  emit(event, data) {
    if (this.events[event]) {
      this.events[event].forEach(callback =&gt; callback(data));
    }
  }
  
  off(event, callback) {
    if (this.events[event]) {
      this.events[event] = this.events[event].filter(cb =&gt; cb !== callback);
    }
  }
}

export const eventBus = new EventBus();

// 3. ä½¿ç”¨å…¨å±€å‘½åç©ºé—´
// globals.js
window.APP_GLOBALS = window.APP_GLOBALS || {
  config: {},
  cache: new Map(),
  utils: {}
};

export default window.APP_GLOBALS;
</code></pre>
<h3 id="q18-å¦‚ä½•å¤„ç†å¤§å‹æ¨¡å—çš„åŠ è½½"><a class="header" href="#q18-å¦‚ä½•å¤„ç†å¤§å‹æ¨¡å—çš„åŠ è½½">Q18: å¦‚ä½•å¤„ç†å¤§å‹æ¨¡å—çš„åŠ è½½ï¼Ÿ</a></h3>
<p><strong>A:</strong> å¤§å‹æ¨¡å—åŠ è½½ä¼˜åŒ–ï¼š</p>
<pre><code class="language-javascript">// 1. æ¨¡å—åˆ†å‰²
// å°†å¤§æ¨¡å—æ‹†åˆ†æˆå°å—
// chart-module/index.js
export const loadBasicChart = () =&gt; import('./basic-chart.js');
export const loadAdvancedChart = () =&gt; import('./advanced-chart.js');
export const loadD3Chart = () =&gt; import('./d3-chart.js');

// 2. æµå¼åŠ è½½
class StreamingModuleLoader {
  async loadModuleInChunks(modulePath, chunkSize = 1024 * 64) {
    const response = await fetch(modulePath);
    const reader = response.body?.getReader();
    
    if (!reader) {
      throw new Error('Streaming not supported');
    }
    
    let code = '';
    let done = false;
    
    while (!done) {
      const { value, done: readerDone } = await reader.read();
      done = readerDone;
      
      if (value) {
        code += new TextDecoder().decode(value);
        
        // æ˜¾ç¤ºåŠ è½½è¿›åº¦
        this.updateProgress(code.length, response.headers.get('content-length'));
      }
    }
    
    // æ‰§è¡Œä»£ç 
    const blob = new Blob([code], { type: 'application/javascript' });
    const url = URL.createObjectURL(blob);
    const module = await import(url);
    URL.revokeObjectURL(url);
    
    return module;
  }
  
  updateProgress(loaded, total) {
    const progress = (loaded / total) * 100;
    console.log(`Loading progress: ${progress.toFixed(1)}%`);
  }
}

// 3. åˆ†ä¼˜å…ˆçº§åŠ è½½
const loadModulesByPriority = async () =&gt; {
  // é«˜ä¼˜å…ˆçº§æ¨¡å—
  const criticalModules = [
    import('./core.js'),
    import('./ui.js')
  ];
  
  await Promise.all(criticalModules);
  
  // ä¸­ä¼˜å…ˆçº§æ¨¡å—
  const importantModules = [
    import('./features.js'),
    import('./analytics.js')
  ];
  
  Promise.all(importantModules);
  
  // ä½ä¼˜å…ˆçº§æ¨¡å—ï¼ˆç©ºé—²æ—¶åŠ è½½ï¼‰
  requestIdleCallback(() =&gt; {
    import('./optional-features.js');
    import('./dev-tools.js');
  });
};
</code></pre>
<h3 id="q19-å¦‚ä½•å®ç°æ¨¡å—çš„çƒ­é‡è½½"><a class="header" href="#q19-å¦‚ä½•å®ç°æ¨¡å—çš„çƒ­é‡è½½">Q19: å¦‚ä½•å®ç°æ¨¡å—çš„çƒ­é‡è½½ï¼Ÿ</a></h3>
<p><strong>A:</strong> æ¨¡å—çƒ­é‡è½½å®ç°ï¼š</p>
<pre><code class="language-javascript">// 1. åŸºç¡€çƒ­é‡è½½æ£€æµ‹
if (module.hot) {
  module.hot.accept('./my-module.js', () =&gt; {
    // æ¨¡å—æ›´æ–°æ—¶çš„å›è°ƒ
    console.log('Module updated');
    
    // é‡æ–°å¯¼å…¥æ›´æ–°çš„æ¨¡å—
    import('./my-module.js').then(newModule =&gt; {
      // æ›´æ–°åº”ç”¨çŠ¶æ€
      updateApplication(newModule);
    });
  });
}

// 2. è‡ªå®šä¹‰çƒ­é‡è½½ç³»ç»Ÿ
class HotReloadManager {
  constructor() {
    this.modules = new Map();
    this.watchers = new Map();
  }
  
  register(modulePath, module) {
    this.modules.set(modulePath, module);
    
    if (this.isDevelopment()) {
      this.watchModule(modulePath);
    }
  }
  
  async watchModule(modulePath) {
    // ä½¿ç”¨WebSocketæˆ–å…¶ä»–æ–¹å¼ç›‘å¬æ–‡ä»¶å˜åŒ–
    const ws = new WebSocket(`ws://localhost:3001/hmr`);
    
    ws.addEventListener('message', async (event) =&gt; {
      const { type, path } = JSON.parse(event.data);
      
      if (type === 'update' &amp;&amp; path === modulePath) {
        await this.reloadModule(modulePath);
      }
    });
  }
  
  async reloadModule(modulePath) {
    try {
      // æ¸…é™¤æ¨¡å—ç¼“å­˜
      delete window.moduleCache?.[modulePath];
      
      // é‡æ–°å¯¼å…¥æ¨¡å—
      const newModule = await import(`${modulePath}?t=${Date.now()}`);
      
      // æ›´æ–°æ¨¡å—å¼•ç”¨
      this.modules.set(modulePath, newModule);
      
      // è§¦å‘æ›´æ–°äº‹ä»¶
      this.emit('moduleUpdated', { path: modulePath, module: newModule });
      
    } catch (error) {
      console.error('Hot reload failed:', error);
    }
  }
  
  isDevelopment() {
    return process.env.NODE_ENV === 'development';
  }
}

// 3. Reactç»„ä»¶çƒ­é‡è½½
// ä½¿ç”¨React Fast Refresh
if (module.hot) {
  module.hot.accept('./MyComponent.jsx', () =&gt; {
    // React Fast Refreshä¼šè‡ªåŠ¨å¤„ç†ç»„ä»¶æ›´æ–°
  });
}
</code></pre>
<p>è¿™äº›FAQæ¶µç›–äº†JavaScriptæ¨¡å—åŒ–å¼€å‘ä¸­æœ€å¸¸é‡åˆ°çš„é—®é¢˜ã€‚é‡åˆ°å…·ä½“é—®é¢˜æ—¶ï¼Œå»ºè®®å…ˆæŸ¥çœ‹ç›¸å…³å·¥å…·çš„å®˜æ–¹æ–‡æ¡£ï¼Œç„¶åå‚è€ƒè¿™äº›è§£å†³æ–¹æ¡ˆè¿›è¡Œè°ƒè¯•å’Œä¼˜åŒ–ã€‚</p>
<hr>
<p><strong>ä¸‹ä¸€ç« </strong>: <a href="#å‚è€ƒèµ„æº">å‚è€ƒèµ„æº</a> â†’</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="å‚è€ƒèµ„æº"><a class="header" href="#å‚è€ƒèµ„æº">å‚è€ƒèµ„æº</a></h1>
<p>æœ¬ç« æ•´ç†äº†JavaScriptæ¨¡å—åŒ–å­¦ä¹ å’Œå¼€å‘ä¸­çš„é‡è¦å‚è€ƒèµ„æºï¼ŒåŒ…æ‹¬å®˜æ–¹æ–‡æ¡£ã€æŠ€æœ¯è§„èŒƒã€å®ç”¨å·¥å…·ã€ç¤¾åŒºèµ„æºå’Œæ¨èé˜…è¯»ã€‚</p>
<h2 id="å®˜æ–¹æ–‡æ¡£å’Œè§„èŒƒ"><a class="header" href="#å®˜æ–¹æ–‡æ¡£å’Œè§„èŒƒ">å®˜æ–¹æ–‡æ¡£å’Œè§„èŒƒ</a></h2>
<h3 id="ecmascriptè§„èŒƒ"><a class="header" href="#ecmascriptè§„èŒƒ">ECMAScriptè§„èŒƒ</a></h3>
<ul>
<li>
<p><strong><a href="https://tc39.es/ecma262/">ECMAScript 2025 Language Specification</a></strong></p>
<ul>
<li>JavaScriptè¯­è¨€çš„å®˜æ–¹è§„èŒƒ</li>
<li>åŒ…å«æœ€æ–°çš„æ¨¡å—ç³»ç»Ÿå®šä¹‰</li>
<li>TC39ææ¡ˆå’Œæ–°ç‰¹æ€§è·Ÿè¸ª</li>
</ul>
</li>
<li>
<p><strong><a href="https://tc39.es/ecma262/#sec-modules">ECMAScript Modules (ESM) è§„èŒƒ</a></strong></p>
<ul>
<li>ESæ¨¡å—çš„è¯¦ç»†æŠ€æœ¯è§„èŒƒ</li>
<li>æ¨¡å—è§£æç®—æ³•</li>
<li>åŠ¨æ€å¯¼å…¥è¯­ä¹‰</li>
</ul>
</li>
</ul>
<h3 id="æµè§ˆå™¨apiæ–‡æ¡£"><a class="header" href="#æµè§ˆå™¨apiæ–‡æ¡£">æµè§ˆå™¨APIæ–‡æ¡£</a></h3>
<ul>
<li>
<p><strong><a href="https://developer.mozilla.org/docs/Web/JavaScript/Guide/Modules">MDN Web Docs - JavaScript Modules</a></strong></p>
<ul>
<li>æƒå¨çš„JavaScriptæ¨¡å—æŒ‡å—</li>
<li>æµè§ˆå™¨å…¼å®¹æ€§ä¿¡æ¯</li>
<li>å®ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ</li>
</ul>
</li>
<li>
<p><strong><a href="https://developer.mozilla.org/docs/Web/HTML/Element/script/type/importmap">Web APIs - Import Maps</a></strong></p>
<ul>
<li>Import Mapsè§„èŒƒå’Œç”¨æ³•</li>
<li>æ¨¡å—è·¯å¾„æ˜ å°„</li>
</ul>
</li>
<li>
<p><strong><a href="https://developer.mozilla.org/docs/Web/HTML/Link_types/modulepreload">Web APIs - Module Preloading</a></strong></p>
<ul>
<li>æ¨¡å—é¢„åŠ è½½æœºåˆ¶</li>
<li>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
</ul>
</li>
</ul>
<h3 id="nodejsæ–‡æ¡£"><a class="header" href="#nodejsæ–‡æ¡£">Node.jsæ–‡æ¡£</a></h3>
<ul>
<li>
<p><strong><a href="https://nodejs.org/api/esm.html">Node.js ES Modules</a></strong></p>
<ul>
<li>Node.jsä¸­çš„ESæ¨¡å—æ”¯æŒ</li>
<li>CommonJSä¸ESMäº’æ“ä½œ</li>
<li>æ¨¡å—è§£æç®—æ³•</li>
</ul>
</li>
<li>
<p><strong><a href="https://nodejs.org/api/modules.html">Node.js Modules</a></strong></p>
<ul>
<li>CommonJSæ¨¡å—ç³»ç»Ÿ</li>
<li>require()å’Œmodule.exports</li>
<li>æ¨¡å—ç¼“å­˜æœºåˆ¶</li>
</ul>
</li>
</ul>
<h2 id="æ„å»ºå·¥å…·æ–‡æ¡£"><a class="header" href="#æ„å»ºå·¥å…·æ–‡æ¡£">æ„å»ºå·¥å…·æ–‡æ¡£</a></h2>
<h3 id="æ‰“åŒ…å·¥å…·-2"><a class="header" href="#æ‰“åŒ…å·¥å…·-2">æ‰“åŒ…å·¥å…·</a></h3>
<h4 id="webpack"><a class="header" href="#webpack">Webpack</a></h4>
<ul>
<li>
<p><strong><a href="https://webpack.js.org/">Webpackå®˜æ–¹æ–‡æ¡£</a></strong></p>
<ul>
<li>é…ç½®æŒ‡å—å’ŒAPIå‚è€ƒ</li>
<li>æ’ä»¶å’Œloaderç”Ÿæ€</li>
<li>ä»£ç åˆ†å‰²å’Œä¼˜åŒ–</li>
</ul>
</li>
<li>
<p><strong><a href="https://webpack.js.org/concepts/module-resolution/">Webpackæ¨¡å—è§£æ</a></strong></p>
<ul>
<li>æ¨¡å—è§£æé…ç½®</li>
<li>åˆ«åå’Œè·¯å¾„æ˜ å°„</li>
</ul>
</li>
</ul>
<h4 id="rollup"><a class="header" href="#rollup">Rollup</a></h4>
<ul>
<li><strong><a href="https://rollupjs.org/">Rollupå®˜æ–¹æ–‡æ¡£</a></strong>
<ul>
<li>é…ç½®å’Œæ’ä»¶ç³»ç»Ÿ</li>
<li>Tree ShakingåŸç†</li>
<li>è¾“å‡ºæ ¼å¼é€‰æ‹©</li>
</ul>
</li>
</ul>
<h4 id="vite"><a class="header" href="#vite">Vite</a></h4>
<ul>
<li><strong><a href="https://vitejs.dev/">Viteå®˜æ–¹æ–‡æ¡£</a></strong>
<ul>
<li>ç°ä»£æ„å»ºå·¥å…·æ¦‚å¿µ</li>
<li>å¼€å‘æœåŠ¡å™¨å’ŒHMR</li>
<li>æ’ä»¶å¼€å‘æŒ‡å—</li>
</ul>
</li>
</ul>
<h4 id="esbuild"><a class="header" href="#esbuild">esbuild</a></h4>
<ul>
<li><strong><a href="https://esbuild.github.io/">esbuildæ–‡æ¡£</a></strong>
<ul>
<li>é«˜æ€§èƒ½æ„å»ºé…ç½®</li>
<li>APIå’Œå‘½ä»¤è¡Œä½¿ç”¨</li>
<li>ä¸å…¶ä»–å·¥å…·é›†æˆ</li>
</ul>
</li>
</ul>
<h3 id="è½¬è¯‘å·¥å…·-2"><a class="header" href="#è½¬è¯‘å·¥å…·-2">è½¬è¯‘å·¥å…·</a></h3>
<h4 id="babel"><a class="header" href="#babel">Babel</a></h4>
<ul>
<li><strong><a href="https://babeljs.io/docs/">Babelå®˜æ–¹æ–‡æ¡£</a></strong>
<ul>
<li>é¢„è®¾å’Œæ’ä»¶é…ç½®</li>
<li>æ¨¡å—è½¬æ¢è§„åˆ™</li>
<li>å…¼å®¹æ€§å¤„ç†</li>
</ul>
</li>
</ul>
<h4 id="swc"><a class="header" href="#swc">SWC</a></h4>
<ul>
<li><strong><a href="https://swc.rs/">SWCæ–‡æ¡£</a></strong>
<ul>
<li>Rustç¼–å†™çš„å¿«é€Ÿç¼–è¯‘å™¨</li>
<li>é…ç½®å’Œä½¿ç”¨æŒ‡å—</li>
<li>æ€§èƒ½åŸºå‡†æµ‹è¯•</li>
</ul>
</li>
</ul>
<h4 id="typescript"><a class="header" href="#typescript">TypeScript</a></h4>
<ul>
<li><strong><a href="https://www.typescriptlang.org/docs/">TypeScript Handbook</a></strong>
<ul>
<li>æ¨¡å—ç³»ç»Ÿæ”¯æŒ</li>
<li>é…ç½®å’Œç¼–è¯‘é€‰é¡¹</li>
<li>ç±»å‹å®šä¹‰å’Œå£°æ˜</li>
</ul>
</li>
</ul>
<h2 id="è¿è¡Œæ—¶ç¯å¢ƒ"><a class="header" href="#è¿è¡Œæ—¶ç¯å¢ƒ">è¿è¡Œæ—¶ç¯å¢ƒ</a></h2>
<h3 id="nodejsç”Ÿæ€"><a class="header" href="#nodejsç”Ÿæ€">Node.jsç”Ÿæ€</a></h3>
<ul>
<li>
<p><strong><a href="https://docs.npmjs.com/">npmæ–‡æ¡£</a></strong></p>
<ul>
<li>åŒ…ç®¡ç†å’Œå‘å¸ƒ</li>
<li>package.jsoné…ç½®</li>
<li>è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶</li>
</ul>
</li>
<li>
<p><strong><a href="https://yarnpkg.com/">yarnæ–‡æ¡£</a></strong></p>
<ul>
<li>ç°ä»£åŒ…ç®¡ç†å™¨</li>
<li>Workspaceså’ŒMonorepo</li>
<li>Plugâ€™nâ€™Playç‰¹æ€§</li>
</ul>
</li>
<li>
<p><strong><a href="https://pnpm.io/">pnpmæ–‡æ¡£</a></strong></p>
<ul>
<li>é«˜æ•ˆçš„åŒ…ç®¡ç†å™¨</li>
<li>ç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥</li>
<li>ç©ºé—´èŠ‚çœç­–ç•¥</li>
</ul>
</li>
</ul>
<h3 id="ç°ä»£è¿è¡Œæ—¶"><a class="header" href="#ç°ä»£è¿è¡Œæ—¶">ç°ä»£è¿è¡Œæ—¶</a></h3>
<h4 id="deno"><a class="header" href="#deno">Deno</a></h4>
<ul>
<li><strong><a href="https://deno.land/manual">Denoå®˜æ–¹æ–‡æ¡£</a></strong>
<ul>
<li>å®‰å…¨çš„JavaScriptè¿è¡Œæ—¶</li>
<li>å†…ç½®TypeScriptæ”¯æŒ</li>
<li>æ ‡å‡†åº“å’Œæ¨¡å—ç³»ç»Ÿ</li>
</ul>
</li>
</ul>
<h4 id="bun"><a class="header" href="#bun">Bun</a></h4>
<ul>
<li><strong><a href="https://bun.sh/docs">Bunæ–‡æ¡£</a></strong>
<ul>
<li>å¿«é€Ÿçš„JavaScriptè¿è¡Œæ—¶</li>
<li>å†…ç½®åŒ…ç®¡ç†å™¨</li>
<li>å…¼å®¹æ€§å’Œæ€§èƒ½</li>
</ul>
</li>
</ul>
<h2 id="æŠ€æœ¯åšå®¢å’Œæ–‡ç« "><a class="header" href="#æŠ€æœ¯åšå®¢å’Œæ–‡ç« ">æŠ€æœ¯åšå®¢å’Œæ–‡ç« </a></h2>
<h3 id="æƒå¨æŠ€æœ¯åšå®¢"><a class="header" href="#æƒå¨æŠ€æœ¯åšå®¢">æƒå¨æŠ€æœ¯åšå®¢</a></h3>
<ul>
<li>
<p><strong><a href="https://v8.dev/blog">V8 JavaScript Engine Blog</a></strong></p>
<ul>
<li>V8å¼•æ“æŠ€æœ¯æ·±åº¦åˆ†æ</li>
<li>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li>æ–°ç‰¹æ€§å®ç°ç»†èŠ‚</li>
</ul>
</li>
<li>
<p><strong><a href="https://developer.chrome.com/blog/">Chrome Developers Blog</a></strong></p>
<ul>
<li>Webå¹³å°æ–°ç‰¹æ€§</li>
<li>æ€§èƒ½ä¼˜åŒ–æŒ‡å—</li>
<li>å¼€å‘è€…å·¥å…·æ›´æ–°</li>
</ul>
</li>
<li>
<p><strong><a href="https://hacks.mozilla.org/">Mozilla Hacks</a></strong></p>
<ul>
<li>Firefoxæµè§ˆå™¨æŠ€æœ¯</li>
<li>Webæ ‡å‡†å’ŒAPI</li>
<li>å¼€å‘æœ€ä½³å®è·µ</li>
</ul>
</li>
</ul>
<h3 id="æŠ€æœ¯ç¤¾åŒº"><a class="header" href="#æŠ€æœ¯ç¤¾åŒº">æŠ€æœ¯ç¤¾åŒº</a></h3>
<ul>
<li>
<p><strong><a href="https://javascriptweekly.com/">JavaScript Weekly</a></strong></p>
<ul>
<li>JavaScriptç”Ÿæ€å‘¨æŠ¥</li>
<li>æ–°å·¥å…·å’Œåº“æ¨è</li>
<li>æŠ€æœ¯æ–‡ç« ç²¾é€‰</li>
</ul>
</li>
<li>
<p><strong><a href="https://dev.to/t/javascript">Dev.to JavaScript</a></strong></p>
<ul>
<li>å¼€å‘è€…ç¤¾åŒºæ–‡ç« </li>
<li>å®æˆ˜ç»éªŒåˆ†äº«</li>
<li>é—®é¢˜è§£ç­”å’Œè®¨è®º</li>
</ul>
</li>
<li>
<p><strong><a href="https://stackoverflow.com/questions/tagged/javascript-modules">Stack Overflow</a></strong></p>
<ul>
<li>é—®é¢˜è§£ç­”ç¤¾åŒº</li>
<li>å®é™…é—®é¢˜æ¡ˆä¾‹</li>
<li>ä¸“å®¶è§£å†³æ–¹æ¡ˆ</li>
</ul>
</li>
</ul>
<h2 id="åœ¨çº¿å­¦ä¹ èµ„æº"><a class="header" href="#åœ¨çº¿å­¦ä¹ èµ„æº">åœ¨çº¿å­¦ä¹ èµ„æº</a></h2>
<h3 id="å…è´¹è¯¾ç¨‹"><a class="header" href="#å…è´¹è¯¾ç¨‹">å…è´¹è¯¾ç¨‹</a></h3>
<ul>
<li>
<p><strong><a href="https://javascript.info/modules">JavaScript.info - Modules</a></strong></p>
<ul>
<li>ç³»ç»Ÿçš„JavaScriptæ•™ç¨‹</li>
<li>æ¨¡å—åŒ–æ¦‚å¿µè®²è§£</li>
<li>äº’åŠ¨ç¤ºä¾‹å’Œç»ƒä¹ </li>
</ul>
</li>
<li>
<p><strong><a href="https://www.freecodecamp.org/">FreeCodeCamp</a></strong></p>
<ul>
<li>å…è´¹ç¼–ç¨‹è¯¾ç¨‹</li>
<li>é¡¹ç›®é©±åŠ¨å­¦ä¹ </li>
<li>ç¤¾åŒºæ”¯æŒ</li>
</ul>
</li>
<li>
<p><strong><a href="https://developer.mozilla.org/docs/Learn">MDN Learning Area</a></strong></p>
<ul>
<li>Webå¼€å‘å­¦ä¹ è·¯å¾„</li>
<li>åŸºç¡€åˆ°é«˜çº§å†…å®¹</li>
<li>å®è·µé¡¹ç›®æŒ‡å¯¼</li>
</ul>
</li>
</ul>
<h3 id="ä»˜è´¹è¯¾ç¨‹"><a class="header" href="#ä»˜è´¹è¯¾ç¨‹">ä»˜è´¹è¯¾ç¨‹</a></h3>
<ul>
<li>
<p><strong><a href="https://frontendmasters.com/">Frontend Masters</a></strong></p>
<ul>
<li>ä¸“ä¸šå‰ç«¯è¯¾ç¨‹</li>
<li>è¡Œä¸šä¸“å®¶æˆè¯¾</li>
<li>æ·±åº¦æŠ€æœ¯è®²è§£</li>
</ul>
</li>
<li>
<p><strong><a href="https://egghead.io/">Egghead.io</a></strong></p>
<ul>
<li>ç®€æ´çš„æŠ€æœ¯è§†é¢‘</li>
<li>ç‰¹å®šæŠ€æœ¯ä¸“é¢˜</li>
<li>å®ç”¨æŠ€èƒ½åŸ¹è®­</li>
</ul>
</li>
</ul>
<h2 id="å·¥å…·å’Œèµ„æº"><a class="header" href="#å·¥å…·å’Œèµ„æº">å·¥å…·å’Œèµ„æº</a></h2>
<h3 id="å¼€å‘å·¥å…·"><a class="header" href="#å¼€å‘å·¥å…·">å¼€å‘å·¥å…·</a></h3>
<h4 id="ä»£ç ç¼–è¾‘å™¨æ’ä»¶"><a class="header" href="#ä»£ç ç¼–è¾‘å™¨æ’ä»¶">ä»£ç ç¼–è¾‘å™¨æ’ä»¶</a></h4>
<ul>
<li><strong>VS Code Extensions</strong>
<ul>
<li>ES6 Module Snippets</li>
<li>Auto Import - ES6, TS, JSX, TSX</li>
<li>Path Intellisense</li>
<li>Import Cost</li>
</ul>
</li>
</ul>
<h4 id="åœ¨çº¿å·¥å…·"><a class="header" href="#åœ¨çº¿å·¥å…·">åœ¨çº¿å·¥å…·</a></h4>
<ul>
<li>
<p><strong><a href="https://github.com/webpack-contrib/webpack-bundle-analyzer">Webpack Bundle Analyzer</a></strong></p>
<ul>
<li>åŒ…ä½“ç§¯åˆ†æå·¥å…·</li>
<li>ä¾èµ–å…³ç³»å¯è§†åŒ–</li>
<li>ä¼˜åŒ–å»ºè®®</li>
</ul>
</li>
<li>
<p><strong><a href="https://bundlephobia.com/">Bundlephobia</a></strong></p>
<ul>
<li>npmåŒ…å¤§å°åˆ†æ</li>
<li>æ‰“åŒ…å½±å“è¯„ä¼°</li>
<li>æ›¿ä»£æ–¹æ¡ˆæ¨è</li>
</ul>
</li>
<li>
<p><strong><a href="https://caniuse.com/">Can I Use</a></strong></p>
<ul>
<li>æµè§ˆå™¨å…¼å®¹æ€§æŸ¥è¯¢</li>
<li>åŠŸèƒ½æ”¯æŒçŠ¶æ€</li>
<li>ä½¿ç”¨ç»Ÿè®¡æ•°æ®</li>
</ul>
</li>
</ul>
<h3 id="ä»£ç ç¤ºä¾‹å’Œæ¨¡æ¿"><a class="header" href="#ä»£ç ç¤ºä¾‹å’Œæ¨¡æ¿">ä»£ç ç¤ºä¾‹å’Œæ¨¡æ¿</a></h3>
<ul>
<li>
<p><strong><a href="https://github.com/topics/javascript-modules">GitHub - Module Examples</a></strong></p>
<ul>
<li>å¼€æºæ¨¡å—ç¤ºä¾‹</li>
<li>æœ€ä½³å®è·µå±•ç¤º</li>
<li>å­¦ä¹ å‚è€ƒä»£ç </li>
</ul>
</li>
<li>
<p><strong><a href="https://codesandbox.io/">CodeSandbox</a></strong></p>
<ul>
<li>åœ¨çº¿ä»£ç ç¼–è¾‘å™¨</li>
<li>æ¨¡å—åŒ–é¡¹ç›®æ¨¡æ¿</li>
<li>å®æ—¶åä½œå¼€å‘</li>
</ul>
</li>
<li>
<p><strong><a href="https://jsfiddle.net/">JSFiddle</a></strong></p>
<ul>
<li>å¿«é€ŸåŸå‹å¼€å‘</li>
<li>ä»£ç ç‰‡æ®µåˆ†äº«</li>
<li>å®éªŒå’Œæµ‹è¯•</li>
</ul>
</li>
</ul>
<h2 id="ä¹¦ç±æ¨è"><a class="header" href="#ä¹¦ç±æ¨è">ä¹¦ç±æ¨è</a></h2>
<h3 id="ç»å…¸æŠ€æœ¯ä¹¦ç±"><a class="header" href="#ç»å…¸æŠ€æœ¯ä¹¦ç±">ç»å…¸æŠ€æœ¯ä¹¦ç±</a></h3>
<h4 id="javascriptæ ¸å¿ƒæŠ€æœ¯"><a class="header" href="#javascriptæ ¸å¿ƒæŠ€æœ¯">JavaScriptæ ¸å¿ƒæŠ€æœ¯</a></h4>
<ul>
<li>
<p><strong>ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹</strong> (Professional JavaScript for Web Developers)</p>
<ul>
<li>ä½œè€…: Nicholas C. Zakas</li>
<li>å…¨é¢çš„JavaScriptè¯­è¨€æŒ‡å—</li>
<li>æ¨¡å—åŒ–ç« èŠ‚è¯¦ç»†è®²è§£</li>
</ul>
</li>
<li>
<p><strong>ã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹</strong> (You Donâ€™t Know JS)</p>
<ul>
<li>ä½œè€…: Kyle Simpson</li>
<li>æ·±å…¥JavaScriptè¯­è¨€æœºåˆ¶</li>
<li>æ¨¡å—ç³»ç»Ÿåº•å±‚åŸç†</li>
</ul>
</li>
<li>
<p><strong>ã€ŠJavaScriptè¯­è¨€ç²¾ç²¹ã€‹</strong> (JavaScript: The Good Parts)</p>
<ul>
<li>ä½œè€…: Douglas Crockford</li>
<li>JavaScriptæœ€ä½³å®è·µ</li>
<li>ä»£ç ç»„ç»‡å’Œæ¨¡å—åŒ–æ€æƒ³</li>
</ul>
</li>
</ul>
<h4 id="å‰ç«¯å·¥ç¨‹åŒ–"><a class="header" href="#å‰ç«¯å·¥ç¨‹åŒ–">å‰ç«¯å·¥ç¨‹åŒ–</a></h4>
<ul>
<li>
<p><strong>ã€Šå‰ç«¯å·¥ç¨‹åŒ–ï¼šä½“ç³»è®¾è®¡ä¸å®è·µã€‹</strong></p>
<ul>
<li>ç°ä»£å‰ç«¯å¼€å‘æµç¨‹</li>
<li>æ¨¡å—åŒ–å·¥å…·é“¾</li>
<li>æœ€ä½³å®è·µæ¡ˆä¾‹</li>
</ul>
</li>
<li>
<p><strong>ã€ŠWebpackå®æˆ˜ï¼šå…¥é—¨ã€è¿›é˜¶ä¸ä¼˜åŒ–ã€‹</strong></p>
<ul>
<li>Webpackæ·±åº¦ä½¿ç”¨æŒ‡å—</li>
<li>æ¨¡å—æ‰“åŒ…ä¼˜åŒ–</li>
<li>å®é™…é¡¹ç›®åº”ç”¨</li>
</ul>
</li>
</ul>
<h3 id="åœ¨çº¿ç”µå­ä¹¦"><a class="header" href="#åœ¨çº¿ç”µå­ä¹¦">åœ¨çº¿ç”µå­ä¹¦</a></h3>
<ul>
<li>
<p><strong><a href="https://eloquentjavascript.net/">Eloquent JavaScript</a></strong></p>
<ul>
<li>å…è´¹çš„JavaScriptæ•™ç¨‹</li>
<li>æ¨¡å—åŒ–ç¼–ç¨‹ç« èŠ‚</li>
<li>äº¤äº’å¼ç»ƒä¹ </li>
</ul>
</li>
<li>
<p><strong><a href="https://exploringjs.com/es6/">Exploring ES6</a></strong></p>
<ul>
<li>ES6æ–°ç‰¹æ€§è¯¦è§£</li>
<li>æ¨¡å—ç³»ç»Ÿæ·±å…¥åˆ†æ</li>
<li>å®ç”¨ç¤ºä¾‹ä»£ç </li>
</ul>
</li>
</ul>
<h2 id="æŠ€æœ¯ä¼šè®®å’Œæ´»åŠ¨"><a class="header" href="#æŠ€æœ¯ä¼šè®®å’Œæ´»åŠ¨">æŠ€æœ¯ä¼šè®®å’Œæ´»åŠ¨</a></h2>
<h3 id="å›½é™…æŠ€æœ¯ä¼šè®®"><a class="header" href="#å›½é™…æŠ€æœ¯ä¼šè®®">å›½é™…æŠ€æœ¯ä¼šè®®</a></h3>
<ul>
<li>
<p><strong><a href="https://jsconf.com/">JSConf</a></strong></p>
<ul>
<li>JavaScriptæŠ€æœ¯å¤§ä¼š</li>
<li>æœ€æ–°æŠ€æœ¯è¶‹åŠ¿</li>
<li>ç¤¾åŒºäº¤æµå¹³å°</li>
</ul>
</li>
<li>
<p><strong><a href="https://conf.reactjs.org/">React Conf</a></strong></p>
<ul>
<li>Reactç”Ÿæ€å¤§ä¼š</li>
<li>ç»„ä»¶å’Œæ¨¡å—åŒ–</li>
<li>æœ€ä½³å®è·µåˆ†äº«</li>
</ul>
</li>
<li>
<p><strong><a href="https://vueconf.us/">VueConf</a></strong></p>
<ul>
<li>Vue.jsæŠ€æœ¯å¤§ä¼š</li>
<li>ç°ä»£å‰ç«¯å¼€å‘</li>
<li>å·¥å…·é“¾å’Œç”Ÿæ€</li>
</ul>
</li>
</ul>
<h3 id="å›½å†…æŠ€æœ¯æ´»åŠ¨"><a class="header" href="#å›½å†…æŠ€æœ¯æ´»åŠ¨">å›½å†…æŠ€æœ¯æ´»åŠ¨</a></h3>
<ul>
<li>
<p><strong><a href="https://gmtc.infoq.cn/">GMTCå…¨çƒå¤§å‰ç«¯æŠ€æœ¯å¤§ä¼š</a></strong></p>
<ul>
<li>å‰ç«¯æŠ€æœ¯è¶‹åŠ¿</li>
<li>å¤§å‚æŠ€æœ¯å®è·µ</li>
<li>å·¥ç¨‹åŒ–ç»éªŒåˆ†äº«</li>
</ul>
</li>
<li>
<p><strong><a href="https://d2.alibaba-inc.com/">D2å‰ç«¯æŠ€æœ¯è®ºå›</a></strong></p>
<ul>
<li>é˜¿é‡Œå·´å·´å‰ç«¯å¤§ä¼š</li>
<li>æŠ€æœ¯åˆ›æ–°å’Œå®è·µ</li>
<li>å¼€æºé¡¹ç›®æ¨å¹¿</li>
</ul>
</li>
</ul>
<h2 id="å¼€æºé¡¹ç›®å’Œæ¡ˆä¾‹"><a class="header" href="#å¼€æºé¡¹ç›®å’Œæ¡ˆä¾‹">å¼€æºé¡¹ç›®å’Œæ¡ˆä¾‹</a></h2>
<h3 id="ä¼˜ç§€å¼€æºé¡¹ç›®"><a class="header" href="#ä¼˜ç§€å¼€æºé¡¹ç›®">ä¼˜ç§€å¼€æºé¡¹ç›®</a></h3>
<h4 id="æ¨¡å—åŒ–åº“"><a class="header" href="#æ¨¡å—åŒ–åº“">æ¨¡å—åŒ–åº“</a></h4>
<ul>
<li>
<p><strong><a href="https://github.com/lodash/lodash">Lodash</a></strong></p>
<ul>
<li>å®ç”¨å·¥å…·åº“</li>
<li>æ¨¡å—åŒ–è®¾è®¡å…¸èŒƒ</li>
<li>Tree Shakingå‹å¥½</li>
</ul>
</li>
<li>
<p><strong><a href="https://github.com/ReactiveX/rxjs">RxJS</a></strong></p>
<ul>
<li>å“åº”å¼ç¼–ç¨‹åº“</li>
<li>æ“ä½œç¬¦æ¨¡å—åŒ–</li>
<li>å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼</li>
</ul>
</li>
<li>
<p><strong><a href="https://github.com/mrdoob/three.js">Three.js</a></strong></p>
<ul>
<li>3Då›¾å½¢åº“</li>
<li>å¤§å‹é¡¹ç›®æ¨¡å—ç»„ç»‡</li>
<li>æ’ä»¶å¼æ¶æ„</li>
</ul>
</li>
</ul>
<h4 id="æ„å»ºå·¥å…·"><a class="header" href="#æ„å»ºå·¥å…·">æ„å»ºå·¥å…·</a></h4>
<ul>
<li>
<p><strong><a href="https://github.com/facebook/create-react-app">Create React App</a></strong></p>
<ul>
<li>Reactåº”ç”¨è„šæ‰‹æ¶</li>
<li>é›¶é…ç½®æ¨¡å—åŒ–æ„å»º</li>
<li>æœ€ä½³å®è·µé›†æˆ</li>
</ul>
</li>
<li>
<p><strong><a href="https://github.com/vuejs/vue-cli">Vue CLI</a></strong></p>
<ul>
<li>Vue.jsé¡¹ç›®è„šæ‰‹æ¶</li>
<li>æ’ä»¶åŒ–æ¶æ„</li>
<li>ç°ä»£å·¥å…·é“¾é›†æˆ</li>
</ul>
</li>
</ul>
<h3 id="å­¦ä¹ æ¡ˆä¾‹"><a class="header" href="#å­¦ä¹ æ¡ˆä¾‹">å­¦ä¹ æ¡ˆä¾‹</a></h3>
<ul>
<li>
<p><strong><a href="https://github.com/tastejs/todomvc">TodoMVC</a></strong></p>
<ul>
<li>ç›¸åŒåº”ç”¨ä¸åŒæ¡†æ¶å®ç°</li>
<li>æ¨¡å—åŒ–æ¶æ„å¯¹æ¯”</li>
<li>ä»£ç ç»„ç»‡æ–¹å¼</li>
</ul>
</li>
<li>
<p><strong><a href="https://github.com/gothinkster/realworld">RealWorld</a></strong></p>
<ul>
<li>å…¨æ ˆåº”ç”¨ç¤ºä¾‹</li>
<li>å‰åç«¯æ¨¡å—åŒ–</li>
<li>æœ€ä½³å®è·µå±•ç¤º</li>
</ul>
</li>
</ul>
<h2 id="æ ‡å‡†å’Œææ¡ˆ"><a class="header" href="#æ ‡å‡†å’Œææ¡ˆ">æ ‡å‡†å’Œææ¡ˆ</a></h2>
<h3 id="w3cæ ‡å‡†"><a class="header" href="#w3cæ ‡å‡†">W3Cæ ‡å‡†</a></h3>
<ul>
<li>
<p><strong><a href="https://www.w3.org/TR/components-intro/">Web Components</a></strong></p>
<ul>
<li>ç»„ä»¶åŒ–Webæ ‡å‡†</li>
<li>è‡ªå®šä¹‰å…ƒç´ å’ŒShadow DOM</li>
<li>æ¨¡å—åŒ–UIç»„ä»¶</li>
</ul>
</li>
<li>
<p><strong><a href="https://www.w3.org/TR/service-workers/">Service Workers</a></strong></p>
<ul>
<li>ç¦»çº¿åŠŸèƒ½å’Œç¼“å­˜</li>
<li>æ¨¡å—åŒ–æ¸è¿›å¼åº”ç”¨</li>
<li>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</li>
</ul>
</li>
</ul>
<h3 id="tc39ææ¡ˆ"><a class="header" href="#tc39ææ¡ˆ">TC39ææ¡ˆ</a></h3>
<ul>
<li>
<p><strong><a href="https://github.com/tc39/proposal-import-assertions">Import Assertions</a></strong></p>
<ul>
<li>å¯¼å…¥æ–­è¨€ææ¡ˆ</li>
<li>æ¨¡å—ç±»å‹éªŒè¯</li>
<li>JSONæ¨¡å—æ”¯æŒ</li>
</ul>
</li>
<li>
<p><strong><a href="https://github.com/tc39/proposal-top-level-await">Top-level await</a></strong></p>
<ul>
<li>é¡¶å±‚awaitææ¡ˆ</li>
<li>å¼‚æ­¥æ¨¡å—åˆå§‹åŒ–</li>
<li>æ¨¡å—ä¾èµ–å¤„ç†</li>
</ul>
</li>
</ul>
<h2 id="æ€§èƒ½ç›‘æ§å’Œåˆ†æ"><a class="header" href="#æ€§èƒ½ç›‘æ§å’Œåˆ†æ">æ€§èƒ½ç›‘æ§å’Œåˆ†æ</a></h2>
<h3 id="æ€§èƒ½åˆ†æå·¥å…·"><a class="header" href="#æ€§èƒ½åˆ†æå·¥å…·">æ€§èƒ½åˆ†æå·¥å…·</a></h3>
<ul>
<li>
<p><strong><a href="https://developers.google.com/web/tools/lighthouse">Lighthouse</a></strong></p>
<ul>
<li>Webæ€§èƒ½å®¡è®¡å·¥å…·</li>
<li>æ¨¡å—åŠ è½½æ€§èƒ½åˆ†æ</li>
<li>ä¼˜åŒ–å»ºè®®ç”Ÿæˆ</li>
</ul>
</li>
<li>
<p><strong><a href="https://www.webpagetest.org/">WebPageTest</a></strong></p>
<ul>
<li>ç½‘é¡µæ€§èƒ½æµ‹è¯•</li>
<li>æ¨¡å—åŠ è½½ç€‘å¸ƒå›¾</li>
<li>çœŸå®ç”¨æˆ·ä½“éªŒæ¨¡æ‹Ÿ</li>
</ul>
</li>
<li>
<p><strong><a href="https://developers.google.com/web/tools/chrome-devtools">Chrome DevTools</a></strong></p>
<ul>
<li>æµè§ˆå™¨å¼€å‘è€…å·¥å…·</li>
<li>ç½‘ç»œé¢æ¿åˆ†æ</li>
<li>æ€§èƒ½é¢æ¿è°ƒè¯•</li>
</ul>
</li>
</ul>
<h3 id="ç›‘æ§æœåŠ¡"><a class="header" href="#ç›‘æ§æœåŠ¡">ç›‘æ§æœåŠ¡</a></h3>
<ul>
<li>
<p><strong><a href="https://sentry.io/">Sentry</a></strong></p>
<ul>
<li>é”™è¯¯ç›‘æ§å’Œæ€§èƒ½è¿½è¸ª</li>
<li>æ¨¡å—åŠ è½½é”™è¯¯åˆ†æ</li>
<li>ç”¨æˆ·ä½“éªŒç›‘æ§</li>
</ul>
</li>
<li>
<p><strong><a href="https://www.datadoghq.com/">DataDog</a></strong></p>
<ul>
<li>åº”ç”¨æ€§èƒ½ç›‘æ§</li>
<li>å‰ç«¯æ€§èƒ½æŒ‡æ ‡</li>
<li>å®æ—¶æ•°æ®åˆ†æ</li>
</ul>
</li>
</ul>
<h2 id="ç¤¾åŒºå’Œè®ºå›"><a class="header" href="#ç¤¾åŒºå’Œè®ºå›">ç¤¾åŒºå’Œè®ºå›</a></h2>
<h3 id="æŠ€æœ¯ç¤¾åŒº-1"><a class="header" href="#æŠ€æœ¯ç¤¾åŒº-1">æŠ€æœ¯ç¤¾åŒº</a></h3>
<ul>
<li>
<p><strong><a href="https://www.reddit.com/r/javascript/">Reddit - JavaScript</a></strong></p>
<ul>
<li>JavaScriptæŠ€æœ¯è®¨è®º</li>
<li>æ–°é—»å’Œèµ„æºåˆ†äº«</li>
<li>é—®é¢˜æ±‚åŠ©å’Œè§£ç­”</li>
</ul>
</li>
<li>
<p><strong><a href="https://discord.gg/javascript">Discord - JavaScript</a></strong></p>
<ul>
<li>å®æ—¶æŠ€æœ¯äº¤æµ</li>
<li>ç¤¾åŒºäº’åŠ©</li>
<li>é¡¹ç›®å±•ç¤º</li>
</ul>
</li>
<li>
<p><strong><a href="https://t.me/javascript">Telegram - JavaScript</a></strong></p>
<ul>
<li>æŠ€æœ¯èµ„è®¯æ¨é€</li>
<li>å¿«é€Ÿé—®é¢˜è§£ç­”</li>
<li>èµ„æºåˆ†äº«</li>
</ul>
</li>
</ul>
<h3 id="ä¸­æ–‡ç¤¾åŒº"><a class="header" href="#ä¸­æ–‡ç¤¾åŒº">ä¸­æ–‡ç¤¾åŒº</a></h3>
<ul>
<li>
<p><strong><a href="https://juejin.cn/frontend">æ˜é‡‘</a></strong></p>
<ul>
<li>ä¸­æ–‡æŠ€æœ¯ç¤¾åŒº</li>
<li>å‰ç«¯æŠ€æœ¯æ–‡ç« </li>
<li>ç»éªŒåˆ†äº«å’Œè®¨è®º</li>
</ul>
</li>
<li>
<p><strong><a href="https://segmentfault.com/t/javascript">æ€å¦ (SegmentFault)</a></strong></p>
<ul>
<li>ä¸­æ–‡é—®ç­”ç¤¾åŒº</li>
<li>æŠ€æœ¯é—®é¢˜è§£å†³</li>
<li>ä»£ç ç‰‡æ®µåˆ†äº«</li>
</ul>
</li>
<li>
<p><strong><a href="https://www.v2ex.com/go/javascript">V2EX</a></strong></p>
<ul>
<li>åˆ›æ„å·¥ä½œè€…ç¤¾åŒº</li>
<li>æŠ€æœ¯è®¨è®ºå’Œåˆ†äº«</li>
<li>èŒä¸šå‘å±•äº¤æµ</li>
</ul>
</li>
</ul>
<h2 id="è®¢é˜…æ¨è"><a class="header" href="#è®¢é˜…æ¨è">è®¢é˜…æ¨è</a></h2>
<h3 id="æŠ€æœ¯å‘¨æŠ¥"><a class="header" href="#æŠ€æœ¯å‘¨æŠ¥">æŠ€æœ¯å‘¨æŠ¥</a></h3>
<ul>
<li>
<p><strong><a href="https://javascriptweekly.com/">JavaScript Weekly</a></strong></p>
<ul>
<li>æ¯å‘¨JavaScriptèµ„è®¯</li>
<li>æ–°å·¥å…·å’Œåº“æ¨è</li>
<li>æŠ€æœ¯æ–‡ç« ç²¾é€‰</li>
</ul>
</li>
<li>
<p><strong><a href="https://frontendfoc.us/">Frontend Focus</a></strong></p>
<ul>
<li>å‰ç«¯æŠ€æœ¯å‘¨æŠ¥</li>
<li>è®¾è®¡å’Œå¼€å‘è¶‹åŠ¿</li>
<li>æµè§ˆå™¨æ–°ç‰¹æ€§</li>
</ul>
</li>
<li>
<p><strong><a href="https://react.statuscode.com/">React Status</a></strong></p>
<ul>
<li>Reactç”Ÿæ€å‘¨æŠ¥</li>
<li>ç»„ä»¶åº“å’Œå·¥å…·æ¨è</li>
<li>æœ€ä½³å®è·µåˆ†äº«</li>
</ul>
</li>
</ul>
<h3 id="æŠ€æœ¯åšå®¢"><a class="header" href="#æŠ€æœ¯åšå®¢">æŠ€æœ¯åšå®¢</a></h3>
<ul>
<li>
<p><strong><a href="https://overreacted.io/">Overreacted</a></strong></p>
<ul>
<li>Dan Abramovçš„æŠ€æœ¯åšå®¢</li>
<li>Reactå’ŒJavaScriptæ·±åº¦æ–‡ç« </li>
<li>æŠ€æœ¯æ€è€ƒå’Œè§è§£</li>
</ul>
</li>
<li>
<p><strong><a href="https://2ality.com/">2ality</a></strong></p>
<ul>
<li>Dr. Axel Rauschmayerçš„åšå®¢</li>
<li>JavaScriptè¯­è¨€ç‰¹æ€§åˆ†æ</li>
<li>ECMAScriptè§„èŒƒè§£è¯»</li>
</ul>
</li>
</ul>
<h2 id="å·¥å…·é“¾é…ç½®æ¨¡æ¿"><a class="header" href="#å·¥å…·é“¾é…ç½®æ¨¡æ¿">å·¥å…·é“¾é…ç½®æ¨¡æ¿</a></h2>
<h3 id="é¡¹ç›®æ¨¡æ¿"><a class="header" href="#é¡¹ç›®æ¨¡æ¿">é¡¹ç›®æ¨¡æ¿</a></h3>
<ul>
<li>
<p><strong><a href="https://github.com/vitejs/vite/tree/main/packages/create-vite">create-vite</a></strong></p>
<ul>
<li>Viteé¡¹ç›®æ¨¡æ¿</li>
<li>å¤šæ¡†æ¶æ”¯æŒ</li>
<li>ç°ä»£å·¥å…·é“¾é…ç½®</li>
</ul>
</li>
<li>
<p><strong><a href="https://github.com/facebook/create-react-app">create-react-app</a></strong></p>
<ul>
<li>Reacté¡¹ç›®æ¨¡æ¿</li>
<li>é›¶é…ç½®å¯åŠ¨</li>
<li>æ¸è¿›å¼å¢å¼º</li>
</ul>
</li>
</ul>
<h3 id="é…ç½®ç¤ºä¾‹"><a class="header" href="#é…ç½®ç¤ºä¾‹">é…ç½®ç¤ºä¾‹</a></h3>
<ul>
<li>
<p><strong><a href="https://github.com/webpack-contrib/awesome-webpack">Awesome Webpack</a></strong></p>
<ul>
<li>Webpackèµ„æºæ±‡æ€»</li>
<li>é…ç½®ç¤ºä¾‹é›†åˆ</li>
<li>æ’ä»¶å’Œloaderæ¨è</li>
</ul>
</li>
<li>
<p><strong><a href="https://github.com/rollup/awesome">Awesome Rollup</a></strong></p>
<ul>
<li>Rollupç”Ÿæ€èµ„æº</li>
<li>æ’ä»¶å’Œå·¥å…·æ¨è</li>
<li>é…ç½®ç¤ºä¾‹å’Œæ•™ç¨‹</li>
</ul>
</li>
</ul>
<h2 id="æŒç»­å­¦ä¹ å»ºè®®"><a class="header" href="#æŒç»­å­¦ä¹ å»ºè®®">æŒç»­å­¦ä¹ å»ºè®®</a></h2>
<h3 id="å­¦ä¹ è·¯å¾„-1"><a class="header" href="#å­¦ä¹ è·¯å¾„-1">å­¦ä¹ è·¯å¾„</a></h3>
<ol>
<li>
<p><strong>åŸºç¡€é˜¶æ®µ</strong></p>
<ul>
<li>æŒæ¡ESæ¨¡å—è¯­æ³•</li>
<li>ç†è§£æ¨¡å—åŒ–æ¦‚å¿µ</li>
<li>å­¦ä¹ åŸºç¡€å·¥å…·ä½¿ç”¨</li>
</ul>
</li>
<li>
<p><strong>è¿›é˜¶é˜¶æ®µ</strong></p>
<ul>
<li>æ·±å…¥æ„å»ºå·¥å…·é…ç½®</li>
<li>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li>æ¨¡å—åŒ–æ¶æ„è®¾è®¡</li>
</ul>
</li>
<li>
<p><strong>é«˜çº§é˜¶æ®µ</strong></p>
<ul>
<li>è‡ªå®šä¹‰æ„å»ºå·¥å…·</li>
<li>å¤§å‹é¡¹ç›®æ¶æ„</li>
<li>å›¢é˜Ÿåä½œå’Œè§„èŒƒ</li>
</ul>
</li>
</ol>
<h3 id="å®è·µå»ºè®®"><a class="header" href="#å®è·µå»ºè®®">å®è·µå»ºè®®</a></h3>
<ul>
<li><strong>åŠ¨æ‰‹å®è·µ</strong>: é€šè¿‡å®é™…é¡¹ç›®åŠ æ·±ç†è§£</li>
<li><strong>æºç é˜…è¯»</strong>: å­¦ä¹ ä¼˜ç§€å¼€æºé¡¹ç›®çš„æ¨¡å—åŒ–è®¾è®¡</li>
<li><strong>ç¤¾åŒºå‚ä¸</strong>: ç§¯æå‚ä¸æŠ€æœ¯è®¨è®ºå’Œè´¡çŒ®</li>
<li><strong>æŒç»­å…³æ³¨</strong>: è·Ÿè¿›æŠ€æœ¯å‘å±•å’Œæ–°ç‰¹æ€§</li>
</ul>
<h3 id="å…³æ³¨é‡ç‚¹"><a class="header" href="#å…³æ³¨é‡ç‚¹">å…³æ³¨é‡ç‚¹</a></h3>
<ul>
<li><strong>æ ‡å‡†å‘å±•</strong>: å…³æ³¨ECMAScriptæ–°ç‰¹æ€§</li>
<li><strong>å·¥å…·æ¼”è¿›</strong>: è·Ÿè¿›æ„å»ºå·¥å…·çš„å‘å±•</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>: æŒç»­å­¦ä¹ æ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li><strong>æœ€ä½³å®è·µ</strong>: å­¦ä¹ å’Œåº”ç”¨è¡Œä¸šæœ€ä½³å®è·µ</li>
</ul>
<p>é€šè¿‡è¿™äº›ä¸°å¯Œçš„å­¦ä¹ èµ„æºï¼Œå¼€å‘è€…å¯ä»¥ç³»ç»Ÿåœ°æŒæ¡JavaScriptæ¨¡å—åŒ–æŠ€æœ¯ï¼Œå¹¶åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨æœ€ä½³å®è·µã€‚å»ºè®®æ ¹æ®è‡ªå·±çš„æŠ€æœ¯æ°´å¹³å’Œé¡¹ç›®éœ€æ±‚ï¼Œæœ‰é€‰æ‹©æ€§åœ°åˆ©ç”¨è¿™äº›èµ„æºè¿›è¡Œæ·±å…¥å­¦ä¹ ã€‚</p>
<hr>
<p><strong>å®Œç»“</strong> ğŸ‰</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
