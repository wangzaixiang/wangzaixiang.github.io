<!DOCTYPE HTML>
<html lang="zh-CN" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>大型项目模块组织 - JavaScript 模块化开发指南</title>


        <!-- Custom HTML head -->

        <meta name="description" content="深入理解 JavaScript 模块系统：从基础概念到现代工具链">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">JavaScript 模块化开发指南</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="大型项目模块组织"><a class="header" href="#大型项目模块组织">大型项目模块组织</a></h1>
<p>本章将探讨如何在大型前端项目中进行模块化架构设计，包括项目结构规划、模块间通信、依赖管理和团队协作等方面的最佳实践。</p>
<h2 id="项目背景"><a class="header" href="#项目背景">项目背景</a></h2>
<p>我们以一个大型电商平台前端项目为例，该项目具有以下特点：</p>
<ul>
<li>多个团队并行开发</li>
<li>功能模块复杂且相互关联</li>
<li>需要支持多种业务场景</li>
<li>代码库规模超过100万行</li>
<li>需要支持微前端架构</li>
</ul>
<h2 id="整体架构设计"><a class="header" href="#整体架构设计">整体架构设计</a></h2>
<h3 id="1-分层架构"><a class="header" href="#1-分层架构">1. 分层架构</a></h3>
<pre><code>大型电商平台
├── 应用层 (Applications)
│   ├── 用户端应用 (Customer App)
│   ├── 商家端应用 (Merchant App)
│   └── 管理端应用 (Admin App)
├── 业务层 (Business)
│   ├── 用户模块 (User)
│   ├── 商品模块 (Product)
│   ├── 订单模块 (Order)
│   ├── 支付模块 (Payment)
│   └── 营销模块 (Marketing)
├── 基础设施层 (Infrastructure)
│   ├── 网络服务 (Network)
│   ├── 状态管理 (State)
│   ├── 路由管理 (Router)
│   └── 缓存服务 (Cache)
└── 通用层 (Common)
    ├── UI组件库 (Components)
    ├── 工具函数 (Utils)
    ├── 常量定义 (Constants)
    └── 类型定义 (Types)
</code></pre>
<h3 id="2-目录结构设计"><a class="header" href="#2-目录结构设计">2. 目录结构设计</a></h3>
<pre><code>ecommerce-platform/
├── apps/                          # 应用层
│   ├── customer/                  # 用户端应用
│   ├── merchant/                  # 商家端应用
│   └── admin/                     # 管理端应用
├── packages/                      # 共享包
│   ├── business/                  # 业务模块
│   │   ├── user/
│   │   ├── product/
│   │   ├── order/
│   │   ├── payment/
│   │   └── marketing/
│   ├── infrastructure/            # 基础设施
│   │   ├── network/
│   │   ├── state/
│   │   ├── router/
│   │   └── cache/
│   ├── ui/                        # UI组件库
│   │   ├── components/
│   │   ├── themes/
│   │   └── styles/
│   └── common/                    # 通用工具
│       ├── utils/
│       ├── constants/
│       ├── types/
│       └── hooks/
├── tools/                         # 开发工具
│   ├── build/
│   ├── eslint-config/
│   └── test-utils/
├── docs/                          # 文档
└── scripts/                       # 脚本
</code></pre>
<h2 id="模块设计原则"><a class="header" href="#模块设计原则">模块设计原则</a></h2>
<h3 id="1-领域驱动设计"><a class="header" href="#1-领域驱动设计">1. 领域驱动设计</a></h3>
<p>每个业务模块按照领域驱动设计(DDD)原则组织：</p>
<pre><code class="language-typescript">// packages/business/user/
├── src/
│   ├── domain/                    # 领域层
│   │   ├── entities/              # 实体
│   │   │   ├── User.ts
│   │   │   └── Profile.ts
│   │   ├── valueObjects/          # 值对象
│   │   │   ├── Email.ts
│   │   │   └── Phone.ts
│   │   ├── services/              # 领域服务
│   │   │   └── UserService.ts
│   │   └── repositories/          # 仓储接口
│   │       └── UserRepository.ts
│   ├── infrastructure/            # 基础设施层
│   │   ├── repositories/          # 仓储实现
│   │   │   └── ApiUserRepository.ts
│   │   └── services/              # 外部服务
│   │       └── AuthService.ts
│   ├── application/               # 应用层
│   │   ├── useCases/              # 用例
│   │   │   ├── CreateUser.ts
│   │   │   ├── UpdateProfile.ts
│   │   │   └── GetUserById.ts
│   │   └── dtos/                  # 数据传输对象
│   │       ├── CreateUserDto.ts
│   │       └── UpdateProfileDto.ts
│   └── presentation/              # 表示层
│       ├── components/            # 组件
│       ├── hooks/                 # 钩子
│       └── stores/                # 状态管理
└── package.json
</code></pre>
<h3 id="2-模块边界定义"><a class="header" href="#2-模块边界定义">2. 模块边界定义</a></h3>
<pre><code class="language-typescript">// packages/business/user/src/index.ts
// 只导出应用层和表示层的公共接口
export { CreateUser, UpdateProfile, GetUserById } from './application/useCases';
export { CreateUserDto, UpdateProfileDto } from './application/dtos';
export { UserProfile, UserSettings } from './presentation/components';
export { useUser, useUserProfile } from './presentation/hooks';
export { userStore } from './presentation/stores';

// 类型定义
export type { User, Profile } from './domain/entities';
export type { Email, Phone } from './domain/valueObjects';
</code></pre>
<h3 id="3-依赖注入配置"><a class="header" href="#3-依赖注入配置">3. 依赖注入配置</a></h3>
<pre><code class="language-typescript">// packages/business/user/src/container.ts
import { Container } from 'inversify';
import { UserRepository } from './domain/repositories/UserRepository';
import { ApiUserRepository } from './infrastructure/repositories/ApiUserRepository';
import { CreateUser } from './application/useCases/CreateUser';

const userContainer = new Container();

// 绑定依赖
userContainer.bind&lt;UserRepository&gt;('UserRepository').to(ApiUserRepository);
userContainer.bind&lt;CreateUser&gt;('CreateUser').to(CreateUser);

export { userContainer };
</code></pre>
<h2 id="模块间通信策略"><a class="header" href="#模块间通信策略">模块间通信策略</a></h2>
<h3 id="1-事件驱动架构"><a class="header" href="#1-事件驱动架构">1. 事件驱动架构</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/events/src/EventBus.ts
export interface Event {
  type: string;
  payload: any;
  timestamp: Date;
  source: string;
}

export class EventBus {
  private listeners: Map&lt;string, Set&lt;(event: Event) =&gt; void&gt;&gt; = new Map();

  subscribe(eventType: string, listener: (event: Event) =&gt; void): void {
    if (!this.listeners.has(eventType)) {
      this.listeners.set(eventType, new Set());
    }
    this.listeners.get(eventType)!.add(listener);
  }

  unsubscribe(eventType: string, listener: (event: Event) =&gt; void): void {
    this.listeners.get(eventType)?.delete(listener);
  }

  publish(event: Event): void {
    const listeners = this.listeners.get(event.type);
    if (listeners) {
      listeners.forEach(listener =&gt; listener(event));
    }
  }
}

// 单例实例
export const eventBus = new EventBus();
</code></pre>
<h3 id="2-跨模块通信示例"><a class="header" href="#2-跨模块通信示例">2. 跨模块通信示例</a></h3>
<pre><code class="language-typescript">// packages/business/order/src/application/useCases/CreateOrder.ts
import { eventBus } from '@platform/infrastructure/events';
import { Order } from '../domain/entities/Order';

export class CreateOrder {
  async execute(orderData: CreateOrderDto): Promise&lt;Order&gt; {
    const order = await this.orderRepository.create(orderData);
    
    // 发布订单创建事件
    eventBus.publish({
      type: 'ORDER_CREATED',
      payload: { orderId: order.id, userId: order.userId },
      timestamp: new Date(),
      source: 'order-module'
    });
    
    return order;
  }
}

// packages/business/user/src/application/useCases/UpdateUserPoints.ts
import { eventBus } from '@platform/infrastructure/events';

export class UpdateUserPoints {
  constructor() {
    // 监听订单创建事件
    eventBus.subscribe('ORDER_CREATED', this.handleOrderCreated.bind(this));
  }

  private async handleOrderCreated(event: Event): Promise&lt;void&gt; {
    const { userId } = event.payload;
    await this.userRepository.addPoints(userId, 100);
  }
}
</code></pre>
<h2 id="状态管理架构"><a class="header" href="#状态管理架构">状态管理架构</a></h2>
<h3 id="1-分层状态管理"><a class="header" href="#1-分层状态管理">1. 分层状态管理</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/state/src/Store.ts
import { configureStore } from '@reduxjs/toolkit';
import { userSlice } from '@platform/business/user';
import { productSlice } from '@platform/business/product';
import { orderSlice } from '@platform/business/order';

export const store = configureStore({
  reducer: {
    // 业务状态
    user: userSlice.reducer,
    product: productSlice.reducer,
    order: orderSlice.reducer,
    
    // 应用状态
    ui: uiSlice.reducer,
    router: routerSlice.reducer,
    
    // 基础设施状态
    network: networkSlice.reducer,
    cache: cacheSlice.reducer
  },
  middleware: (getDefaultMiddleware) =&gt;
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: ['persist/PERSIST']
      }
    }).concat(
      // 自定义中间件
      eventMiddleware,
      cacheMiddleware,
      loggerMiddleware
    )
});

export type RootState = ReturnType&lt;typeof store.getState&gt;;
export type AppDispatch = typeof store.dispatch;
</code></pre>
<h3 id="2-模块状态隔离"><a class="header" href="#2-模块状态隔离">2. 模块状态隔离</a></h3>
<pre><code class="language-typescript">// packages/business/user/src/presentation/stores/userSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

interface UserState {
  currentUser: User | null;
  profile: Profile | null;
  loading: boolean;
  error: string | null;
}

const initialState: UserState = {
  currentUser: null,
  profile: null,
  loading: false,
  error: null
};

export const userSlice = createSlice({
  name: 'user',
  initialState,
  reducers: {
    setUser: (state, action: PayloadAction&lt;User&gt;) =&gt; {
      state.currentUser = action.payload;
    },
    setProfile: (state, action: PayloadAction&lt;Profile&gt;) =&gt; {
      state.profile = action.payload;
    },
    setLoading: (state, action: PayloadAction&lt;boolean&gt;) =&gt; {
      state.loading = action.payload;
    },
    setError: (state, action: PayloadAction&lt;string&gt;) =&gt; {
      state.error = action.payload;
    }
  }
});

export const { setUser, setProfile, setLoading, setError } = userSlice.actions;
</code></pre>
<h2 id="组件库设计"><a class="header" href="#组件库设计">组件库设计</a></h2>
<h3 id="1-设计系统组件"><a class="header" href="#1-设计系统组件">1. 设计系统组件</a></h3>
<pre><code class="language-typescript">// packages/ui/components/src/Button/Button.tsx
import React from 'react';
import { styled } from '@platform/ui/themes';

export interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'danger';
  size?: 'small' | 'medium' | 'large';
  disabled?: boolean;
  loading?: boolean;
  children: React.ReactNode;
  onClick?: () =&gt; void;
}

const StyledButton = styled.button&lt;ButtonProps&gt;`
  /* 使用设计系统的token */
  font-family: ${({ theme }) =&gt; theme.typography.fontFamily};
  font-size: ${({ theme, size }) =&gt; theme.typography.fontSize[size || 'medium']};
  padding: ${({ theme, size }) =&gt; theme.spacing.button[size || 'medium']};
  border-radius: ${({ theme }) =&gt; theme.borderRadius.medium};
  
  /* 变体样式 */
  ${({ theme, variant }) =&gt; {
    switch (variant) {
      case 'primary':
        return `
          background-color: ${theme.colors.primary[500]};
          color: ${theme.colors.white};
          border: none;
        `;
      case 'secondary':
        return `
          background-color: transparent;
          color: ${theme.colors.primary[500]};
          border: 1px solid ${theme.colors.primary[500]};
        `;
      case 'danger':
        return `
          background-color: ${theme.colors.danger[500]};
          color: ${theme.colors.white};
          border: none;
        `;
      default:
        return '';
    }
  }}
`;

export const Button: React.FC&lt;ButtonProps&gt; = ({
  variant = 'primary',
  size = 'medium',
  disabled = false,
  loading = false,
  children,
  onClick
}) =&gt; {
  return (
    &lt;StyledButton
      variant={variant}
      size={size}
      disabled={disabled || loading}
      onClick={onClick}
    &gt;
      {loading ? 'Loading...' : children}
    &lt;/StyledButton&gt;
  );
};
</code></pre>
<h3 id="2-复合组件模式"><a class="header" href="#2-复合组件模式">2. 复合组件模式</a></h3>
<pre><code class="language-typescript">// packages/ui/components/src/DataTable/DataTable.tsx
import React from 'react';

interface DataTableProps&lt;T&gt; {
  data: T[];
  children: React.ReactNode;
}

interface DataTableHeaderProps {
  children: React.ReactNode;
}

interface DataTableBodyProps {
  children: React.ReactNode;
}

interface DataTableRowProps&lt;T&gt; {
  item: T;
  children: (item: T) =&gt; React.ReactNode;
}

function DataTable&lt;T&gt;({ data, children }: DataTableProps&lt;T&gt;) {
  return (
    &lt;table className="data-table"&gt;
      {children}
    &lt;/table&gt;
  );
}

function DataTableHeader({ children }: DataTableHeaderProps) {
  return (
    &lt;thead&gt;
      &lt;tr&gt;{children}&lt;/tr&gt;
    &lt;/thead&gt;
  );
}

function DataTableBody&lt;T&gt;({ children }: DataTableBodyProps) {
  return &lt;tbody&gt;{children}&lt;/tbody&gt;;
}

function DataTableRow&lt;T&gt;({ item, children }: DataTableRowProps&lt;T&gt;) {
  return &lt;tr&gt;{children(item)}&lt;/tr&gt;;
}

// 复合组件导出
DataTable.Header = DataTableHeader;
DataTable.Body = DataTableBody;
DataTable.Row = DataTableRow;

export { DataTable };
</code></pre>
<h2 id="性能优化策略"><a class="header" href="#性能优化策略">性能优化策略</a></h2>
<h3 id="1-代码分割策略"><a class="header" href="#1-代码分割策略">1. 代码分割策略</a></h3>
<pre><code class="language-typescript">// apps/customer/src/routes/index.tsx
import { lazy, Suspense } from 'react';
import { Routes, Route } from 'react-router-dom';
import { LoadingSpinner } from '@platform/ui/components';

// 路由级别的代码分割
const HomePage = lazy(() =&gt; import('../pages/HomePage'));
const ProductPage = lazy(() =&gt; import('../pages/ProductPage'));
const OrderPage = lazy(() =&gt; import('../pages/OrderPage'));
const UserPage = lazy(() =&gt; import('../pages/UserPage'));

export function AppRoutes() {
  return (
    &lt;Suspense fallback={&lt;LoadingSpinner /&gt;}&gt;
      &lt;Routes&gt;
        &lt;Route path="/" element={&lt;HomePage /&gt;} /&gt;
        &lt;Route path="/products/*" element={&lt;ProductPage /&gt;} /&gt;
        &lt;Route path="/orders/*" element={&lt;OrderPage /&gt;} /&gt;
        &lt;Route path="/user/*" element={&lt;UserPage /&gt;} /&gt;
      &lt;/Routes&gt;
    &lt;/Suspense&gt;
  );
}
</code></pre>
<h3 id="2-模块级别的懒加载"><a class="header" href="#2-模块级别的懒加载">2. 模块级别的懒加载</a></h3>
<pre><code class="language-typescript">// packages/business/product/src/index.ts
import { lazy } from 'react';

// 懒加载复杂组件
export const ProductCatalog = lazy(() =&gt; import('./presentation/components/ProductCatalog'));
export const ProductDetail = lazy(() =&gt; import('./presentation/components/ProductDetail'));

// 立即导出轻量级模块
export { useProduct } from './presentation/hooks/useProduct';
export { productStore } from './presentation/stores/productSlice';
export type { Product, ProductCategory } from './domain/entities';
</code></pre>
<h3 id="3-缓存策略"><a class="header" href="#3-缓存策略">3. 缓存策略</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/cache/src/CacheManager.ts
export class CacheManager {
  private cache = new Map&lt;string, { data: any; expiry: number }&gt;();

  set&lt;T&gt;(key: string, data: T, ttl: number = 5 * 60 * 1000): void {
    this.cache.set(key, {
      data,
      expiry: Date.now() + ttl
    });
  }

  get&lt;T&gt;(key: string): T | null {
    const cached = this.cache.get(key);
    if (!cached) return null;

    if (Date.now() &gt; cached.expiry) {
      this.cache.delete(key);
      return null;
    }

    return cached.data as T;
  }

  invalidate(pattern: string): void {
    const regex = new RegExp(pattern);
    for (const key of this.cache.keys()) {
      if (regex.test(key)) {
        this.cache.delete(key);
      }
    }
  }
}

export const cacheManager = new CacheManager();
</code></pre>
<h2 id="构建和部署"><a class="header" href="#构建和部署">构建和部署</a></h2>
<h3 id="1-monorepo构建配置"><a class="header" href="#1-monorepo构建配置">1. Monorepo构建配置</a></h3>
<pre><code class="language-javascript">// turbo.json
{
  "pipeline": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": ["dist/**", ".next/**"]
    },
    "test": {
      "dependsOn": ["^build"],
      "outputs": ["coverage/**"]
    },
    "lint": {
      "outputs": []
    },
    "dev": {
      "cache": false
    }
  }
}
</code></pre>
<h3 id="2-微前端部署策略"><a class="header" href="#2-微前端部署策略">2. 微前端部署策略</a></h3>
<pre><code class="language-typescript">// tools/build/webpack.config.js
const ModuleFederationPlugin = require('@module-federation/webpack');

module.exports = {
  plugins: [
    new ModuleFederationPlugin({
      name: 'customer_app',
      filename: 'remoteEntry.js',
      exposes: {
        './App': './src/App',
        './routes': './src/routes'
      },
      shared: {
        react: { singleton: true },
        'react-dom': { singleton: true },
        '@platform/ui': { singleton: true }
      }
    })
  ]
};
</code></pre>
<h2 id="团队协作"><a class="header" href="#团队协作">团队协作</a></h2>
<h3 id="1-模块所有权"><a class="header" href="#1-模块所有权">1. 模块所有权</a></h3>
<pre><code class="language-yaml"># .github/CODEOWNERS
# 业务模块所有权
/packages/business/user/ @user-team
/packages/business/product/ @product-team
/packages/business/order/ @order-team
/packages/business/payment/ @payment-team

# 基础设施
/packages/infrastructure/ @platform-team
/packages/ui/ @design-system-team

# 应用
/apps/customer/ @frontend-team
/apps/merchant/ @merchant-team
/apps/admin/ @admin-team
</code></pre>
<h3 id="2-开发工作流"><a class="header" href="#2-开发工作流">2. 开发工作流</a></h3>
<pre><code class="language-typescript">// scripts/dev-workflow.ts
export class DevWorkflow {
  async runTests(modules: string[]): Promise&lt;void&gt; {
    // 只运行相关模块的测试
    for (const module of modules) {
      await this.runModuleTests(module);
    }
  }

  async buildAffectedModules(changedFiles: string[]): Promise&lt;void&gt; {
    const affectedModules = this.getAffectedModules(changedFiles);
    await this.buildModules(affectedModules);
  }

  private getAffectedModules(changedFiles: string[]): string[] {
    // 基于依赖图分析影响的模块
    return this.dependencyGraph.getAffected(changedFiles);
  }
}
</code></pre>
<h2 id="监控和维护"><a class="header" href="#监控和维护">监控和维护</a></h2>
<h3 id="1-模块健康度监控"><a class="header" href="#1-模块健康度监控">1. 模块健康度监控</a></h3>
<pre><code class="language-typescript">// tools/monitoring/src/ModuleHealthChecker.ts
export class ModuleHealthChecker {
  checkDependencyHealth(): HealthReport {
    const report: HealthReport = {
      circularDependencies: this.findCircularDependencies(),
      unusedDependencies: this.findUnusedDependencies(),
      outdatedDependencies: this.findOutdatedDependencies(),
      bundleSize: this.analyzeBundleSize()
    };
    return report;
  }

  generateReport(): void {
    const health = this.checkDependencyHealth();
    console.log('模块健康度报告:', health);
  }
}
</code></pre>
<h3 id="2-性能监控"><a class="header" href="#2-性能监控">2. 性能监控</a></h3>
<pre><code class="language-typescript">// packages/infrastructure/monitoring/src/PerformanceMonitor.ts
export class PerformanceMonitor {
  trackModuleLoad(moduleName: string): void {
    const startTime = performance.now();
    
    // 监控模块加载时间
    import(moduleName).then(() =&gt; {
      const loadTime = performance.now() - startTime;
      this.reportMetric('module_load_time', loadTime, { module: moduleName });
    });
  }

  trackComponentRender(componentName: string, renderTime: number): void {
    this.reportMetric('component_render_time', renderTime, { component: componentName });
  }

  private reportMetric(metric: string, value: number, tags: Record&lt;string, string&gt;): void {
    // 发送到监控系统
    analytics.track(metric, value, tags);
  }
}
</code></pre>
<h2 id="最佳实践总结"><a class="header" href="#最佳实践总结">最佳实践总结</a></h2>
<h3 id="1-架构设计原则"><a class="header" href="#1-架构设计原则">1. 架构设计原则</a></h3>
<ul>
<li><strong>单一职责</strong>：每个模块只负责一个业务领域</li>
<li><strong>依赖倒置</strong>：依赖抽象而不是具体实现</li>
<li><strong>开放封闭</strong>：对扩展开放，对修改封闭</li>
<li><strong>接口隔离</strong>：客户端不应该依赖它不需要的接口</li>
</ul>
<h3 id="2-模块化策略"><a class="header" href="#2-模块化策略">2. 模块化策略</a></h3>
<ul>
<li><strong>清晰的边界</strong>：明确定义模块的输入和输出</li>
<li><strong>松耦合</strong>：减少模块间的直接依赖</li>
<li><strong>高内聚</strong>：相关功能应该在同一个模块内</li>
<li><strong>可测试性</strong>：模块应该易于单独测试</li>
</ul>
<h3 id="3-团队协作"><a class="header" href="#3-团队协作">3. 团队协作</a></h3>
<ul>
<li><strong>模块所有权</strong>：每个模块有明确的负责团队</li>
<li><strong>API契约</strong>：模块间通过稳定的API进行交互</li>
<li><strong>版本管理</strong>：使用语义化版本管理模块更新</li>
<li><strong>文档维护</strong>：保持API文档和架构文档的更新</li>
</ul>
<h3 id="4-性能优化"><a class="header" href="#4-性能优化">4. 性能优化</a></h3>
<ul>
<li><strong>代码分割</strong>：按需加载模块和组件</li>
<li><strong>缓存策略</strong>：合理使用各种缓存机制</li>
<li><strong>包体积优化</strong>：避免重复依赖和无用代码</li>
<li><strong>运行时优化</strong>：使用虚拟列表、memo等技术</li>
</ul>
<p>通过这套完整的大型项目模块化方案，我们可以构建出可维护、可扩展、高性能的企业级前端应用。</p>
<hr />
<p><strong>下一章</strong>: <a href="lazy-loading.html">模块懒加载实现</a> →</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../examples/library.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../examples/lazy-loading.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../examples/library.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../examples/lazy-loading.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
